(()=>{"use strict";function e(e){const t=window.location.href;e=e.replace(/[\[\]]/g,"\\$&");const n=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)").exec(t);return n?n[2]?decodeURIComponent(n[2].replace(/\+/g," ")):"":null}var t=function(e,t,n,o){return new(n||(n=Promise))((function(s,a){function i(e){try{l(o.next(e))}catch(t){a(t)}}function r(e){try{l(o.throw(e))}catch(t){a(t)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,r)}l((o=o.apply(e,t||[])).next())}))};class n{constructor(e,t,n){this.systemLanguage=e,this.localesDirectory=t,this.getLocalesJson=n,this.supportedTranslationLocales=["en"],this.defaultLocale="en",this.localeNames=new Map([["af","Afrikaans"],["ar","العربية الفصحى"],["az","Azərbaycanca"],["be","Беларуская"],["bg","български"],["bn","বাংলা"],["bs","bosanski jezik"],["ca","català"],["cs","čeština"],["cy","Cymraeg, y Gymraeg"],["da","dansk"],["de","Deutsch"],["el","Ελληνικά"],["en","English"],["en-GB","English (British)"],["en-IN","English (India)"],["eo","Esperanto"],["es","español"],["et","eesti"],["eu","euskara"],["fa","فارسی"],["fi","suomi"],["fil","Wikang Filipino"],["fr","français"],["gl","galego"],["he","עברית"],["hi","हिन्दी"],["hr","hrvatski"],["hu","magyar"],["id","Bahasa Indonesia"],["it","italiano"],["ja","日本語"],["ka","ქართული"],["km","ខ្មែរ, ខេមរភាសា, ភាសាខ្មែរ"],["kn","ಕನ್ನಡ"],["ko","한국어"],["lt","lietuvių kalba"],["lv","Latvietis"],["me","црногорски"],["ml","മലയാളം"],["mr","मराठी"],["my","ဗမာစကား"],["nb","norsk (bokmål)"],["ne","नेपाली"],["nl","Nederlands"],["nn","Norsk Nynorsk"],["or","ଓଡ଼ିଆ"],["pl","polski"],["pt-BR","português do Brasil"],["pt-PT","português"],["ro","română"],["ru","русский"],["si","සිංහල"],["sk","slovenčina"],["sl","Slovenski jezik, Slovenščina"],["sr","Српски"],["sv","svenska"],["te","తెలుగు"],["th","ไทย"],["tr","Türkçe"],["uk","українська"],["vi","Tiếng Việt"],["zh-CN","中文（中国大陆）"],["zh-TW","中文（台灣）"]]),this.defaultMessages={},this.localeMessages={},this.systemLanguage=e.replace("_","-")}init(e){return t(this,void 0,void 0,(function*(){if(this.inited)throw new Error("i18n already initialized.");if(null==this.supportedTranslationLocales||0===this.supportedTranslationLocales.length)throw new Error("supportedTranslationLocales not set.");this.inited=!0,this.translationLocale=null!=e?e:this.systemLanguage;try{this.collator=new Intl.Collator(this.translationLocale,{numeric:!0,sensitivity:"base"})}catch(t){this.collator=null}-1===this.supportedTranslationLocales.indexOf(this.translationLocale)&&(this.translationLocale=this.translationLocale.slice(0,2),-1===this.supportedTranslationLocales.indexOf(this.translationLocale)&&(this.translationLocale=this.defaultLocale)),null!=this.localesDirectory&&(yield this.loadMessages(this.translationLocale,this.localeMessages),this.translationLocale!==this.defaultLocale&&(yield this.loadMessages(this.defaultLocale,this.defaultMessages)))}))}t(e,t,n,o){return this.translate(e,t,n,o)}translate(e,t,n,o){let s;return s=this.localeMessages.hasOwnProperty(e)&&this.localeMessages[e]?this.localeMessages[e]:this.defaultMessages.hasOwnProperty(e)&&this.defaultMessages[e]?this.defaultMessages[e]:"",""!==s&&(null!=t&&(s=s.split("__$1__").join(t.toString())),null!=n&&(s=s.split("__$2__").join(n.toString())),null!=o&&(s=s.split("__$3__").join(o.toString()))),s}loadMessages(e,n){return t(this,void 0,void 0,(function*(){const t=e.replace("-","_"),o=yield this.getLocalesJson(t);for(const e in o)if(o.hasOwnProperty(e)&&(n[e]=o[e].message,o[e].placeholders))for(const t in o[e].placeholders){if(!o[e].placeholders.hasOwnProperty(t)||!o[e].placeholders[t].content)continue;const s="\\$"+t.toUpperCase()+"\\$";let a=o[e].placeholders[t].content;"$1"!==a&&"$2"!==a&&"$3"!==a||(a="__$"+a+"__"),n[e]=n[e].replace(new RegExp(s,"g"),a)}}))}}const o=["en","af","ar","az","be","bg","bn","bs","ca","cs","cy","da","de","el","en-GB","en-IN","eo","es","et","eu","fa","fi","fil","fr","gl","he","hi","hr","hu","id","it","ja","ka","km","kn","ko","lv","ml","mr","my","nb","ne","nl","nn","or","pl","pt-PT","pt-BR","ro","ru","si","sk","sl","sr","sv","te","th","tr","uk","vi","zh-CN","zh-TW"];var s=function(e,t,n,o){return new(n||(n=Promise))((function(s,a){function i(e){try{l(o.next(e))}catch(t){a(t)}}function r(e){try{l(o.throw(e))}catch(t){a(t)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,r)}l((o=o.apply(e,t||[])).next())}))};class a extends n{constructor(e,t){super(e||"en-US",t,(e=>s(this,void 0,void 0,(function*(){const t=this.localesDirectory+"/"+e+"/messages.json?cache=j6vwl9",n=yield fetch(t);return yield n.json()})))),this.supportedTranslationLocales=o}get translationLocale(){return this._translationLocale}set translationLocale(e){this._translationLocale=e}}var i=function(e,t,n,o){return new(n||(n=Promise))((function(s,a){function i(e){try{l(o.next(e))}catch(t){a(t)}}function r(e){try{l(o.throw(e))}catch(t){a(t)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,r)}l((o=o.apply(e,t||[])).next())}))};let r=null;function l(e){var t;const n=document.getElementById("content");if(!n)throw new Error("content element not found");n.className="tw-text-center",n.innerHTML="";const o=document.createElement("h1"),s=document.createElement("p");if(!r)throw new Error("localeService is not initialized");if(o.textContent=r.t("youSuccessfullyLoggedIn"),s.textContent="web"==e?r.t("thisWindowWillCloseIn5Seconds"):r.t("youMayCloseThisWindow"),o.className="tw-font-semibold",s.className="tw-mb-4",n.appendChild(o),n.appendChild(s),"web"==e){const e=document.createElement("button");if(e.textContent=r.t("close"),e.className="tw-bg-primary-600 hover:tw-bg-primary-700 tw-text-contrast tw-px-4 tw-py-2 tw-rounded-md tw-transition tw-border-transparent tw-text-center focus:tw-outline-none",e.addEventListener("click",(()=>{window.close()})),n.appendChild(e),null===s.textContent)throw new Error("count down container is null");const o=(null===(t=s.textContent.match(/\d+/))||void 0===t?void 0:t[0])||null;if(!o)throw new Error("count down time cannot be null");let a=Number(o);const i=setInterval((()=>{if(a>1){if(null===s.textContent)throw new Error("count down container is null");s.textContent=s.textContent.replace(String(a),String(a-1)),a--}else clearInterval(i),window.close()}),1e3)}}window.addEventListener("load",(()=>i(void 0,void 0,void 0,(function*(){const t=e("duoFramelessUrl");if(t)return void function(e){const t=/^api-[a-zA-Z0-9]+\.(duosecurity|duofederal)\.com$/,n=new URL(e);if(n.username||n.password)throw new Error("Invalid redirect URL: embedded credentials not allowed");if("https:"!==n.protocol)throw new Error("Invalid redirect URL: invalid protocol");if(n.port&&"443"!==n.port)throw new Error("Invalid redirect URL: port not allowed");if("/oauth/v1/authorize"!==n.pathname)throw new Error("Invalid redirect URL: invalid pathname");if(!t.test(n.hostname))throw new Error("Invalid redirect URL");window.location.href=e}(t);const n=e("client"),o=e("code"),s=e("state");if(!n)throw new Error("client is null");if(!o)throw new Error("code is null");if(!s)throw new Error("state is null");if(r=new a(navigator.language,"locales"),yield r.init(),"web"===n){const e=new BroadcastChannel("duoResult");e.postMessage({code:o,state:s}),e.close(),l(n)}else"browser"===n?(window.postMessage({command:"duoResult",code:o,state:s},window.location.origin),l(n)):"mobile"!==n&&"desktop"!==n||("desktop"===n&&l(n),document.location.replace("bitwarden://duo-callback?code="+encodeURIComponent(o)+"&state="+encodeURIComponent(s)))}))))})();
//# sourceMappingURL=duo-redirect.2cb63ccc84aad6834f8f.js.map