{"version":3,"file":"encrypt-worker.f26ac70601559c4b1b16.js","mappings":"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","sources":["webpack://@bitwarden/web-vault/webpack/runtime/chunk loaded","webpack://@bitwarden/web-vault/webpack/runtime/startup chunk dependencies","webpack://@bitwarden/web-vault/../../libs/common/src/enums/push-technology.enum.ts","webpack://@bitwarden/web-vault/../../libs/common/src/platform/abstractions/config/server-config.ts","webpack://@bitwarden/web-vault/../../libs/common/src/platform/misc/utils.ts","webpack://@bitwarden/web-vault/../../libs/common/src/platform/enums/encryption-type.enum.ts","webpack://@bitwarden/web-vault/../../libs/common/src/platform/enums/file-upload-type.enum.ts","webpack://@bitwarden/web-vault/../../libs/common/src/platform/enums/hash-purpose.enum.ts","webpack://@bitwarden/web-vault/../../libs/storage-core/src/html-storage-location.enum.ts","webpack://@bitwarden/web-vault/../../libs/storage-core/src/storage-location.enum.ts","webpack://@bitwarden/web-vault/../../libs/common/src/platform/enums/key-suffix-options.enum.ts","webpack://@bitwarden/web-vault/../../libs/common/src/platform/enums/log-level-type.enum.ts","webpack://@bitwarden/web-vault/../../libs/common/src/platform/enums/theme-type.enum.ts","webpack://@bitwarden/web-vault/../../libs/common/src/platform/models/domain/symmetric-crypto-key.ts","webpack://@bitwarden/web-vault/../../libs/common/src/platform/services/console-log.service.ts","webpack://@bitwarden/web-vault/../../libs/common/src/platform/services/container.service.ts","webpack://@bitwarden/web-vault/../../libs/common/src/platform/models/domain/enc-string.ts","webpack://@bitwarden/web-vault/../../libs/common/src/platform/services/cryptography/initializer-key.ts","webpack://@bitwarden/web-vault/../../libs/common/src/platform/models/domain/domain-base.ts","webpack://@bitwarden/web-vault/../../libs/common/src/vault/enums/cipher-type.ts","webpack://@bitwarden/web-vault/../../libs/common/src/models/response/base.response.ts","webpack://@bitwarden/web-vault/../../libs/common/src/vault/models/api/cipher-permissions.api.ts","webpack://@bitwarden/web-vault/../../libs/common/src/vault/models/data/attachment.data.ts","webpack://@bitwarden/web-vault/../../libs/common/src/vault/models/data/card.data.ts","webpack://@bitwarden/web-vault/../../libs/common/src/vault/models/data/field.data.ts","webpack://@bitwarden/web-vault/../../libs/common/src/vault/models/data/identity.data.ts","webpack://@bitwarden/web-vault/../../libs/common/src/vault/models/data/fido2-credential.data.ts","webpack://@bitwarden/web-vault/../../libs/common/src/vault/models/data/login-uri.data.ts","webpack://@bitwarden/web-vault/../../libs/common/src/vault/models/data/login.data.ts","webpack://@bitwarden/web-vault/../../libs/common/src/vault/models/data/password-history.data.ts","webpack://@bitwarden/web-vault/../../libs/common/src/vault/models/data/secure-note.data.ts","webpack://@bitwarden/web-vault/../../libs/common/src/vault/models/data/ssh-key.data.ts","webpack://@bitwarden/web-vault/../../libs/common/src/vault/models/data/cipher.data.ts","webpack://@bitwarden/web-vault/../../libs/common/src/vault/enums/cipher-reprompt-type.ts","webpack://@bitwarden/web-vault/../../libs/common/src/vault/enums/linked-id-type.enum.ts","webpack://@bitwarden/web-vault/../../libs/common/src/vault/enums/field-type.enum.ts","webpack://@bitwarden/web-vault/../../libs/common/src/vault/models/view/attachment.view.ts","webpack://@bitwarden/web-vault/../../libs/common/src/autofill/constants/match-patterns.ts","webpack://@bitwarden/web-vault/../../libs/common/src/autofill/utils.ts","webpack://@bitwarden/web-vault/../../libs/common/src/vault/linked-field-option.decorator.ts","webpack://@bitwarden/web-vault/../../libs/common/src/vault/models/view/item.view.ts","webpack://@bitwarden/web-vault/../../libs/common/src/vault/models/view/card.view.ts","webpack://@bitwarden/web-vault/../../libs/common/src/vault/models/view/field.view.ts","webpack://@bitwarden/web-vault/../../libs/common/src/vault/models/view/identity.view.ts","webpack://@bitwarden/web-vault/../../libs/common/src/vault/models/view/fido2-credential.view.ts","webpack://@bitwarden/web-vault/../../libs/common/src/models/domain/domain-service.ts","webpack://@bitwarden/web-vault/../../libs/common/src/platform/misc/safe-urls.ts","webpack://@bitwarden/web-vault/../../libs/common/src/vault/models/view/login-uri.view.ts","webpack://@bitwarden/web-vault/../../libs/common/src/vault/models/view/login.view.ts","webpack://@bitwarden/web-vault/../../libs/common/src/vault/models/view/password-history.view.ts","webpack://@bitwarden/web-vault/../../libs/common/src/vault/models/view/secure-note.view.ts","webpack://@bitwarden/web-vault/../../libs/common/src/vault/models/view/ssh-key.view.ts","webpack://@bitwarden/web-vault/../../libs/common/src/vault/models/view/cipher.view.ts","webpack://@bitwarden/web-vault/../../libs/common/src/vault/models/domain/attachment.ts","webpack://@bitwarden/web-vault/../../libs/common/src/vault/models/domain/card.ts","webpack://@bitwarden/web-vault/../../libs/common/src/vault/models/domain/field.ts","webpack://@bitwarden/web-vault/../../libs/common/src/vault/models/domain/identity.ts","webpack://@bitwarden/web-vault/../../libs/common/src/vault/models/domain/fido2-credential.ts","webpack://@bitwarden/web-vault/../../libs/common/src/vault/models/domain/login-uri.ts","webpack://@bitwarden/web-vault/../../libs/common/src/vault/models/domain/login.ts","webpack://@bitwarden/web-vault/../../libs/common/src/vault/models/domain/password.ts","webpack://@bitwarden/web-vault/../../libs/common/src/vault/models/domain/secure-note.ts","webpack://@bitwarden/web-vault/../../libs/common/src/vault/models/domain/ssh-key.ts","webpack://@bitwarden/web-vault/../../libs/common/src/vault/models/domain/cipher.ts","webpack://@bitwarden/web-vault/../../libs/common/src/platform/services/cryptography/get-class-initializer.ts","webpack://@bitwarden/web-vault/../../libs/common/src/key-management/crypto/types/worker-command.type.ts","webpack://@bitwarden/web-vault/../../libs/common/src/platform/models/domain/enc-array-buffer.ts","webpack://@bitwarden/web-vault/../../libs/common/src/platform/models/domain/encrypted-object.ts","webpack://@bitwarden/web-vault/../../libs/common/src/enums/feature-flag.enum.ts","webpack://@bitwarden/web-vault/../../libs/common/src/platform/abstractions/sdk/sdk-load.service.ts","webpack://@bitwarden/web-vault/../../libs/common/src/key-management/crypto/services/encrypt.service.implementation.ts","webpack://@bitwarden/web-vault/../../libs/common/src/key-management/crypto/services/web-crypto-function.service.ts","webpack://@bitwarden/web-vault/../../libs/common/src/key-management/crypto/services/encrypt.worker.ts","webpack://@bitwarden/web-vault/webpack/bootstrap","webpack://@bitwarden/web-vault/webpack/runtime/define property getters","webpack://@bitwarden/web-vault/webpack/runtime/ensure chunk","webpack://@bitwarden/web-vault/webpack/runtime/get javascript chunk filename","webpack://@bitwarden/web-vault/webpack/runtime/get mini-css chunk filename","webpack://@bitwarden/web-vault/webpack/runtime/global","webpack://@bitwarden/web-vault/webpack/runtime/harmony module decorator","webpack://@bitwarden/web-vault/webpack/runtime/hasOwnProperty shorthand","webpack://@bitwarden/web-vault/webpack/runtime/make namespace object","webpack://@bitwarden/web-vault/webpack/runtime/publicPath","webpack://@bitwarden/web-vault/webpack/runtime/importScripts chunk loading","webpack://@bitwarden/web-vault/webpack/startup"],"sourcesContent":["var deferred = [];\n__webpack_require__.O = (result, chunkIds, fn, priority) => {\n\tif(chunkIds) {\n\t\tpriority = priority || 0;\n\t\tfor(var i = deferred.length; i > 0 && deferred[i - 1][2] > priority; i--) deferred[i] = deferred[i - 1];\n\t\tdeferred[i] = [chunkIds, fn, priority];\n\t\treturn;\n\t}\n\tvar notFulfilled = Infinity;\n\tfor (var i = 0; i < deferred.length; i++) {\n\t\tvar [chunkIds, fn, priority] = deferred[i];\n\t\tvar fulfilled = true;\n\t\tfor (var j = 0; j < chunkIds.length; j++) {\n\t\t\tif ((priority & 1 === 0 || notFulfilled >= priority) && Object.keys(__webpack_require__.O).every((key) => (__webpack_require__.O[key](chunkIds[j])))) {\n\t\t\t\tchunkIds.splice(j--, 1);\n\t\t\t} else {\n\t\t\t\tfulfilled = false;\n\t\t\t\tif(priority < notFulfilled) notFulfilled = priority;\n\t\t\t}\n\t\t}\n\t\tif(fulfilled) {\n\t\t\tdeferred.splice(i--, 1)\n\t\t\tvar r = fn();\n\t\t\tif (r !== undefined) result = r;\n\t\t}\n\t}\n\treturn result;\n};","var next = __webpack_require__.x;\n__webpack_require__.x = () => {\n\treturn __webpack_require__.e(577).then(next);\n};","/**\n * The preferred push technology of the server.\n */\n// FIXME: update to use a const object instead of a typescript enum\n// eslint-disable-next-line @bitwarden/platform/no-enums\nexport enum PushTechnology {\n  /**\n   * Indicates that we should use SignalR over web sockets to receive push notifications from the server.\n   */\n  SignalR = 0,\n  /**\n   * Indicatates that we should use WebPush to receive push notifications from the server.\n   */\n  WebPush = 1,\n}\n","// FIXME: Update this file to be type safe and remove this and next line\n// @ts-strict-ignore\nimport { Jsonify } from \"type-fest\";\n\nimport { AllowedFeatureFlagTypes } from \"../../../enums/feature-flag.enum\";\nimport { PushTechnology } from \"../../../enums/push-technology.enum\";\nimport {\n  ServerConfigData,\n  ThirdPartyServerConfigData,\n  EnvironmentServerConfigData,\n} from \"../../models/data/server-config.data\";\nimport { ServerSettings } from \"../../models/domain/server-settings\";\n\ntype PushConfig =\n  | { pushTechnology: PushTechnology.SignalR }\n  | { pushTechnology: PushTechnology.WebPush; vapidPublicKey: string }\n  | undefined;\n\nconst dayInMilliseconds = 24 * 3600 * 1000;\n\nexport class ServerConfig {\n  version: string;\n  gitHash: string;\n  server?: ThirdPartyServerConfigData;\n  environment?: EnvironmentServerConfigData;\n  utcDate: Date;\n  featureStates: { [key: string]: AllowedFeatureFlagTypes } = {};\n  push: PushConfig;\n  settings: ServerSettings;\n\n  constructor(serverConfigData: ServerConfigData) {\n    this.version = serverConfigData.version;\n    this.gitHash = serverConfigData.gitHash;\n    this.server = serverConfigData.server;\n    this.utcDate = new Date(serverConfigData.utcDate);\n    this.environment = serverConfigData.environment;\n    this.featureStates = serverConfigData.featureStates;\n    this.push =\n      serverConfigData.push == null\n        ? {\n            pushTechnology: PushTechnology.SignalR,\n          }\n        : {\n            pushTechnology: serverConfigData.push.pushTechnology,\n            vapidPublicKey: serverConfigData.push.vapidPublicKey,\n          };\n    this.settings = serverConfigData.settings;\n\n    if (this.server?.name == null && this.server?.url == null) {\n      this.server = null;\n    }\n  }\n\n  private getAgeInMilliseconds(): number {\n    return new Date().getTime() - this.utcDate?.getTime();\n  }\n\n  isValid(): boolean {\n    return this.getAgeInMilliseconds() <= dayInMilliseconds;\n  }\n\n  static fromJSON(obj: Jsonify<ServerConfig>): ServerConfig {\n    if (obj == null) {\n      return null;\n    }\n\n    return new ServerConfig(obj);\n  }\n}\n","// FIXME: Update this file to be type safe and remove this and next line\n// @ts-strict-ignore\n/* eslint-disable no-useless-escape */\nimport * as path from \"path\";\n\nimport { Buffer as BufferLib } from \"buffer/\";\nimport { Observable, of, switchMap } from \"rxjs\";\nimport { getHostname, parse } from \"tldts\";\nimport { Merge } from \"type-fest\";\n\n// This import has been flagged as unallowed for this class. It may be involved in a circular dependency loop.\n// eslint-disable-next-line no-restricted-imports\nimport { KeyService } from \"@bitwarden/key-management\";\n\nimport { EncryptService } from \"../../key-management/crypto/abstractions/encrypt.service\";\nimport { I18nService } from \"../abstractions/i18n.service\";\n\n// FIXME: Remove when updating file. Eslint update\n// eslint-disable-next-line @typescript-eslint/no-require-imports\nconst nodeURL = typeof self === \"undefined\" ? require(\"url\") : null;\n\ndeclare global {\n  /* eslint-disable-next-line no-var */\n  var bitwardenContainerService: BitwardenContainerService;\n}\n\ninterface BitwardenContainerService {\n  getKeyService: () => KeyService;\n  getEncryptService: () => EncryptService;\n}\n\nexport class Utils {\n  static inited = false;\n  static isNode = false;\n  static isBrowser = true;\n  static isMobileBrowser = false;\n  static isAppleMobileBrowser = false;\n  static global: typeof global = null;\n  // Transpiled version of /\\p{Emoji_Presentation}/gu using https://mothereff.in/regexpu. Used for compatability in older browsers.\n  static regexpEmojiPresentation =\n    /(?:[\\u231A\\u231B\\u23E9-\\u23EC\\u23F0\\u23F3\\u25FD\\u25FE\\u2614\\u2615\\u2648-\\u2653\\u267F\\u2693\\u26A1\\u26AA\\u26AB\\u26BD\\u26BE\\u26C4\\u26C5\\u26CE\\u26D4\\u26EA\\u26F2\\u26F3\\u26F5\\u26FA\\u26FD\\u2705\\u270A\\u270B\\u2728\\u274C\\u274E\\u2753-\\u2755\\u2757\\u2795-\\u2797\\u27B0\\u27BF\\u2B1B\\u2B1C\\u2B50\\u2B55]|\\uD83C[\\uDC04\\uDCCF\\uDD8E\\uDD91-\\uDD9A\\uDDE6-\\uDDFF\\uDE01\\uDE1A\\uDE2F\\uDE32-\\uDE36\\uDE38-\\uDE3A\\uDE50\\uDE51\\uDF00-\\uDF20\\uDF2D-\\uDF35\\uDF37-\\uDF7C\\uDF7E-\\uDF93\\uDFA0-\\uDFCA\\uDFCF-\\uDFD3\\uDFE0-\\uDFF0\\uDFF4\\uDFF8-\\uDFFF]|\\uD83D[\\uDC00-\\uDC3E\\uDC40\\uDC42-\\uDCFC\\uDCFF-\\uDD3D\\uDD4B-\\uDD4E\\uDD50-\\uDD67\\uDD7A\\uDD95\\uDD96\\uDDA4\\uDDFB-\\uDE4F\\uDE80-\\uDEC5\\uDECC\\uDED0-\\uDED2\\uDED5-\\uDED7\\uDEEB\\uDEEC\\uDEF4-\\uDEFC\\uDFE0-\\uDFEB]|\\uD83E[\\uDD0C-\\uDD3A\\uDD3C-\\uDD45\\uDD47-\\uDD78\\uDD7A-\\uDDCB\\uDDCD-\\uDDFF\\uDE70-\\uDE74\\uDE78-\\uDE7A\\uDE80-\\uDE86\\uDE90-\\uDEA8\\uDEB0-\\uDEB6\\uDEC0-\\uDEC2\\uDED0-\\uDED6])/g;\n  static readonly validHosts: string[] = [\"localhost\"];\n  static readonly originalMinimumPasswordLength = 8;\n  static readonly minimumPasswordLength = 12;\n  static readonly DomainMatchBlacklist = new Map<string, Set<string>>([\n    [\"google.com\", new Set([\"script.google.com\"])],\n  ]);\n\n  static init() {\n    if (Utils.inited) {\n      return;\n    }\n\n    Utils.inited = true;\n    Utils.isNode =\n      typeof process !== \"undefined\" &&\n      (process as any).release != null &&\n      (process as any).release.name === \"node\";\n    Utils.isBrowser = typeof window !== \"undefined\";\n\n    Utils.isMobileBrowser = Utils.isBrowser && this.isMobile(window);\n    Utils.isAppleMobileBrowser = Utils.isBrowser && this.isAppleMobile(window);\n\n    if (Utils.isNode) {\n      Utils.global = global;\n    } else if (Utils.isBrowser) {\n      Utils.global = window;\n    } else {\n      // If it's not browser or node then it must be a service worker\n      Utils.global = self;\n    }\n  }\n\n  static fromB64ToArray(str: string): Uint8Array {\n    if (str == null) {\n      return null;\n    }\n\n    if (Utils.isNode) {\n      return new Uint8Array(Buffer.from(str, \"base64\"));\n    } else {\n      const binaryString = Utils.global.atob(str);\n      const bytes = new Uint8Array(binaryString.length);\n      for (let i = 0; i < binaryString.length; i++) {\n        bytes[i] = binaryString.charCodeAt(i);\n      }\n      return bytes;\n    }\n  }\n\n  static fromUrlB64ToArray(str: string): Uint8Array {\n    return Utils.fromB64ToArray(Utils.fromUrlB64ToB64(str));\n  }\n\n  static fromHexToArray(str: string): Uint8Array {\n    if (Utils.isNode) {\n      return new Uint8Array(Buffer.from(str, \"hex\"));\n    } else {\n      const bytes = new Uint8Array(str.length / 2);\n      for (let i = 0; i < str.length; i += 2) {\n        bytes[i / 2] = parseInt(str.substr(i, 2), 16);\n      }\n      return bytes;\n    }\n  }\n\n  static fromUtf8ToArray(str: string): Uint8Array {\n    if (Utils.isNode) {\n      return new Uint8Array(Buffer.from(str, \"utf8\"));\n    } else {\n      const strUtf8 = unescape(encodeURIComponent(str));\n      const arr = new Uint8Array(strUtf8.length);\n      for (let i = 0; i < strUtf8.length; i++) {\n        arr[i] = strUtf8.charCodeAt(i);\n      }\n      return arr;\n    }\n  }\n\n  static fromByteStringToArray(str: string): Uint8Array {\n    if (str == null) {\n      return null;\n    }\n    const arr = new Uint8Array(str.length);\n    for (let i = 0; i < str.length; i++) {\n      arr[i] = str.charCodeAt(i);\n    }\n    return arr;\n  }\n\n  static fromBufferToB64(buffer: ArrayBuffer): string {\n    if (buffer == null) {\n      return null;\n    }\n    if (Utils.isNode) {\n      return Buffer.from(buffer).toString(\"base64\");\n    } else {\n      let binary = \"\";\n      const bytes = new Uint8Array(buffer);\n      for (let i = 0; i < bytes.byteLength; i++) {\n        binary += String.fromCharCode(bytes[i]);\n      }\n      return Utils.global.btoa(binary);\n    }\n  }\n\n  static fromBufferToUrlB64(buffer: ArrayBuffer): string {\n    return Utils.fromB64toUrlB64(Utils.fromBufferToB64(buffer));\n  }\n\n  static fromB64toUrlB64(b64Str: string) {\n    return b64Str.replace(/\\+/g, \"-\").replace(/\\//g, \"_\").replace(/=/g, \"\");\n  }\n\n  static fromBufferToUtf8(buffer: ArrayBuffer): string {\n    return BufferLib.from(buffer).toString(\"utf8\");\n  }\n\n  static fromBufferToByteString(buffer: ArrayBuffer): string {\n    return String.fromCharCode.apply(null, new Uint8Array(buffer));\n  }\n\n  // ref: https://stackoverflow.com/a/40031979/1090359\n  static fromBufferToHex(buffer: ArrayBuffer): string {\n    if (Utils.isNode) {\n      return Buffer.from(buffer).toString(\"hex\");\n    } else {\n      const bytes = new Uint8Array(buffer);\n      return Array.prototype.map\n        .call(bytes, (x: number) => (\"00\" + x.toString(16)).slice(-2))\n        .join(\"\");\n    }\n  }\n\n  /**\n   * Converts a hex string to an ArrayBuffer.\n   * Note: this doesn't need any Node specific code as parseInt() / ArrayBuffer / Uint8Array\n   * work the same in Node and the browser.\n   * @param {string} hexString - A string of hexadecimal characters.\n   * @returns {ArrayBuffer} The ArrayBuffer representation of the hex string.\n   */\n  static hexStringToArrayBuffer(hexString: string): ArrayBuffer {\n    // Check if the hexString has an even length, as each hex digit represents half a byte (4 bits),\n    // and it takes two hex digits to represent a full byte (8 bits).\n    if (hexString.length % 2 !== 0) {\n      throw \"HexString has to be an even length\";\n    }\n\n    // Create an ArrayBuffer with a length that is half the length of the hex string,\n    // because each pair of hex digits will become a single byte.\n    const arrayBuffer = new ArrayBuffer(hexString.length / 2);\n\n    // Create a Uint8Array view on top of the ArrayBuffer (each position represents a byte)\n    // as ArrayBuffers cannot be edited directly.\n    const uint8Array = new Uint8Array(arrayBuffer);\n\n    // Loop through the bytes\n    for (let i = 0; i < uint8Array.length; i++) {\n      // Extract two hex characters (1 byte)\n      const hexByte = hexString.substr(i * 2, 2);\n\n      // Convert hexByte into a decimal value from base 16. (ex: ff --> 255)\n      const byteValue = parseInt(hexByte, 16);\n\n      // Place the byte value into the uint8Array\n      uint8Array[i] = byteValue;\n    }\n\n    return arrayBuffer;\n  }\n\n  static fromUrlB64ToB64(urlB64Str: string): string {\n    let output = urlB64Str.replace(/-/g, \"+\").replace(/_/g, \"/\");\n    switch (output.length % 4) {\n      case 0:\n        break;\n      case 2:\n        output += \"==\";\n        break;\n      case 3:\n        output += \"=\";\n        break;\n      default:\n        throw new Error(\"Illegal base64url string!\");\n    }\n\n    return output;\n  }\n\n  static fromUrlB64ToUtf8(urlB64Str: string): string {\n    return Utils.fromB64ToUtf8(Utils.fromUrlB64ToB64(urlB64Str));\n  }\n\n  static fromUtf8ToB64(utfStr: string): string {\n    if (Utils.isNode) {\n      return Buffer.from(utfStr, \"utf8\").toString(\"base64\");\n    } else {\n      return BufferLib.from(utfStr, \"utf8\").toString(\"base64\");\n    }\n  }\n\n  static fromUtf8ToUrlB64(utfStr: string): string {\n    return Utils.fromBufferToUrlB64(Utils.fromUtf8ToArray(utfStr));\n  }\n\n  static fromB64ToUtf8(b64Str: string): string {\n    if (Utils.isNode) {\n      return Buffer.from(b64Str, \"base64\").toString(\"utf8\");\n    } else {\n      return BufferLib.from(b64Str, \"base64\").toString(\"utf8\");\n    }\n  }\n\n  // ref: http://stackoverflow.com/a/2117523/1090359\n  static newGuid(): string {\n    return \"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx\".replace(/[xy]/g, (c) => {\n      const r = (Math.random() * 16) | 0;\n      const v = c === \"x\" ? r : (r & 0x3) | 0x8;\n      return v.toString(16);\n    });\n  }\n\n  static guidRegex = /^[0-9a-f]{8}-(?:[0-9a-f]{4}-){3}[0-9a-f]{12}$/;\n\n  static isGuid(id: string) {\n    return RegExp(Utils.guidRegex, \"i\").test(id);\n  }\n\n  static getHostname(uriString: string): string {\n    if (Utils.isNullOrWhitespace(uriString)) {\n      return null;\n    }\n\n    uriString = uriString.trim();\n\n    if (uriString.startsWith(\"data:\")) {\n      return null;\n    }\n\n    if (uriString.startsWith(\"about:\")) {\n      return null;\n    }\n\n    if (uriString.startsWith(\"file:\")) {\n      return null;\n    }\n\n    // Does uriString contain invalid characters\n    // TODO Needs to possibly be extended, although '!' is a reserved character\n    if (uriString.indexOf(\"!\") > 0) {\n      return null;\n    }\n\n    try {\n      const hostname = getHostname(uriString, { validHosts: this.validHosts });\n      if (hostname != null) {\n        return hostname;\n      }\n    } catch {\n      return null;\n    }\n    return null;\n  }\n\n  static getHost(uriString: string): string {\n    const url = Utils.getUrl(uriString);\n    try {\n      return url != null && url.host !== \"\" ? url.host : null;\n    } catch {\n      return null;\n    }\n  }\n\n  static getDomain(uriString: string): string {\n    if (Utils.isNullOrWhitespace(uriString)) {\n      return null;\n    }\n\n    uriString = uriString.trim();\n\n    if (uriString.startsWith(\"data:\")) {\n      return null;\n    }\n\n    if (uriString.startsWith(\"about:\")) {\n      return null;\n    }\n\n    try {\n      const parseResult = parse(uriString, {\n        validHosts: this.validHosts,\n        allowPrivateDomains: true,\n      });\n      if (parseResult != null && parseResult.hostname != null) {\n        if (parseResult.hostname === \"localhost\" || parseResult.isIp) {\n          return parseResult.hostname;\n        }\n\n        if (parseResult.domain != null) {\n          return parseResult.domain;\n        }\n        return null;\n      }\n    } catch {\n      return null;\n    }\n    return null;\n  }\n\n  static getQueryParams(uriString: string): Map<string, string> {\n    const url = Utils.getUrl(uriString);\n    if (url == null || url.search == null || url.search === \"\") {\n      return null;\n    }\n    const map = new Map<string, string>();\n    const pairs = (url.search[0] === \"?\" ? url.search.substr(1) : url.search).split(\"&\");\n    pairs.forEach((pair) => {\n      const parts = pair.split(\"=\");\n      if (parts.length < 1) {\n        return;\n      }\n      map.set(\n        decodeURIComponent(parts[0]).toLowerCase(),\n        parts[1] == null ? \"\" : decodeURIComponent(parts[1]),\n      );\n    });\n    return map;\n  }\n\n  static getSortFunction<T>(\n    i18nService: I18nService,\n    prop: { [K in keyof T]: T[K] extends string ? K : never }[keyof T],\n  ): (a: T, b: T) => number {\n    return (a, b) => {\n      if (a[prop] == null && b[prop] != null) {\n        return -1;\n      }\n      if (a[prop] != null && b[prop] == null) {\n        return 1;\n      }\n      if (a[prop] == null && b[prop] == null) {\n        return 0;\n      }\n\n      // The `as unknown as string` here is unfortunate because typescript doesn't property understand that the return of T[prop] will be a string\n      return i18nService.collator\n        ? i18nService.collator.compare(a[prop] as unknown as string, b[prop] as unknown as string)\n        : (a[prop] as unknown as string).localeCompare(b[prop] as unknown as string);\n    };\n  }\n\n  static isNullOrWhitespace(str: string): boolean {\n    return str == null || typeof str !== \"string\" || str.trim() === \"\";\n  }\n\n  static isNullOrEmpty(str: string | null): boolean {\n    return str == null || typeof str !== \"string\" || str == \"\";\n  }\n\n  static isPromise(obj: any): obj is Promise<unknown> {\n    return (\n      obj != undefined && typeof obj[\"then\"] === \"function\" && typeof obj[\"catch\"] === \"function\"\n    );\n  }\n\n  static nameOf<T>(name: string & keyof T) {\n    return name;\n  }\n\n  static assign<T>(target: T, source: Partial<T>): T {\n    return Object.assign(target, source);\n  }\n\n  static iterateEnum<O extends object, K extends keyof O = keyof O>(obj: O) {\n    return (Object.keys(obj).filter((k) => Number.isNaN(+k)) as K[]).map((k) => obj[k]);\n  }\n\n  static getUrl(uriString: string): URL {\n    if (this.isNullOrWhitespace(uriString)) {\n      return null;\n    }\n\n    uriString = uriString.trim();\n\n    return Utils.getUrlObject(uriString);\n  }\n\n  static camelToPascalCase(s: string) {\n    return s.charAt(0).toUpperCase() + s.slice(1);\n  }\n\n  /**\n   * There are a few ways to calculate text color for contrast, this one seems to fit accessibility guidelines best.\n   * https://stackoverflow.com/a/3943023/6869691\n   *\n   * @param {string} bgColor\n   * @param {number} [threshold] see stackoverflow link above\n   * @param {boolean} [svgTextFill]\n   * Indicates if this method is performed on an SVG <text> 'fill' attribute (e.g. <text fill=\"black\"></text>).\n   * This check is necessary because the '!important' tag cannot be used in a 'fill' attribute.\n   */\n  static pickTextColorBasedOnBgColor(bgColor: string, threshold = 186, svgTextFill = false) {\n    const bgColorHexNums = bgColor.charAt(0) === \"#\" ? bgColor.substring(1, 7) : bgColor;\n    const r = parseInt(bgColorHexNums.substring(0, 2), 16); // hexToR\n    const g = parseInt(bgColorHexNums.substring(2, 4), 16); // hexToG\n    const b = parseInt(bgColorHexNums.substring(4, 6), 16); // hexToB\n    const blackColor = svgTextFill ? \"black\" : \"black !important\";\n    const whiteColor = svgTextFill ? \"white\" : \"white !important\";\n    return r * 0.299 + g * 0.587 + b * 0.114 > threshold ? blackColor : whiteColor;\n  }\n\n  static stringToColor(str: string): string {\n    let hash = 0;\n    for (let i = 0; i < str.length; i++) {\n      hash = str.charCodeAt(i) + ((hash << 5) - hash);\n    }\n    let color = \"#\";\n    for (let i = 0; i < 3; i++) {\n      const value = (hash >> (i * 8)) & 0xff;\n      color += (\"00\" + value.toString(16)).substr(-2);\n    }\n    return color;\n  }\n\n  /**\n   * @throws Will throw an error if the ContainerService has not been attached to the window object\n   */\n  static getContainerService(): BitwardenContainerService {\n    if (this.global.bitwardenContainerService == null) {\n      throw new Error(\"global bitwardenContainerService not initialized.\");\n    }\n    return this.global.bitwardenContainerService;\n  }\n\n  static validateHexColor(color: string) {\n    return /^#([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$/.test(color);\n  }\n\n  /**\n   * Converts map to a Record<string, V> with the same data. Inverse of recordToMap\n   * Useful in toJSON methods, since Maps are not serializable\n   * @param map\n   * @returns\n   */\n  static mapToRecord<K extends string | number, V>(map: Map<K, V>): Record<string, V> {\n    if (map == null) {\n      return null;\n    }\n    if (!(map instanceof Map)) {\n      return map;\n    }\n    return Object.fromEntries(map);\n  }\n\n  /**\n   * Converts record to a Map<string, V> with the same data. Inverse of mapToRecord\n   * Useful in fromJSON methods, since Maps are not serializable\n   *\n   * Warning: If the record has string keys that are numbers, they will be converted to numbers in the map\n   * @param record\n   * @returns\n   */\n  static recordToMap<K extends string | number, V>(record: Record<K, V>): Map<K, V> {\n    if (record == null) {\n      return null;\n    } else if (record instanceof Map) {\n      return record;\n    }\n\n    const entries = Object.entries(record);\n    if (entries.length === 0) {\n      return new Map();\n    }\n\n    if (isNaN(Number(entries[0][0]))) {\n      return new Map(entries) as Map<K, V>;\n    } else {\n      return new Map(entries.map((e) => [Number(e[0]), e[1]])) as Map<K, V>;\n    }\n  }\n\n  /** Applies Object.assign, but converts the type nicely using Type-Fest Merge<Destination, Source> */\n  static merge<Destination, Source>(\n    destination: Destination,\n    source: Source,\n  ): Merge<Destination, Source> {\n    return Object.assign(destination, source) as unknown as Merge<Destination, Source>;\n  }\n\n  /**\n   * encodeURIComponent escapes all characters except the following:\n   * alphabetic, decimal digits, - _ . ! ~ * ' ( )\n   * https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/encodeURIComponent#encoding_for_rfc3986\n   */\n  static encodeRFC3986URIComponent(str: string): string {\n    return encodeURIComponent(str).replace(\n      /[!'()*]/g,\n      (c) => `%${c.charCodeAt(0).toString(16).toUpperCase()}`,\n    );\n  }\n\n  /**\n   * Normalizes a path for defense against attacks like traversals\n   * @param denormalizedPath\n   * @returns\n   */\n  static normalizePath(denormalizedPath: string): string {\n    return path.normalize(decodeURIComponent(denormalizedPath)).replace(/^(\\.\\.(\\/|\\\\|$))+/, \"\");\n  }\n\n  private static isMobile(win: Window) {\n    let mobile = false;\n    ((a) => {\n      if (\n        /(android|bb\\d+|meego).+mobile|avantgo|bada\\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(\n          a,\n        ) ||\n        /1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\\-(n|u)|c55\\/|capi|ccwa|cdm\\-|cell|chtm|cldc|cmd\\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\\-s|devi|dica|dmob|do(c|p)o|ds(12|\\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\\-|_)|g1 u|g560|gene|gf\\-5|g\\-mo|go(\\.w|od)|gr(ad|un)|haie|hcit|hd\\-(m|p|t)|hei\\-|hi(pt|ta)|hp( i|ip)|hs\\-c|ht(c(\\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\\-(20|go|ma)|i230|iac( |\\-|\\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\\/)|klon|kpt |kwc\\-|kyo(c|k)|le(no|xi)|lg( g|\\/(k|l|u)|50|54|\\-[a-w])|libw|lynx|m1\\-w|m3ga|m50\\/|ma(te|ui|xo)|mc(01|21|ca)|m\\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\\-2|po(ck|rt|se)|prox|psio|pt\\-g|qa\\-a|qc(07|12|21|32|60|\\-[2-7]|i\\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\\-|oo|p\\-)|sdk\\/|se(c(\\-|0|1)|47|mc|nd|ri)|sgh\\-|shar|sie(\\-|m)|sk\\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\\-|v\\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\\-|tdg\\-|tel(i|m)|tim\\-|t\\-mo|to(pl|sh)|ts(70|m\\-|m3|m5)|tx\\-9|up(\\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\\-|your|zeto|zte\\-/i.test(\n          a.substr(0, 4),\n        )\n      ) {\n        mobile = true;\n      }\n    })(win.navigator.userAgent || win.navigator.vendor || (win as any).opera);\n    return mobile || win.navigator.userAgent.match(/iPad/i) != null;\n  }\n\n  static delay(ms: number): Promise<void> {\n    return new Promise((resolve) => setTimeout(resolve, ms));\n  }\n\n  /**\n   * Generate an observable from a function that returns a promise.\n   * Similar to the rxjs function {@link from} with one big exception:\n   * {@link from} will not re-execute the function when observers resubscribe.\n   * {@link Util.asyncToObservable} will execute `generator` for every\n   * subscribe, making it ideal if the value ever needs to be refreshed.\n   * */\n  static asyncToObservable<T>(generator: () => Promise<T>): Observable<T> {\n    return of(undefined).pipe(switchMap(() => generator()));\n  }\n\n  /**\n   * Return the number of days remaining before a target date arrives.\n   * Returns 0 if the day has already passed.\n   */\n  static daysRemaining(targetDate: Date): number {\n    const diffTime = targetDate.getTime() - Date.now();\n    const msPerDay = 86400000;\n    return Math.max(0, Math.floor(diffTime / msPerDay));\n  }\n\n  private static isAppleMobile(win: Window) {\n    return (\n      win.navigator.userAgent.match(/iPhone/i) != null ||\n      win.navigator.userAgent.match(/iPad/i) != null\n    );\n  }\n\n  private static getUrlObject(uriString: string): URL {\n    // All the methods below require a protocol to properly parse a URL string\n    // Assume http if no other protocol is present\n    const hasProtocol = uriString.indexOf(\"://\") > -1;\n    if (!hasProtocol && uriString.indexOf(\".\") > -1) {\n      uriString = \"http://\" + uriString;\n    } else if (!hasProtocol) {\n      return null;\n    }\n\n    try {\n      if (nodeURL != null) {\n        return new nodeURL.URL(uriString);\n      }\n\n      return new URL(uriString);\n      // FIXME: Remove when updating file. Eslint update\n      // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    } catch (e) {\n      // Ignore error\n    }\n\n    return null;\n  }\n}\n\nUtils.init();\n","// FIXME: update to use a const object instead of a typescript enum\n// eslint-disable-next-line @bitwarden/platform/no-enums\nexport enum EncryptionType {\n  // Symmetric encryption types\n  AesCbc256_B64 = 0,\n  // Type 1 was the unused and removed AesCbc128_HmacSha256_B64\n  AesCbc256_HmacSha256_B64 = 2,\n  // Cose is the encoding for the key used, but contained can be:\n  // - XChaCha20Poly1305\n  CoseEncrypt0 = 7,\n\n  // Asymmetric encryption types. These never occur in the same places that the symmetric ones would\n  // and can be split out into a separate enum.\n  Rsa2048_OaepSha256_B64 = 3,\n  Rsa2048_OaepSha1_B64 = 4,\n  Rsa2048_OaepSha256_HmacSha256_B64 = 5,\n  Rsa2048_OaepSha1_HmacSha256_B64 = 6,\n}\n\nexport function encryptionTypeToString(encryptionType: EncryptionType): string {\n  if (encryptionType in EncryptionType) {\n    return EncryptionType[encryptionType];\n  } else {\n    return \"Unknown encryption type \" + encryptionType;\n  }\n}\n\n/** The expected number of parts to a serialized EncString of the given encryption type.\n * For example, an EncString of type AesCbc256_B64 will have 2 parts\n *\n * Example of annotated serialized EncStrings:\n * 0.iv|data\n * 2.iv|data|mac\n * 3.data\n * 4.data\n *\n * @see EncString\n * @see EncryptionType\n * @see EncString.parseEncryptedString\n */\nexport const EXPECTED_NUM_PARTS_BY_ENCRYPTION_TYPE = {\n  [EncryptionType.AesCbc256_B64]: 2,\n  [EncryptionType.AesCbc256_HmacSha256_B64]: 3,\n  [EncryptionType.Rsa2048_OaepSha256_B64]: 1,\n  [EncryptionType.Rsa2048_OaepSha1_B64]: 1,\n  [EncryptionType.Rsa2048_OaepSha256_HmacSha256_B64]: 2,\n  [EncryptionType.Rsa2048_OaepSha1_HmacSha256_B64]: 2,\n  [EncryptionType.CoseEncrypt0]: 1,\n};\n","// FIXME: update to use a const object instead of a typescript enum\n// eslint-disable-next-line @bitwarden/platform/no-enums\nexport enum FileUploadType {\n  Direct = 0,\n  Azure = 1,\n}\n","// FIXME: update to use a const object instead of a typescript enum\n// eslint-disable-next-line @bitwarden/platform/no-enums\nexport enum HashPurpose {\n  ServerAuthorization = 1,\n  LocalAuthorization = 2,\n}\n","// FIXME: update to use a const object instead of a typescript enum\n// eslint-disable-next-line @bitwarden/platform/no-enums\nexport enum HtmlStorageLocation {\n  Local = \"local\",\n  Memory = \"memory\",\n  Session = \"session\",\n}\n","// FIXME: update to use a const object instead of a typescript enum\n// eslint-disable-next-line @bitwarden/platform/no-enums\nexport enum StorageLocationEnum {\n  Both = \"both\",\n  Disk = \"disk\",\n  Memory = \"memory\",\n}\n","// FIXME: update to use a const object instead of a typescript enum\n// eslint-disable-next-line @bitwarden/platform/no-enums\nexport enum KeySuffixOptions {\n  Auto = \"auto\",\n  Pin = \"pin\",\n}\n","// FIXME: update to use a const object instead of a typescript enum\n// eslint-disable-next-line @bitwarden/platform/no-enums\nexport enum LogLevelType {\n  Debug,\n  Info,\n  Warning,\n  Error,\n}\n","/**\n * @deprecated prefer the `ThemeTypes` constants and `Theme` type over unsafe enum types\n **/\n// FIXME: update to use a const object instead of a typescript enum\n// eslint-disable-next-line @bitwarden/platform/no-enums\nexport enum ThemeType {\n  System = \"system\",\n  Light = \"light\",\n  Dark = \"dark\",\n}\n\nexport const ThemeTypes = {\n  System: \"system\",\n  Light: \"light\",\n  Dark: \"dark\",\n} as const;\n\nexport type Theme = (typeof ThemeTypes)[keyof typeof ThemeTypes];\n","// FIXME: Update this file to be type safe and remove this and next line\n// @ts-strict-ignore\nimport { Jsonify } from \"type-fest\";\n\nimport { Utils } from \"../../../platform/misc/utils\";\nimport { EncryptionType } from \"../../enums\";\n\nexport type Aes256CbcHmacKey = {\n  type: EncryptionType.AesCbc256_HmacSha256_B64;\n  encryptionKey: Uint8Array;\n  authenticationKey: Uint8Array;\n};\n\nexport type Aes256CbcKey = {\n  type: EncryptionType.AesCbc256_B64;\n  encryptionKey: Uint8Array;\n};\n\nexport type CoseKey = {\n  type: EncryptionType.CoseEncrypt0;\n  // Encryption key here refers to the cose-encoded and padded key. This MAY later be refactored to contain the actual key bytes, as is the case in the SDK\n  encryptionKey: Uint8Array;\n};\n\n/**\n *  A symmetric crypto key represents a symmetric key usable for symmetric encryption and decryption operations.\n *  The specific algorithm used is private to the key, and should only be exposed to encrypt service implementations.\n *  This can be done via `inner()`.\n */\nexport class SymmetricCryptoKey {\n  private innerKey: Aes256CbcHmacKey | Aes256CbcKey | CoseKey;\n\n  keyB64: string;\n\n  /**\n   * @param key The key in one of the permitted serialization formats\n   */\n  constructor(key: Uint8Array) {\n    if (key == null) {\n      throw new Error(\"Must provide key\");\n    }\n\n    if (key.byteLength === 32) {\n      this.innerKey = {\n        type: EncryptionType.AesCbc256_B64,\n        encryptionKey: key,\n      };\n      this.keyB64 = this.toBase64();\n    } else if (key.byteLength === 64) {\n      this.innerKey = {\n        type: EncryptionType.AesCbc256_HmacSha256_B64,\n        encryptionKey: key.slice(0, 32),\n        authenticationKey: key.slice(32),\n      };\n      this.keyB64 = this.toBase64();\n    } else if (key.byteLength > 64) {\n      this.innerKey = {\n        type: EncryptionType.CoseEncrypt0,\n        encryptionKey: key,\n      };\n      this.keyB64 = this.toBase64();\n    } else {\n      throw new Error(`Unsupported encType/key length ${key.byteLength}`);\n    }\n  }\n\n  toJSON() {\n    // The whole object is constructed from the initial key, so just store the B64 key\n    return { keyB64: this.keyB64 };\n  }\n\n  /**\n   * It is preferred not to work with the raw key where possible.\n   * Only use this method if absolutely necessary.\n   *\n   * @returns The inner key instance that can be directly used for encryption primitives\n   */\n  inner(): Aes256CbcHmacKey | Aes256CbcKey | CoseKey {\n    return this.innerKey;\n  }\n\n  /**\n   * @returns The serialized key in base64 format\n   */\n  toBase64(): string {\n    return Utils.fromBufferToB64(this.toEncoded());\n  }\n\n  /**\n   * Serializes the key to a format that can be written to state or shared\n   * The currently permitted format is:\n   * - AesCbc256_B64: 32 bytes (the raw key)\n   * - AesCbc256_HmacSha256_B64: 64 bytes (32 bytes encryption key, 32 bytes authentication key, concatenated)\n   *\n   * @returns The serialized key that can be written to state or encrypted and then written to state / shared\n   */\n  toEncoded(): Uint8Array {\n    if (this.innerKey.type === EncryptionType.AesCbc256_B64) {\n      return this.innerKey.encryptionKey;\n    } else if (this.innerKey.type === EncryptionType.AesCbc256_HmacSha256_B64) {\n      const encodedKey = new Uint8Array(64);\n      encodedKey.set(this.innerKey.encryptionKey, 0);\n      encodedKey.set(this.innerKey.authenticationKey, 32);\n      return encodedKey;\n    } else if (this.innerKey.type === EncryptionType.CoseEncrypt0) {\n      return this.innerKey.encryptionKey;\n    } else {\n      throw new Error(\"Unsupported encryption type.\");\n    }\n  }\n\n  /**\n   * @param s The serialized key in base64 format\n   * @returns A SymmetricCryptoKey instance\n   */\n  static fromString(s: string): SymmetricCryptoKey {\n    if (s == null) {\n      return null;\n    }\n\n    const arrayBuffer = Utils.fromB64ToArray(s);\n    return new SymmetricCryptoKey(arrayBuffer);\n  }\n\n  static fromJSON(obj: Jsonify<SymmetricCryptoKey>): SymmetricCryptoKey {\n    return SymmetricCryptoKey.fromString(obj?.keyB64);\n  }\n}\n","// FIXME: Update this file to be type safe and remove this and next line\n// @ts-strict-ignore\nimport { LogService as LogServiceAbstraction } from \"../abstractions/log.service\";\nimport { LogLevelType } from \"../enums/log-level-type.enum\";\n\nexport class ConsoleLogService implements LogServiceAbstraction {\n  protected timersMap: Map<string, [number, number]> = new Map();\n\n  constructor(\n    protected isDev: boolean,\n    protected filter: (level: LogLevelType) => boolean = null,\n  ) {}\n\n  debug(message?: any, ...optionalParams: any[]) {\n    if (!this.isDev) {\n      return;\n    }\n    this.write(LogLevelType.Debug, message, ...optionalParams);\n  }\n\n  info(message?: any, ...optionalParams: any[]) {\n    this.write(LogLevelType.Info, message, ...optionalParams);\n  }\n\n  warning(message?: any, ...optionalParams: any[]) {\n    this.write(LogLevelType.Warning, message, ...optionalParams);\n  }\n\n  error(message?: any, ...optionalParams: any[]) {\n    this.write(LogLevelType.Error, message, ...optionalParams);\n  }\n\n  write(level: LogLevelType, message?: any, ...optionalParams: any[]) {\n    if (this.filter != null && this.filter(level)) {\n      return;\n    }\n\n    switch (level) {\n      case LogLevelType.Debug:\n        // eslint-disable-next-line\n        console.log(message, ...optionalParams);\n        break;\n      case LogLevelType.Info:\n        // eslint-disable-next-line\n        console.log(message, ...optionalParams);\n        break;\n      case LogLevelType.Warning:\n        // eslint-disable-next-line\n        console.warn(message, ...optionalParams);\n        break;\n      case LogLevelType.Error:\n        // eslint-disable-next-line\n        console.error(message, ...optionalParams);\n        break;\n      default:\n        break;\n    }\n  }\n}\n","// This import has been flagged as unallowed for this class. It may be involved in a circular dependency loop.\n// eslint-disable-next-line no-restricted-imports\nimport { KeyService } from \"@bitwarden/key-management\";\n\nimport { EncryptService } from \"../../key-management/crypto/abstractions/encrypt.service\";\n\nexport class ContainerService {\n  constructor(\n    private keyService: KeyService,\n    private encryptService: EncryptService,\n  ) {}\n\n  attachToGlobal(global: any) {\n    if (!global.bitwardenContainerService) {\n      global.bitwardenContainerService = this;\n    }\n  }\n\n  /**\n   * @throws Will throw if KeyService was not instantiated and provided to the ContainerService constructor\n   */\n  getKeyService(): KeyService {\n    if (this.keyService == null) {\n      throw new Error(\"ContainerService.keyService not initialized.\");\n    }\n    return this.keyService;\n  }\n\n  /**\n   * @throws Will throw if EncryptService was not instantiated and provided to the ContainerService constructor\n   */\n  getEncryptService(): EncryptService {\n    if (this.encryptService == null) {\n      throw new Error(\"ContainerService.encryptService not initialized.\");\n    }\n    return this.encryptService;\n  }\n}\n","// FIXME: Update this file to be type safe and remove this and next line\n// @ts-strict-ignore\nimport { Jsonify, Opaque } from \"type-fest\";\n\nimport { EncryptService } from \"../../../key-management/crypto/abstractions/encrypt.service\";\nimport { EncryptionType, EXPECTED_NUM_PARTS_BY_ENCRYPTION_TYPE } from \"../../enums\";\nimport { Encrypted } from \"../../interfaces/encrypted\";\nimport { Utils } from \"../../misc/utils\";\n\nimport { SymmetricCryptoKey } from \"./symmetric-crypto-key\";\n\nexport const DECRYPT_ERROR = \"[error: cannot decrypt]\";\n\nexport class EncString implements Encrypted {\n  encryptedString?: EncryptedString;\n  encryptionType?: EncryptionType;\n  decryptedValue?: string;\n  data?: string;\n  iv?: string;\n  mac?: string;\n\n  constructor(\n    encryptedStringOrType: string | EncryptionType,\n    data?: string,\n    iv?: string,\n    mac?: string,\n  ) {\n    if (data != null) {\n      this.initFromData(encryptedStringOrType as EncryptionType, data, iv, mac);\n    } else {\n      this.initFromEncryptedString(encryptedStringOrType as string);\n    }\n  }\n\n  get ivBytes(): Uint8Array {\n    return this.iv == null ? null : Utils.fromB64ToArray(this.iv);\n  }\n\n  get macBytes(): Uint8Array {\n    return this.mac == null ? null : Utils.fromB64ToArray(this.mac);\n  }\n\n  get dataBytes(): Uint8Array {\n    return this.data == null ? null : Utils.fromB64ToArray(this.data);\n  }\n\n  toJSON() {\n    return this.encryptedString as string;\n  }\n\n  static fromJSON(obj: Jsonify<EncString>): EncString {\n    if (obj == null) {\n      return null;\n    }\n\n    return new EncString(obj);\n  }\n\n  private initFromData(encType: EncryptionType, data: string, iv: string, mac: string) {\n    if (iv != null) {\n      this.encryptedString = (encType + \".\" + iv + \"|\" + data) as EncryptedString;\n    } else {\n      this.encryptedString = (encType + \".\" + data) as EncryptedString;\n    }\n\n    // mac\n    if (mac != null) {\n      this.encryptedString = (this.encryptedString + \"|\" + mac) as EncryptedString;\n    }\n\n    this.encryptionType = encType;\n    this.data = data;\n    this.iv = iv;\n    this.mac = mac;\n  }\n\n  private initFromEncryptedString(encryptedString: string) {\n    this.encryptedString = encryptedString as EncryptedString;\n    if (!this.encryptedString) {\n      return;\n    }\n\n    const { encType, encPieces } = EncString.parseEncryptedString(this.encryptedString);\n\n    this.encryptionType = encType;\n\n    if (encPieces.length !== EXPECTED_NUM_PARTS_BY_ENCRYPTION_TYPE[encType]) {\n      return;\n    }\n\n    switch (encType) {\n      case EncryptionType.AesCbc256_HmacSha256_B64:\n        this.iv = encPieces[0];\n        this.data = encPieces[1];\n        this.mac = encPieces[2];\n        break;\n      case EncryptionType.AesCbc256_B64:\n        this.iv = encPieces[0];\n        this.data = encPieces[1];\n        break;\n      case EncryptionType.Rsa2048_OaepSha256_B64:\n      case EncryptionType.Rsa2048_OaepSha1_B64:\n        this.data = encPieces[0];\n        break;\n      case EncryptionType.Rsa2048_OaepSha256_HmacSha256_B64:\n      case EncryptionType.Rsa2048_OaepSha1_HmacSha256_B64:\n        this.data = encPieces[0];\n        this.mac = encPieces[1];\n        break;\n      default:\n        return;\n    }\n  }\n\n  private static parseEncryptedString(encryptedString: string): {\n    encType: EncryptionType;\n    encPieces: string[];\n  } {\n    const headerPieces = encryptedString.split(\".\");\n    let encType: EncryptionType;\n    let encPieces: string[] = null;\n\n    if (headerPieces.length === 2) {\n      try {\n        encType = parseInt(headerPieces[0], null);\n        encPieces = headerPieces[1].split(\"|\");\n        // FIXME: Remove when updating file. Eslint update\n        // eslint-disable-next-line @typescript-eslint/no-unused-vars\n      } catch (e) {\n        return { encType: NaN, encPieces: [] };\n      }\n    } else {\n      encPieces = encryptedString.split(\"|\");\n      encType = EncryptionType.AesCbc256_B64;\n    }\n\n    return {\n      encType,\n      encPieces,\n    };\n  }\n\n  static isSerializedEncString(s: string): boolean {\n    if (s == null) {\n      return false;\n    }\n\n    const { encType, encPieces } = this.parseEncryptedString(s);\n\n    if (isNaN(encType) || encPieces.length === 0) {\n      return false;\n    }\n\n    return EXPECTED_NUM_PARTS_BY_ENCRYPTION_TYPE[encType] === encPieces.length;\n  }\n\n  async decrypt(\n    orgId: string | null,\n    key: SymmetricCryptoKey | null = null,\n    context?: string,\n  ): Promise<string> {\n    if (this.decryptedValue != null) {\n      return this.decryptedValue;\n    }\n\n    try {\n      if (key == null) {\n        key = await this.getKeyForDecryption(orgId);\n      }\n      if (key == null) {\n        throw new Error(\"No key to decrypt EncString with orgId \" + orgId);\n      }\n\n      const encryptService = Utils.getContainerService().getEncryptService();\n      this.decryptedValue = await encryptService.decryptString(this, key);\n      // FIXME: Remove when updating file. Eslint update\n      // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    } catch (e) {\n      this.decryptedValue = DECRYPT_ERROR;\n    }\n    return this.decryptedValue;\n  }\n\n  async decryptWithKey(\n    key: SymmetricCryptoKey,\n    encryptService: EncryptService,\n    decryptTrace: string = \"domain-withkey\",\n  ): Promise<string> {\n    try {\n      if (key == null) {\n        throw new Error(\"No key to decrypt EncString\");\n      }\n\n      this.decryptedValue = await encryptService.decryptString(this, key);\n      // FIXME: Remove when updating file. Eslint update\n      // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    } catch (e) {\n      this.decryptedValue = DECRYPT_ERROR;\n    }\n\n    return this.decryptedValue;\n  }\n  private async getKeyForDecryption(orgId: string) {\n    const keyService = Utils.getContainerService().getKeyService();\n    return orgId != null\n      ? await keyService.getOrgKey(orgId)\n      : await keyService.getUserKeyWithLegacySupport();\n  }\n}\n\nexport type EncryptedString = Opaque<string, \"EncString\">;\n","// FIXME: update to use a const object instead of a typescript enum\n// eslint-disable-next-line @bitwarden/platform/no-enums\nexport enum InitializerKey {\n  Cipher = 0,\n  CipherView = 1,\n}\n","import { ConditionalExcept, ConditionalKeys, Constructor } from \"type-fest\";\n\nimport { EncryptService } from \"../../../key-management/crypto/abstractions/encrypt.service\";\nimport { View } from \"../../../models/view/view\";\n\nimport { EncString } from \"./enc-string\";\nimport { SymmetricCryptoKey } from \"./symmetric-crypto-key\";\n\n// eslint-disable-next-line @typescript-eslint/no-unsafe-function-type\ntype EncStringKeys<T> = ConditionalKeys<ConditionalExcept<T, Function>, EncString>;\nexport type DecryptedObject<\n  TEncryptedObject,\n  TDecryptedKeys extends EncStringKeys<TEncryptedObject>,\n> = Record<TDecryptedKeys, string> & Omit<TEncryptedObject, TDecryptedKeys>;\n\n// extracts shared keys from the domain and view types\ntype EncryptableKeys<D extends Domain, V extends View> = (keyof D &\n  ConditionalKeys<D, EncString | null>) &\n  (keyof V & ConditionalKeys<V, string | null>);\n\ntype DomainEncryptableKeys<D extends Domain> = {\n  [key in ConditionalKeys<D, EncString | null>]: EncString | null;\n};\n\ntype ViewEncryptableKeys<V extends View> = {\n  [key in ConditionalKeys<V, string | null>]: string | null;\n};\n\n// https://contributing.bitwarden.com/architecture/clients/data-model#domain\nexport default class Domain {\n  protected buildDomainModel<D extends Domain>(\n    domain: D,\n    dataObj: any,\n    map: any,\n    notEncList: any[] = [],\n  ) {\n    for (const prop in map) {\n      // eslint-disable-next-line\n      if (!map.hasOwnProperty(prop)) {\n        continue;\n      }\n\n      const objProp = dataObj[map[prop] || prop];\n      if (notEncList.indexOf(prop) > -1) {\n        (domain as any)[prop] = objProp ? objProp : null;\n      } else {\n        (domain as any)[prop] = objProp ? new EncString(objProp) : null;\n      }\n    }\n  }\n\n  protected buildDataModel<D extends Domain>(\n    domain: D,\n    dataObj: any,\n    map: any,\n    notEncStringList: any[] = [],\n  ) {\n    for (const prop in map) {\n      // eslint-disable-next-line\n      if (!map.hasOwnProperty(prop)) {\n        continue;\n      }\n\n      const objProp = (domain as any)[map[prop] || prop];\n      if (notEncStringList.indexOf(prop) > -1) {\n        (dataObj as any)[prop] = objProp != null ? objProp : null;\n      } else {\n        (dataObj as any)[prop] = objProp != null ? (objProp as EncString).encryptedString : null;\n      }\n    }\n  }\n\n  protected async decryptObj<D extends Domain, V extends View>(\n    domain: DomainEncryptableKeys<D>,\n    viewModel: ViewEncryptableKeys<V>,\n    props: EncryptableKeys<D, V>[],\n    orgId: string | null,\n    key: SymmetricCryptoKey | null = null,\n    objectContext: string = \"No Domain Context\",\n  ): Promise<V> {\n    for (const prop of props) {\n      viewModel[prop] =\n        (await domain[prop]?.decrypt(\n          orgId,\n          key,\n          `Property: ${prop as string}; ObjectContext: ${objectContext}`,\n        )) ?? null;\n    }\n\n    return viewModel as V;\n  }\n\n  /**\n   * Decrypts the requested properties of the domain object with the provided key and encrypt service.\n   *\n   * If a property is null, the result will be null.\n   * @see {@link EncString.decryptWithKey} for more details on decryption behavior.\n   *\n   * @param encryptedProperties The properties to decrypt. Type restricted to EncString properties of the domain object.\n   * @param key The key to use for decryption.\n   * @param encryptService The encryption service to use for decryption.\n   * @param _ The constructor of the domain object. Used for type inference if the domain object is not automatically inferred.\n   * @returns An object with the requested properties decrypted and the rest of the domain object untouched.\n   */\n  protected async decryptObjWithKey<\n    TThis extends Domain,\n    const TEncryptedKeys extends EncStringKeys<TThis>,\n  >(\n    this: TThis,\n    encryptedProperties: TEncryptedKeys[],\n    key: SymmetricCryptoKey,\n    encryptService: EncryptService,\n    _: Constructor<TThis> = this.constructor as Constructor<TThis>,\n    objectContext: string = \"No Domain Context\",\n  ): Promise<DecryptedObject<TThis, TEncryptedKeys>> {\n    const decryptedObjects = [];\n\n    for (const prop of encryptedProperties) {\n      const value = this[prop] as EncString;\n      const decrypted = await this.decryptProperty(\n        prop,\n        value,\n        key,\n        encryptService,\n        `Property: ${prop.toString()}; ObjectContext: ${objectContext}`,\n      );\n      decryptedObjects.push(decrypted);\n    }\n\n    const decryptedObject = decryptedObjects.reduce(\n      (acc, obj) => {\n        return { ...acc, ...obj };\n      },\n      { ...this },\n    );\n    return decryptedObject as DecryptedObject<TThis, TEncryptedKeys>;\n  }\n\n  private async decryptProperty<const TEncryptedKeys extends EncStringKeys<this>>(\n    propertyKey: TEncryptedKeys,\n    value: EncString,\n    key: SymmetricCryptoKey,\n    encryptService: EncryptService,\n    decryptTrace: string,\n  ) {\n    let decrypted: string | null = null;\n    if (value) {\n      decrypted = await value.decryptWithKey(key, encryptService, decryptTrace);\n    }\n    return {\n      [propertyKey]: decrypted,\n    };\n  }\n}\n","const _CipherType = Object.freeze({\n  Login: 1,\n  SecureNote: 2,\n  Card: 3,\n  Identity: 4,\n  SshKey: 5,\n} as const);\n\ntype _CipherType = typeof _CipherType;\n\nexport type CipherType = _CipherType[keyof _CipherType];\n\n// FIXME: Update typing of `CipherType` to be `Record<keyof _CipherType, CipherType>` which is ADR-0025 compliant when the TypeScript version is at least 5.8.\nexport const CipherType: typeof _CipherType = _CipherType;\n\n/**\n * Reverse mapping of Cipher Types to their associated names.\n * Prefer using {@link toCipherTypeName} rather than accessing this object directly.\n *\n * When represented as an enum in TypeScript, this mapping was provided\n * by default. Now using a constant object it needs to be defined manually.\n */\nexport const cipherTypeNames = Object.freeze(\n  Object.fromEntries(Object.entries(CipherType).map(([key, value]) => [value, key])),\n) as Readonly<Record<CipherType, keyof typeof CipherType>>;\n\n/**\n * Returns the associated name for the cipher type, will throw when the name is not found.\n */\nexport function toCipherTypeName(type: CipherType): keyof typeof CipherType | undefined {\n  const name = cipherTypeNames[type];\n\n  return name;\n}\n\n/**\n * @returns `true` if the value is a valid `CipherType`, `false` otherwise.\n */\nexport const isCipherType = (value: unknown): value is CipherType => {\n  return Object.values(CipherType).includes(value as CipherType);\n};\n\n/**\n * Converts a value to a `CipherType` if it is valid, otherwise returns `null`.\n */\nexport const toCipherType = (value: unknown): CipherType | undefined => {\n  if (isCipherType(value)) {\n    return value;\n  }\n\n  if (typeof value === \"string\") {\n    const valueAsInt = parseInt(value, 10);\n\n    if (isCipherType(valueAsInt)) {\n      return valueAsInt;\n    }\n  }\n\n  return undefined;\n};\n","// FIXME: Update this file to be type safe and remove this and next line\n// @ts-strict-ignore\nexport abstract class BaseResponse {\n  private response: any;\n\n  constructor(response: any) {\n    this.response = response;\n  }\n\n  protected getResponseProperty(\n    propertyName: string,\n    response: any = null,\n    exactName = false,\n  ): any {\n    if (propertyName == null || propertyName === \"\") {\n      throw new Error(\"propertyName must not be null/empty.\");\n    }\n    if (response == null && this.response != null) {\n      response = this.response;\n    }\n    if (response == null) {\n      return null;\n    }\n    if (!exactName && response[propertyName] === undefined) {\n      let otherCasePropertyName: string = null;\n      if (propertyName.charAt(0) === propertyName.charAt(0).toUpperCase()) {\n        otherCasePropertyName = propertyName.charAt(0).toLowerCase();\n      } else {\n        otherCasePropertyName = propertyName.charAt(0).toUpperCase();\n      }\n      if (propertyName.length > 1) {\n        otherCasePropertyName += propertyName.slice(1);\n      }\n\n      propertyName = otherCasePropertyName;\n      if (response[propertyName] === undefined) {\n        propertyName = propertyName.toLowerCase();\n      }\n      if (response[propertyName] === undefined) {\n        propertyName = propertyName.toUpperCase();\n      }\n    }\n    return response[propertyName];\n  }\n}\n","import { Jsonify } from \"type-fest\";\n\nimport { CipherPermissions as SdkCipherPermissions } from \"@bitwarden/sdk-internal\";\n\nimport { BaseResponse } from \"../../../models/response/base.response\";\n\nexport class CipherPermissionsApi extends BaseResponse {\n  delete: boolean = false;\n  restore: boolean = false;\n\n  constructor(data: any = null) {\n    super(data);\n    if (data == null) {\n      return;\n    }\n    this.delete = this.getResponseProperty(\"Delete\");\n    this.restore = this.getResponseProperty(\"Restore\");\n  }\n\n  static fromJSON(obj: Jsonify<CipherPermissionsApi>) {\n    return Object.assign(new CipherPermissionsApi(), obj);\n  }\n\n  /**\n   * Converts the SDK CipherPermissionsApi to a CipherPermissionsApi.\n   */\n  static fromSdkCipherPermissions(obj: SdkCipherPermissions): CipherPermissionsApi | undefined {\n    if (!obj) {\n      return undefined;\n    }\n\n    const permissions = new CipherPermissionsApi();\n    permissions.delete = obj.delete;\n    permissions.restore = obj.restore;\n\n    return permissions;\n  }\n}\n","// FIXME: Update this file to be type safe and remove this and next line\n// @ts-strict-ignore\nimport { AttachmentResponse } from \"../response/attachment.response\";\n\nexport class AttachmentData {\n  id: string;\n  url: string;\n  fileName: string;\n  key: string;\n  size: string;\n  sizeName: string;\n\n  constructor(response?: AttachmentResponse) {\n    if (response == null) {\n      return;\n    }\n    this.id = response.id;\n    this.url = response.url;\n    this.fileName = response.fileName;\n    this.key = response.key;\n    this.size = response.size;\n    this.sizeName = response.sizeName;\n  }\n}\n","// FIXME: Update this file to be type safe and remove this and next line\n// @ts-strict-ignore\nimport { CardApi } from \"../api/card.api\";\n\nexport class CardData {\n  cardholderName: string;\n  brand: string;\n  number: string;\n  expMonth: string;\n  expYear: string;\n  code: string;\n\n  constructor(data?: CardApi) {\n    if (data == null) {\n      return;\n    }\n\n    this.cardholderName = data.cardholderName;\n    this.brand = data.brand;\n    this.number = data.number;\n    this.expMonth = data.expMonth;\n    this.expYear = data.expYear;\n    this.code = data.code;\n  }\n}\n","// FIXME: Update this file to be type safe and remove this and next line\n// @ts-strict-ignore\nimport { FieldType, LinkedIdType } from \"../../enums\";\nimport { FieldApi } from \"../api/field.api\";\n\nexport class FieldData {\n  type: FieldType;\n  name: string;\n  value: string;\n  linkedId: LinkedIdType | null;\n\n  constructor(response?: FieldApi) {\n    if (response == null) {\n      return;\n    }\n    this.type = response.type;\n    this.name = response.name;\n    this.value = response.value;\n    this.linkedId = response.linkedId;\n  }\n}\n","// FIXME: Update this file to be type safe and remove this and next line\n// @ts-strict-ignore\nimport { IdentityApi } from \"../api/identity.api\";\n\nexport class IdentityData {\n  title: string;\n  firstName: string;\n  middleName: string;\n  lastName: string;\n  address1: string;\n  address2: string;\n  address3: string;\n  city: string;\n  state: string;\n  postalCode: string;\n  country: string;\n  company: string;\n  email: string;\n  phone: string;\n  ssn: string;\n  username: string;\n  passportNumber: string;\n  licenseNumber: string;\n\n  constructor(data?: IdentityApi) {\n    if (data == null) {\n      return;\n    }\n\n    this.title = data.title;\n    this.firstName = data.firstName;\n    this.middleName = data.middleName;\n    this.lastName = data.lastName;\n    this.address1 = data.address1;\n    this.address2 = data.address2;\n    this.address3 = data.address3;\n    this.city = data.city;\n    this.state = data.state;\n    this.postalCode = data.postalCode;\n    this.country = data.country;\n    this.company = data.company;\n    this.email = data.email;\n    this.phone = data.phone;\n    this.ssn = data.ssn;\n    this.username = data.username;\n    this.passportNumber = data.passportNumber;\n    this.licenseNumber = data.licenseNumber;\n  }\n}\n","// FIXME: Update this file to be type safe and remove this and next line\n// @ts-strict-ignore\nimport { Fido2CredentialApi } from \"../api/fido2-credential.api\";\n\nexport class Fido2CredentialData {\n  credentialId: string;\n  keyType: \"public-key\";\n  keyAlgorithm: \"ECDSA\";\n  keyCurve: \"P-256\";\n  keyValue: string;\n  rpId: string;\n  userHandle: string;\n  userName: string;\n  counter: string;\n  rpName: string;\n  userDisplayName: string;\n  discoverable: string;\n  creationDate: string;\n\n  constructor(data?: Fido2CredentialApi) {\n    if (data == null) {\n      return;\n    }\n\n    this.credentialId = data.credentialId;\n    this.keyType = data.keyType;\n    this.keyAlgorithm = data.keyAlgorithm;\n    this.keyCurve = data.keyCurve;\n    this.keyValue = data.keyValue;\n    this.rpId = data.rpId;\n    this.userHandle = data.userHandle;\n    this.userName = data.userName;\n    this.counter = data.counter;\n    this.rpName = data.rpName;\n    this.userDisplayName = data.userDisplayName;\n    this.discoverable = data.discoverable;\n    this.creationDate = data.creationDate;\n  }\n}\n","// FIXME: Update this file to be type safe and remove this and next line\n// @ts-strict-ignore\nimport { UriMatchStrategySetting } from \"../../../models/domain/domain-service\";\nimport { LoginUriApi } from \"../api/login-uri.api\";\n\nexport class LoginUriData {\n  uri: string;\n  uriChecksum: string;\n  match: UriMatchStrategySetting = null;\n\n  constructor(data?: LoginUriApi) {\n    if (data == null) {\n      return;\n    }\n    this.uri = data.uri;\n    this.uriChecksum = data.uriChecksum;\n    this.match = data.match;\n  }\n}\n","// FIXME: Update this file to be type safe and remove this and next line\n// @ts-strict-ignore\nimport { LoginApi } from \"../api/login.api\";\n\nimport { Fido2CredentialData } from \"./fido2-credential.data\";\nimport { LoginUriData } from \"./login-uri.data\";\n\nexport class LoginData {\n  uris: LoginUriData[];\n  username: string;\n  password: string;\n  passwordRevisionDate: string;\n  totp: string;\n  autofillOnPageLoad: boolean;\n  fido2Credentials?: Fido2CredentialData[];\n\n  constructor(data?: LoginApi) {\n    if (data == null) {\n      return;\n    }\n\n    this.username = data.username;\n    this.password = data.password;\n    this.passwordRevisionDate = data.passwordRevisionDate;\n    this.totp = data.totp;\n    this.autofillOnPageLoad = data.autofillOnPageLoad;\n\n    if (data.uris) {\n      this.uris = data.uris.map((u) => new LoginUriData(u));\n    }\n\n    if (data.fido2Credentials) {\n      this.fido2Credentials = data.fido2Credentials?.map((key) => new Fido2CredentialData(key));\n    }\n  }\n}\n","// FIXME: Update this file to be type safe and remove this and next line\n// @ts-strict-ignore\nimport { PasswordHistoryResponse } from \"../response/password-history.response\";\n\nexport class PasswordHistoryData {\n  password: string;\n  lastUsedDate: string;\n\n  constructor(response?: PasswordHistoryResponse) {\n    if (response == null) {\n      return;\n    }\n\n    this.password = response.password;\n    this.lastUsedDate = response.lastUsedDate;\n  }\n}\n","// FIXME: Update this file to be type safe and remove this and next line\n// @ts-strict-ignore\nimport { SecureNoteType } from \"../../enums\";\nimport { SecureNoteApi } from \"../api/secure-note.api\";\n\nexport class SecureNoteData {\n  type: SecureNoteType;\n\n  constructor(data?: SecureNoteApi) {\n    if (data == null) {\n      return;\n    }\n\n    this.type = data.type;\n  }\n}\n","// FIXME: Update this file to be type safe and remove this and next line\n// @ts-strict-ignore\nimport { SshKeyApi } from \"../api/ssh-key.api\";\n\nexport class SshKeyData {\n  privateKey: string;\n  publicKey: string;\n  keyFingerprint: string;\n\n  constructor(data?: SshKeyApi) {\n    if (data == null) {\n      return;\n    }\n\n    this.privateKey = data.privateKey;\n    this.publicKey = data.publicKey;\n    this.keyFingerprint = data.keyFingerprint;\n  }\n}\n","// FIXME: Update this file to be type safe and remove this and next line\n// @ts-strict-ignore\nimport { Jsonify } from \"type-fest\";\n\nimport { CipherRepromptType } from \"../../enums/cipher-reprompt-type\";\nimport { CipherType } from \"../../enums/cipher-type\";\nimport { CipherPermissionsApi } from \"../api/cipher-permissions.api\";\nimport { CipherResponse } from \"../response/cipher.response\";\n\nimport { AttachmentData } from \"./attachment.data\";\nimport { CardData } from \"./card.data\";\nimport { FieldData } from \"./field.data\";\nimport { IdentityData } from \"./identity.data\";\nimport { LoginData } from \"./login.data\";\nimport { PasswordHistoryData } from \"./password-history.data\";\nimport { SecureNoteData } from \"./secure-note.data\";\nimport { SshKeyData } from \"./ssh-key.data\";\n\nexport class CipherData {\n  id: string;\n  organizationId: string;\n  folderId: string;\n  edit: boolean;\n  viewPassword: boolean;\n  permissions: CipherPermissionsApi;\n  organizationUseTotp: boolean;\n  favorite: boolean;\n  revisionDate: string;\n  type: CipherType;\n  name: string;\n  notes: string;\n  login?: LoginData;\n  secureNote?: SecureNoteData;\n  card?: CardData;\n  identity?: IdentityData;\n  sshKey?: SshKeyData;\n  fields?: FieldData[];\n  attachments?: AttachmentData[];\n  passwordHistory?: PasswordHistoryData[];\n  collectionIds?: string[];\n  creationDate: string;\n  deletedDate: string | null;\n  reprompt: CipherRepromptType;\n  key: string;\n\n  constructor(response?: CipherResponse, collectionIds?: string[]) {\n    if (response == null) {\n      return;\n    }\n\n    this.id = response.id;\n    this.organizationId = response.organizationId;\n    this.folderId = response.folderId;\n    this.edit = response.edit;\n    this.viewPassword = response.viewPassword;\n    this.permissions = response.permissions;\n    this.organizationUseTotp = response.organizationUseTotp;\n    this.favorite = response.favorite;\n    this.revisionDate = response.revisionDate;\n    this.type = response.type as CipherType;\n    this.name = response.name;\n    this.notes = response.notes;\n    this.collectionIds = collectionIds != null ? collectionIds : response.collectionIds;\n    this.creationDate = response.creationDate;\n    this.deletedDate = response.deletedDate;\n    this.reprompt = response.reprompt;\n    this.key = response.key;\n\n    switch (this.type) {\n      case CipherType.Login:\n        this.login = new LoginData(response.login);\n        break;\n      case CipherType.SecureNote:\n        this.secureNote = new SecureNoteData(response.secureNote);\n        break;\n      case CipherType.Card:\n        this.card = new CardData(response.card);\n        break;\n      case CipherType.Identity:\n        this.identity = new IdentityData(response.identity);\n        break;\n      case CipherType.SshKey:\n        this.sshKey = new SshKeyData(response.sshKey);\n        break;\n      default:\n        break;\n    }\n\n    if (response.fields != null) {\n      this.fields = response.fields.map((f) => new FieldData(f));\n    }\n    if (response.attachments != null) {\n      this.attachments = response.attachments.map((a) => new AttachmentData(a));\n    }\n    if (response.passwordHistory != null) {\n      this.passwordHistory = response.passwordHistory.map((ph) => new PasswordHistoryData(ph));\n    }\n  }\n\n  static fromJSON(obj: Jsonify<CipherData>) {\n    const result = Object.assign(new CipherData(), obj);\n    result.permissions = CipherPermissionsApi.fromJSON(obj.permissions);\n    return result;\n  }\n}\n","import { UnionOfValues } from \"../types/union-of-values\";\n\nexport const CipherRepromptType = {\n  None: 0,\n  Password: 1,\n} as const;\n\nexport type CipherRepromptType = UnionOfValues<typeof CipherRepromptType>;\n","import { UnionOfValues } from \"../types/union-of-values\";\n\nexport type LinkedIdType = LoginLinkedId | CardLinkedId | IdentityLinkedId;\n\n// LoginView\nexport const LoginLinkedId = {\n  Username: 100,\n  Password: 101,\n} as const;\n\nexport type LoginLinkedId = UnionOfValues<typeof LoginLinkedId>;\n\n// CardView\nexport const CardLinkedId = {\n  CardholderName: 300,\n  ExpMonth: 301,\n  ExpYear: 302,\n  Code: 303,\n  Brand: 304,\n  Number: 305,\n} as const;\n\nexport type CardLinkedId = UnionOfValues<typeof CardLinkedId>;\n\n// IdentityView\nexport const IdentityLinkedId = {\n  Title: 400,\n  MiddleName: 401,\n  Address1: 402,\n  Address2: 403,\n  Address3: 404,\n  City: 405,\n  State: 406,\n  PostalCode: 407,\n  Country: 408,\n  Company: 409,\n  Email: 410,\n  Phone: 411,\n  Ssn: 412,\n  Username: 413,\n  PassportNumber: 414,\n  LicenseNumber: 415,\n  FirstName: 416,\n  LastName: 417,\n  FullName: 418,\n} as const;\n\nexport type IdentityLinkedId = UnionOfValues<typeof IdentityLinkedId>;\n","const _FieldType = Object.freeze({\n  Text: 0,\n  Hidden: 1,\n  Boolean: 2,\n  Linked: 3,\n} as const);\n\ntype _FieldType = typeof _FieldType;\n\nexport type FieldType = _FieldType[keyof _FieldType];\n\nexport const FieldType: Record<keyof _FieldType, FieldType> = _FieldType;\n","// FIXME: Update this file to be type safe and remove this and next line\n// @ts-strict-ignore\nimport { Jsonify } from \"type-fest\";\n\nimport { AttachmentView as SdkAttachmentView } from \"@bitwarden/sdk-internal\";\n\nimport { View } from \"../../../models/view/view\";\nimport { EncString } from \"../../../platform/models/domain/enc-string\";\nimport { SymmetricCryptoKey } from \"../../../platform/models/domain/symmetric-crypto-key\";\nimport { Attachment } from \"../domain/attachment\";\n\nexport class AttachmentView implements View {\n  id: string = null;\n  url: string = null;\n  size: string = null;\n  sizeName: string = null;\n  fileName: string = null;\n  key: SymmetricCryptoKey = null;\n  /**\n   * The SDK returns an encrypted key for the attachment.\n   */\n  encryptedKey: EncString | undefined;\n\n  constructor(a?: Attachment) {\n    if (!a) {\n      return;\n    }\n\n    this.id = a.id;\n    this.url = a.url;\n    this.size = a.size;\n    this.sizeName = a.sizeName;\n  }\n\n  get fileSize(): number {\n    try {\n      if (this.size != null) {\n        return parseInt(this.size, null);\n      }\n    } catch {\n      // Invalid file size.\n    }\n    return 0;\n  }\n\n  static fromJSON(obj: Partial<Jsonify<AttachmentView>>): AttachmentView {\n    const key = obj.key == null ? null : SymmetricCryptoKey.fromJSON(obj.key);\n    return Object.assign(new AttachmentView(), obj, { key: key });\n  }\n\n  /**\n   * Converts the AttachmentView to a SDK AttachmentView.\n   */\n  toSdkAttachmentView(): SdkAttachmentView {\n    return {\n      id: this.id,\n      url: this.url,\n      size: this.size,\n      sizeName: this.sizeName,\n      fileName: this.fileName,\n      key: this.encryptedKey?.toJSON(),\n    };\n  }\n\n  /**\n   * Converts the SDK AttachmentView to a AttachmentView.\n   */\n  static fromSdkAttachmentView(obj: SdkAttachmentView): AttachmentView | undefined {\n    if (!obj) {\n      return undefined;\n    }\n\n    const view = new AttachmentView();\n    view.id = obj.id ?? null;\n    view.url = obj.url ?? null;\n    view.size = obj.size ?? null;\n    view.sizeName = obj.sizeName ?? null;\n    view.fileName = obj.fileName ?? null;\n    view.encryptedKey = new EncString(obj.key);\n\n    return view;\n  }\n}\n","export const CardExpiryDateDelimiters: string[] = [\"/\", \"-\", \".\", \" \"];\n\n// `CardExpiryDateDelimiters` is not intended solely for regex consumption,\n// so we need to format it here\nexport const ExpiryDateDelimitersPattern =\n  \"\\\\\" +\n  CardExpiryDateDelimiters.join(\"\\\\\")\n    // replace space character with the regex whitespace character class\n    .replace(\" \", \"s\");\n\nexport const MonthPattern = \"(([1]{1}[0-2]{1})|(0?[1-9]{1}))\";\n\n// Because we're dealing with expiry dates, we assume the year will be in current or next century (as of 2024)\nexport const ExpiryFullYearPattern = \"2[0-1]{1}\\\\d{2}\";\n\nexport const DelimiterPatternExpression = new RegExp(`[${ExpiryDateDelimitersPattern}]`, \"g\");\n\nexport const IrrelevantExpiryCharactersPatternExpression = new RegExp(\n  // \"nor digits\" to ensure numbers are removed from guidance pattern, which aren't covered by ^\\w\n  `[^\\\\d${ExpiryDateDelimitersPattern}]`,\n  \"g\",\n);\n\nexport const MonthPatternExpression = new RegExp(`^${MonthPattern}$`);\n\nexport const ExpiryFullYearPatternExpression = new RegExp(`^${ExpiryFullYearPattern}$`);\n","import { NeverDomains } from \"@bitwarden/common/models/domain/domain-service\";\nimport { Utils } from \"@bitwarden/common/platform/misc/utils\";\n\nimport { CardView } from \"../vault/models/view/card.view\";\n\nimport {\n  DelimiterPatternExpression,\n  ExpiryFullYearPattern,\n  ExpiryFullYearPatternExpression,\n  IrrelevantExpiryCharactersPatternExpression,\n  MonthPatternExpression,\n} from \"./constants\";\n\ntype NonZeroIntegers = 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9;\ntype Year = `${NonZeroIntegers}${NonZeroIntegers}${0 | NonZeroIntegers}${0 | NonZeroIntegers}`;\n\n/**\n * Takes a string or number value and returns a string value formatted as a valid 4-digit year\n *\n * @param {(string | number)} yearInput\n * @return {*}  {(Year | null)}\n */\nexport function normalizeExpiryYearFormat(yearInput: string | number): Year | null {\n  // The input[type=\"number\"] is returning a number, convert it to a string\n  // An empty field returns null, avoid casting `\"null\"` to a string\n  const yearInputIsEmpty = yearInput == null || yearInput === \"\";\n  let expirationYear = yearInputIsEmpty ? null : `${yearInput}`;\n\n  // Exit early if year is already formatted correctly or empty\n  if (yearInputIsEmpty || (expirationYear && /^[1-9]{1}\\d{3}$/.test(expirationYear))) {\n    return expirationYear as Year;\n  }\n\n  expirationYear = (expirationYear || \"\")\n    // For safety, because even input[type=\"number\"] will allow decimals\n    .replace(/[^\\d]/g, \"\")\n    // remove any leading zero padding (leave the last leading zero if it ends the string)\n    .replace(/^[0]+(?=.)/, \"\");\n\n  if (expirationYear === \"\") {\n    expirationYear = null;\n  }\n\n  // given the context of payment card expiry, a year character length of 3, or over 4\n  // is more likely to be a mistake than an intentional value for the far past or far future.\n  if (expirationYear && expirationYear.length !== 4) {\n    const paddedYear = (\"00\" + expirationYear).slice(-2);\n    const currentCentury = `${new Date().getFullYear()}`.slice(0, 2);\n\n    expirationYear = currentCentury + paddedYear;\n  }\n\n  return expirationYear as Year | null;\n}\n\n/**\n * Takes a cipher card view and returns \"true\" if the month and year affirmativey indicate\n * the card is expired. Uncertain cases return \"false\".\n *\n * @param {CardView} cipherCard\n * @return {*}  {boolean}\n */\nexport function isCardExpired(cipherCard: CardView): boolean {\n  if (cipherCard) {\n    const { expMonth = null, expYear = null } = cipherCard;\n\n    if (!expYear) {\n      return false;\n    }\n\n    const now = new Date();\n    const normalizedYear = normalizeExpiryYearFormat(expYear);\n    const parsedYear = normalizedYear ? parseInt(normalizedYear, 10) : NaN;\n\n    const expiryYearIsBeforeCurrentYear = parsedYear < now.getFullYear();\n    const expiryYearIsAfterCurrentYear = parsedYear > now.getFullYear();\n\n    // If the expiry year is before the current year, skip checking the month, since it must be expired\n    if (normalizedYear && expiryYearIsBeforeCurrentYear) {\n      return true;\n    }\n\n    // If the expiry year is after the current year, skip checking the month, since it cannot be expired\n    if (normalizedYear && expiryYearIsAfterCurrentYear) {\n      return false;\n    }\n\n    if (normalizedYear && expMonth) {\n      const parsedMonthInteger = parseInt(expMonth, 10);\n      const parsedMonthIsValid = parsedMonthInteger && !isNaN(parsedMonthInteger);\n\n      // If the parsed month value is 0, we don't know when the expiry passes this year, so do not treat it as expired\n      if (!parsedMonthIsValid) {\n        return false;\n      }\n\n      // `Date` months are zero-indexed\n      const parsedMonth = parsedMonthInteger - 1;\n\n      // First day of the next month\n      const cardExpiry = new Date(parsedYear, parsedMonth + 1, 1);\n\n      return cardExpiry <= now;\n    }\n  }\n\n  return false;\n}\n\n/**\n * Attempt to split a string into date segments on the basis of expected formats and delimiter symbols.\n *\n * @param {string} combinedExpiryValue\n * @return {*}  {string[]}\n */\nfunction splitCombinedDateValues(combinedExpiryValue: string): string[] {\n  let sanitizedValue = combinedExpiryValue\n    .replace(IrrelevantExpiryCharactersPatternExpression, \"\")\n    .trim();\n\n  // Do this after initial value replace to avoid identifying leading whitespace as delimiter\n  const parsedDelimiter = sanitizedValue.match(DelimiterPatternExpression)?.[0] || null;\n\n  let dateParts = [sanitizedValue];\n\n  if (parsedDelimiter?.length) {\n    // If the parsed delimiter is a whitespace character, assign 's' (character class) instead\n    const delimiterPattern = /\\s/.test(parsedDelimiter) ? \"\\\\s\" : \"\\\\\" + parsedDelimiter;\n\n    sanitizedValue = sanitizedValue\n      // Remove all other delimiter characters not identified as the delimiter\n      .replace(new RegExp(`[^\\\\d${delimiterPattern}]`, \"g\"), \"\")\n      // Also de-dupe the delimiter character\n      .replace(new RegExp(`[${delimiterPattern}]{2,}`, \"g\"), parsedDelimiter);\n\n    dateParts = sanitizedValue.split(parsedDelimiter);\n  }\n\n  return (\n    dateParts\n      // remove values that have no length\n      .filter((splitValue) => splitValue?.length)\n  );\n}\n\n/**\n * Given an array of split card expiry date parts,\n * returns an array of those values ordered by year then month\n *\n * @param {string[]} splitDateInput\n * @return {*}  {([string | null, string | null])}\n */\nfunction parseDelimitedYearMonthExpiry([firstPart, secondPart]: string[]): [string, string] {\n  // Conditionals here are structured to avoid unnecessary evaluations and are ordered\n  // from more authoritative checks to checks yielding increasingly inferred conclusions\n\n  // If a 4-digit value is found (when there are multiple parts), it can't be month\n  if (ExpiryFullYearPatternExpression.test(firstPart)) {\n    return [firstPart, secondPart];\n  }\n\n  // If a 4-digit value is found (when there are multiple parts), it can't be month\n  if (ExpiryFullYearPatternExpression.test(secondPart)) {\n    return [secondPart, firstPart];\n  }\n\n  // If it's a two digit value that doesn't match against month pattern, assume it's a year\n  if (/\\d{2}/.test(firstPart) && !MonthPatternExpression.test(firstPart)) {\n    return [firstPart, secondPart];\n  }\n\n  // If it's a two digit value that doesn't match against month pattern, assume it's a year\n  if (/\\d{2}/.test(secondPart) && !MonthPatternExpression.test(secondPart)) {\n    return [secondPart, firstPart];\n  }\n\n  // Values are too ambiguous (e.g. \"12/09\"). For the most part,\n  // a month-looking value likely is, at the time of writing (year 2024).\n  let parsedYear = firstPart;\n  let parsedMonth = secondPart;\n\n  if (MonthPatternExpression.test(firstPart)) {\n    parsedYear = secondPart;\n    parsedMonth = firstPart;\n  }\n\n  return [parsedYear, parsedMonth];\n}\n\n/**\n * Given a single string of integers, attempts to identify card expiry date portions within\n * and return values ordered by year then month\n *\n * @param {string} dateInput\n * @return {*}  {([string | null, string | null])}\n */\nfunction parseNonDelimitedYearMonthExpiry(dateInput: string): [string | null, string | null] {\n  if (dateInput.length > 4) {\n    // e.g.\n    // \"052024\"\n    // \"202405\"\n    // \"20245\"\n    // \"52024\"\n\n    // If the value is over 5-characters long, it likely has a full year format in it\n    const [parsedYear, parsedMonth] = dateInput\n      .split(new RegExp(`(?=${ExpiryFullYearPattern})|(?<=${ExpiryFullYearPattern})`, \"g\"))\n      .sort((current: string, next: string) => (current.length > next.length ? -1 : 1));\n\n    return [parsedYear, parsedMonth];\n  }\n\n  if (dateInput.length === 4) {\n    // e.g.\n    // \"0524\"\n    // \"2405\"\n\n    // If the `sanitizedFirstPart` value is a length of 4, it must be split in half, since\n    // neither a year or month will be represented with three characters\n    const splitFirstPartFirstHalf = dateInput.slice(0, 2);\n    const splitFirstPartSecondHalf = dateInput.slice(-2);\n\n    let parsedYear = splitFirstPartSecondHalf;\n    let parsedMonth = splitFirstPartFirstHalf;\n\n    // If the first part doesn't match a month pattern, assume it's a year\n    if (!MonthPatternExpression.test(splitFirstPartFirstHalf)) {\n      parsedYear = splitFirstPartFirstHalf;\n      parsedMonth = splitFirstPartSecondHalf;\n    }\n\n    return [parsedYear, parsedMonth];\n  }\n\n  // e.g.\n  // \"245\"\n  // \"202\"\n  // \"212\"\n  // \"022\"\n  // \"111\"\n\n  // A valid year representation here must be two characters so try to find it first.\n\n  let parsedYear = null;\n  let parsedMonth = null;\n\n  // Split if there is a digit with a leading zero\n  const splitFirstPartOnLeadingZero = dateInput.split(/(?<=0[1-9]{1})|(?=0[1-9]{1})/);\n\n  // Assume a leading zero indicates a month in ambiguous cases (e.g. \"202\"), since we're\n  // dealing with expiry dates and the next two-digit year with a leading zero will be 2100\n  if (splitFirstPartOnLeadingZero.length > 1) {\n    parsedYear = splitFirstPartOnLeadingZero[0];\n    parsedMonth = splitFirstPartOnLeadingZero[1];\n\n    if (splitFirstPartOnLeadingZero[0].startsWith(\"0\")) {\n      parsedMonth = splitFirstPartOnLeadingZero[0];\n      parsedYear = splitFirstPartOnLeadingZero[1];\n    }\n  } else {\n    // Here, a year has to be two-digits, and a month can't be more than one, so assume the first two digits that are greater than the current year is the year representation.\n    parsedYear = dateInput.slice(0, 2);\n    parsedMonth = dateInput.slice(-1);\n\n    const currentYear = new Date().getFullYear();\n    const normalizedYearFormat = normalizeExpiryYearFormat(parsedYear);\n    const normalizedParsedYear = normalizedYearFormat && parseInt(normalizedYearFormat, 10);\n    const normalizedExpiryYearFormat = normalizeExpiryYearFormat(dateInput.slice(-2));\n    const normalizedParsedYearAlternative =\n      normalizedExpiryYearFormat && parseInt(normalizedExpiryYearFormat, 10);\n\n    if (\n      normalizedParsedYear &&\n      normalizedParsedYear < currentYear &&\n      normalizedParsedYearAlternative &&\n      normalizedParsedYearAlternative >= currentYear\n    ) {\n      parsedYear = dateInput.slice(-2);\n      parsedMonth = dateInput.slice(0, 1);\n    }\n  }\n\n  return [parsedYear, parsedMonth];\n}\n\n/**\n * Attempt to parse year and month parts of a combined expiry date value.\n *\n * @param {string} combinedExpiryValue\n * @return {*}  {([string | null, string | null])}\n */\nexport function parseYearMonthExpiry(combinedExpiryValue: string): [Year | null, string | null] {\n  let parsedYear = null;\n  let parsedMonth = null;\n\n  const dateParts = splitCombinedDateValues(combinedExpiryValue);\n\n  if (dateParts.length < 1) {\n    return [null, null];\n  }\n\n  const sanitizedFirstPart =\n    dateParts[0]?.replace(IrrelevantExpiryCharactersPatternExpression, \"\") || \"\";\n  const sanitizedSecondPart =\n    dateParts[1]?.replace(IrrelevantExpiryCharactersPatternExpression, \"\") || \"\";\n\n  // If there is only one date part, no delimiter was found in the passed value\n  if (dateParts.length === 1) {\n    const [parsedNonDelimitedYear, parsedNonDelimitedMonth] =\n      parseNonDelimitedYearMonthExpiry(sanitizedFirstPart);\n\n    parsedYear = parsedNonDelimitedYear;\n    parsedMonth = parsedNonDelimitedMonth;\n  }\n  // There are multiple date parts\n  else {\n    const [parsedDelimitedYear, parsedDelimitedMonth] = parseDelimitedYearMonthExpiry([\n      sanitizedFirstPart,\n      sanitizedSecondPart,\n    ]);\n\n    parsedYear = parsedDelimitedYear;\n    parsedMonth = parsedDelimitedMonth;\n  }\n\n  const normalizedParsedYear = parsedYear ? normalizeExpiryYearFormat(parsedYear) : null;\n  const normalizedParsedMonth = parsedMonth?.replace(/^0+/, \"\").slice(0, 2);\n\n  // Set \"empty\" values to null\n  parsedYear = normalizedParsedYear?.length ? normalizedParsedYear : null;\n  parsedMonth = normalizedParsedMonth?.length ? normalizedParsedMonth : null;\n\n  return [parsedYear, parsedMonth];\n}\n\n/**\n * Takes a URL string and a NeverDomains object and determines if the passed URL's hostname is in `urlList`\n *\n * @param {string} url - representation of URL to check\n * @param {NeverDomains} urlList - object with hostname key names\n */\nexport function isUrlInList(url: string = \"\", urlList: NeverDomains = {}): boolean {\n  const urlListKeys = urlList && Object.keys(urlList);\n\n  if (urlListKeys.length && url?.length) {\n    let tabHostname;\n    try {\n      tabHostname = Utils.getHostname(url);\n    } catch {\n      // If the input was invalid, exit early and return false\n      return false;\n    }\n\n    if (tabHostname) {\n      return urlListKeys.some((blockedHostname) => tabHostname.endsWith(blockedHostname));\n    }\n  }\n\n  return false;\n}\n","// FIXME: Update this file to be type safe and remove this and next line\n// @ts-strict-ignore\nimport { LinkedIdType } from \"./enums\";\nimport { ItemView } from \"./models/view/item.view\";\n\ntype LinkedMetadataAttributes = {\n  /**\n   * The i18n key used to describe the decorated class property in the UI.\n   * If it is null, then the name of the class property will be used as the i18n key.\n   */\n  i18nKey?: string;\n\n  /**\n   * The position of the individual field to be applied when sorted.\n   */\n  sortPosition: number;\n};\n\nexport class LinkedMetadata {\n  private readonly _i18nKey: string;\n  readonly sortPosition: number;\n\n  constructor(\n    readonly propertyKey: string,\n    attributes: LinkedMetadataAttributes,\n  ) {\n    this._i18nKey = attributes?.i18nKey;\n    this.sortPosition = attributes.sortPosition;\n  }\n\n  get i18nKey() {\n    return this._i18nKey ?? this.propertyKey;\n  }\n}\n\n/**\n * A decorator used to set metadata used by Linked custom fields. Apply it to a class property or getter to make it\n *    available as a Linked custom field option.\n * @param id - A unique value that is saved in the Field model. It is used to look up the decorated class property.\n * @param options - {@link LinkedMetadataAttributes}\n */\nexport function linkedFieldOption(id: LinkedIdType, attributes: LinkedMetadataAttributes) {\n  return (prototype: ItemView, propertyKey: string) => {\n    if (prototype.linkedFieldOptions == null) {\n      prototype.linkedFieldOptions = new Map<LinkedIdType, LinkedMetadata>();\n    }\n\n    prototype.linkedFieldOptions.set(id, new LinkedMetadata(propertyKey, attributes));\n  };\n}\n","// FIXME: Update this file to be type safe and remove this and next line\n// @ts-strict-ignore\nimport { View } from \"../../../models/view/view\";\nimport { LinkedMetadata } from \"../../linked-field-option.decorator\";\n\nexport abstract class ItemView implements View {\n  linkedFieldOptions: Map<number, LinkedMetadata>;\n  abstract get subTitle(): string;\n}\n","// FIXME: Update this file to be type safe and remove this and next line\n// @ts-strict-ignore\nimport { Jsonify } from \"type-fest\";\n\nimport { CardView as SdkCardView } from \"@bitwarden/sdk-internal\";\n\nimport { normalizeExpiryYearFormat } from \"../../../autofill/utils\";\nimport { CardLinkedId as LinkedId } from \"../../enums\";\nimport { linkedFieldOption } from \"../../linked-field-option.decorator\";\n\nimport { ItemView } from \"./item.view\";\n\nexport class CardView extends ItemView {\n  @linkedFieldOption(LinkedId.CardholderName, { sortPosition: 0 })\n  cardholderName: string = null;\n  @linkedFieldOption(LinkedId.ExpMonth, { sortPosition: 3, i18nKey: \"expirationMonth\" })\n  expMonth: string = null;\n  @linkedFieldOption(LinkedId.ExpYear, { sortPosition: 4, i18nKey: \"expirationYear\" })\n  expYear: string = null;\n  @linkedFieldOption(LinkedId.Code, { sortPosition: 5, i18nKey: \"securityCode\" })\n  code: string = null;\n\n  private _brand: string = null;\n  private _number: string = null;\n  private _subTitle: string = null;\n\n  get maskedCode(): string {\n    return this.code != null ? \"\".repeat(this.code.length) : null;\n  }\n\n  get maskedNumber(): string {\n    return this.number != null ? \"\".repeat(this.number.length) : null;\n  }\n\n  @linkedFieldOption(LinkedId.Brand, { sortPosition: 2 })\n  get brand(): string {\n    return this._brand;\n  }\n  set brand(value: string) {\n    this._brand = value;\n    this._subTitle = null;\n  }\n\n  @linkedFieldOption(LinkedId.Number, { sortPosition: 1 })\n  get number(): string {\n    return this._number;\n  }\n  set number(value: string) {\n    this._number = value;\n    this._subTitle = null;\n  }\n\n  get subTitle(): string {\n    if (this._subTitle == null) {\n      this._subTitle = this.brand;\n      if (this.number != null && this.number.length >= 4) {\n        if (this._subTitle != null && this._subTitle !== \"\") {\n          this._subTitle += \", \";\n        } else {\n          this._subTitle = \"\";\n        }\n\n        // Show last 5 on amex, last 4 for all others\n        const count =\n          this.number.length >= 5 && this.number.match(new RegExp(\"^3[47]\")) != null ? 5 : 4;\n        this._subTitle += \"*\" + this.number.substr(this.number.length - count);\n      }\n    }\n    return this._subTitle;\n  }\n\n  get expiration(): string {\n    const normalizedYear = normalizeExpiryYearFormat(this.expYear);\n\n    if (!this.expMonth && !normalizedYear) {\n      return null;\n    }\n\n    let exp = this.expMonth != null ? (\"0\" + this.expMonth).slice(-2) : \"__\";\n    exp += \" / \" + (normalizedYear || \"____\");\n\n    return exp;\n  }\n\n  static fromJSON(obj: Partial<Jsonify<CardView>>): CardView {\n    return Object.assign(new CardView(), obj);\n  }\n\n  // ref https://stackoverflow.com/a/5911300\n  static getCardBrandByPatterns(cardNum: string): string {\n    if (cardNum == null || typeof cardNum !== \"string\" || cardNum.trim() === \"\") {\n      return null;\n    }\n\n    // Visa\n    let re = new RegExp(\"^4\");\n    if (cardNum.match(re) != null) {\n      return \"Visa\";\n    }\n\n    // Mastercard\n    // Updated for Mastercard 2017 BINs expansion\n    if (\n      /^(5[1-5][0-9]{14}|2(22[1-9][0-9]{12}|2[3-9][0-9]{13}|[3-6][0-9]{14}|7[0-1][0-9]{13}|720[0-9]{12}))$/.test(\n        cardNum,\n      )\n    ) {\n      return \"Mastercard\";\n    }\n\n    // AMEX\n    re = new RegExp(\"^3[47]\");\n    if (cardNum.match(re) != null) {\n      return \"Amex\";\n    }\n\n    // Discover\n    re = new RegExp(\n      \"^(6011|622(12[6-9]|1[3-9][0-9]|[2-8][0-9]{2}|9[0-1][0-9]|92[0-5]|64[4-9])|65)\",\n    );\n    if (cardNum.match(re) != null) {\n      return \"Discover\";\n    }\n\n    // Diners\n    re = new RegExp(\"^36\");\n    if (cardNum.match(re) != null) {\n      return \"Diners Club\";\n    }\n\n    // Diners - Carte Blanche\n    re = new RegExp(\"^30[0-5]\");\n    if (cardNum.match(re) != null) {\n      return \"Diners Club\";\n    }\n\n    // JCB\n    re = new RegExp(\"^35(2[89]|[3-8][0-9])\");\n    if (cardNum.match(re) != null) {\n      return \"JCB\";\n    }\n\n    // Visa Electron\n    re = new RegExp(\"^(4026|417500|4508|4844|491(3|7))\");\n    if (cardNum.match(re) != null) {\n      return \"Visa\";\n    }\n\n    return null;\n  }\n\n  /**\n   * Converts an SDK CardView to a CardView.\n   */\n  static fromSdkCardView(obj: SdkCardView): CardView | undefined {\n    if (obj == null) {\n      return undefined;\n    }\n\n    const cardView = new CardView();\n\n    cardView.cardholderName = obj.cardholderName ?? null;\n    cardView.brand = obj.brand ?? null;\n    cardView.number = obj.number ?? null;\n    cardView.expMonth = obj.expMonth ?? null;\n    cardView.expYear = obj.expYear ?? null;\n    cardView.code = obj.code ?? null;\n\n    return cardView;\n  }\n}\n","// FIXME: Update this file to be type safe and remove this and next line\n// @ts-strict-ignore\nimport { Jsonify } from \"type-fest\";\n\nimport { FieldView as SdkFieldView } from \"@bitwarden/sdk-internal\";\n\nimport { View } from \"../../../models/view/view\";\nimport { FieldType, LinkedIdType } from \"../../enums\";\nimport { Field } from \"../domain/field\";\n\nexport class FieldView implements View {\n  name: string = null;\n  value: string = null;\n  type: FieldType = null;\n  newField = false; // Marks if the field is new and hasn't been saved\n  showValue = false;\n  showCount = false;\n  linkedId: LinkedIdType = null;\n\n  constructor(f?: Field) {\n    if (!f) {\n      return;\n    }\n\n    this.type = f.type;\n    this.linkedId = f.linkedId;\n  }\n\n  get maskedValue(): string {\n    return this.value != null ? \"\" : null;\n  }\n\n  static fromJSON(obj: Partial<Jsonify<FieldView>>): FieldView {\n    return Object.assign(new FieldView(), obj);\n  }\n\n  /**\n   * Converts the SDK FieldView to a FieldView.\n   */\n  static fromSdkFieldView(obj: SdkFieldView): FieldView | undefined {\n    if (!obj) {\n      return undefined;\n    }\n\n    const view = new FieldView();\n    view.name = obj.name;\n    view.value = obj.value;\n    view.type = obj.type;\n    view.linkedId = obj.linkedId as unknown as LinkedIdType;\n\n    return view;\n  }\n}\n","// FIXME: Update this file to be type safe and remove this and next line\n// @ts-strict-ignore\nimport { Jsonify } from \"type-fest\";\n\nimport { IdentityView as SdkIdentityView } from \"@bitwarden/sdk-internal\";\n\nimport { Utils } from \"../../../platform/misc/utils\";\nimport { IdentityLinkedId as LinkedId } from \"../../enums\";\nimport { linkedFieldOption } from \"../../linked-field-option.decorator\";\n\nimport { ItemView } from \"./item.view\";\n\nexport class IdentityView extends ItemView {\n  @linkedFieldOption(LinkedId.Title, { sortPosition: 0 })\n  title: string = null;\n  @linkedFieldOption(LinkedId.MiddleName, { sortPosition: 2 })\n  middleName: string = null;\n  @linkedFieldOption(LinkedId.Address1, { sortPosition: 12 })\n  address1: string = null;\n  @linkedFieldOption(LinkedId.Address2, { sortPosition: 13 })\n  address2: string = null;\n  @linkedFieldOption(LinkedId.Address3, { sortPosition: 14 })\n  address3: string = null;\n  @linkedFieldOption(LinkedId.City, { sortPosition: 15, i18nKey: \"cityTown\" })\n  city: string = null;\n  @linkedFieldOption(LinkedId.State, { sortPosition: 16, i18nKey: \"stateProvince\" })\n  state: string = null;\n  @linkedFieldOption(LinkedId.PostalCode, { sortPosition: 17, i18nKey: \"zipPostalCode\" })\n  postalCode: string = null;\n  @linkedFieldOption(LinkedId.Country, { sortPosition: 18 })\n  country: string = null;\n  @linkedFieldOption(LinkedId.Company, { sortPosition: 6 })\n  company: string = null;\n  @linkedFieldOption(LinkedId.Email, { sortPosition: 10 })\n  email: string = null;\n  @linkedFieldOption(LinkedId.Phone, { sortPosition: 11 })\n  phone: string = null;\n  @linkedFieldOption(LinkedId.Ssn, { sortPosition: 7 })\n  ssn: string = null;\n  @linkedFieldOption(LinkedId.Username, { sortPosition: 5 })\n  username: string = null;\n  @linkedFieldOption(LinkedId.PassportNumber, { sortPosition: 8 })\n  passportNumber: string = null;\n  @linkedFieldOption(LinkedId.LicenseNumber, { sortPosition: 9 })\n  licenseNumber: string = null;\n\n  private _firstName: string = null;\n  private _lastName: string = null;\n  private _subTitle: string = null;\n\n  constructor() {\n    super();\n  }\n\n  @linkedFieldOption(LinkedId.FirstName, { sortPosition: 1 })\n  get firstName(): string {\n    return this._firstName;\n  }\n  set firstName(value: string) {\n    this._firstName = value;\n    this._subTitle = null;\n  }\n\n  @linkedFieldOption(LinkedId.LastName, { sortPosition: 4 })\n  get lastName(): string {\n    return this._lastName;\n  }\n  set lastName(value: string) {\n    this._lastName = value;\n    this._subTitle = null;\n  }\n\n  get subTitle(): string {\n    if (this._subTitle == null && (this.firstName != null || this.lastName != null)) {\n      this._subTitle = \"\";\n      if (this.firstName != null) {\n        this._subTitle = this.firstName;\n      }\n      if (this.lastName != null) {\n        if (this._subTitle !== \"\") {\n          this._subTitle += \" \";\n        }\n        this._subTitle += this.lastName;\n      }\n    }\n\n    return this._subTitle;\n  }\n\n  @linkedFieldOption(LinkedId.FullName, { sortPosition: 3 })\n  get fullName(): string {\n    if (\n      this.title != null ||\n      this.firstName != null ||\n      this.middleName != null ||\n      this.lastName != null\n    ) {\n      let name = \"\";\n      if (this.title != null) {\n        name += this.title + \" \";\n      }\n      if (this.firstName != null) {\n        name += this.firstName + \" \";\n      }\n      if (this.middleName != null) {\n        name += this.middleName + \" \";\n      }\n      if (this.lastName != null) {\n        name += this.lastName;\n      }\n      return name.trim();\n    }\n\n    return null;\n  }\n\n  get fullAddress(): string {\n    let address = this.address1;\n    if (!Utils.isNullOrWhitespace(this.address2)) {\n      if (!Utils.isNullOrWhitespace(address)) {\n        address += \", \";\n      }\n      address += this.address2;\n    }\n    if (!Utils.isNullOrWhitespace(this.address3)) {\n      if (!Utils.isNullOrWhitespace(address)) {\n        address += \", \";\n      }\n      address += this.address3;\n    }\n    return address;\n  }\n\n  get fullAddressPart2(): string {\n    if (this.city == null && this.state == null && this.postalCode == null) {\n      return null;\n    }\n    const city = this.city || \"-\";\n    const state = this.state;\n    const postalCode = this.postalCode || \"-\";\n    let addressPart2 = city;\n    if (!Utils.isNullOrWhitespace(state)) {\n      addressPart2 += \", \" + state;\n    }\n    addressPart2 += \", \" + postalCode;\n    return addressPart2;\n  }\n\n  get fullAddressForCopy(): string {\n    let address = this.fullAddress;\n    if (this.city != null || this.state != null || this.postalCode != null) {\n      address += \"\\n\" + this.fullAddressPart2;\n    }\n    if (this.country != null) {\n      address += \"\\n\" + this.country;\n    }\n    return address;\n  }\n\n  static fromJSON(obj: Partial<Jsonify<IdentityView>>): IdentityView {\n    return Object.assign(new IdentityView(), obj);\n  }\n\n  /**\n   * Converts the SDK IdentityView to an IdentityView.\n   */\n  static fromSdkIdentityView(obj: SdkIdentityView): IdentityView | undefined {\n    if (obj == null) {\n      return undefined;\n    }\n\n    const identityView = new IdentityView();\n\n    identityView.title = obj.title ?? null;\n    identityView.firstName = obj.firstName ?? null;\n    identityView.middleName = obj.middleName ?? null;\n    identityView.lastName = obj.lastName ?? null;\n    identityView.address1 = obj.address1 ?? null;\n    identityView.address2 = obj.address2 ?? null;\n    identityView.address3 = obj.address3 ?? null;\n    identityView.city = obj.city ?? null;\n    identityView.state = obj.state ?? null;\n    identityView.postalCode = obj.postalCode ?? null;\n    identityView.country = obj.country ?? null;\n    identityView.company = obj.company ?? null;\n    identityView.email = obj.email ?? null;\n    identityView.phone = obj.phone ?? null;\n    identityView.ssn = obj.ssn ?? null;\n    identityView.username = obj.username ?? null;\n    identityView.passportNumber = obj.passportNumber ?? null;\n    identityView.licenseNumber = obj.licenseNumber ?? null;\n\n    return identityView;\n  }\n}\n","// FIXME: Update this file to be type safe and remove this and next line\n// @ts-strict-ignore\nimport { Jsonify } from \"type-fest\";\n\nimport { Fido2CredentialView as SdkFido2CredentialView } from \"@bitwarden/sdk-internal\";\n\nimport { ItemView } from \"./item.view\";\n\nexport class Fido2CredentialView extends ItemView {\n  credentialId: string;\n  keyType: \"public-key\";\n  keyAlgorithm: \"ECDSA\";\n  keyCurve: \"P-256\";\n  keyValue: string;\n  rpId: string;\n  userHandle: string;\n  userName: string;\n  counter: number;\n  rpName: string;\n  userDisplayName: string;\n  discoverable: boolean;\n  creationDate: Date = null;\n\n  get subTitle(): string {\n    return this.userDisplayName;\n  }\n\n  static fromJSON(obj: Partial<Jsonify<Fido2CredentialView>>): Fido2CredentialView {\n    const creationDate = obj.creationDate != null ? new Date(obj.creationDate) : null;\n    return Object.assign(new Fido2CredentialView(), obj, {\n      creationDate,\n    });\n  }\n\n  /**\n   * Converts the SDK Fido2CredentialView to a Fido2CredentialView.\n   */\n  static fromSdkFido2CredentialView(obj: SdkFido2CredentialView): Fido2CredentialView | undefined {\n    if (!obj) {\n      return undefined;\n    }\n\n    const view = new Fido2CredentialView();\n    view.credentialId = obj.credentialId;\n    view.keyType = obj.keyType as \"public-key\";\n    view.keyAlgorithm = obj.keyAlgorithm as \"ECDSA\";\n    view.keyCurve = obj.keyCurve as \"P-256\";\n    view.rpId = obj.rpId;\n    view.userHandle = obj.userHandle;\n    view.userName = obj.userName;\n    view.counter = parseInt(obj.counter);\n    view.rpName = obj.rpName;\n    view.userDisplayName = obj.userDisplayName;\n    view.discoverable = obj.discoverable?.toLowerCase() === \"true\" ? true : false;\n    view.creationDate = obj.creationDate ? new Date(obj.creationDate) : null;\n\n    return view;\n  }\n}\n","/*\n  See full documentation at:\n    https://bitwarden.com/help/uri-match-detection/#match-detection-options\n\n  Domain: \"the top-level domain and second-level domain of the URI match the detected resource\",\n  Host: \"the hostname and (if specified) port of the URI matches the detected resource\",\n  StartsWith: \"the detected resource starts with the URI, regardless of what follows it\",\n  Exact: \"the URI matches the detected resource exactly\",\n  RegularExpression: \"the detected resource matches a specified regular expression\",\n  Never: \"never offer auto-fill for the item\",\n*/\nexport const UriMatchStrategy = {\n  Domain: 0,\n  Host: 1,\n  StartsWith: 2,\n  Exact: 3,\n  RegularExpression: 4,\n  Never: 5,\n} as const;\n\nexport type UriMatchStrategySetting = (typeof UriMatchStrategy)[keyof typeof UriMatchStrategy];\n\n// using uniqueness properties of object shape over Set for ease of state storability\nexport type NeverDomains = { [id: string]: null | { bannerIsDismissed?: boolean } };\nexport type EquivalentDomains = string[][];\n","import { Utils } from \"./utils\";\n\nconst CanLaunchWhitelist = [\n  \"https://\",\n  \"http://\",\n  \"ssh://\",\n  \"ftp://\",\n  \"sftp://\",\n  \"irc://\",\n  \"vnc://\",\n  // https://docs.microsoft.com/en-us/windows-server/remote/remote-desktop-services/clients/remote-desktop-uri\n  \"rdp://\", // Legacy RDP URI scheme\n  \"ms-rd:\", // Preferred RDP URI scheme\n  \"chrome://\",\n  \"iosapp://\",\n  \"androidapp://\",\n];\n\nexport class SafeUrls {\n  static canLaunch(uri: string): boolean {\n    if (Utils.isNullOrWhitespace(uri)) {\n      return false;\n    }\n\n    for (let i = 0; i < CanLaunchWhitelist.length; i++) {\n      if (uri.indexOf(CanLaunchWhitelist[i]) === 0) {\n        return true;\n      }\n    }\n\n    return false;\n  }\n}\n","// FIXME: Update this file to be type safe and remove this and next line\n// @ts-strict-ignore\nimport { Jsonify } from \"type-fest\";\n\nimport { LoginUriView as SdkLoginUriView } from \"@bitwarden/sdk-internal\";\n\nimport { UriMatchStrategy, UriMatchStrategySetting } from \"../../../models/domain/domain-service\";\nimport { View } from \"../../../models/view/view\";\nimport { SafeUrls } from \"../../../platform/misc/safe-urls\";\nimport { Utils } from \"../../../platform/misc/utils\";\nimport { LoginUri } from \"../domain/login-uri\";\n\nexport class LoginUriView implements View {\n  match: UriMatchStrategySetting = null;\n\n  private _uri: string = null;\n  private _domain: string = null;\n  private _hostname: string = null;\n  private _host: string = null;\n  private _canLaunch: boolean = null;\n\n  constructor(u?: LoginUri) {\n    if (!u) {\n      return;\n    }\n\n    this.match = u.match;\n  }\n\n  get uri(): string {\n    return this._uri;\n  }\n  set uri(value: string) {\n    this._uri = value;\n    this._domain = null;\n    this._canLaunch = null;\n  }\n\n  get domain(): string {\n    if (this._domain == null && this.uri != null) {\n      this._domain = Utils.getDomain(this.uri);\n      if (this._domain === \"\") {\n        this._domain = null;\n      }\n    }\n\n    return this._domain;\n  }\n\n  get hostname(): string {\n    if (this.match === UriMatchStrategy.RegularExpression) {\n      return null;\n    }\n    if (this._hostname == null && this.uri != null) {\n      this._hostname = Utils.getHostname(this.uri);\n      if (this._hostname === \"\") {\n        this._hostname = null;\n      }\n    }\n\n    return this._hostname;\n  }\n\n  get host(): string {\n    if (this.match === UriMatchStrategy.RegularExpression) {\n      return null;\n    }\n    if (this._host == null && this.uri != null) {\n      this._host = Utils.getHost(this.uri);\n      if (this._host === \"\") {\n        this._host = null;\n      }\n    }\n\n    return this._host;\n  }\n\n  get hostnameOrUri(): string {\n    return this.hostname != null ? this.hostname : this.uri;\n  }\n\n  get hostOrUri(): string {\n    return this.host != null ? this.host : this.uri;\n  }\n\n  get isWebsite(): boolean {\n    return (\n      this.uri != null &&\n      (this.uri.indexOf(\"http://\") === 0 ||\n        this.uri.indexOf(\"https://\") === 0 ||\n        (this.uri.indexOf(\"://\") < 0 && !Utils.isNullOrWhitespace(Utils.getDomain(this.uri))))\n    );\n  }\n\n  get canLaunch(): boolean {\n    if (this._canLaunch != null) {\n      return this._canLaunch;\n    }\n    if (this.uri != null && this.match !== UriMatchStrategy.RegularExpression) {\n      this._canLaunch = SafeUrls.canLaunch(this.launchUri);\n    } else {\n      this._canLaunch = false;\n    }\n    return this._canLaunch;\n  }\n\n  get launchUri(): string {\n    return this.uri.indexOf(\"://\") < 0 && !Utils.isNullOrWhitespace(Utils.getDomain(this.uri))\n      ? \"http://\" + this.uri\n      : this.uri;\n  }\n\n  static fromJSON(obj: Partial<Jsonify<LoginUriView>>): LoginUriView {\n    return Object.assign(new LoginUriView(), obj);\n  }\n\n  /**\n   * Converts a LoginUriView object from the SDK to a LoginUriView object.\n   */\n  static fromSdkLoginUriView(obj: SdkLoginUriView): LoginUriView | undefined {\n    if (obj == null) {\n      return undefined;\n    }\n\n    const view = new LoginUriView();\n    view.uri = obj.uri;\n    view.match = obj.match;\n\n    return view;\n  }\n\n  matchesUri(\n    targetUri: string,\n    equivalentDomains: Set<string>,\n    defaultUriMatch: UriMatchStrategySetting = null,\n  ): boolean {\n    if (!this.uri || !targetUri) {\n      return false;\n    }\n\n    let matchType = this.match ?? defaultUriMatch;\n    matchType ??= UriMatchStrategy.Domain;\n\n    const targetDomain = Utils.getDomain(targetUri);\n    const matchDomains = equivalentDomains.add(targetDomain);\n\n    switch (matchType) {\n      case UriMatchStrategy.Domain:\n        return this.matchesDomain(targetUri, matchDomains);\n      case UriMatchStrategy.Host: {\n        const urlHost = Utils.getHost(targetUri);\n        return urlHost != null && urlHost === Utils.getHost(this.uri);\n      }\n      case UriMatchStrategy.Exact:\n        return targetUri === this.uri;\n      case UriMatchStrategy.StartsWith:\n        return targetUri.startsWith(this.uri);\n      case UriMatchStrategy.RegularExpression:\n        try {\n          const regex = new RegExp(this.uri, \"i\");\n          return regex.test(targetUri);\n          // FIXME: Remove when updating file. Eslint update\n          // eslint-disable-next-line @typescript-eslint/no-unused-vars\n        } catch (e) {\n          // Invalid regex\n          return false;\n        }\n      case UriMatchStrategy.Never:\n        return false;\n      default:\n        break;\n    }\n\n    return false;\n  }\n\n  private matchesDomain(targetUri: string, matchDomains: Set<string>) {\n    if (targetUri == null || this.domain == null || !matchDomains.has(this.domain)) {\n      return false;\n    }\n\n    if (Utils.DomainMatchBlacklist.has(this.domain)) {\n      const domainUrlHost = Utils.getHost(targetUri);\n      return !Utils.DomainMatchBlacklist.get(this.domain).has(domainUrlHost);\n    }\n\n    return true;\n  }\n}\n","// FIXME: Update this file to be type safe and remove this and next line\n// @ts-strict-ignore\nimport { LoginView as SdkLoginView } from \"@bitwarden/sdk-internal\";\n\nimport { UriMatchStrategySetting } from \"../../../models/domain/domain-service\";\nimport { Utils } from \"../../../platform/misc/utils\";\nimport { DeepJsonify } from \"../../../types/deep-jsonify\";\nimport { LoginLinkedId as LinkedId } from \"../../enums\";\nimport { linkedFieldOption } from \"../../linked-field-option.decorator\";\nimport { Login } from \"../domain/login\";\n\nimport { Fido2CredentialView } from \"./fido2-credential.view\";\nimport { ItemView } from \"./item.view\";\nimport { LoginUriView } from \"./login-uri.view\";\n\nexport class LoginView extends ItemView {\n  @linkedFieldOption(LinkedId.Username, { sortPosition: 0 })\n  username: string = null;\n  @linkedFieldOption(LinkedId.Password, { sortPosition: 1 })\n  password: string = null;\n\n  passwordRevisionDate?: Date = null;\n  totp: string = null;\n  uris: LoginUriView[] = [];\n  autofillOnPageLoad: boolean = null;\n  fido2Credentials: Fido2CredentialView[] = null;\n\n  constructor(l?: Login) {\n    super();\n    if (!l) {\n      return;\n    }\n\n    this.passwordRevisionDate = l.passwordRevisionDate;\n    this.autofillOnPageLoad = l.autofillOnPageLoad;\n  }\n\n  get uri(): string {\n    return this.hasUris ? this.uris[0].uri : null;\n  }\n\n  get maskedPassword(): string {\n    return this.password != null ? \"\" : null;\n  }\n\n  get subTitle(): string {\n    // if there's a passkey available, use that as a fallback\n    if (Utils.isNullOrEmpty(this.username) && this.fido2Credentials?.length > 0) {\n      return this.fido2Credentials[0].userName;\n    }\n\n    return this.username;\n  }\n\n  get canLaunch(): boolean {\n    return this.hasUris && this.uris.some((u) => u.canLaunch);\n  }\n\n  get hasTotp(): boolean {\n    return !Utils.isNullOrWhitespace(this.totp);\n  }\n\n  get launchUri(): string {\n    if (this.hasUris) {\n      const uri = this.uris.find((u) => u.canLaunch);\n      if (uri != null) {\n        return uri.launchUri;\n      }\n    }\n    return null;\n  }\n\n  get hasUris(): boolean {\n    return this.uris != null && this.uris.length > 0;\n  }\n\n  get hasFido2Credentials(): boolean {\n    return this.fido2Credentials != null && this.fido2Credentials.length > 0;\n  }\n\n  matchesUri(\n    targetUri: string,\n    equivalentDomains: Set<string>,\n    defaultUriMatch: UriMatchStrategySetting = null,\n  ): boolean {\n    if (this.uris == null) {\n      return false;\n    }\n\n    return this.uris.some((uri) => uri.matchesUri(targetUri, equivalentDomains, defaultUriMatch));\n  }\n\n  static fromJSON(obj: Partial<DeepJsonify<LoginView>>): LoginView {\n    const passwordRevisionDate =\n      obj.passwordRevisionDate == null ? null : new Date(obj.passwordRevisionDate);\n    const uris = obj.uris.map((uri) => LoginUriView.fromJSON(uri));\n    const fido2Credentials = obj.fido2Credentials?.map((key) => Fido2CredentialView.fromJSON(key));\n\n    return Object.assign(new LoginView(), obj, {\n      passwordRevisionDate,\n      uris,\n      fido2Credentials,\n    });\n  }\n\n  /**\n   * Converts the SDK LoginView to a LoginView.\n   *\n   * Note: FIDO2 credentials remain encrypted at this stage.\n   * Unlike other fields that are decrypted as part of the LoginView, the SDK maintains\n   * the FIDO2 credentials in encrypted form. We can decrypt them later using a separate\n   * call to client.vault().ciphers().decrypt_fido2_credentials().\n   */\n  static fromSdkLoginView(obj: SdkLoginView): LoginView | undefined {\n    if (obj == null) {\n      return undefined;\n    }\n\n    const loginView = new LoginView();\n\n    loginView.username = obj.username ?? null;\n    loginView.password = obj.password ?? null;\n    loginView.passwordRevisionDate =\n      obj.passwordRevisionDate == null ? null : new Date(obj.passwordRevisionDate);\n    loginView.totp = obj.totp ?? null;\n    loginView.autofillOnPageLoad = obj.autofillOnPageLoad ?? null;\n    loginView.uris = obj.uris?.map((uri) => LoginUriView.fromSdkLoginUriView(uri)) || [];\n    // FIDO2 credentials are not decrypted here, they remain encrypted\n    loginView.fido2Credentials = null;\n\n    return loginView;\n  }\n}\n","// FIXME: Update this file to be type safe and remove this and next line\n// @ts-strict-ignore\nimport { Jsonify } from \"type-fest\";\n\nimport { PasswordHistoryView as SdkPasswordHistoryView } from \"@bitwarden/sdk-internal\";\n\nimport { View } from \"../../../models/view/view\";\nimport { Password } from \"../domain/password\";\n\nexport class PasswordHistoryView implements View {\n  password: string = null;\n  lastUsedDate: Date = null;\n\n  constructor(ph?: Password) {\n    if (!ph) {\n      return;\n    }\n\n    this.lastUsedDate = ph.lastUsedDate;\n  }\n\n  static fromJSON(obj: Partial<Jsonify<PasswordHistoryView>>): PasswordHistoryView {\n    const lastUsedDate = obj.lastUsedDate == null ? null : new Date(obj.lastUsedDate);\n\n    return Object.assign(new PasswordHistoryView(), obj, {\n      lastUsedDate: lastUsedDate,\n    });\n  }\n\n  /**\n   * Converts the SDK PasswordHistoryView to a PasswordHistoryView.\n   */\n  static fromSdkPasswordHistoryView(obj: SdkPasswordHistoryView): PasswordHistoryView | undefined {\n    if (!obj) {\n      return undefined;\n    }\n\n    const view = new PasswordHistoryView();\n    view.password = obj.password;\n    view.lastUsedDate = obj.lastUsedDate == null ? null : new Date(obj.lastUsedDate);\n\n    return view;\n  }\n}\n","// FIXME: Update this file to be type safe and remove this and next line\n// @ts-strict-ignore\nimport { Jsonify } from \"type-fest\";\n\nimport { SecureNoteView as SdkSecureNoteView } from \"@bitwarden/sdk-internal\";\n\nimport { SecureNoteType } from \"../../enums\";\nimport { SecureNote } from \"../domain/secure-note\";\n\nimport { ItemView } from \"./item.view\";\n\nexport class SecureNoteView extends ItemView {\n  type: SecureNoteType = null;\n\n  constructor(n?: SecureNote) {\n    super();\n    if (!n) {\n      return;\n    }\n\n    this.type = n.type;\n  }\n\n  get subTitle(): string {\n    return null;\n  }\n\n  static fromJSON(obj: Partial<Jsonify<SecureNoteView>>): SecureNoteView {\n    return Object.assign(new SecureNoteView(), obj);\n  }\n\n  /**\n   * Converts the SDK SecureNoteView to a SecureNoteView.\n   */\n  static fromSdkSecureNoteView(obj: SdkSecureNoteView): SecureNoteView | undefined {\n    if (!obj) {\n      return undefined;\n    }\n\n    const secureNoteView = new SecureNoteView();\n    secureNoteView.type = obj.type ?? null;\n\n    return secureNoteView;\n  }\n}\n","// FIXME: Update this file to be type safe and remove this and next line\n// @ts-strict-ignore\nimport { Jsonify } from \"type-fest\";\n\nimport { SshKeyView as SdkSshKeyView } from \"@bitwarden/sdk-internal\";\n\nimport { SshKey } from \"../domain/ssh-key\";\n\nimport { ItemView } from \"./item.view\";\n\nexport class SshKeyView extends ItemView {\n  privateKey: string = null;\n  publicKey: string = null;\n  keyFingerprint: string = null;\n\n  constructor(n?: SshKey) {\n    super();\n    if (!n) {\n      return;\n    }\n  }\n\n  get maskedPrivateKey(): string {\n    if (!this.privateKey || this.privateKey.length === 0) {\n      return \"\";\n    }\n\n    let lines = this.privateKey.split(\"\\n\").filter((l) => l.trim() !== \"\");\n    lines = lines.map((l, i) => {\n      if (i === 0 || i === lines.length - 1) {\n        return l;\n      }\n      return this.maskLine(l);\n    });\n    return lines.join(\"\\n\");\n  }\n\n  private maskLine(line: string): string {\n    return \"\".repeat(32);\n  }\n\n  get subTitle(): string {\n    return this.keyFingerprint;\n  }\n\n  static fromJSON(obj: Partial<Jsonify<SshKeyView>>): SshKeyView {\n    return Object.assign(new SshKeyView(), obj);\n  }\n\n  /**\n   * Converts the SDK SshKeyView to a SshKeyView.\n   */\n  static fromSdkSshKeyView(obj: SdkSshKeyView): SshKeyView | undefined {\n    if (!obj) {\n      return undefined;\n    }\n\n    const sshKeyView = new SshKeyView();\n\n    sshKeyView.privateKey = obj.privateKey ?? null;\n    sshKeyView.publicKey = obj.publicKey ?? null;\n    sshKeyView.keyFingerprint = obj.fingerprint ?? null;\n\n    return sshKeyView;\n  }\n}\n","// FIXME: Update this file to be type safe and remove this and next line\n// @ts-strict-ignore\nimport { CipherView as SdkCipherView } from \"@bitwarden/sdk-internal\";\n\nimport { View } from \"../../../models/view/view\";\nimport { InitializerMetadata } from \"../../../platform/interfaces/initializer-metadata.interface\";\nimport { InitializerKey } from \"../../../platform/services/cryptography/initializer-key\";\nimport { DeepJsonify } from \"../../../types/deep-jsonify\";\nimport { CipherType, LinkedIdType } from \"../../enums\";\nimport { CipherRepromptType } from \"../../enums/cipher-reprompt-type\";\nimport { CipherPermissionsApi } from \"../api/cipher-permissions.api\";\nimport { LocalData } from \"../data/local.data\";\nimport { Cipher } from \"../domain/cipher\";\n\nimport { AttachmentView } from \"./attachment.view\";\nimport { CardView } from \"./card.view\";\nimport { FieldView } from \"./field.view\";\nimport { IdentityView } from \"./identity.view\";\nimport { LoginView } from \"./login.view\";\nimport { PasswordHistoryView } from \"./password-history.view\";\nimport { SecureNoteView } from \"./secure-note.view\";\nimport { SshKeyView } from \"./ssh-key.view\";\n\nexport class CipherView implements View, InitializerMetadata {\n  readonly initializerKey = InitializerKey.CipherView;\n\n  id: string = null;\n  organizationId: string | undefined = null;\n  folderId: string = null;\n  name: string = null;\n  notes: string = null;\n  type: CipherType = null;\n  favorite = false;\n  organizationUseTotp = false;\n  permissions: CipherPermissionsApi = new CipherPermissionsApi();\n  edit = false;\n  viewPassword = true;\n  localData: LocalData;\n  login = new LoginView();\n  identity = new IdentityView();\n  card = new CardView();\n  secureNote = new SecureNoteView();\n  sshKey = new SshKeyView();\n  attachments: AttachmentView[] = null;\n  fields: FieldView[] = null;\n  passwordHistory: PasswordHistoryView[] = null;\n  collectionIds: string[] = null;\n  revisionDate: Date = null;\n  creationDate: Date = null;\n  deletedDate: Date = null;\n  reprompt: CipherRepromptType = CipherRepromptType.None;\n\n  /**\n   * Flag to indicate if the cipher decryption failed.\n   */\n  decryptionFailure = false;\n\n  constructor(c?: Cipher) {\n    if (!c) {\n      return;\n    }\n\n    this.id = c.id;\n    this.organizationId = c.organizationId;\n    this.folderId = c.folderId;\n    this.favorite = c.favorite;\n    this.organizationUseTotp = c.organizationUseTotp;\n    this.edit = c.edit;\n    this.viewPassword = c.viewPassword;\n    this.permissions = c.permissions;\n    this.type = c.type;\n    this.localData = c.localData;\n    this.collectionIds = c.collectionIds;\n    this.revisionDate = c.revisionDate;\n    this.creationDate = c.creationDate;\n    this.deletedDate = c.deletedDate;\n    // Old locally stored ciphers might have reprompt == null. If so set it to None.\n    this.reprompt = c.reprompt ?? CipherRepromptType.None;\n  }\n\n  private get item() {\n    switch (this.type) {\n      case CipherType.Login:\n        return this.login;\n      case CipherType.SecureNote:\n        return this.secureNote;\n      case CipherType.Card:\n        return this.card;\n      case CipherType.Identity:\n        return this.identity;\n      case CipherType.SshKey:\n        return this.sshKey;\n      default:\n        break;\n    }\n\n    return null;\n  }\n\n  get subTitle(): string {\n    return this.item?.subTitle;\n  }\n\n  get hasPasswordHistory(): boolean {\n    return this.passwordHistory && this.passwordHistory.length > 0;\n  }\n\n  get hasAttachments(): boolean {\n    return this.attachments && this.attachments.length > 0;\n  }\n\n  get hasOldAttachments(): boolean {\n    if (this.hasAttachments) {\n      for (let i = 0; i < this.attachments.length; i++) {\n        if (this.attachments[i].key == null && this.attachments[i].encryptedKey == null) {\n          return true;\n        }\n      }\n    }\n    return false;\n  }\n\n  get hasFields(): boolean {\n    return this.fields && this.fields.length > 0;\n  }\n\n  get passwordRevisionDisplayDate(): Date {\n    if (this.type !== CipherType.Login || this.login == null) {\n      return null;\n    } else if (this.login.password == null || this.login.password === \"\") {\n      return null;\n    }\n    return this.login.passwordRevisionDate;\n  }\n\n  get isDeleted(): boolean {\n    return this.deletedDate != null;\n  }\n\n  get linkedFieldOptions() {\n    return this.item?.linkedFieldOptions;\n  }\n\n  get isUnassigned(): boolean {\n    return (\n      this.organizationId != null && (this.collectionIds == null || this.collectionIds.length === 0)\n    );\n  }\n\n  get canAssignToCollections(): boolean {\n    if (this.organizationId == null) {\n      return true;\n    }\n\n    return this.edit && this.viewPassword;\n  }\n  /**\n   * Determines if the cipher can be launched in a new browser tab.\n   */\n  get canLaunch(): boolean {\n    return this.type === CipherType.Login && this.login.canLaunch;\n  }\n\n  linkedFieldValue(id: LinkedIdType) {\n    const linkedFieldOption = this.linkedFieldOptions?.get(id);\n    if (linkedFieldOption == null) {\n      return null;\n    }\n\n    // FIXME: Remove when updating file. Eslint update\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    const item = this.item;\n    return this.item[linkedFieldOption.propertyKey as keyof typeof item];\n  }\n\n  linkedFieldI18nKey(id: LinkedIdType): string {\n    return this.linkedFieldOptions.get(id)?.i18nKey;\n  }\n\n  // This is used as a marker to indicate that the cipher view object still has its prototype\n  toJSON() {\n    return this;\n  }\n\n  static fromJSON(obj: Partial<DeepJsonify<CipherView>>): CipherView {\n    if (obj == null) {\n      return null;\n    }\n\n    const view = new CipherView();\n    const creationDate = obj.creationDate == null ? null : new Date(obj.creationDate);\n    const revisionDate = obj.revisionDate == null ? null : new Date(obj.revisionDate);\n    const deletedDate = obj.deletedDate == null ? null : new Date(obj.deletedDate);\n    const attachments = obj.attachments?.map((a: any) => AttachmentView.fromJSON(a));\n    const fields = obj.fields?.map((f: any) => FieldView.fromJSON(f));\n    const passwordHistory = obj.passwordHistory?.map((ph: any) => PasswordHistoryView.fromJSON(ph));\n\n    Object.assign(view, obj, {\n      creationDate: creationDate,\n      revisionDate: revisionDate,\n      deletedDate: deletedDate,\n      attachments: attachments,\n      fields: fields,\n      passwordHistory: passwordHistory,\n    });\n\n    switch (obj.type) {\n      case CipherType.Card:\n        view.card = CardView.fromJSON(obj.card);\n        break;\n      case CipherType.Identity:\n        view.identity = IdentityView.fromJSON(obj.identity);\n        break;\n      case CipherType.Login:\n        view.login = LoginView.fromJSON(obj.login);\n        break;\n      case CipherType.SecureNote:\n        view.secureNote = SecureNoteView.fromJSON(obj.secureNote);\n        break;\n      case CipherType.SshKey:\n        view.sshKey = SshKeyView.fromJSON(obj.sshKey);\n        break;\n      default:\n        break;\n    }\n\n    return view;\n  }\n\n  /**\n   * Creates a CipherView from the SDK CipherView.\n   */\n  static fromSdkCipherView(obj: SdkCipherView): CipherView | undefined {\n    if (obj == null) {\n      return undefined;\n    }\n\n    const cipherView = new CipherView();\n    cipherView.id = obj.id ?? null;\n    cipherView.organizationId = obj.organizationId ?? null;\n    cipherView.folderId = obj.folderId ?? null;\n    cipherView.name = obj.name;\n    cipherView.notes = obj.notes ?? null;\n    cipherView.type = obj.type;\n    cipherView.favorite = obj.favorite;\n    cipherView.organizationUseTotp = obj.organizationUseTotp;\n    cipherView.permissions = CipherPermissionsApi.fromSdkCipherPermissions(obj.permissions);\n    cipherView.edit = obj.edit;\n    cipherView.viewPassword = obj.viewPassword;\n    cipherView.localData = obj.localData\n      ? {\n          lastUsedDate: obj.localData.lastUsedDate\n            ? new Date(obj.localData.lastUsedDate).getTime()\n            : undefined,\n          lastLaunched: obj.localData.lastLaunched\n            ? new Date(obj.localData.lastLaunched).getTime()\n            : undefined,\n        }\n      : undefined;\n    cipherView.attachments =\n      obj.attachments?.map((a) => AttachmentView.fromSdkAttachmentView(a)) ?? null;\n    cipherView.fields = obj.fields?.map((f) => FieldView.fromSdkFieldView(f)) ?? null;\n    cipherView.passwordHistory =\n      obj.passwordHistory?.map((ph) => PasswordHistoryView.fromSdkPasswordHistoryView(ph)) ?? null;\n    cipherView.collectionIds = obj.collectionIds ?? null;\n    cipherView.revisionDate = obj.revisionDate == null ? null : new Date(obj.revisionDate);\n    cipherView.creationDate = obj.creationDate == null ? null : new Date(obj.creationDate);\n    cipherView.deletedDate = obj.deletedDate == null ? null : new Date(obj.deletedDate);\n    cipherView.reprompt = obj.reprompt ?? CipherRepromptType.None;\n\n    switch (obj.type) {\n      case CipherType.Card:\n        cipherView.card = CardView.fromSdkCardView(obj.card);\n        break;\n      case CipherType.Identity:\n        cipherView.identity = IdentityView.fromSdkIdentityView(obj.identity);\n        break;\n      case CipherType.Login:\n        cipherView.login = LoginView.fromSdkLoginView(obj.login);\n        break;\n      case CipherType.SecureNote:\n        cipherView.secureNote = SecureNoteView.fromSdkSecureNoteView(obj.secureNote);\n        break;\n      case CipherType.SshKey:\n        cipherView.sshKey = SshKeyView.fromSdkSshKeyView(obj.sshKey);\n        break;\n      default:\n        break;\n    }\n\n    return cipherView;\n  }\n}\n","// FIXME: Update this file to be type safe and remove this and next line\n// @ts-strict-ignore\nimport { Jsonify } from \"type-fest\";\n\nimport { Attachment as SdkAttachment } from \"@bitwarden/sdk-internal\";\n\nimport { Utils } from \"../../../platform/misc/utils\";\nimport Domain from \"../../../platform/models/domain/domain-base\";\nimport { EncString } from \"../../../platform/models/domain/enc-string\";\nimport { SymmetricCryptoKey } from \"../../../platform/models/domain/symmetric-crypto-key\";\nimport { AttachmentData } from \"../data/attachment.data\";\nimport { AttachmentView } from \"../view/attachment.view\";\n\nexport class Attachment extends Domain {\n  id: string;\n  url: string;\n  size: string;\n  sizeName: string; // Readable size, ex: \"4.2 KB\" or \"1.43 GB\"\n  key: EncString;\n  fileName: EncString;\n\n  constructor(obj?: AttachmentData) {\n    super();\n    if (obj == null) {\n      return;\n    }\n\n    this.size = obj.size;\n    this.buildDomainModel(\n      this,\n      obj,\n      {\n        id: null,\n        url: null,\n        sizeName: null,\n        fileName: null,\n        key: null,\n      },\n      [\"id\", \"url\", \"sizeName\"],\n    );\n  }\n\n  async decrypt(\n    orgId: string,\n    context = \"No Cipher Context\",\n    encKey?: SymmetricCryptoKey,\n  ): Promise<AttachmentView> {\n    const view = await this.decryptObj<Attachment, AttachmentView>(\n      this,\n      new AttachmentView(this),\n      [\"fileName\"],\n      orgId,\n      encKey,\n      \"DomainType: Attachment; \" + context,\n    );\n\n    if (this.key != null) {\n      view.key = await this.decryptAttachmentKey(orgId, encKey);\n    }\n\n    return view;\n  }\n\n  private async decryptAttachmentKey(orgId: string, encKey?: SymmetricCryptoKey) {\n    try {\n      if (encKey == null) {\n        encKey = await this.getKeyForDecryption(orgId);\n      }\n\n      const encryptService = Utils.getContainerService().getEncryptService();\n      const decValue = await encryptService.unwrapSymmetricKey(this.key, encKey);\n      return decValue;\n      // FIXME: Remove when updating file. Eslint update\n      // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    } catch (e) {\n      // TODO: error?\n    }\n  }\n\n  private async getKeyForDecryption(orgId: string) {\n    const keyService = Utils.getContainerService().getKeyService();\n    return orgId != null\n      ? await keyService.getOrgKey(orgId)\n      : await keyService.getUserKeyWithLegacySupport();\n  }\n\n  toAttachmentData(): AttachmentData {\n    const a = new AttachmentData();\n    a.size = this.size;\n    this.buildDataModel(\n      this,\n      a,\n      {\n        id: null,\n        url: null,\n        sizeName: null,\n        fileName: null,\n        key: null,\n      },\n      [\"id\", \"url\", \"sizeName\"],\n    );\n    return a;\n  }\n\n  static fromJSON(obj: Partial<Jsonify<Attachment>>): Attachment {\n    if (obj == null) {\n      return null;\n    }\n\n    const key = EncString.fromJSON(obj.key);\n    const fileName = EncString.fromJSON(obj.fileName);\n\n    return Object.assign(new Attachment(), obj, {\n      key,\n      fileName,\n    });\n  }\n\n  /**\n   * Maps to SDK Attachment\n   *\n   * @returns {SdkAttachment} - The SDK Attachment object\n   */\n  toSdkAttachment(): SdkAttachment {\n    return {\n      id: this.id,\n      url: this.url,\n      size: this.size,\n      sizeName: this.sizeName,\n      fileName: this.fileName?.toJSON(),\n      key: this.key?.toJSON(),\n    };\n  }\n}\n","// FIXME: Update this file to be type safe and remove this and next line\n// @ts-strict-ignore\nimport { Jsonify } from \"type-fest\";\n\nimport { Card as SdkCard } from \"@bitwarden/sdk-internal\";\n\nimport Domain from \"../../../platform/models/domain/domain-base\";\nimport { EncString } from \"../../../platform/models/domain/enc-string\";\nimport { SymmetricCryptoKey } from \"../../../platform/models/domain/symmetric-crypto-key\";\nimport { CardData } from \"../data/card.data\";\nimport { CardView } from \"../view/card.view\";\n\nexport class Card extends Domain {\n  cardholderName: EncString;\n  brand: EncString;\n  number: EncString;\n  expMonth: EncString;\n  expYear: EncString;\n  code: EncString;\n\n  constructor(obj?: CardData) {\n    super();\n    if (obj == null) {\n      return;\n    }\n\n    this.buildDomainModel(\n      this,\n      obj,\n      {\n        cardholderName: null,\n        brand: null,\n        number: null,\n        expMonth: null,\n        expYear: null,\n        code: null,\n      },\n      [],\n    );\n  }\n\n  async decrypt(\n    orgId: string,\n    context = \"No Cipher Context\",\n    encKey?: SymmetricCryptoKey,\n  ): Promise<CardView> {\n    return this.decryptObj<Card, CardView>(\n      this,\n      new CardView(),\n      [\"cardholderName\", \"brand\", \"number\", \"expMonth\", \"expYear\", \"code\"],\n      orgId,\n      encKey,\n      \"DomainType: Card; \" + context,\n    );\n  }\n\n  toCardData(): CardData {\n    const c = new CardData();\n    this.buildDataModel(this, c, {\n      cardholderName: null,\n      brand: null,\n      number: null,\n      expMonth: null,\n      expYear: null,\n      code: null,\n    });\n    return c;\n  }\n\n  static fromJSON(obj: Partial<Jsonify<Card>>): Card {\n    if (obj == null) {\n      return null;\n    }\n\n    const cardholderName = EncString.fromJSON(obj.cardholderName);\n    const brand = EncString.fromJSON(obj.brand);\n    const number = EncString.fromJSON(obj.number);\n    const expMonth = EncString.fromJSON(obj.expMonth);\n    const expYear = EncString.fromJSON(obj.expYear);\n    const code = EncString.fromJSON(obj.code);\n    return Object.assign(new Card(), obj, {\n      cardholderName,\n      brand,\n      number,\n      expMonth,\n      expYear,\n      code,\n    });\n  }\n\n  /**\n   *  Maps Card to SDK format.\n   *\n   * @returns {SdkCard} The SDK card object.\n   */\n  toSdkCard(): SdkCard {\n    return {\n      cardholderName: this.cardholderName?.toJSON(),\n      brand: this.brand?.toJSON(),\n      number: this.number?.toJSON(),\n      expMonth: this.expMonth?.toJSON(),\n      expYear: this.expYear?.toJSON(),\n      code: this.code?.toJSON(),\n    };\n  }\n}\n","// FIXME: Update this file to be type safe and remove this and next line\n// @ts-strict-ignore\nimport { Jsonify } from \"type-fest\";\n\nimport { Field as SdkField, LinkedIdType as SdkLinkedIdType } from \"@bitwarden/sdk-internal\";\n\nimport Domain from \"../../../platform/models/domain/domain-base\";\nimport { EncString } from \"../../../platform/models/domain/enc-string\";\nimport { SymmetricCryptoKey } from \"../../../platform/models/domain/symmetric-crypto-key\";\nimport { FieldType, LinkedIdType } from \"../../enums\";\nimport { FieldData } from \"../data/field.data\";\nimport { FieldView } from \"../view/field.view\";\n\nexport class Field extends Domain {\n  name: EncString;\n  value: EncString;\n  type: FieldType;\n  linkedId: LinkedIdType;\n\n  constructor(obj?: FieldData) {\n    super();\n    if (obj == null) {\n      return;\n    }\n\n    this.type = obj.type;\n    this.linkedId = obj.linkedId;\n    this.buildDomainModel(\n      this,\n      obj,\n      {\n        name: null,\n        value: null,\n      },\n      [],\n    );\n  }\n\n  decrypt(orgId: string, encKey?: SymmetricCryptoKey): Promise<FieldView> {\n    return this.decryptObj<Field, FieldView>(\n      this,\n      new FieldView(this),\n      [\"name\", \"value\"],\n      orgId,\n      encKey,\n    );\n  }\n\n  toFieldData(): FieldData {\n    const f = new FieldData();\n    this.buildDataModel(\n      this,\n      f,\n      {\n        name: null,\n        value: null,\n        type: null,\n        linkedId: null,\n      },\n      [\"type\", \"linkedId\"],\n    );\n    return f;\n  }\n\n  static fromJSON(obj: Partial<Jsonify<Field>>): Field {\n    if (obj == null) {\n      return null;\n    }\n\n    const name = EncString.fromJSON(obj.name);\n    const value = EncString.fromJSON(obj.value);\n\n    return Object.assign(new Field(), obj, {\n      name,\n      value,\n    });\n  }\n\n  /**\n   * Maps Field to SDK format.\n   *\n   * @returns {SdkField} The SDK field object.\n   */\n  toSdkField(): SdkField {\n    return {\n      name: this.name?.toJSON(),\n      value: this.value?.toJSON(),\n      type: this.type,\n      // Safe type cast: client and SDK LinkedIdType enums have identical values\n      linkedId: this.linkedId as unknown as SdkLinkedIdType,\n    };\n  }\n}\n","// FIXME: Update this file to be type safe and remove this and next line\n// @ts-strict-ignore\nimport { Jsonify } from \"type-fest\";\n\nimport { Identity as SdkIdentity } from \"@bitwarden/sdk-internal\";\n\nimport Domain from \"../../../platform/models/domain/domain-base\";\nimport { EncString } from \"../../../platform/models/domain/enc-string\";\nimport { SymmetricCryptoKey } from \"../../../platform/models/domain/symmetric-crypto-key\";\nimport { IdentityData } from \"../data/identity.data\";\nimport { IdentityView } from \"../view/identity.view\";\n\nexport class Identity extends Domain {\n  title: EncString;\n  firstName: EncString;\n  middleName: EncString;\n  lastName: EncString;\n  address1: EncString;\n  address2: EncString;\n  address3: EncString;\n  city: EncString;\n  state: EncString;\n  postalCode: EncString;\n  country: EncString;\n  company: EncString;\n  email: EncString;\n  phone: EncString;\n  ssn: EncString;\n  username: EncString;\n  passportNumber: EncString;\n  licenseNumber: EncString;\n\n  constructor(obj?: IdentityData) {\n    super();\n    if (obj == null) {\n      return;\n    }\n\n    this.buildDomainModel(\n      this,\n      obj,\n      {\n        title: null,\n        firstName: null,\n        middleName: null,\n        lastName: null,\n        address1: null,\n        address2: null,\n        address3: null,\n        city: null,\n        state: null,\n        postalCode: null,\n        country: null,\n        company: null,\n        email: null,\n        phone: null,\n        ssn: null,\n        username: null,\n        passportNumber: null,\n        licenseNumber: null,\n      },\n      [],\n    );\n  }\n\n  decrypt(\n    orgId: string,\n    context: string = \"No Cipher Context\",\n    encKey?: SymmetricCryptoKey,\n  ): Promise<IdentityView> {\n    return this.decryptObj<Identity, IdentityView>(\n      this,\n      new IdentityView(),\n      [\n        \"title\",\n        \"firstName\",\n        \"middleName\",\n        \"lastName\",\n        \"address1\",\n        \"address2\",\n        \"address3\",\n        \"city\",\n        \"state\",\n        \"postalCode\",\n        \"country\",\n        \"company\",\n        \"email\",\n        \"phone\",\n        \"ssn\",\n        \"username\",\n        \"passportNumber\",\n        \"licenseNumber\",\n      ],\n      orgId,\n      encKey,\n      \"DomainType: Identity; \" + context,\n    );\n  }\n\n  toIdentityData(): IdentityData {\n    const i = new IdentityData();\n    this.buildDataModel(this, i, {\n      title: null,\n      firstName: null,\n      middleName: null,\n      lastName: null,\n      address1: null,\n      address2: null,\n      address3: null,\n      city: null,\n      state: null,\n      postalCode: null,\n      country: null,\n      company: null,\n      email: null,\n      phone: null,\n      ssn: null,\n      username: null,\n      passportNumber: null,\n      licenseNumber: null,\n    });\n    return i;\n  }\n\n  static fromJSON(obj: Jsonify<Identity>): Identity {\n    if (obj == null) {\n      return null;\n    }\n\n    const title = EncString.fromJSON(obj.title);\n    const firstName = EncString.fromJSON(obj.firstName);\n    const middleName = EncString.fromJSON(obj.middleName);\n    const lastName = EncString.fromJSON(obj.lastName);\n    const address1 = EncString.fromJSON(obj.address1);\n    const address2 = EncString.fromJSON(obj.address2);\n    const address3 = EncString.fromJSON(obj.address3);\n    const city = EncString.fromJSON(obj.city);\n    const state = EncString.fromJSON(obj.state);\n    const postalCode = EncString.fromJSON(obj.postalCode);\n    const country = EncString.fromJSON(obj.country);\n    const company = EncString.fromJSON(obj.company);\n    const email = EncString.fromJSON(obj.email);\n    const phone = EncString.fromJSON(obj.phone);\n    const ssn = EncString.fromJSON(obj.ssn);\n    const username = EncString.fromJSON(obj.username);\n    const passportNumber = EncString.fromJSON(obj.passportNumber);\n    const licenseNumber = EncString.fromJSON(obj.licenseNumber);\n\n    return Object.assign(new Identity(), obj, {\n      title,\n      firstName,\n      middleName,\n      lastName,\n      address1,\n      address2,\n      address3,\n      city,\n      state,\n      postalCode,\n      country,\n      company,\n      email,\n      phone,\n      ssn,\n      username,\n      passportNumber,\n      licenseNumber,\n    });\n  }\n\n  /**\n   * Maps Identity to SDK format.\n   *\n   * @returns {SdkIdentity} The SDK identity object.\n   */\n  toSdkIdentity(): SdkIdentity {\n    return {\n      title: this.title?.toJSON(),\n      firstName: this.firstName?.toJSON(),\n      middleName: this.middleName?.toJSON(),\n      lastName: this.lastName?.toJSON(),\n      address1: this.address1?.toJSON(),\n      address2: this.address2?.toJSON(),\n      address3: this.address3?.toJSON(),\n      city: this.city?.toJSON(),\n      state: this.state?.toJSON(),\n      postalCode: this.postalCode?.toJSON(),\n      country: this.country?.toJSON(),\n      company: this.company?.toJSON(),\n      email: this.email?.toJSON(),\n      phone: this.phone?.toJSON(),\n      ssn: this.ssn?.toJSON(),\n      username: this.username?.toJSON(),\n      passportNumber: this.passportNumber?.toJSON(),\n      licenseNumber: this.licenseNumber?.toJSON(),\n    };\n  }\n}\n","// FIXME: Update this file to be type safe and remove this and next line\n// @ts-strict-ignore\nimport { Jsonify } from \"type-fest\";\n\nimport { Fido2Credential as SdkFido2Credential } from \"@bitwarden/sdk-internal\";\n\nimport Domain from \"../../../platform/models/domain/domain-base\";\nimport { EncString } from \"../../../platform/models/domain/enc-string\";\nimport { SymmetricCryptoKey } from \"../../../platform/models/domain/symmetric-crypto-key\";\nimport { Fido2CredentialData } from \"../data/fido2-credential.data\";\nimport { Fido2CredentialView } from \"../view/fido2-credential.view\";\n\nexport class Fido2Credential extends Domain {\n  credentialId: EncString | null = null;\n  keyType: EncString;\n  keyAlgorithm: EncString;\n  keyCurve: EncString;\n  keyValue: EncString;\n  rpId: EncString;\n  userHandle: EncString;\n  userName: EncString;\n  counter: EncString;\n  rpName: EncString;\n  userDisplayName: EncString;\n  discoverable: EncString;\n  creationDate: Date;\n\n  constructor(obj?: Fido2CredentialData) {\n    super();\n    if (obj == null) {\n      return;\n    }\n\n    this.buildDomainModel(\n      this,\n      obj,\n      {\n        credentialId: null,\n        keyType: null,\n        keyAlgorithm: null,\n        keyCurve: null,\n        keyValue: null,\n        rpId: null,\n        userHandle: null,\n        userName: null,\n        counter: null,\n        rpName: null,\n        userDisplayName: null,\n        discoverable: null,\n      },\n      [],\n    );\n    this.creationDate = obj.creationDate != null ? new Date(obj.creationDate) : null;\n  }\n\n  async decrypt(orgId: string, encKey?: SymmetricCryptoKey): Promise<Fido2CredentialView> {\n    const view = await this.decryptObj<Fido2Credential, Fido2CredentialView>(\n      this,\n      new Fido2CredentialView(),\n      [\n        \"credentialId\",\n        \"keyType\",\n        \"keyAlgorithm\",\n        \"keyCurve\",\n        \"keyValue\",\n        \"rpId\",\n        \"userHandle\",\n        \"userName\",\n        \"rpName\",\n        \"userDisplayName\",\n      ],\n      orgId,\n      encKey,\n    );\n\n    const { counter } = await this.decryptObj<\n      Fido2Credential,\n      {\n        counter: string;\n      }\n    >(this, { counter: \"\" }, [\"counter\"], orgId, encKey);\n    // Counter will end up as NaN if this fails\n    view.counter = parseInt(counter);\n\n    const { discoverable } = await this.decryptObj<Fido2Credential, { discoverable: string }>(\n      this,\n      { discoverable: \"\" },\n      [\"discoverable\"],\n      orgId,\n      encKey,\n    );\n    view.discoverable = discoverable === \"true\";\n    view.creationDate = this.creationDate;\n\n    return view;\n  }\n\n  toFido2CredentialData(): Fido2CredentialData {\n    const i = new Fido2CredentialData();\n    i.creationDate = this.creationDate.toISOString();\n    this.buildDataModel(this, i, {\n      credentialId: null,\n      keyType: null,\n      keyAlgorithm: null,\n      keyCurve: null,\n      keyValue: null,\n      rpId: null,\n      userHandle: null,\n      userName: null,\n      counter: null,\n      rpName: null,\n      userDisplayName: null,\n      discoverable: null,\n    });\n    return i;\n  }\n\n  static fromJSON(obj: Jsonify<Fido2Credential>): Fido2Credential {\n    if (obj == null) {\n      return null;\n    }\n\n    const credentialId = EncString.fromJSON(obj.credentialId);\n    const keyType = EncString.fromJSON(obj.keyType);\n    const keyAlgorithm = EncString.fromJSON(obj.keyAlgorithm);\n    const keyCurve = EncString.fromJSON(obj.keyCurve);\n    const keyValue = EncString.fromJSON(obj.keyValue);\n    const rpId = EncString.fromJSON(obj.rpId);\n    const userHandle = EncString.fromJSON(obj.userHandle);\n    const userName = EncString.fromJSON(obj.userName);\n    const counter = EncString.fromJSON(obj.counter);\n    const rpName = EncString.fromJSON(obj.rpName);\n    const userDisplayName = EncString.fromJSON(obj.userDisplayName);\n    const discoverable = EncString.fromJSON(obj.discoverable);\n    const creationDate = obj.creationDate != null ? new Date(obj.creationDate) : null;\n\n    return Object.assign(new Fido2Credential(), obj, {\n      credentialId,\n      keyType,\n      keyAlgorithm,\n      keyCurve,\n      keyValue,\n      rpId,\n      userHandle,\n      userName,\n      counter,\n      rpName,\n      userDisplayName,\n      discoverable,\n      creationDate,\n    });\n  }\n\n  /**\n   *  Maps Fido2Credential to SDK format.\n   *\n   * @returns {SdkFido2Credential} The SDK Fido2Credential object.\n   */\n  toSdkFido2Credential(): SdkFido2Credential {\n    return {\n      credentialId: this.credentialId?.toJSON(),\n      keyType: this.keyType.toJSON(),\n      keyAlgorithm: this.keyAlgorithm.toJSON(),\n      keyCurve: this.keyCurve.toJSON(),\n      keyValue: this.keyValue.toJSON(),\n      rpId: this.rpId.toJSON(),\n      userHandle: this.userHandle?.toJSON(),\n      userName: this.userName?.toJSON(),\n      counter: this.counter.toJSON(),\n      rpName: this.rpName?.toJSON(),\n      userDisplayName: this.userDisplayName?.toJSON(),\n      discoverable: this.discoverable?.toJSON(),\n      creationDate: this.creationDate.toISOString(),\n    };\n  }\n}\n","// FIXME: Update this file to be type safe and remove this and next line\n// @ts-strict-ignore\nimport { Jsonify } from \"type-fest\";\n\nimport { LoginUri as SdkLoginUri } from \"@bitwarden/sdk-internal\";\n\nimport { UriMatchStrategySetting } from \"../../../models/domain/domain-service\";\nimport { Utils } from \"../../../platform/misc/utils\";\nimport Domain from \"../../../platform/models/domain/domain-base\";\nimport { EncString } from \"../../../platform/models/domain/enc-string\";\nimport { SymmetricCryptoKey } from \"../../../platform/models/domain/symmetric-crypto-key\";\nimport { LoginUriData } from \"../data/login-uri.data\";\nimport { LoginUriView } from \"../view/login-uri.view\";\n\nexport class LoginUri extends Domain {\n  uri: EncString;\n  uriChecksum: EncString | undefined;\n  match: UriMatchStrategySetting;\n\n  constructor(obj?: LoginUriData) {\n    super();\n    if (obj == null) {\n      return;\n    }\n\n    this.match = obj.match;\n    this.buildDomainModel(\n      this,\n      obj,\n      {\n        uri: null,\n        uriChecksum: null,\n      },\n      [],\n    );\n  }\n\n  decrypt(\n    orgId: string,\n    context: string = \"No Cipher Context\",\n    encKey?: SymmetricCryptoKey,\n  ): Promise<LoginUriView> {\n    return this.decryptObj<LoginUri, LoginUriView>(\n      this,\n      new LoginUriView(this),\n      [\"uri\"],\n      orgId,\n      encKey,\n      context,\n    );\n  }\n\n  async validateChecksum(clearTextUri: string, orgId: string, encKey: SymmetricCryptoKey) {\n    if (this.uriChecksum == null) {\n      return false;\n    }\n\n    const keyService = Utils.getContainerService().getEncryptService();\n    const localChecksum = await keyService.hash(clearTextUri, \"sha256\");\n\n    const remoteChecksum = await this.uriChecksum.decrypt(orgId, encKey);\n    return remoteChecksum === localChecksum;\n  }\n\n  toLoginUriData(): LoginUriData {\n    const u = new LoginUriData();\n    this.buildDataModel(\n      this,\n      u,\n      {\n        uri: null,\n        uriChecksum: null,\n        match: null,\n      },\n      [\"match\"],\n    );\n    return u;\n  }\n\n  static fromJSON(obj: Jsonify<LoginUri>): LoginUri {\n    if (obj == null) {\n      return null;\n    }\n\n    const uri = EncString.fromJSON(obj.uri);\n    const uriChecksum = EncString.fromJSON(obj.uriChecksum);\n    return Object.assign(new LoginUri(), obj, {\n      uri,\n      uriChecksum,\n    });\n  }\n\n  /**\n   *  Maps LoginUri to SDK format.\n   *\n   * @returns {SdkLoginUri} The SDK login uri object.\n   */\n  toSdkLoginUri(): SdkLoginUri {\n    return {\n      uri: this.uri?.toJSON(),\n      uriChecksum: this.uriChecksum?.toJSON(),\n      match: this.match,\n    };\n  }\n}\n","// FIXME: Update this file to be type safe and remove this and next line\n// @ts-strict-ignore\nimport { Jsonify } from \"type-fest\";\n\nimport { Login as SdkLogin } from \"@bitwarden/sdk-internal\";\n\nimport Domain from \"../../../platform/models/domain/domain-base\";\nimport { EncString } from \"../../../platform/models/domain/enc-string\";\nimport { SymmetricCryptoKey } from \"../../../platform/models/domain/symmetric-crypto-key\";\nimport { LoginData } from \"../data/login.data\";\nimport { LoginView } from \"../view/login.view\";\n\nimport { Fido2Credential } from \"./fido2-credential\";\nimport { LoginUri } from \"./login-uri\";\n\nexport class Login extends Domain {\n  uris: LoginUri[];\n  username: EncString;\n  password: EncString;\n  passwordRevisionDate?: Date;\n  totp: EncString;\n  autofillOnPageLoad: boolean;\n  fido2Credentials: Fido2Credential[];\n\n  constructor(obj?: LoginData) {\n    super();\n    if (obj == null) {\n      return;\n    }\n\n    this.passwordRevisionDate =\n      obj.passwordRevisionDate != null ? new Date(obj.passwordRevisionDate) : null;\n    this.autofillOnPageLoad = obj.autofillOnPageLoad;\n    this.buildDomainModel(\n      this,\n      obj,\n      {\n        username: null,\n        password: null,\n        totp: null,\n      },\n      [],\n    );\n\n    if (obj.uris) {\n      this.uris = [];\n      obj.uris.forEach((u) => {\n        this.uris.push(new LoginUri(u));\n      });\n    }\n\n    if (obj.fido2Credentials) {\n      this.fido2Credentials = obj.fido2Credentials.map((key) => new Fido2Credential(key));\n    }\n  }\n\n  async decrypt(\n    orgId: string,\n    bypassValidation: boolean,\n    context: string = \"No Cipher Context\",\n    encKey?: SymmetricCryptoKey,\n  ): Promise<LoginView> {\n    const view = await this.decryptObj<Login, LoginView>(\n      this,\n      new LoginView(this),\n      [\"username\", \"password\", \"totp\"],\n      orgId,\n      encKey,\n      `DomainType: Login; ${context}`,\n    );\n\n    if (this.uris != null) {\n      view.uris = [];\n      for (let i = 0; i < this.uris.length; i++) {\n        // If the uri is null, there is nothing to decrypt or validate\n        if (this.uris[i].uri == null) {\n          continue;\n        }\n\n        const uri = await this.uris[i].decrypt(orgId, context, encKey);\n        // URIs are shared remotely after decryption\n        // we need to validate that the string hasn't been changed by a compromised server\n        // This validation is tied to the existence of cypher.key for backwards compatibility\n        // So we bypass the validation if there's no cipher.key or procceed with the validation and\n        // Skip the value if it's been tampered with.\n        if (bypassValidation || (await this.uris[i].validateChecksum(uri.uri, orgId, encKey))) {\n          view.uris.push(uri);\n        }\n      }\n    }\n\n    if (this.fido2Credentials != null) {\n      view.fido2Credentials = await Promise.all(\n        this.fido2Credentials.map((key) => key.decrypt(orgId, encKey)),\n      );\n    }\n\n    return view;\n  }\n\n  toLoginData(): LoginData {\n    const l = new LoginData();\n    l.passwordRevisionDate =\n      this.passwordRevisionDate != null ? this.passwordRevisionDate.toISOString() : null;\n    l.autofillOnPageLoad = this.autofillOnPageLoad;\n    this.buildDataModel(this, l, {\n      username: null,\n      password: null,\n      totp: null,\n    });\n\n    if (this.uris != null && this.uris.length > 0) {\n      l.uris = [];\n      this.uris.forEach((u) => {\n        l.uris.push(u.toLoginUriData());\n      });\n    }\n\n    if (this.fido2Credentials != null && this.fido2Credentials.length > 0) {\n      l.fido2Credentials = this.fido2Credentials.map((key) => key.toFido2CredentialData());\n    }\n\n    return l;\n  }\n\n  static fromJSON(obj: Partial<Jsonify<Login>>): Login {\n    if (obj == null) {\n      return null;\n    }\n\n    const username = EncString.fromJSON(obj.username);\n    const password = EncString.fromJSON(obj.password);\n    const totp = EncString.fromJSON(obj.totp);\n    const passwordRevisionDate =\n      obj.passwordRevisionDate == null ? null : new Date(obj.passwordRevisionDate);\n    const uris = obj.uris?.map((uri: any) => LoginUri.fromJSON(uri));\n    const fido2Credentials =\n      obj.fido2Credentials?.map((key) => Fido2Credential.fromJSON(key)) ?? [];\n\n    return Object.assign(new Login(), obj, {\n      username,\n      password,\n      totp,\n      passwordRevisionDate,\n      uris,\n      fido2Credentials,\n    });\n  }\n\n  /**\n   * Maps Login to SDK format.\n   *\n   * @returns {SdkLogin} The SDK login object.\n   */\n  toSdkLogin(): SdkLogin {\n    return {\n      uris: this.uris?.map((u) => u.toSdkLoginUri()),\n      username: this.username?.toJSON(),\n      password: this.password?.toJSON(),\n      passwordRevisionDate: this.passwordRevisionDate?.toISOString(),\n      totp: this.totp?.toJSON(),\n      autofillOnPageLoad: this.autofillOnPageLoad ?? undefined,\n      fido2Credentials: this.fido2Credentials?.map((f) => f.toSdkFido2Credential()),\n    };\n  }\n}\n","// FIXME: Update this file to be type safe and remove this and next line\n// @ts-strict-ignore\nimport { Jsonify } from \"type-fest\";\n\nimport { PasswordHistory } from \"@bitwarden/sdk-internal\";\n\nimport Domain from \"../../../platform/models/domain/domain-base\";\nimport { EncString } from \"../../../platform/models/domain/enc-string\";\nimport { SymmetricCryptoKey } from \"../../../platform/models/domain/symmetric-crypto-key\";\nimport { PasswordHistoryData } from \"../data/password-history.data\";\nimport { PasswordHistoryView } from \"../view/password-history.view\";\n\nexport class Password extends Domain {\n  password: EncString;\n  lastUsedDate: Date;\n\n  constructor(obj?: PasswordHistoryData) {\n    super();\n    if (obj == null) {\n      return;\n    }\n\n    this.buildDomainModel(this, obj, {\n      password: null,\n    });\n    this.lastUsedDate = new Date(obj.lastUsedDate);\n  }\n\n  decrypt(orgId: string, encKey?: SymmetricCryptoKey): Promise<PasswordHistoryView> {\n    return this.decryptObj<Password, PasswordHistoryView>(\n      this,\n      new PasswordHistoryView(this),\n      [\"password\"],\n      orgId,\n      encKey,\n      \"DomainType: PasswordHistory\",\n    );\n  }\n\n  toPasswordHistoryData(): PasswordHistoryData {\n    const ph = new PasswordHistoryData();\n    ph.lastUsedDate = this.lastUsedDate.toISOString();\n    this.buildDataModel(this, ph, {\n      password: null,\n    });\n    return ph;\n  }\n\n  static fromJSON(obj: Partial<Jsonify<Password>>): Password {\n    if (obj == null) {\n      return null;\n    }\n\n    const password = EncString.fromJSON(obj.password);\n    const lastUsedDate = obj.lastUsedDate == null ? null : new Date(obj.lastUsedDate);\n\n    return Object.assign(new Password(), obj, {\n      password,\n      lastUsedDate,\n    });\n  }\n\n  /**\n   * Maps Password to SDK format.\n   *\n   * @returns {PasswordHistory} The SDK password history object.\n   */\n  toSdkPasswordHistory(): PasswordHistory {\n    return {\n      password: this.password.toJSON(),\n      lastUsedDate: this.lastUsedDate.toISOString(),\n    };\n  }\n}\n","// FIXME: Update this file to be type safe and remove this and next line\n// @ts-strict-ignore\nimport { Jsonify } from \"type-fest\";\n\nimport { SecureNote as SdkSecureNote } from \"@bitwarden/sdk-internal\";\n\nimport Domain from \"../../../platform/models/domain/domain-base\";\nimport { SymmetricCryptoKey } from \"../../../platform/models/domain/symmetric-crypto-key\";\nimport { SecureNoteType } from \"../../enums\";\nimport { SecureNoteData } from \"../data/secure-note.data\";\nimport { SecureNoteView } from \"../view/secure-note.view\";\n\nexport class SecureNote extends Domain {\n  type: SecureNoteType;\n\n  constructor(obj?: SecureNoteData) {\n    super();\n    if (obj == null) {\n      return;\n    }\n\n    this.type = obj.type;\n  }\n\n  async decrypt(\n    orgId: string,\n    context = \"No Cipher Context\",\n    encKey?: SymmetricCryptoKey,\n  ): Promise<SecureNoteView> {\n    return new SecureNoteView(this);\n  }\n\n  toSecureNoteData(): SecureNoteData {\n    const n = new SecureNoteData();\n    n.type = this.type;\n    return n;\n  }\n\n  static fromJSON(obj: Jsonify<SecureNote>): SecureNote {\n    if (obj == null) {\n      return null;\n    }\n\n    return Object.assign(new SecureNote(), obj);\n  }\n\n  /**\n   * Maps Secure note to SDK format.\n   *\n   * @returns {SdkSecureNote} The SDK secure note object.\n   */\n  toSdkSecureNote(): SdkSecureNote {\n    return {\n      type: this.type,\n    };\n  }\n}\n","// FIXME: Update this file to be type safe and remove this and next line\n// @ts-strict-ignore\nimport { Jsonify } from \"type-fest\";\n\nimport { SshKey as SdkSshKey } from \"@bitwarden/sdk-internal\";\n\nimport Domain from \"../../../platform/models/domain/domain-base\";\nimport { EncString } from \"../../../platform/models/domain/enc-string\";\nimport { SymmetricCryptoKey } from \"../../../platform/models/domain/symmetric-crypto-key\";\nimport { SshKeyData } from \"../data/ssh-key.data\";\nimport { SshKeyView } from \"../view/ssh-key.view\";\n\nexport class SshKey extends Domain {\n  privateKey: EncString;\n  publicKey: EncString;\n  keyFingerprint: EncString;\n\n  constructor(obj?: SshKeyData) {\n    super();\n    if (obj == null) {\n      return;\n    }\n\n    this.buildDomainModel(\n      this,\n      obj,\n      {\n        privateKey: null,\n        publicKey: null,\n        keyFingerprint: null,\n      },\n      [],\n    );\n  }\n\n  decrypt(\n    orgId: string,\n    context = \"No Cipher Context\",\n    encKey?: SymmetricCryptoKey,\n  ): Promise<SshKeyView> {\n    return this.decryptObj<SshKey, SshKeyView>(\n      this,\n      new SshKeyView(),\n      [\"privateKey\", \"publicKey\", \"keyFingerprint\"],\n      orgId,\n      encKey,\n      \"DomainType: SshKey; \" + context,\n    );\n  }\n\n  toSshKeyData(): SshKeyData {\n    const c = new SshKeyData();\n    this.buildDataModel(this, c, {\n      privateKey: null,\n      publicKey: null,\n      keyFingerprint: null,\n    });\n    return c;\n  }\n\n  static fromJSON(obj: Partial<Jsonify<SshKey>>): SshKey {\n    if (obj == null) {\n      return null;\n    }\n\n    const privateKey = EncString.fromJSON(obj.privateKey);\n    const publicKey = EncString.fromJSON(obj.publicKey);\n    const keyFingerprint = EncString.fromJSON(obj.keyFingerprint);\n    return Object.assign(new SshKey(), obj, {\n      privateKey,\n      publicKey,\n      keyFingerprint,\n    });\n  }\n\n  /**\n   * Maps SSH key to SDK format.\n   *\n   * @returns {SdkSshKey} The SDK SSH key object.\n   */\n  toSdkSshKey(): SdkSshKey {\n    return {\n      privateKey: this.privateKey.toJSON(),\n      publicKey: this.publicKey.toJSON(),\n      fingerprint: this.keyFingerprint.toJSON(),\n    };\n  }\n}\n","// FIXME: Update this file to be type safe and remove this and next line\n// @ts-strict-ignore\nimport { Jsonify } from \"type-fest\";\n\nimport { Cipher as SdkCipher } from \"@bitwarden/sdk-internal\";\n\nimport { Decryptable } from \"../../../platform/interfaces/decryptable.interface\";\nimport { Utils } from \"../../../platform/misc/utils\";\nimport Domain from \"../../../platform/models/domain/domain-base\";\nimport { EncString } from \"../../../platform/models/domain/enc-string\";\nimport { SymmetricCryptoKey } from \"../../../platform/models/domain/symmetric-crypto-key\";\nimport { InitializerKey } from \"../../../platform/services/cryptography/initializer-key\";\nimport { CipherRepromptType } from \"../../enums/cipher-reprompt-type\";\nimport { CipherType } from \"../../enums/cipher-type\";\nimport { CipherPermissionsApi } from \"../api/cipher-permissions.api\";\nimport { CipherData } from \"../data/cipher.data\";\nimport { LocalData } from \"../data/local.data\";\nimport { AttachmentView } from \"../view/attachment.view\";\nimport { CipherView } from \"../view/cipher.view\";\nimport { FieldView } from \"../view/field.view\";\nimport { PasswordHistoryView } from \"../view/password-history.view\";\n\nimport { Attachment } from \"./attachment\";\nimport { Card } from \"./card\";\nimport { Field } from \"./field\";\nimport { Identity } from \"./identity\";\nimport { Login } from \"./login\";\nimport { Password } from \"./password\";\nimport { SecureNote } from \"./secure-note\";\nimport { SshKey } from \"./ssh-key\";\n\nexport class Cipher extends Domain implements Decryptable<CipherView> {\n  readonly initializerKey = InitializerKey.Cipher;\n\n  id: string;\n  organizationId: string;\n  folderId: string;\n  name: EncString;\n  notes: EncString;\n  type: CipherType;\n  favorite: boolean;\n  organizationUseTotp: boolean;\n  edit: boolean;\n  viewPassword: boolean;\n  permissions: CipherPermissionsApi;\n  revisionDate: Date;\n  localData: LocalData;\n  login: Login;\n  identity: Identity;\n  card: Card;\n  secureNote: SecureNote;\n  sshKey: SshKey;\n  attachments: Attachment[];\n  fields: Field[];\n  passwordHistory: Password[];\n  collectionIds: string[];\n  creationDate: Date;\n  deletedDate: Date;\n  reprompt: CipherRepromptType;\n  key: EncString;\n\n  constructor(obj?: CipherData, localData: LocalData = null) {\n    super();\n    if (obj == null) {\n      return;\n    }\n\n    this.buildDomainModel(\n      this,\n      obj,\n      {\n        id: null,\n        organizationId: null,\n        folderId: null,\n        name: null,\n        notes: null,\n        key: null,\n      },\n      [\"id\", \"organizationId\", \"folderId\"],\n    );\n\n    this.type = obj.type;\n    this.favorite = obj.favorite;\n    this.organizationUseTotp = obj.organizationUseTotp;\n    this.edit = obj.edit;\n    if (obj.viewPassword != null) {\n      this.viewPassword = obj.viewPassword;\n    } else {\n      this.viewPassword = true; // Default for already synced Ciphers without viewPassword\n    }\n    this.permissions = obj.permissions;\n    this.revisionDate = obj.revisionDate != null ? new Date(obj.revisionDate) : null;\n    this.collectionIds = obj.collectionIds;\n    this.localData = localData;\n    this.creationDate = obj.creationDate != null ? new Date(obj.creationDate) : null;\n    this.deletedDate = obj.deletedDate != null ? new Date(obj.deletedDate) : null;\n    this.reprompt = obj.reprompt;\n\n    switch (this.type) {\n      case CipherType.Login:\n        this.login = new Login(obj.login);\n        break;\n      case CipherType.SecureNote:\n        this.secureNote = new SecureNote(obj.secureNote);\n        break;\n      case CipherType.Card:\n        this.card = new Card(obj.card);\n        break;\n      case CipherType.Identity:\n        this.identity = new Identity(obj.identity);\n        break;\n      case CipherType.SshKey:\n        this.sshKey = new SshKey(obj.sshKey);\n        break;\n      default:\n        break;\n    }\n\n    if (obj.attachments != null) {\n      this.attachments = obj.attachments.map((a) => new Attachment(a));\n    } else {\n      this.attachments = null;\n    }\n\n    if (obj.fields != null) {\n      this.fields = obj.fields.map((f) => new Field(f));\n    } else {\n      this.fields = null;\n    }\n\n    if (obj.passwordHistory != null) {\n      this.passwordHistory = obj.passwordHistory.map((ph) => new Password(ph));\n    } else {\n      this.passwordHistory = null;\n    }\n  }\n\n  // We are passing the organizationId into the EncString.decrypt() method here, but because the encKey will always be\n  // present and so the organizationId will not be used.\n  // We will refactor the EncString.decrypt() in https://bitwarden.atlassian.net/browse/PM-3762 to remove the dependency on the organizationId.\n  async decrypt(encKey: SymmetricCryptoKey): Promise<CipherView> {\n    const model = new CipherView(this);\n    let bypassValidation = true;\n\n    if (this.key != null) {\n      const encryptService = Utils.getContainerService().getEncryptService();\n\n      try {\n        const cipherKey = await encryptService.unwrapSymmetricKey(this.key, encKey);\n        encKey = cipherKey;\n        bypassValidation = false;\n      } catch {\n        model.name = \"[error: cannot decrypt]\";\n        model.decryptionFailure = true;\n        return model;\n      }\n    }\n\n    await this.decryptObj<Cipher, CipherView>(\n      this,\n      model,\n      [\"name\", \"notes\"],\n      this.organizationId,\n      encKey,\n    );\n\n    switch (this.type) {\n      case CipherType.Login:\n        model.login = await this.login.decrypt(\n          this.organizationId,\n          bypassValidation,\n          `Cipher Id: ${this.id}`,\n          encKey,\n        );\n        break;\n      case CipherType.SecureNote:\n        model.secureNote = await this.secureNote.decrypt(\n          this.organizationId,\n          `Cipher Id: ${this.id}`,\n          encKey,\n        );\n        break;\n      case CipherType.Card:\n        model.card = await this.card.decrypt(this.organizationId, `Cipher Id: ${this.id}`, encKey);\n        break;\n      case CipherType.Identity:\n        model.identity = await this.identity.decrypt(\n          this.organizationId,\n          `Cipher Id: ${this.id}`,\n          encKey,\n        );\n        break;\n      case CipherType.SshKey:\n        model.sshKey = await this.sshKey.decrypt(\n          this.organizationId,\n          `Cipher Id: ${this.id}`,\n          encKey,\n        );\n        break;\n      default:\n        break;\n    }\n\n    if (this.attachments != null && this.attachments.length > 0) {\n      const attachments: AttachmentView[] = [];\n      for (const attachment of this.attachments) {\n        attachments.push(\n          await attachment.decrypt(this.organizationId, `Cipher Id: ${this.id}`, encKey),\n        );\n      }\n      model.attachments = attachments;\n    }\n\n    if (this.fields != null && this.fields.length > 0) {\n      const fields: FieldView[] = [];\n      for (const field of this.fields) {\n        fields.push(await field.decrypt(this.organizationId, encKey));\n      }\n      model.fields = fields;\n    }\n\n    if (this.passwordHistory != null && this.passwordHistory.length > 0) {\n      const passwordHistory: PasswordHistoryView[] = [];\n      for (const ph of this.passwordHistory) {\n        passwordHistory.push(await ph.decrypt(this.organizationId, encKey));\n      }\n      model.passwordHistory = passwordHistory;\n    }\n\n    return model;\n  }\n\n  toCipherData(): CipherData {\n    const c = new CipherData();\n    c.id = this.id;\n    c.organizationId = this.organizationId;\n    c.folderId = this.folderId;\n    c.edit = this.edit;\n    c.viewPassword = this.viewPassword;\n    c.organizationUseTotp = this.organizationUseTotp;\n    c.favorite = this.favorite;\n    c.revisionDate = this.revisionDate != null ? this.revisionDate.toISOString() : null;\n    c.type = this.type;\n    c.collectionIds = this.collectionIds;\n    c.creationDate = this.creationDate != null ? this.creationDate.toISOString() : null;\n    c.deletedDate = this.deletedDate != null ? this.deletedDate.toISOString() : null;\n    c.reprompt = this.reprompt;\n    c.key = this.key?.encryptedString;\n    c.permissions = this.permissions;\n\n    this.buildDataModel(this, c, {\n      name: null,\n      notes: null,\n    });\n\n    switch (c.type) {\n      case CipherType.Login:\n        c.login = this.login.toLoginData();\n        break;\n      case CipherType.SecureNote:\n        c.secureNote = this.secureNote.toSecureNoteData();\n        break;\n      case CipherType.Card:\n        c.card = this.card.toCardData();\n        break;\n      case CipherType.Identity:\n        c.identity = this.identity.toIdentityData();\n        break;\n      case CipherType.SshKey:\n        c.sshKey = this.sshKey.toSshKeyData();\n        break;\n      default:\n        break;\n    }\n\n    if (this.fields != null) {\n      c.fields = this.fields.map((f) => f.toFieldData());\n    }\n    if (this.attachments != null) {\n      c.attachments = this.attachments.map((a) => a.toAttachmentData());\n    }\n    if (this.passwordHistory != null) {\n      c.passwordHistory = this.passwordHistory.map((ph) => ph.toPasswordHistoryData());\n    }\n    return c;\n  }\n\n  static fromJSON(obj: Jsonify<Cipher>) {\n    if (obj == null) {\n      return null;\n    }\n\n    const domain = new Cipher();\n    const name = EncString.fromJSON(obj.name);\n    const notes = EncString.fromJSON(obj.notes);\n    const creationDate = obj.creationDate == null ? null : new Date(obj.creationDate);\n    const revisionDate = obj.revisionDate == null ? null : new Date(obj.revisionDate);\n    const deletedDate = obj.deletedDate == null ? null : new Date(obj.deletedDate);\n    const attachments = obj.attachments?.map((a: any) => Attachment.fromJSON(a));\n    const fields = obj.fields?.map((f: any) => Field.fromJSON(f));\n    const passwordHistory = obj.passwordHistory?.map((ph: any) => Password.fromJSON(ph));\n    const key = EncString.fromJSON(obj.key);\n\n    Object.assign(domain, obj, {\n      name,\n      notes,\n      creationDate,\n      revisionDate,\n      deletedDate,\n      attachments,\n      fields,\n      passwordHistory,\n      key,\n    });\n\n    switch (obj.type) {\n      case CipherType.Card:\n        domain.card = Card.fromJSON(obj.card);\n        break;\n      case CipherType.Identity:\n        domain.identity = Identity.fromJSON(obj.identity);\n        break;\n      case CipherType.Login:\n        domain.login = Login.fromJSON(obj.login);\n        break;\n      case CipherType.SecureNote:\n        domain.secureNote = SecureNote.fromJSON(obj.secureNote);\n        break;\n      case CipherType.SshKey:\n        domain.sshKey = SshKey.fromJSON(obj.sshKey);\n        break;\n      default:\n        break;\n    }\n\n    return domain;\n  }\n\n  /**\n   * Maps Cipher to SDK format.\n   *\n   * @returns {SdkCipher} The SDK cipher object.\n   */\n  toSdkCipher(): SdkCipher {\n    const sdkCipher: SdkCipher = {\n      id: this.id,\n      organizationId: this.organizationId ?? undefined,\n      folderId: this.folderId ?? undefined,\n      collectionIds: this.collectionIds ?? [],\n      key: this.key?.toJSON(),\n      name: this.name.toJSON(),\n      notes: this.notes?.toJSON(),\n      type: this.type,\n      favorite: this.favorite ?? false,\n      organizationUseTotp: this.organizationUseTotp ?? false,\n      edit: this.edit,\n      permissions: this.permissions\n        ? {\n            delete: this.permissions.delete,\n            restore: this.permissions.restore,\n          }\n        : undefined,\n      viewPassword: this.viewPassword,\n      localData: this.localData\n        ? {\n            lastUsedDate: this.localData.lastUsedDate\n              ? new Date(this.localData.lastUsedDate).toISOString()\n              : undefined,\n            lastLaunched: this.localData.lastLaunched\n              ? new Date(this.localData.lastLaunched).toISOString()\n              : undefined,\n          }\n        : undefined,\n      attachments: this.attachments?.map((a) => a.toSdkAttachment()),\n      fields: this.fields?.map((f) => f.toSdkField()),\n      passwordHistory: this.passwordHistory?.map((ph) => ph.toSdkPasswordHistory()),\n      revisionDate: this.revisionDate?.toISOString(),\n      creationDate: this.creationDate?.toISOString(),\n      deletedDate: this.deletedDate?.toISOString(),\n      reprompt: this.reprompt,\n      // Initialize all cipher-type-specific properties as undefined\n      login: undefined,\n      identity: undefined,\n      card: undefined,\n      secureNote: undefined,\n      sshKey: undefined,\n    };\n\n    switch (this.type) {\n      case CipherType.Login:\n        sdkCipher.login = this.login.toSdkLogin();\n        break;\n      case CipherType.SecureNote:\n        sdkCipher.secureNote = this.secureNote.toSdkSecureNote();\n        break;\n      case CipherType.Card:\n        sdkCipher.card = this.card.toSdkCard();\n        break;\n      case CipherType.Identity:\n        sdkCipher.identity = this.identity.toSdkIdentity();\n        break;\n      case CipherType.SshKey:\n        sdkCipher.sshKey = this.sshKey.toSdkSshKey();\n        break;\n      default:\n        break;\n    }\n\n    return sdkCipher;\n  }\n}\n","import { Jsonify } from \"type-fest\";\n\nimport { Cipher } from \"../../../vault/models/domain/cipher\";\nimport { CipherView } from \"../../../vault/models/view/cipher.view\";\nimport { InitializerMetadata } from \"../../interfaces/initializer-metadata.interface\";\n\nimport { InitializerKey } from \"./initializer-key\";\n\n/**\n * Internal reference of classes so we can reconstruct objects properly.\n * Each entry should be keyed using the Decryptable.initializerKey property\n */\nconst classInitializers: Record<InitializerKey, (obj: any) => any> = {\n  [InitializerKey.Cipher]: Cipher.fromJSON,\n  [InitializerKey.CipherView]: CipherView.fromJSON,\n};\n\nexport function getClassInitializer<T extends InitializerMetadata>(\n  className: InitializerKey,\n): (obj: Jsonify<T>) => T {\n  return classInitializers[className];\n}\n","import { Jsonify } from \"type-fest\";\n\nimport { ServerConfig } from \"../../../platform/abstractions/config/server-config\";\nimport { Decryptable } from \"../../../platform/interfaces/decryptable.interface\";\nimport { SymmetricCryptoKey } from \"../../../platform/models/domain/symmetric-crypto-key\";\n\nexport const DECRYPT_COMMAND = \"decrypt\";\nexport const SET_CONFIG_COMMAND = \"updateConfig\";\n\nexport type DecryptCommandData = {\n  id: string;\n  items: Decryptable<any>[];\n  key: SymmetricCryptoKey;\n};\n\nexport type ParsedDecryptCommandData = {\n  id: string;\n  items: Jsonify<Decryptable<any>>[];\n  key: Jsonify<SymmetricCryptoKey>;\n};\n\ntype SetConfigCommandData = { newConfig: ServerConfig };\n\nexport function buildDecryptMessage(data: DecryptCommandData): string {\n  return JSON.stringify({\n    command: DECRYPT_COMMAND,\n    ...data,\n  });\n}\n\nexport function buildSetConfigMessage(data: SetConfigCommandData): string {\n  return JSON.stringify({\n    command: SET_CONFIG_COMMAND,\n    ...data,\n  });\n}\n","// FIXME: Update this file to be type safe and remove this and next line\n// @ts-strict-ignore\nimport { Utils } from \"../../../platform/misc/utils\";\nimport { EncryptionType } from \"../../enums\";\nimport { Encrypted } from \"../../interfaces/encrypted\";\n\nconst ENC_TYPE_LENGTH = 1;\nconst IV_LENGTH = 16;\nconst MAC_LENGTH = 32;\nconst MIN_DATA_LENGTH = 1;\n\nexport class EncArrayBuffer implements Encrypted {\n  readonly encryptionType: EncryptionType = null;\n  readonly dataBytes: Uint8Array = null;\n  readonly ivBytes: Uint8Array = null;\n  readonly macBytes: Uint8Array = null;\n\n  constructor(readonly buffer: Uint8Array) {\n    const encBytes = buffer;\n    const encType = encBytes[0];\n\n    switch (encType) {\n      case EncryptionType.AesCbc256_HmacSha256_B64: {\n        const minimumLength = ENC_TYPE_LENGTH + IV_LENGTH + MAC_LENGTH + MIN_DATA_LENGTH;\n        if (encBytes.length < minimumLength) {\n          this.throwDecryptionError();\n        }\n\n        this.ivBytes = encBytes.slice(ENC_TYPE_LENGTH, ENC_TYPE_LENGTH + IV_LENGTH);\n        this.macBytes = encBytes.slice(\n          ENC_TYPE_LENGTH + IV_LENGTH,\n          ENC_TYPE_LENGTH + IV_LENGTH + MAC_LENGTH,\n        );\n        this.dataBytes = encBytes.slice(ENC_TYPE_LENGTH + IV_LENGTH + MAC_LENGTH);\n        break;\n      }\n      case EncryptionType.AesCbc256_B64: {\n        const minimumLength = ENC_TYPE_LENGTH + IV_LENGTH + MIN_DATA_LENGTH;\n        if (encBytes.length < minimumLength) {\n          this.throwDecryptionError();\n        }\n\n        this.ivBytes = encBytes.slice(ENC_TYPE_LENGTH, ENC_TYPE_LENGTH + IV_LENGTH);\n        this.dataBytes = encBytes.slice(ENC_TYPE_LENGTH + IV_LENGTH);\n        break;\n      }\n      default:\n        this.throwDecryptionError();\n    }\n\n    this.encryptionType = encType;\n  }\n\n  private throwDecryptionError() {\n    throw new Error(\n      \"Error parsing encrypted ArrayBuffer: data is corrupted or has an invalid format.\",\n    );\n  }\n\n  static fromParts(\n    encryptionType: EncryptionType,\n    iv: Uint8Array,\n    data: Uint8Array,\n    mac: Uint8Array | undefined | null,\n  ) {\n    if (encryptionType == null || iv == null || data == null) {\n      throw new Error(\"encryptionType, iv, and data must be provided\");\n    }\n\n    switch (encryptionType) {\n      case EncryptionType.AesCbc256_B64:\n      case EncryptionType.AesCbc256_HmacSha256_B64:\n        EncArrayBuffer.validateIvLength(iv);\n        EncArrayBuffer.validateMacLength(encryptionType, mac);\n        break;\n      default:\n        throw new Error(`Unknown EncryptionType ${encryptionType} for EncArrayBuffer.fromParts`);\n    }\n\n    let macLen = 0;\n    if (mac != null) {\n      macLen = mac.length;\n    }\n\n    const bytes = new Uint8Array(1 + iv.byteLength + macLen + data.byteLength);\n    bytes.set([encryptionType], 0);\n    bytes.set(iv, 1);\n    if (mac != null) {\n      bytes.set(mac, 1 + iv.byteLength);\n    }\n    bytes.set(data, 1 + iv.byteLength + macLen);\n    return new EncArrayBuffer(bytes);\n  }\n\n  static async fromResponse(response: {\n    arrayBuffer: () => Promise<ArrayBuffer>;\n  }): Promise<EncArrayBuffer> {\n    const buffer = await response.arrayBuffer();\n    if (buffer == null) {\n      throw new Error(\"Cannot create EncArrayBuffer from Response - Response is empty\");\n    }\n    return new EncArrayBuffer(new Uint8Array(buffer));\n  }\n\n  static fromB64(b64: string) {\n    const buffer = Utils.fromB64ToArray(b64);\n    return new EncArrayBuffer(buffer);\n  }\n\n  static validateIvLength(iv: Uint8Array) {\n    if (iv == null || iv.length !== IV_LENGTH) {\n      throw new Error(\"Invalid IV length\");\n    }\n  }\n\n  static validateMacLength(encType: EncryptionType, mac: Uint8Array | null | undefined) {\n    switch (encType) {\n      case EncryptionType.AesCbc256_B64:\n        if (mac != null) {\n          throw new Error(\"mac must not be provided for AesCbc256_B64\");\n        }\n        break;\n      case EncryptionType.AesCbc256_HmacSha256_B64:\n        if (mac == null || mac.length !== MAC_LENGTH) {\n          throw new Error(\"Invalid MAC length\");\n        }\n        break;\n      default:\n        throw new Error(\"Invalid encryption type and mac combination\");\n    }\n  }\n}\n","// FIXME: Update this file to be type safe and remove this and next line\n// @ts-strict-ignore\n\nexport class EncryptedObject {\n  iv: Uint8Array;\n  data: Uint8Array;\n  mac: Uint8Array;\n}\n","import { ServerConfig } from \"../platform/abstractions/config/server-config\";\n\n/**\n * Feature flags.\n *\n * Flags MUST be short lived and SHALL be removed once enabled.\n *\n * Flags should be grouped by team to have visibility of ownership and cleanup.\n */\n// FIXME: update to use a const object instead of a typescript enum\n// eslint-disable-next-line @bitwarden/platform/no-enums\nexport enum FeatureFlag {\n  /* Admin Console Team */\n  SeparateCustomRolePermissions = \"pm-19917-separate-custom-role-permissions\",\n  CreateDefaultLocation = \"pm-19467-create-default-location\",\n\n  /* Auth */\n  PM16117_SetInitialPasswordRefactor = \"pm-16117-set-initial-password-refactor\",\n  PM16117_ChangeExistingPasswordRefactor = \"pm-16117-change-existing-password-refactor\",\n  PM9115_TwoFactorExtensionDataPersistence = \"pm-9115-two-factor-extension-data-persistence\",\n  PM14938_BrowserExtensionLoginApproval = \"pm-14938-browser-extension-login-approvals\",\n\n  /* Autofill */\n  BlockBrowserInjectionsByDomain = \"block-browser-injections-by-domain\",\n  EnableNewCardCombinedExpiryAutofill = \"enable-new-card-combined-expiry-autofill\",\n  NotificationRefresh = \"notification-refresh\",\n  UseTreeWalkerApiForPageDetailsCollection = \"use-tree-walker-api-for-page-details-collection\",\n  MacOsNativeCredentialSync = \"macos-native-credential-sync\",\n\n  /* Billing */\n  TrialPaymentOptional = \"PM-8163-trial-payment\",\n  PM12276_BreadcrumbEventLogs = \"pm-12276-breadcrumbing-for-business-features\",\n  PM17772_AdminInitiatedSponsorships = \"pm-17772-admin-initiated-sponsorships\",\n  PM19956_RequireProviderPaymentMethodDuringSetup = \"pm-19956-require-provider-payment-method-during-setup\",\n  UseOrganizationWarningsService = \"use-organization-warnings-service\",\n  AllowTrialLengthZero = \"pm-20322-allow-trial-length-0\",\n\n  /* Data Insights and Reporting */\n  EnableRiskInsightsNotifications = \"enable-risk-insights-notifications\",\n\n  /* Key Management */\n  PrivateKeyRegeneration = \"pm-12241-private-key-regeneration\",\n  PM4154_BulkEncryptionService = \"PM-4154-bulk-encryption-service\",\n  UseSDKForDecryption = \"use-sdk-for-decryption\",\n  PM17987_BlockType0 = \"pm-17987-block-type-0\",\n  EnrollAeadOnKeyRotation = \"enroll-aead-on-key-rotation\",\n\n  /* Tools */\n  DesktopSendUIRefresh = \"desktop-send-ui-refresh\",\n\n  /* Vault */\n  PM8851_BrowserOnboardingNudge = \"pm-8851-browser-onboarding-nudge\",\n  PM9111ExtensionPersistAddEditForm = \"pm-9111-extension-persist-add-edit-form\",\n  PM19941MigrateCipherDomainToSdk = \"pm-19941-migrate-cipher-domain-to-sdk\",\n  CipherKeyEncryption = \"cipher-key-encryption\",\n  PM18520_UpdateDesktopCipherForm = \"pm-18520-desktop-cipher-forms\",\n  EndUserNotifications = \"pm-10609-end-user-notifications\",\n  RemoveCardItemTypePolicy = \"pm-16442-remove-card-item-type-policy\",\n\n  /* Platform */\n  IpcChannelFramework = \"ipc-channel-framework\",\n}\n\nexport type AllowedFeatureFlagTypes = boolean | number | string;\n\n// Helper to ensure the value is treated as a boolean.\nconst FALSE = false as boolean;\n\n/**\n * Default value for feature flags.\n *\n * DO NOT enable previously disabled flags, REMOVE them instead.\n * We support true as a value as we prefer flags to \"enable\" not \"disable\".\n *\n * Flags should be grouped by team to have visibility of ownership and cleanup.\n */\nexport const DefaultFeatureFlagValue = {\n  /* Admin Console Team */\n  [FeatureFlag.SeparateCustomRolePermissions]: FALSE,\n  [FeatureFlag.CreateDefaultLocation]: FALSE,\n\n  /* Autofill */\n  [FeatureFlag.BlockBrowserInjectionsByDomain]: FALSE,\n  [FeatureFlag.EnableNewCardCombinedExpiryAutofill]: FALSE,\n  [FeatureFlag.NotificationRefresh]: FALSE,\n  [FeatureFlag.UseTreeWalkerApiForPageDetailsCollection]: FALSE,\n  [FeatureFlag.MacOsNativeCredentialSync]: FALSE,\n\n  /* Data Insights and Reporting */\n  [FeatureFlag.EnableRiskInsightsNotifications]: FALSE,\n\n  /* Tools */\n  [FeatureFlag.DesktopSendUIRefresh]: FALSE,\n\n  /* Vault */\n  [FeatureFlag.PM8851_BrowserOnboardingNudge]: FALSE,\n  [FeatureFlag.PM9111ExtensionPersistAddEditForm]: FALSE,\n  [FeatureFlag.CipherKeyEncryption]: FALSE,\n  [FeatureFlag.PM18520_UpdateDesktopCipherForm]: FALSE,\n  [FeatureFlag.EndUserNotifications]: FALSE,\n  [FeatureFlag.PM19941MigrateCipherDomainToSdk]: FALSE,\n  [FeatureFlag.RemoveCardItemTypePolicy]: FALSE,\n\n  /* Auth */\n  [FeatureFlag.PM16117_SetInitialPasswordRefactor]: FALSE,\n  [FeatureFlag.PM16117_ChangeExistingPasswordRefactor]: FALSE,\n  [FeatureFlag.PM9115_TwoFactorExtensionDataPersistence]: FALSE,\n  [FeatureFlag.PM14938_BrowserExtensionLoginApproval]: FALSE,\n\n  /* Billing */\n  [FeatureFlag.TrialPaymentOptional]: FALSE,\n  [FeatureFlag.PM12276_BreadcrumbEventLogs]: FALSE,\n  [FeatureFlag.PM17772_AdminInitiatedSponsorships]: FALSE,\n  [FeatureFlag.PM19956_RequireProviderPaymentMethodDuringSetup]: FALSE,\n  [FeatureFlag.UseOrganizationWarningsService]: FALSE,\n  [FeatureFlag.AllowTrialLengthZero]: FALSE,\n\n  /* Key Management */\n  [FeatureFlag.PrivateKeyRegeneration]: FALSE,\n  [FeatureFlag.PM4154_BulkEncryptionService]: FALSE,\n  [FeatureFlag.UseSDKForDecryption]: FALSE,\n  [FeatureFlag.PM17987_BlockType0]: FALSE,\n  [FeatureFlag.EnrollAeadOnKeyRotation]: FALSE,\n\n  /* Platform */\n  [FeatureFlag.IpcChannelFramework]: FALSE,\n} satisfies Record<FeatureFlag, AllowedFeatureFlagTypes>;\n\nexport type DefaultFeatureFlagValueType = typeof DefaultFeatureFlagValue;\n\nexport type FeatureFlagValueType<Flag extends FeatureFlag> = DefaultFeatureFlagValueType[Flag];\n\nexport function getFeatureFlagValue<Flag extends FeatureFlag>(\n  serverConfig: ServerConfig | null,\n  flag: Flag,\n) {\n  if (serverConfig?.featureStates == null || serverConfig.featureStates[flag] == null) {\n    return DefaultFeatureFlagValue[flag];\n  }\n\n  return serverConfig.featureStates[flag] as FeatureFlagValueType<Flag>;\n}\n","import { init_sdk } from \"@bitwarden/sdk-internal\";\n\n// eslint-disable-next-line @typescript-eslint/no-unused-vars -- used in docs\nimport type { SdkService } from \"./sdk.service\";\n\nexport class SdkLoadFailedError extends Error {\n  constructor(error: unknown) {\n    super(`SDK loading failed: ${error}`);\n  }\n}\n\nexport abstract class SdkLoadService {\n  private static markAsReady: () => void;\n  private static markAsFailed: (error: unknown) => void;\n\n  /**\n   * This promise is resolved when the SDK is ready to be used. Use it when your code might run early and/or is not able to use DI.\n   * Beware that WASM always requires a load step which makes it tricky to use functions and classes directly, it is therefore recommended\n   * to use the SDK through the {@link SdkService}. Only use this promise in advanced scenarios!\n   *\n   * @example\n   * ```typescript\n   * import { pureFunction } from \"@bitwarden/sdk-internal\";\n   *\n   * async function myFunction() {\n   *   await SdkLoadService.Ready;\n   *   pureFunction();\n   * }\n   * ```\n   */\n  static readonly Ready = new Promise<void>((resolve, reject) => {\n    SdkLoadService.markAsReady = resolve;\n    SdkLoadService.markAsFailed = (error: unknown) => reject(new SdkLoadFailedError(error));\n  });\n\n  /**\n   * Load WASM and initalize SDK-JS integrations such as logging.\n   * This method should be called once at the start of the application.\n   * Raw functions and classes from the SDK can be used after this method resolves.\n   */\n  async loadAndInit(): Promise<void> {\n    try {\n      await this.load();\n      init_sdk();\n      SdkLoadService.markAsReady();\n    } catch (error) {\n      SdkLoadService.markAsFailed(error);\n    }\n  }\n\n  protected abstract load(): Promise<void>;\n}\n","// FIXME: Update this file to be type safe and remove this and next line\n// @ts-strict-ignore\nimport { CryptoFunctionService } from \"@bitwarden/common/key-management/crypto/abstractions/crypto-function.service\";\nimport { LogService } from \"@bitwarden/common/platform/abstractions/log.service\";\nimport {\n  EncryptionType,\n  encryptionTypeToString as encryptionTypeName,\n} from \"@bitwarden/common/platform/enums\";\nimport { Decryptable } from \"@bitwarden/common/platform/interfaces/decryptable.interface\";\nimport { Encrypted } from \"@bitwarden/common/platform/interfaces/encrypted\";\nimport { InitializerMetadata } from \"@bitwarden/common/platform/interfaces/initializer-metadata.interface\";\nimport { Utils } from \"@bitwarden/common/platform/misc/utils\";\nimport { EncArrayBuffer } from \"@bitwarden/common/platform/models/domain/enc-array-buffer\";\nimport { EncString } from \"@bitwarden/common/platform/models/domain/enc-string\";\nimport { EncryptedObject } from \"@bitwarden/common/platform/models/domain/encrypted-object\";\nimport {\n  Aes256CbcHmacKey,\n  Aes256CbcKey,\n  SymmetricCryptoKey,\n} from \"@bitwarden/common/platform/models/domain/symmetric-crypto-key\";\nimport { PureCrypto } from \"@bitwarden/sdk-internal\";\n\nimport {\n  DefaultFeatureFlagValue,\n  FeatureFlag,\n  getFeatureFlagValue,\n} from \"../../../enums/feature-flag.enum\";\nimport { ServerConfig } from \"../../../platform/abstractions/config/server-config\";\nimport { SdkLoadService } from \"../../../platform/abstractions/sdk/sdk-load.service\";\nimport { EncryptService } from \"../abstractions/encrypt.service\";\n\nexport class EncryptServiceImplementation implements EncryptService {\n  protected useSDKForDecryption: boolean = DefaultFeatureFlagValue[FeatureFlag.UseSDKForDecryption];\n  private blockType0: boolean = DefaultFeatureFlagValue[FeatureFlag.PM17987_BlockType0];\n\n  constructor(\n    protected cryptoFunctionService: CryptoFunctionService,\n    protected logService: LogService,\n    protected logMacFailures: boolean,\n  ) {}\n\n  // Proxy functions; Their implementation are temporary before moving at this level to the SDK\n  async encryptString(plainValue: string, key: SymmetricCryptoKey): Promise<EncString> {\n    return this.encrypt(plainValue, key);\n  }\n\n  async encryptBytes(plainValue: Uint8Array, key: SymmetricCryptoKey): Promise<EncString> {\n    return this.encrypt(plainValue, key);\n  }\n\n  async encryptFileData(plainValue: Uint8Array, key: SymmetricCryptoKey): Promise<EncArrayBuffer> {\n    return this.encryptToBytes(plainValue, key);\n  }\n\n  async decryptString(encString: EncString, key: SymmetricCryptoKey): Promise<string> {\n    return this.decryptToUtf8(encString, key);\n  }\n\n  async decryptBytes(encString: EncString, key: SymmetricCryptoKey): Promise<Uint8Array> {\n    return this.decryptToBytes(encString, key);\n  }\n\n  async decryptFileData(encBuffer: EncArrayBuffer, key: SymmetricCryptoKey): Promise<Uint8Array> {\n    return this.decryptToBytes(encBuffer, key);\n  }\n\n  async wrapDecapsulationKey(\n    decapsulationKeyPkcs8: Uint8Array,\n    wrappingKey: SymmetricCryptoKey,\n  ): Promise<EncString> {\n    if (decapsulationKeyPkcs8 == null) {\n      throw new Error(\"No decapsulation key provided for wrapping.\");\n    }\n\n    if (wrappingKey == null) {\n      throw new Error(\"No wrappingKey provided for wrapping.\");\n    }\n\n    return await this.encryptUint8Array(decapsulationKeyPkcs8, wrappingKey);\n  }\n\n  async wrapEncapsulationKey(\n    encapsulationKeySpki: Uint8Array,\n    wrappingKey: SymmetricCryptoKey,\n  ): Promise<EncString> {\n    if (encapsulationKeySpki == null) {\n      throw new Error(\"No encapsulation key provided for wrapping.\");\n    }\n\n    if (wrappingKey == null) {\n      throw new Error(\"No wrappingKey provided for wrapping.\");\n    }\n\n    return await this.encryptUint8Array(encapsulationKeySpki, wrappingKey);\n  }\n\n  async wrapSymmetricKey(\n    keyToBeWrapped: SymmetricCryptoKey,\n    wrappingKey: SymmetricCryptoKey,\n  ): Promise<EncString> {\n    if (keyToBeWrapped == null) {\n      throw new Error(\"No keyToBeWrapped provided for wrapping.\");\n    }\n\n    if (wrappingKey == null) {\n      throw new Error(\"No wrappingKey provided for wrapping.\");\n    }\n\n    return await this.encryptUint8Array(keyToBeWrapped.toEncoded(), wrappingKey);\n  }\n\n  async unwrapDecapsulationKey(\n    wrappedDecapsulationKey: EncString,\n    wrappingKey: SymmetricCryptoKey,\n  ): Promise<Uint8Array> {\n    return this.decryptBytes(wrappedDecapsulationKey, wrappingKey);\n  }\n  async unwrapEncapsulationKey(\n    wrappedEncapsulationKey: EncString,\n    wrappingKey: SymmetricCryptoKey,\n  ): Promise<Uint8Array> {\n    return this.decryptBytes(wrappedEncapsulationKey, wrappingKey);\n  }\n  async unwrapSymmetricKey(\n    keyToBeUnwrapped: EncString,\n    wrappingKey: SymmetricCryptoKey,\n  ): Promise<SymmetricCryptoKey> {\n    return new SymmetricCryptoKey(await this.decryptBytes(keyToBeUnwrapped, wrappingKey));\n  }\n\n  async hash(value: string | Uint8Array, algorithm: \"sha1\" | \"sha256\" | \"sha512\"): Promise<string> {\n    const hashArray = await this.cryptoFunctionService.hash(value, algorithm);\n    return Utils.fromBufferToB64(hashArray);\n  }\n\n  // Handle updating private properties to turn on/off feature flags.\n  onServerConfigChange(newConfig: ServerConfig): void {\n    const oldFlagValue = this.useSDKForDecryption;\n    this.useSDKForDecryption = getFeatureFlagValue(newConfig, FeatureFlag.UseSDKForDecryption);\n    this.logService.debug(\n      \"[EncryptService] Updated sdk decryption flag\",\n      oldFlagValue,\n      this.useSDKForDecryption,\n    );\n    this.blockType0 = getFeatureFlagValue(newConfig, FeatureFlag.PM17987_BlockType0);\n  }\n\n  async encrypt(plainValue: string | Uint8Array, key: SymmetricCryptoKey): Promise<EncString> {\n    if (key == null) {\n      throw new Error(\"No encryption key provided.\");\n    }\n\n    if (this.blockType0) {\n      if (key.inner().type === EncryptionType.AesCbc256_B64) {\n        throw new Error(\"Type 0 encryption is not supported.\");\n      }\n    }\n\n    if (plainValue == null) {\n      return Promise.resolve(null);\n    }\n\n    if (typeof plainValue === \"string\") {\n      return this.encryptUint8Array(Utils.fromUtf8ToArray(plainValue), key);\n    } else {\n      return this.encryptUint8Array(plainValue, key);\n    }\n  }\n\n  private async encryptUint8Array(\n    plainValue: Uint8Array,\n    key: SymmetricCryptoKey,\n  ): Promise<EncString> {\n    if (key == null) {\n      throw new Error(\"No encryption key provided.\");\n    }\n\n    if (this.blockType0) {\n      if (key.inner().type === EncryptionType.AesCbc256_B64) {\n        throw new Error(\"Type 0 encryption is not supported.\");\n      }\n    }\n\n    if (plainValue == null) {\n      return Promise.resolve(null);\n    }\n\n    const innerKey = key.inner();\n    if (innerKey.type === EncryptionType.AesCbc256_HmacSha256_B64) {\n      const encObj = await this.aesEncrypt(plainValue, innerKey);\n      const iv = Utils.fromBufferToB64(encObj.iv);\n      const data = Utils.fromBufferToB64(encObj.data);\n      const mac = Utils.fromBufferToB64(encObj.mac);\n      return new EncString(innerKey.type, data, iv, mac);\n    } else if (innerKey.type === EncryptionType.AesCbc256_B64) {\n      const encObj = await this.aesEncryptLegacy(plainValue, innerKey);\n      const iv = Utils.fromBufferToB64(encObj.iv);\n      const data = Utils.fromBufferToB64(encObj.data);\n      return new EncString(innerKey.type, data, iv);\n    }\n  }\n\n  async encryptToBytes(plainValue: Uint8Array, key: SymmetricCryptoKey): Promise<EncArrayBuffer> {\n    if (key == null) {\n      throw new Error(\"No encryption key provided.\");\n    }\n\n    if (this.blockType0) {\n      if (key.inner().type === EncryptionType.AesCbc256_B64) {\n        throw new Error(\"Type 0 encryption is not supported.\");\n      }\n    }\n\n    const innerKey = key.inner();\n    if (innerKey.type === EncryptionType.AesCbc256_HmacSha256_B64) {\n      const encValue = await this.aesEncrypt(plainValue, innerKey);\n      const macLen = encValue.mac.length;\n      const encBytes = new Uint8Array(\n        1 + encValue.iv.byteLength + macLen + encValue.data.byteLength,\n      );\n      encBytes.set([innerKey.type]);\n      encBytes.set(new Uint8Array(encValue.iv), 1);\n      encBytes.set(new Uint8Array(encValue.mac), 1 + encValue.iv.byteLength);\n      encBytes.set(new Uint8Array(encValue.data), 1 + encValue.iv.byteLength + macLen);\n      return new EncArrayBuffer(encBytes);\n    } else if (innerKey.type === EncryptionType.AesCbc256_B64) {\n      const encValue = await this.aesEncryptLegacy(plainValue, innerKey);\n      const encBytes = new Uint8Array(1 + encValue.iv.byteLength + encValue.data.byteLength);\n      encBytes.set([innerKey.type]);\n      encBytes.set(new Uint8Array(encValue.iv), 1);\n      encBytes.set(new Uint8Array(encValue.data), 1 + encValue.iv.byteLength);\n      return new EncArrayBuffer(encBytes);\n    }\n  }\n\n  async decryptToUtf8(\n    encString: EncString,\n    key: SymmetricCryptoKey,\n    decryptContext: string = \"no context\",\n  ): Promise<string> {\n    if (this.useSDKForDecryption) {\n      this.logService.debug(\"decrypting with SDK\");\n      if (encString == null || encString.encryptedString == null) {\n        throw new Error(\"encString is null or undefined\");\n      }\n      await SdkLoadService.Ready;\n      return PureCrypto.symmetric_decrypt(encString.encryptedString, key.toEncoded());\n    }\n    this.logService.debug(\"decrypting with javascript\");\n\n    if (key == null) {\n      throw new Error(\"No key provided for decryption.\");\n    }\n\n    const innerKey = key.inner();\n    if (encString.encryptionType !== innerKey.type) {\n      this.logDecryptError(\n        \"Key encryption type does not match payload encryption type\",\n        innerKey.type,\n        encString.encryptionType,\n        decryptContext,\n      );\n      return null;\n    }\n\n    if (innerKey.type === EncryptionType.AesCbc256_HmacSha256_B64) {\n      const fastParams = this.cryptoFunctionService.aesDecryptFastParameters(\n        encString.data,\n        encString.iv,\n        encString.mac,\n        key,\n      );\n\n      const computedMac = await this.cryptoFunctionService.hmacFast(\n        fastParams.macData,\n        fastParams.macKey,\n        \"sha256\",\n      );\n      const macsEqual = await this.cryptoFunctionService.compareFast(fastParams.mac, computedMac);\n      if (!macsEqual) {\n        this.logMacFailed(\n          \"decryptToUtf8 MAC comparison failed. Key or payload has changed.\",\n          innerKey.type,\n          encString.encryptionType,\n          decryptContext,\n        );\n        return null;\n      }\n      return await this.cryptoFunctionService.aesDecryptFast({\n        mode: \"cbc\",\n        parameters: fastParams,\n      });\n    } else if (innerKey.type === EncryptionType.AesCbc256_B64) {\n      const fastParams = this.cryptoFunctionService.aesDecryptFastParameters(\n        encString.data,\n        encString.iv,\n        undefined,\n        key,\n      );\n      return await this.cryptoFunctionService.aesDecryptFast({\n        mode: \"cbc\",\n        parameters: fastParams,\n      });\n    } else {\n      throw new Error(`Unsupported encryption type`);\n    }\n  }\n\n  async decryptToBytes(\n    encThing: Encrypted,\n    key: SymmetricCryptoKey,\n    decryptContext: string = \"no context\",\n  ): Promise<Uint8Array | null> {\n    if (this.useSDKForDecryption) {\n      this.logService.debug(\"[EncryptService] Decrypting bytes with SDK\");\n      if (\n        encThing.encryptionType == null ||\n        encThing.ivBytes == null ||\n        encThing.dataBytes == null\n      ) {\n        throw new Error(\"Cannot decrypt, missing type, IV, or data bytes.\");\n      }\n      const buffer = EncArrayBuffer.fromParts(\n        encThing.encryptionType,\n        encThing.ivBytes,\n        encThing.dataBytes,\n        encThing.macBytes,\n      ).buffer;\n      await SdkLoadService.Ready;\n      return PureCrypto.symmetric_decrypt_array_buffer(buffer, key.toEncoded());\n    }\n    this.logService.debug(\"[EncryptService] Decrypting bytes with javascript\");\n\n    if (key == null) {\n      throw new Error(\"No encryption key provided.\");\n    }\n\n    if (encThing == null) {\n      throw new Error(\"Nothing provided for decryption.\");\n    }\n\n    const inner = key.inner();\n    if (encThing.encryptionType !== inner.type) {\n      this.logDecryptError(\n        \"Encryption key type mismatch\",\n        inner.type,\n        encThing.encryptionType,\n        decryptContext,\n      );\n      return null;\n    }\n\n    if (inner.type === EncryptionType.AesCbc256_HmacSha256_B64) {\n      if (encThing.macBytes == null) {\n        this.logDecryptError(\"Mac missing\", inner.type, encThing.encryptionType, decryptContext);\n        return null;\n      }\n\n      const macData = new Uint8Array(encThing.ivBytes.byteLength + encThing.dataBytes.byteLength);\n      macData.set(new Uint8Array(encThing.ivBytes), 0);\n      macData.set(new Uint8Array(encThing.dataBytes), encThing.ivBytes.byteLength);\n      const computedMac = await this.cryptoFunctionService.hmac(\n        macData,\n        inner.authenticationKey,\n        \"sha256\",\n      );\n      const macsMatch = await this.cryptoFunctionService.compare(encThing.macBytes, computedMac);\n      if (!macsMatch) {\n        this.logMacFailed(\n          \"MAC comparison failed. Key or payload has changed.\",\n          inner.type,\n          encThing.encryptionType,\n          decryptContext,\n        );\n        return null;\n      }\n\n      return await this.cryptoFunctionService.aesDecrypt(\n        encThing.dataBytes,\n        encThing.ivBytes,\n        inner.encryptionKey,\n        \"cbc\",\n      );\n    } else if (inner.type === EncryptionType.AesCbc256_B64) {\n      return await this.cryptoFunctionService.aesDecrypt(\n        encThing.dataBytes,\n        encThing.ivBytes,\n        inner.encryptionKey,\n        \"cbc\",\n      );\n    }\n  }\n\n  async encapsulateKeyUnsigned(\n    sharedKey: SymmetricCryptoKey,\n    encapsulationKey: Uint8Array,\n  ): Promise<EncString> {\n    if (sharedKey == null) {\n      throw new Error(\"No sharedKey provided for encapsulation\");\n    }\n    return await this.rsaEncrypt(sharedKey.toEncoded(), encapsulationKey);\n  }\n\n  async decapsulateKeyUnsigned(\n    encryptedSharedKey: EncString,\n    decapsulationKey: Uint8Array,\n  ): Promise<SymmetricCryptoKey> {\n    const keyBytes = await this.rsaDecrypt(encryptedSharedKey, decapsulationKey);\n    return new SymmetricCryptoKey(keyBytes);\n  }\n\n  /**\n   * @deprecated Replaced by BulkEncryptService (PM-4154)\n   */\n  async decryptItems<T extends InitializerMetadata>(\n    items: Decryptable<T>[],\n    key: SymmetricCryptoKey,\n  ): Promise<T[]> {\n    if (items == null || items.length < 1) {\n      return [];\n    }\n\n    // don't use promise.all because this task is not io bound\n    const results = [];\n    for (let i = 0; i < items.length; i++) {\n      results.push(await items[i].decrypt(key));\n    }\n    return results;\n  }\n\n  private async aesEncrypt(data: Uint8Array, key: Aes256CbcHmacKey): Promise<EncryptedObject> {\n    const obj = new EncryptedObject();\n    obj.iv = await this.cryptoFunctionService.randomBytes(16);\n    obj.data = await this.cryptoFunctionService.aesEncrypt(data, obj.iv, key.encryptionKey);\n\n    const macData = new Uint8Array(obj.iv.byteLength + obj.data.byteLength);\n    macData.set(new Uint8Array(obj.iv), 0);\n    macData.set(new Uint8Array(obj.data), obj.iv.byteLength);\n    obj.mac = await this.cryptoFunctionService.hmac(macData, key.authenticationKey, \"sha256\");\n\n    return obj;\n  }\n\n  /**\n   * @deprecated Removed once AesCbc256_B64 support is removed\n   */\n  private async aesEncryptLegacy(data: Uint8Array, key: Aes256CbcKey): Promise<EncryptedObject> {\n    const obj = new EncryptedObject();\n    obj.iv = await this.cryptoFunctionService.randomBytes(16);\n    obj.data = await this.cryptoFunctionService.aesEncrypt(data, obj.iv, key.encryptionKey);\n    return obj;\n  }\n\n  private logDecryptError(\n    msg: string,\n    keyEncType: EncryptionType,\n    dataEncType: EncryptionType,\n    decryptContext: string,\n  ) {\n    this.logService.error(\n      `[Encrypt service] ${msg} Key type ${encryptionTypeName(keyEncType)} Payload type ${encryptionTypeName(dataEncType)} Decrypt context: ${decryptContext}`,\n    );\n  }\n\n  private logMacFailed(\n    msg: string,\n    keyEncType: EncryptionType,\n    dataEncType: EncryptionType,\n    decryptContext: string,\n  ) {\n    if (this.logMacFailures) {\n      this.logDecryptError(msg, keyEncType, dataEncType, decryptContext);\n    }\n  }\n\n  async rsaEncrypt(data: Uint8Array, publicKey: Uint8Array): Promise<EncString> {\n    if (data == null) {\n      throw new Error(\"No data provided for encryption.\");\n    }\n\n    if (publicKey == null) {\n      throw new Error(\"No public key provided for encryption.\");\n    }\n    const encrypted = await this.cryptoFunctionService.rsaEncrypt(data, publicKey, \"sha1\");\n    return new EncString(EncryptionType.Rsa2048_OaepSha1_B64, Utils.fromBufferToB64(encrypted));\n  }\n\n  async rsaDecrypt(data: EncString, privateKey: Uint8Array): Promise<Uint8Array> {\n    if (data == null) {\n      throw new Error(\"[Encrypt service] rsaDecrypt: No data provided for decryption.\");\n    }\n\n    let algorithm: \"sha1\" | \"sha256\";\n    switch (data.encryptionType) {\n      case EncryptionType.Rsa2048_OaepSha1_B64:\n      case EncryptionType.Rsa2048_OaepSha1_HmacSha256_B64:\n        algorithm = \"sha1\";\n        break;\n      case EncryptionType.Rsa2048_OaepSha256_B64:\n      case EncryptionType.Rsa2048_OaepSha256_HmacSha256_B64:\n        algorithm = \"sha256\";\n        break;\n      default:\n        throw new Error(\"Invalid encryption type.\");\n    }\n\n    if (privateKey == null) {\n      throw new Error(\"[Encrypt service] rsaDecrypt: No private key provided for decryption.\");\n    }\n\n    return this.cryptoFunctionService.rsaDecrypt(data.dataBytes, privateKey, algorithm);\n  }\n}\n","import * as argon2 from \"argon2-browser\";\nimport * as forge from \"node-forge\";\n\nimport { EncryptionType } from \"../../../platform/enums\";\nimport { Utils } from \"../../../platform/misc/utils\";\nimport {\n  CbcDecryptParameters,\n  EcbDecryptParameters,\n} from \"../../../platform/models/domain/decrypt-parameters\";\nimport { SymmetricCryptoKey } from \"../../../platform/models/domain/symmetric-crypto-key\";\nimport { CsprngArray } from \"../../../types/csprng\";\nimport { CryptoFunctionService } from \"../abstractions/crypto-function.service\";\n\nexport class WebCryptoFunctionService implements CryptoFunctionService {\n  private crypto: Crypto;\n  private subtle: SubtleCrypto;\n  private wasmSupported: boolean;\n\n  constructor(globalContext: { crypto: Crypto }) {\n    if (globalContext?.crypto?.subtle == null) {\n      throw new Error(\n        \"Could not instantiate WebCryptoFunctionService. Could not locate Subtle crypto.\",\n      );\n    }\n    this.crypto = globalContext.crypto;\n    this.subtle = this.crypto.subtle;\n    this.wasmSupported = this.checkIfWasmSupported();\n  }\n\n  async pbkdf2(\n    password: string | Uint8Array,\n    salt: string | Uint8Array,\n    algorithm: \"sha256\" | \"sha512\",\n    iterations: number,\n  ): Promise<Uint8Array> {\n    const wcLen = algorithm === \"sha256\" ? 256 : 512;\n    const passwordBuf = this.toBuf(password);\n    const saltBuf = this.toBuf(salt);\n\n    const pbkdf2Params: Pbkdf2Params = {\n      name: \"PBKDF2\",\n      salt: saltBuf,\n      iterations: iterations,\n      hash: { name: this.toWebCryptoAlgorithm(algorithm) },\n    };\n\n    const impKey = await this.subtle.importKey(\n      \"raw\",\n      passwordBuf,\n      { name: \"PBKDF2\" } as any,\n      false,\n      [\"deriveBits\"],\n    );\n    const buffer = await this.subtle.deriveBits(pbkdf2Params as any, impKey, wcLen);\n    return new Uint8Array(buffer);\n  }\n\n  async argon2(\n    password: string | Uint8Array,\n    salt: string | Uint8Array,\n    iterations: number,\n    memory: number,\n    parallelism: number,\n  ): Promise<Uint8Array> {\n    if (!this.wasmSupported) {\n      throw \"Webassembly support is required for the Argon2 KDF feature.\";\n    }\n\n    const passwordArr = new Uint8Array(this.toBuf(password));\n    const saltArr = new Uint8Array(this.toBuf(salt));\n\n    const result = await argon2.hash({\n      pass: passwordArr,\n      salt: saltArr,\n      time: iterations,\n      mem: memory,\n      parallelism: parallelism,\n      hashLen: 32,\n      type: argon2.ArgonType.Argon2id,\n    });\n    argon2.unloadRuntime();\n    return result.hash;\n  }\n\n  async hkdf(\n    ikm: Uint8Array,\n    salt: string | Uint8Array,\n    info: string | Uint8Array,\n    outputByteSize: number,\n    algorithm: \"sha256\" | \"sha512\",\n  ): Promise<Uint8Array> {\n    const saltBuf = this.toBuf(salt);\n    const infoBuf = this.toBuf(info);\n\n    const hkdfParams: HkdfParams = {\n      name: \"HKDF\",\n      salt: saltBuf,\n      info: infoBuf,\n      hash: { name: this.toWebCryptoAlgorithm(algorithm) },\n    };\n\n    const impKey = await this.subtle.importKey(\"raw\", ikm, { name: \"HKDF\" } as any, false, [\n      \"deriveBits\",\n    ]);\n    const buffer = await this.subtle.deriveBits(hkdfParams as any, impKey, outputByteSize * 8);\n    return new Uint8Array(buffer);\n  }\n\n  // ref: https://tools.ietf.org/html/rfc5869\n  async hkdfExpand(\n    prk: Uint8Array,\n    info: string | Uint8Array,\n    outputByteSize: number,\n    algorithm: \"sha256\" | \"sha512\",\n  ): Promise<Uint8Array> {\n    const hashLen = algorithm === \"sha256\" ? 32 : 64;\n    if (outputByteSize > 255 * hashLen) {\n      throw new Error(\"outputByteSize is too large.\");\n    }\n    const prkArr = new Uint8Array(prk);\n    if (prkArr.length < hashLen) {\n      throw new Error(\"prk is too small.\");\n    }\n    const infoBuf = this.toBuf(info);\n    const infoArr = new Uint8Array(infoBuf);\n    let runningOkmLength = 0;\n    let previousT = new Uint8Array(0);\n    const n = Math.ceil(outputByteSize / hashLen);\n    const okm = new Uint8Array(n * hashLen);\n    for (let i = 0; i < n; i++) {\n      const t = new Uint8Array(previousT.length + infoArr.length + 1);\n      t.set(previousT);\n      t.set(infoArr, previousT.length);\n      t.set([i + 1], t.length - 1);\n      previousT = new Uint8Array(await this.hmac(t, prk, algorithm));\n      okm.set(previousT, runningOkmLength);\n      runningOkmLength += previousT.length;\n      if (runningOkmLength >= outputByteSize) {\n        break;\n      }\n    }\n    return okm.slice(0, outputByteSize);\n  }\n\n  async hash(\n    value: string | Uint8Array,\n    algorithm: \"sha1\" | \"sha256\" | \"sha512\" | \"md5\",\n  ): Promise<Uint8Array> {\n    if (algorithm === \"md5\") {\n      const md = forge.md.md5.create();\n      const valueBytes = this.toByteString(value);\n      md.update(valueBytes, \"raw\");\n      return Utils.fromByteStringToArray(md.digest().data);\n    }\n\n    const valueBuf = this.toBuf(value);\n    const buffer = await this.subtle.digest(\n      { name: this.toWebCryptoAlgorithm(algorithm) },\n      valueBuf,\n    );\n    return new Uint8Array(buffer);\n  }\n\n  async hmac(\n    value: Uint8Array,\n    key: Uint8Array,\n    algorithm: \"sha1\" | \"sha256\" | \"sha512\",\n  ): Promise<Uint8Array> {\n    const signingAlgorithm = {\n      name: \"HMAC\",\n      hash: { name: this.toWebCryptoAlgorithm(algorithm) },\n    };\n\n    const impKey = await this.subtle.importKey(\"raw\", key, signingAlgorithm, false, [\"sign\"]);\n    const buffer = await this.subtle.sign(signingAlgorithm, impKey, value);\n    return new Uint8Array(buffer);\n  }\n\n  // Safely compare two values in a way that protects against timing attacks (Double HMAC Verification).\n  // ref: https://www.nccgroup.trust/us/about-us/newsroom-and-events/blog/2011/february/double-hmac-verification/\n  // ref: https://paragonie.com/blog/2015/11/preventing-timing-attacks-on-string-comparison-with-double-hmac-strategy\n  async compare(a: Uint8Array, b: Uint8Array): Promise<boolean> {\n    const macKey = await this.randomBytes(32);\n    const signingAlgorithm = {\n      name: \"HMAC\",\n      hash: { name: \"SHA-256\" },\n    };\n    const impKey = await this.subtle.importKey(\"raw\", macKey, signingAlgorithm, false, [\"sign\"]);\n    const mac1 = await this.subtle.sign(signingAlgorithm, impKey, a);\n    const mac2 = await this.subtle.sign(signingAlgorithm, impKey, b);\n\n    if (mac1.byteLength !== mac2.byteLength) {\n      return false;\n    }\n\n    const arr1 = new Uint8Array(mac1);\n    const arr2 = new Uint8Array(mac2);\n    for (let i = 0; i < arr2.length; i++) {\n      if (arr1[i] !== arr2[i]) {\n        return false;\n      }\n    }\n\n    return true;\n  }\n\n  hmacFast(value: string, key: string, algorithm: \"sha1\" | \"sha256\" | \"sha512\"): Promise<string> {\n    const hmac = forge.hmac.create();\n    hmac.start(algorithm, key);\n    hmac.update(value);\n    const bytes = hmac.digest().getBytes();\n    return Promise.resolve(bytes);\n  }\n\n  async compareFast(a: string, b: string): Promise<boolean> {\n    const rand = await this.randomBytes(32);\n    const bytes = new Uint32Array(rand);\n    const buffer = forge.util.createBuffer();\n    for (let i = 0; i < bytes.length; i++) {\n      buffer.putInt32(bytes[i]);\n    }\n    const macKey = buffer.getBytes();\n\n    const hmac = forge.hmac.create();\n    hmac.start(\"sha256\", macKey);\n    hmac.update(a);\n    const mac1 = hmac.digest().getBytes();\n\n    hmac.start(\"sha256\", null);\n    hmac.update(b);\n    const mac2 = hmac.digest().getBytes();\n\n    const equals = mac1 === mac2;\n    return equals;\n  }\n\n  async aesEncrypt(data: Uint8Array, iv: Uint8Array, key: Uint8Array): Promise<Uint8Array> {\n    const impKey = await this.subtle.importKey(\"raw\", key, { name: \"AES-CBC\" } as any, false, [\n      \"encrypt\",\n    ]);\n    const buffer = await this.subtle.encrypt({ name: \"AES-CBC\", iv: iv }, impKey, data);\n    return new Uint8Array(buffer);\n  }\n\n  aesDecryptFastParameters(\n    data: string,\n    iv: string,\n    mac: string | null,\n    key: SymmetricCryptoKey,\n  ): CbcDecryptParameters<string> {\n    const innerKey = key.inner();\n    if (innerKey.type === EncryptionType.AesCbc256_B64) {\n      return {\n        iv: forge.util.decode64(iv),\n        data: forge.util.decode64(data),\n        encKey: forge.util.createBuffer(innerKey.encryptionKey).getBytes(),\n      } as CbcDecryptParameters<string>;\n    } else if (innerKey.type === EncryptionType.AesCbc256_HmacSha256_B64) {\n      const macData = forge.util.decode64(iv) + forge.util.decode64(data);\n      return {\n        iv: forge.util.decode64(iv),\n        data: forge.util.decode64(data),\n        encKey: forge.util.createBuffer(innerKey.encryptionKey).getBytes(),\n        macKey: forge.util.createBuffer(innerKey.authenticationKey).getBytes(),\n        mac: forge.util.decode64(mac!),\n        macData,\n      } as CbcDecryptParameters<string>;\n    } else {\n      throw new Error(\"Unsupported encryption type.\");\n    }\n  }\n\n  aesDecryptFast({\n    mode,\n    parameters,\n  }:\n    | { mode: \"cbc\"; parameters: CbcDecryptParameters<string> }\n    | { mode: \"ecb\"; parameters: EcbDecryptParameters<string> }): Promise<string> {\n    const decipher = (forge as any).cipher.createDecipher(\n      this.toWebCryptoAesMode(mode),\n      parameters.encKey,\n    );\n    const options = {} as any;\n    if (mode === \"cbc\") {\n      options.iv = parameters.iv;\n    }\n    const dataBuffer = (forge as any).util.createBuffer(parameters.data);\n    decipher.start(options);\n    decipher.update(dataBuffer);\n    decipher.finish();\n    const val = decipher.output.toString();\n    return Promise.resolve(val);\n  }\n\n  async aesDecrypt(\n    data: Uint8Array,\n    iv: Uint8Array | null,\n    key: Uint8Array,\n    mode: \"cbc\" | \"ecb\",\n  ): Promise<Uint8Array> {\n    if (mode === \"ecb\") {\n      // Web crypto does not support AES-ECB mode, so we need to do this in forge.\n      const parameters: EcbDecryptParameters<string> = {\n        data: this.toByteString(data),\n        encKey: this.toByteString(key),\n      };\n      const result = await this.aesDecryptFast({ mode: \"ecb\", parameters });\n      return Utils.fromByteStringToArray(result);\n    }\n    const impKey = await this.subtle.importKey(\"raw\", key, { name: \"AES-CBC\" } as any, false, [\n      \"decrypt\",\n    ]);\n\n    // CBC\n    if (iv == null) {\n      throw new Error(\"IV is required for CBC mode.\");\n    }\n    const buffer = await this.subtle.decrypt({ name: \"AES-CBC\", iv: iv }, impKey, data);\n    return new Uint8Array(buffer);\n  }\n\n  async rsaEncrypt(\n    data: Uint8Array,\n    publicKey: Uint8Array,\n    algorithm: \"sha1\" | \"sha256\",\n  ): Promise<Uint8Array> {\n    // Note: Edge browser requires that we specify name and hash for both key import and decrypt.\n    // We cannot use the proper types here.\n    const rsaParams = {\n      name: \"RSA-OAEP\",\n      hash: { name: this.toWebCryptoAlgorithm(algorithm) },\n    };\n    const impKey = await this.subtle.importKey(\"spki\", publicKey, rsaParams, false, [\"encrypt\"]);\n    const buffer = await this.subtle.encrypt(rsaParams, impKey, data);\n    return new Uint8Array(buffer);\n  }\n\n  async rsaDecrypt(\n    data: Uint8Array,\n    privateKey: Uint8Array,\n    algorithm: \"sha1\" | \"sha256\",\n  ): Promise<Uint8Array> {\n    // Note: Edge browser requires that we specify name and hash for both key import and decrypt.\n    // We cannot use the proper types here.\n    const rsaParams = {\n      name: \"RSA-OAEP\",\n      hash: { name: this.toWebCryptoAlgorithm(algorithm) },\n    };\n    const impKey = await this.subtle.importKey(\"pkcs8\", privateKey, rsaParams, false, [\"decrypt\"]);\n    const buffer = await this.subtle.decrypt(rsaParams, impKey, data);\n    return new Uint8Array(buffer);\n  }\n\n  async rsaExtractPublicKey(privateKey: Uint8Array): Promise<Uint8Array> {\n    const rsaParams = {\n      name: \"RSA-OAEP\",\n      // Have to specify some algorithm\n      hash: { name: this.toWebCryptoAlgorithm(\"sha1\") },\n    };\n    const impPrivateKey = await this.subtle.importKey(\"pkcs8\", privateKey, rsaParams, true, [\n      \"decrypt\",\n    ]);\n    const jwkPrivateKey = await this.subtle.exportKey(\"jwk\", impPrivateKey);\n    const jwkPublicKeyParams = {\n      kty: \"RSA\",\n      e: jwkPrivateKey.e,\n      n: jwkPrivateKey.n,\n      alg: \"RSA-OAEP\",\n      ext: true,\n    };\n    const impPublicKey = await this.subtle.importKey(\"jwk\", jwkPublicKeyParams, rsaParams, true, [\n      \"encrypt\",\n    ]);\n    const buffer = await this.subtle.exportKey(\"spki\", impPublicKey);\n    return new Uint8Array(buffer);\n  }\n\n  async aesGenerateKey(bitLength = 128 | 192 | 256 | 512): Promise<CsprngArray> {\n    if (bitLength === 512) {\n      // 512 bit keys are not supported in WebCrypto, so we concat two 256 bit keys\n      const key1 = await this.aesGenerateKey(256);\n      const key2 = await this.aesGenerateKey(256);\n      return new Uint8Array([...key1, ...key2]) as CsprngArray;\n    }\n    const aesParams = {\n      name: \"AES-CBC\",\n      length: bitLength,\n    };\n\n    const key = await this.subtle.generateKey(aesParams, true, [\"encrypt\", \"decrypt\"]);\n    const rawKey = await this.subtle.exportKey(\"raw\", key);\n    return new Uint8Array(rawKey) as CsprngArray;\n  }\n\n  async rsaGenerateKeyPair(length: 1024 | 2048 | 4096): Promise<[Uint8Array, Uint8Array]> {\n    const rsaParams = {\n      name: \"RSA-OAEP\",\n      modulusLength: length,\n      publicExponent: new Uint8Array([0x01, 0x00, 0x01]), // 65537\n      // Have to specify some algorithm\n      hash: { name: this.toWebCryptoAlgorithm(\"sha1\") },\n    };\n    const keyPair = await this.subtle.generateKey(rsaParams, true, [\"encrypt\", \"decrypt\"]);\n    const publicKey = await this.subtle.exportKey(\"spki\", keyPair.publicKey);\n    const privateKey = await this.subtle.exportKey(\"pkcs8\", keyPair.privateKey);\n    return [new Uint8Array(publicKey), new Uint8Array(privateKey)];\n  }\n\n  randomBytes(length: number): Promise<CsprngArray> {\n    const arr = new Uint8Array(length);\n    this.crypto.getRandomValues(arr);\n    return Promise.resolve(arr as CsprngArray);\n  }\n\n  private toBuf(value: string | Uint8Array): Uint8Array {\n    let buf: Uint8Array;\n    if (typeof value === \"string\") {\n      buf = Utils.fromUtf8ToArray(value);\n    } else {\n      buf = value;\n    }\n    return buf;\n  }\n\n  private toByteString(value: string | Uint8Array): string {\n    let bytes: string;\n    if (typeof value === \"string\") {\n      bytes = forge.util.encodeUtf8(value);\n    } else {\n      bytes = Utils.fromBufferToByteString(value);\n    }\n    return bytes;\n  }\n\n  private toWebCryptoAlgorithm(algorithm: \"sha1\" | \"sha256\" | \"sha512\" | \"md5\"): string {\n    if (algorithm === \"md5\") {\n      throw new Error(\"MD5 is not supported in WebCrypto.\");\n    }\n    return algorithm === \"sha1\" ? \"SHA-1\" : algorithm === \"sha256\" ? \"SHA-256\" : \"SHA-512\";\n  }\n\n  private toWebCryptoAesMode(mode: \"cbc\" | \"ecb\"): string {\n    return mode === \"cbc\" ? \"AES-CBC\" : \"AES-ECB\";\n  }\n\n  // ref: https://stackoverflow.com/a/47880734/1090359\n  private checkIfWasmSupported(): boolean {\n    try {\n      if (typeof WebAssembly === \"object\" && typeof WebAssembly.instantiate === \"function\") {\n        const module = new WebAssembly.Module(\n          Uint8Array.of(0x0, 0x61, 0x73, 0x6d, 0x01, 0x00, 0x00, 0x00),\n        );\n        if (module instanceof WebAssembly.Module) {\n          return new WebAssembly.Instance(module) instanceof WebAssembly.Instance;\n        }\n      }\n    } catch {\n      return false;\n    }\n    return false;\n  }\n}\n","// FIXME: Update this file to be type safe and remove this and next line\n// @ts-strict-ignore\nimport { Jsonify } from \"type-fest\";\n\nimport { ServerConfig } from \"../../../platform/abstractions/config/server-config\";\nimport { LogService } from \"../../../platform/abstractions/log.service\";\nimport { Decryptable } from \"../../../platform/interfaces/decryptable.interface\";\nimport { SymmetricCryptoKey } from \"../../../platform/models/domain/symmetric-crypto-key\";\nimport { ConsoleLogService } from \"../../../platform/services/console-log.service\";\nimport { ContainerService } from \"../../../platform/services/container.service\";\nimport { getClassInitializer } from \"../../../platform/services/cryptography/get-class-initializer\";\nimport {\n  DECRYPT_COMMAND,\n  SET_CONFIG_COMMAND,\n  ParsedDecryptCommandData,\n} from \"../types/worker-command.type\";\n\nimport { EncryptServiceImplementation } from \"./encrypt.service.implementation\";\nimport { WebCryptoFunctionService } from \"./web-crypto-function.service\";\n\nconst workerApi: Worker = self as any;\n\nlet inited = false;\nlet encryptService: EncryptServiceImplementation;\nlet logService: LogService;\n\n/**\n * Bootstrap the worker environment with services required for decryption\n */\nexport function init() {\n  const cryptoFunctionService = new WebCryptoFunctionService(self);\n  logService = new ConsoleLogService(false);\n  encryptService = new EncryptServiceImplementation(cryptoFunctionService, logService, true);\n\n  const bitwardenContainerService = new ContainerService(null, encryptService);\n  bitwardenContainerService.attachToGlobal(self);\n\n  inited = true;\n}\n\n/**\n * Listen for messages and decrypt their contents\n */\nworkerApi.addEventListener(\"message\", async (event: { data: string }) => {\n  if (!inited) {\n    init();\n  }\n\n  const request: {\n    command: string;\n  } = JSON.parse(event.data);\n\n  switch (request.command) {\n    case DECRYPT_COMMAND:\n      return await handleDecrypt(request as unknown as ParsedDecryptCommandData);\n    case SET_CONFIG_COMMAND: {\n      const newConfig = (request as unknown as { newConfig: Jsonify<ServerConfig> }).newConfig;\n      return await handleSetConfig(newConfig);\n    }\n    default:\n      logService.error(`[EncryptWorker] unknown worker command`, request.command, request);\n  }\n});\n\nasync function handleDecrypt(request: ParsedDecryptCommandData) {\n  const key = SymmetricCryptoKey.fromJSON(request.key);\n  const items = request.items.map((jsonItem) => {\n    const initializer = getClassInitializer<Decryptable<any>>(jsonItem.initializerKey);\n    return initializer(jsonItem);\n  });\n  const result = await encryptService.decryptItems(items, key);\n\n  workerApi.postMessage({\n    id: request.id,\n    items: JSON.stringify(result),\n  });\n}\n\nasync function handleSetConfig(newConfig: Jsonify<ServerConfig>) {\n  encryptService.onServerConfigChange(ServerConfig.fromJSON(newConfig));\n}\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\tid: moduleId,\n\t\tloaded: false,\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Flag the module as loaded\n\tmodule.loaded = true;\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n// expose the module cache\n__webpack_require__.c = __webpack_module_cache__;\n\n// the startup function\n__webpack_require__.x = () => {\n\t// Load entry module and return exports\n\tvar __webpack_exports__ = __webpack_require__.O(undefined, [577], () => (__webpack_require__(61016)))\n\t__webpack_exports__ = __webpack_require__.O(__webpack_exports__);\n\treturn __webpack_exports__;\n};\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.f = {};\n// This file contains only the entry chunk.\n// The chunk loading function for additional chunks\n__webpack_require__.e = (chunkId) => {\n\treturn Promise.all(Object.keys(__webpack_require__.f).reduce((promises, key) => {\n\t\t__webpack_require__.f[key](chunkId, promises);\n\t\treturn promises;\n\t}, []));\n};","// This function allow to reference async chunks and sibling chunks for the entrypoint\n__webpack_require__.u = (chunkId) => {\n\t// return url for filenames based on template\n\treturn \"\" + chunkId + \".\" + \"304d02554de6bd1ad2c6\" + \".js\";\n};","// This function allow to reference async chunks and sibling chunks for the entrypoint\n__webpack_require__.miniCssF = (chunkId) => {\n\t// return url for filenames based on template\n\treturn undefined;\n};","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.hmd = (module) => {\n\tmodule = Object.create(module);\n\tif (!module.children) module.children = [];\n\tObject.defineProperty(module, 'exports', {\n\t\tenumerable: true,\n\t\tset: () => {\n\t\t\tthrow new Error('ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: ' + module.id);\n\t\t}\n\t});\n\treturn module;\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","var scriptUrl;\nif (__webpack_require__.g.importScripts) scriptUrl = __webpack_require__.g.location + \"\";\nvar document = __webpack_require__.g.document;\nif (!scriptUrl && document) {\n\tif (document.currentScript && document.currentScript.tagName.toUpperCase() === 'SCRIPT')\n\t\tscriptUrl = document.currentScript.src;\n\tif (!scriptUrl) {\n\t\tvar scripts = document.getElementsByTagName(\"script\");\n\t\tif(scripts.length) {\n\t\t\tvar i = scripts.length - 1;\n\t\t\twhile (i > -1 && (!scriptUrl || !/^http(s?):/.test(scriptUrl))) scriptUrl = scripts[i--].src;\n\t\t}\n\t}\n}\n// When supporting browsers where an automatic publicPath is not supported you must specify an output.publicPath manually via configuration\n// or pass an empty string (\"\") and set the __webpack_public_path__ variable from your code to use your own logic.\nif (!scriptUrl) throw new Error(\"Automatic publicPath is not supported in this browser\");\nscriptUrl = scriptUrl.replace(/^blob:/, \"\").replace(/#.*$/, \"\").replace(/\\?.*$/, \"\").replace(/\\/[^\\/]+$/, \"/\");\n__webpack_require__.p = scriptUrl;","// no baseURI\n\n// object to store loaded chunks\n// \"1\" means \"already loaded\"\nvar installedChunks = {\n\t357: 1\n};\n\n// importScripts chunk loading\nvar installChunk = (data) => {\n\tvar [chunkIds, moreModules, runtime] = data;\n\tfor(var moduleId in moreModules) {\n\t\tif(__webpack_require__.o(moreModules, moduleId)) {\n\t\t\t__webpack_require__.m[moduleId] = moreModules[moduleId];\n\t\t}\n\t}\n\tif(runtime) runtime(__webpack_require__);\n\twhile(chunkIds.length)\n\t\tinstalledChunks[chunkIds.pop()] = 1;\n\tparentChunkLoadingFunction(data);\n};\n__webpack_require__.f.i = (chunkId, promises) => {\n\t// \"1\" is the signal for \"already loaded\"\n\tif(!installedChunks[chunkId]) {\n\t\tif(true) { // all chunks have JS\n\t\t\timportScripts(__webpack_require__.p + __webpack_require__.u(chunkId));\n\t\t}\n\t}\n};\n\nvar chunkLoadingGlobal = self[\"webpackChunk_bitwarden_web_vault\"] = self[\"webpackChunk_bitwarden_web_vault\"] || [];\nvar parentChunkLoadingFunction = chunkLoadingGlobal.push.bind(chunkLoadingGlobal);\nchunkLoadingGlobal.push = installChunk;\n\n// no HMR\n\n// no HMR manifest","// module cache are used so entry inlining is disabled\n// run startup\nvar __webpack_exports__ = __webpack_require__.x();\n"],"names":["deferred","next","PushTechnology","ServerConfig","constructor","serverConfigData","featureStates","this","version","gitHash","server","utcDate","Date","environment","push","pushTechnology","SignalR","vapidPublicKey","settings","name","url","getAgeInMilliseconds","getTime","isValid","fromJSON","obj","nodeURL","self","init","inited","isNode","process","release","isBrowser","window","isMobileBrowser","isMobile","isAppleMobileBrowser","isAppleMobile","global","g","fromB64ToArray","str","Uint8Array","Buffer","from","binaryString","atob","bytes","length","i","charCodeAt","fromUrlB64ToArray","fromUrlB64ToB64","fromHexToArray","parseInt","substr","fromUtf8ToArray","strUtf8","unescape","encodeURIComponent","arr","fromByteStringToArray","fromBufferToB64","buffer","toString","binary","byteLength","String","fromCharCode","btoa","fromBufferToUrlB64","fromB64toUrlB64","b64Str","replace","fromBufferToUtf8","fromBufferToByteString","apply","fromBufferToHex","Array","prototype","map","call","x","slice","join","hexStringToArrayBuffer","hexString","arrayBuffer","ArrayBuffer","uint8Array","hexByte","byteValue","urlB64Str","output","Error","fromUrlB64ToUtf8","fromB64ToUtf8","fromUtf8ToB64","utfStr","fromUtf8ToUrlB64","newGuid","c","r","Math","random","isGuid","id","RegExp","guidRegex","test","getHostname","uriString","isNullOrWhitespace","trim","startsWith","indexOf","hostname","validHosts","getHost","getUrl","host","getDomain","parseResult","allowPrivateDomains","isIp","domain","getQueryParams","search","Map","split","forEach","pair","parts","set","decodeURIComponent","toLowerCase","getSortFunction","i18nService","prop","a","b","collator","compare","localeCompare","isNullOrEmpty","isPromise","undefined","nameOf","assign","target","source","Object","iterateEnum","keys","filter","k","Number","isNaN","getUrlObject","camelToPascalCase","s","charAt","toUpperCase","pickTextColorBasedOnBgColor","bgColor","threshold","svgTextFill","bgColorHexNums","substring","stringToColor","hash","color","getContainerService","bitwardenContainerService","validateHexColor","mapToRecord","fromEntries","recordToMap","record","entries","e","merge","destination","encodeRFC3986URIComponent","normalizePath","denormalizedPath","win","mobile","navigator","userAgent","vendor","opera","match","delay","ms","Promise","resolve","setTimeout","asyncToObservable","generator","of","pipe","switchMap","daysRemaining","targetDate","diffTime","now","max","floor","hasProtocol","URL","EncryptionType","encryptionTypeToString","encryptionType","regexpEmojiPresentation","originalMinimumPasswordLength","minimumPasswordLength","DomainMatchBlacklist","Set","EXPECTED_NUM_PARTS_BY_ENCRYPTION_TYPE","AesCbc256_B64","AesCbc256_HmacSha256_B64","Rsa2048_OaepSha256_B64","Rsa2048_OaepSha1_B64","Rsa2048_OaepSha256_HmacSha256_B64","Rsa2048_OaepSha1_HmacSha256_B64","CoseEncrypt0","FileUploadType","HashPurpose","HtmlStorageLocation","StorageLocationEnum","KeySuffixOptions","LogLevelType","ThemeType","SymmetricCryptoKey","key","innerKey","type","encryptionKey","keyB64","toBase64","authenticationKey","toJSON","inner","toEncoded","encodedKey","fromString","ConsoleLogService","isDev","timersMap","debug","message","optionalParams","write","Debug","info","Info","warning","Warning","error","level","console","log","warn","ContainerService","keyService","encryptService","attachToGlobal","getKeyService","getEncryptService","DECRYPT_ERROR","EncString","encryptedStringOrType","data","iv","mac","initFromData","initFromEncryptedString","ivBytes","macBytes","dataBytes","encryptedString","encType","encPieces","parseEncryptedString","headerPieces","NaN","isSerializedEncString","decrypt","orgId","context","decryptedValue","getKeyForDecryption","decryptString","decryptWithKey","decryptTrace","getOrgKey","getUserKeyWithLegacySupport","InitializerKey","Domain","buildDomainModel","dataObj","notEncList","hasOwnProperty","objProp","buildDataModel","notEncStringList","decryptObj","viewModel","props","objectContext","decryptObjWithKey","encryptedProperties","_","decryptedObjects","value","decrypted","decryptProperty","reduce","acc","propertyKey","CipherType","freeze","Login","SecureNote","Card","Identity","SshKey","BaseResponse","response","getResponseProperty","propertyName","exactName","otherCasePropertyName","CipherPermissionsApi","super","delete","restore","fromSdkCipherPermissions","permissions","AttachmentData","fileName","size","sizeName","CardData","cardholderName","brand","number","expMonth","expYear","code","FieldData","linkedId","IdentityData","title","firstName","middleName","lastName","address1","address2","address3","city","state","postalCode","country","company","email","phone","ssn","username","passportNumber","licenseNumber","Fido2CredentialData","credentialId","keyType","keyAlgorithm","keyCurve","keyValue","rpId","userHandle","userName","counter","rpName","userDisplayName","discoverable","creationDate","LoginUriData","uri","uriChecksum","LoginData","password","passwordRevisionDate","totp","autofillOnPageLoad","uris","u","fido2Credentials","PasswordHistoryData","lastUsedDate","SecureNoteData","SshKeyData","privateKey","publicKey","keyFingerprint","CipherData","collectionIds","organizationId","folderId","edit","viewPassword","organizationUseTotp","favorite","revisionDate","notes","deletedDate","reprompt","login","secureNote","card","identity","sshKey","fields","f","attachments","passwordHistory","ph","result","CipherRepromptType","LoginLinkedId","Text","Hidden","Boolean","Linked","CardLinkedId","IdentityLinkedId","AttachmentView","fileSize","toSdkAttachmentView","encryptedKey","fromSdkAttachmentView","view","ExpiryDateDelimitersPattern","normalizeExpiryYearFormat","yearInput","yearInputIsEmpty","expirationYear","paddedYear","getFullYear","LinkedMetadata","attributes","_i18nKey","i18nKey","sortPosition","linkedFieldOption","linkedFieldOptions","ItemView","CardView","_brand","_number","_subTitle","maskedCode","repeat","maskedNumber","subTitle","count","expiration","normalizedYear","exp","getCardBrandByPatterns","cardNum","re","fromSdkCardView","cardView","FieldView","newField","showValue","showCount","maskedValue","fromSdkFieldView","IdentityView","_firstName","_lastName","fullName","fullAddress","address","fullAddressPart2","addressPart2","fullAddressForCopy","fromSdkIdentityView","identityView","Fido2CredentialView","fromSdkFido2CredentialView","UriMatchStrategy","CanLaunchWhitelist","SafeUrls","canLaunch","LoginUriView","_uri","_domain","_hostname","_host","_canLaunch","hostnameOrUri","hostOrUri","isWebsite","launchUri","fromSdkLoginUriView","matchesUri","targetUri","equivalentDomains","defaultUriMatch","matchType","targetDomain","matchDomains","add","matchesDomain","urlHost","has","domainUrlHost","get","LoginView","l","hasUris","maskedPassword","some","hasTotp","find","hasFido2Credentials","fromSdkLoginView","loginView","PasswordHistoryView","fromSdkPasswordHistoryView","SecureNoteView","n","fromSdkSecureNoteView","secureNoteView","SshKeyView","maskedPrivateKey","lines","maskLine","line","fromSdkSshKeyView","sshKeyView","fingerprint","CipherView","initializerKey","decryptionFailure","localData","item","hasPasswordHistory","hasAttachments","hasOldAttachments","hasFields","passwordRevisionDisplayDate","isDeleted","isUnassigned","canAssignToCollections","linkedFieldValue","linkedFieldI18nKey","fromSdkCipherView","cipherView","lastLaunched","Attachment","encKey","decryptAttachmentKey","unwrapSymmetricKey","toAttachmentData","toSdkAttachment","toCardData","toSdkCard","Field","toFieldData","toSdkField","toIdentityData","toSdkIdentity","Fido2Credential","toFido2CredentialData","toISOString","toSdkFido2Credential","LoginUri","validateChecksum","clearTextUri","localChecksum","toLoginUriData","toSdkLoginUri","bypassValidation","all","toLoginData","toSdkLogin","Password","toPasswordHistoryData","toSdkPasswordHistory","toSecureNoteData","toSdkSecureNote","toSshKeyData","toSdkSshKey","Cipher","model","cipherKey","attachment","field","toCipherData","toSdkCipher","sdkCipher","classInitializers","DECRYPT_COMMAND","SET_CONFIG_COMMAND","IV_LENGTH","EncArrayBuffer","encBytes","minimumLength","ENC_TYPE_LENGTH","throwDecryptionError","fromParts","validateIvLength","validateMacLength","macLen","fromResponse","fromB64","b64","EncryptedObject","FeatureFlag","FALSE","DefaultFeatureFlagValue","SeparateCustomRolePermissions","CreateDefaultLocation","BlockBrowserInjectionsByDomain","EnableNewCardCombinedExpiryAutofill","NotificationRefresh","UseTreeWalkerApiForPageDetailsCollection","MacOsNativeCredentialSync","EnableRiskInsightsNotifications","DesktopSendUIRefresh","PM8851_BrowserOnboardingNudge","PM9111ExtensionPersistAddEditForm","CipherKeyEncryption","PM18520_UpdateDesktopCipherForm","EndUserNotifications","PM19941MigrateCipherDomainToSdk","RemoveCardItemTypePolicy","PM16117_SetInitialPasswordRefactor","PM16117_ChangeExistingPasswordRefactor","PM9115_TwoFactorExtensionDataPersistence","PM14938_BrowserExtensionLoginApproval","TrialPaymentOptional","PM12276_BreadcrumbEventLogs","PM17772_AdminInitiatedSponsorships","PM19956_RequireProviderPaymentMethodDuringSetup","UseOrganizationWarningsService","AllowTrialLengthZero","PrivateKeyRegeneration","PM4154_BulkEncryptionService","UseSDKForDecryption","PM17987_BlockType0","EnrollAeadOnKeyRotation","IpcChannelFramework","getFeatureFlagValue","serverConfig","flag","SdkLoadFailedError","SdkLoadService","loadAndInit","load","init_sdk","markAsReady","markAsFailed","Ready","reject","EncryptServiceImplementation","cryptoFunctionService","logService","logMacFailures","useSDKForDecryption","blockType0","encryptString","plainValue","encrypt","encryptBytes","encryptFileData","encryptToBytes","encString","decryptToUtf8","decryptBytes","decryptToBytes","decryptFileData","encBuffer","wrapDecapsulationKey","decapsulationKeyPkcs8","wrappingKey","encryptUint8Array","wrapEncapsulationKey","encapsulationKeySpki","wrapSymmetricKey","keyToBeWrapped","unwrapDecapsulationKey","wrappedDecapsulationKey","unwrapEncapsulationKey","wrappedEncapsulationKey","keyToBeUnwrapped","algorithm","hashArray","onServerConfigChange","newConfig","oldFlagValue","encObj","aesEncrypt","aesEncryptLegacy","encValue","decryptContext","PureCrypto","symmetric_decrypt","logDecryptError","fastParams","aesDecryptFastParameters","computedMac","hmacFast","macData","macKey","compareFast","aesDecryptFast","mode","parameters","logMacFailed","encThing","symmetric_decrypt_array_buffer","hmac","aesDecrypt","encapsulateKeyUnsigned","sharedKey","encapsulationKey","rsaEncrypt","decapsulateKeyUnsigned","encryptedSharedKey","decapsulationKey","keyBytes","rsaDecrypt","decryptItems","items","results","randomBytes","msg","keyEncType","dataEncType","encrypted","WebCryptoFunctionService","globalContext","crypto","subtle","wasmSupported","checkIfWasmSupported","pbkdf2","salt","iterations","wcLen","passwordBuf","toBuf","pbkdf2Params","toWebCryptoAlgorithm","impKey","importKey","deriveBits","argon2","memory","parallelism","passwordArr","saltArr","pass","time","mem","hashLen","ArgonType","Argon2id","unloadRuntime","hkdf","ikm","outputByteSize","hkdfParams","hkdfExpand","prk","infoBuf","infoArr","runningOkmLength","previousT","ceil","okm","t","md","md5","create","valueBytes","toByteString","update","digest","valueBuf","signingAlgorithm","sign","mac1","mac2","arr1","arr2","start","getBytes","rand","Uint32Array","createBuffer","putInt32","decode64","decipher","createDecipher","toWebCryptoAesMode","options","dataBuffer","finish","val","rsaParams","rsaExtractPublicKey","impPrivateKey","jwkPrivateKey","exportKey","jwkPublicKeyParams","kty","alg","ext","impPublicKey","aesGenerateKey","bitLength","key1","key2","aesParams","generateKey","rawKey","rsaGenerateKeyPair","modulusLength","publicExponent","keyPair","getRandomValues","buf","encodeUtf8","WebAssembly","instantiate","module","Module","Instance","workerApi","addEventListener","event","request","JSON","parse","command","jsonItem","className","postMessage","stringify","handleDecrypt","handleSetConfig","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","exports","loaded","__webpack_modules__","m","__webpack_exports__","O","chunkIds","fn","priority","notFulfilled","Infinity","fulfilled","j","every","splice","d","definition","o","defineProperty","enumerable","chunkId","promises","miniCssF","globalThis","Function","hmd","children","Symbol","toStringTag","scriptUrl","importScripts","location","document","currentScript","tagName","src","scripts","getElementsByTagName","p","installedChunks","chunkLoadingGlobal","parentChunkLoadingFunction","bind","moreModules","runtime","pop","then"],"sourceRoot":""}