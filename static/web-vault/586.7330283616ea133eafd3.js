"use strict";(self.webpackChunk_bitwarden_web_vault=self.webpackChunk_bitwarden_web_vault||[]).push([[586],{28756:(e,t,i)=>{i.d(t,{w:()=>o});var n=i(74208),s=i(3204),r=i(1601);function o(e){return function(e,t,i,n,s){var r;const o=Object.assign(Object.assign({},n),{component:e}),a=null!=s?s:n;return[Object.assign(Object.assign({},a),{component:t,canMatch:[i,...null!==(r=a.canMatch)&&void 0!==r?r:[]]}),o]}(e.defaultComponent,e.flaggedComponent,()=>(0,n.WQX)(r.w).getFeatureFlag$(e.featureFlag).pipe((0,s.T)(e=>!0===e)),e.routeOptions)}},60586:(e,t,i)=>{i.d(t,{MembersModule:()=>Yo});var n=i(94251),s=i(49355),r=i(81285),o=i(88565),a=i(88083);function c(e,t,i,n){return s=>{var r;if(!(null===(r=s.value)||void 0===r?void 0:r.trim()))return null;if(!l(e.productTierType))return null;const o=n+function(e,t){const i=Array.from(new Set(t.value.split(",").filter(t=>t&&""!==t.trim()&&!e.some(e=>e===t.trim()))));return i.length}(t,s);return o>e.seats?{seatLimitReached:{message:i}}:null}}function l(e){switch(e){case a.K_.Free:case a.K_.Families:case a.K_.TeamsStarter:return!0;default:return!1}}var u=i(16452),d=i(74208),h=i(50700),p=i(21274),m=i(69855),g=i(23649),b=function(e,t,i,n){return new(i||(i=Promise))(function(s,r){function o(e){try{c(n.next(e))}catch(t){r(t)}}function a(e){try{c(n.throw(e))}catch(t){r(t)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(o,a)}c((n=n.apply(e,t||[])).next())})};class f{constructor(e,t,i,n){this.i18nService=e,this.dialogService=t,this.toastService=i,this.router=n}checkSeatLimit(e,t){var i;const n=null!==(i=null==t?void 0:t.organizationOccupiedSeats)&&void 0!==i?i:0;if(null==n)throw new Error("Cannot check seat limit: billingMetadata is null or undefined.");return n<e.seats?{canAddUsers:!0}:e.hasReseller?{canAddUsers:!1,reason:"reseller-limit"}:l(e.productTierType)?{canAddUsers:!1,reason:"fixed-seat-limit",shouldShowUpgradeDialog:e.canEditSubscription}:{canAddUsers:!0}}seatLimitReached(e,t){return b(this,void 0,void 0,function*(){if(e.canAddUsers)return!1;switch(e.reason){case"reseller-limit":return this.toastService.showToast({variant:"error",title:this.i18nService.t("seatLimitReached"),message:this.i18nService.t("contactYourProvider")}),!0;case"fixed-seat-limit":if(e.shouldShowUpgradeDialog){return(yield this.showChangePlanDialog(t))!==u.d1.Submitted}return yield this.showSeatLimitReachedDialog(t),!0;default:return!0}})}showChangePlanDialog(e){return b(this,void 0,void 0,function*(){const t=(0,u.IO)(this.dialogService,{data:{organizationId:e.id,productTierType:e.productTierType}}),i=yield(0,o.s)(t.closed);if(null==i)throw new Error("ChangePlanDialog result is null or undefined.");return i})}showSeatLimitReachedDialog(e){return b(this,void 0,void 0,function*(){const t=this.getSeatLimitReachedDialogContent(e),i=this.getSeatLimitReachedDialogAcceptButtonText(e),n={title:this.i18nService.t("upgradeOrganization"),content:t,type:"primary",acceptButtonText:i,cancelButtonText:e.canEditSubscription?void 0:null},s=this.dialogService.openSimpleDialogRef(n);(yield(0,o.s)(s.closed))&&e.canEditSubscription&&(yield this.handleUpgradeNavigation(e))})}handleUpgradeNavigation(e){return b(this,void 0,void 0,function*(){const t=e.productTierType;if((0,a.LF)(t))throw new Error(`Unsupported product type: ${e.productTierType}`);yield this.router.navigate(["/organizations",e.id,"billing","subscription"],{queryParams:{upgrade:!0}})})}getSeatLimitReachedDialogContent(e){const t=this.getProductKey(e);return this.i18nService.t(t,e.seats)}getSeatLimitReachedDialogAcceptButtonText(e){if(!e.canEditSubscription)return this.i18nService.t("ok");const t=e.productTierType;if((0,a.LF)(t))throw new Error(`Unsupported product type: ${t}`);return this.i18nService.t("upgrade")}getProductKey(e){const t=e.canEditSubscription?"ManageBilling":"NoManageBilling";let i="";switch(e.productTierType){case a.K_.Free:i="freeOrg";break;case a.K_.TeamsStarter:i="teamsStarterPlan";break;case a.K_.Families:i="familiesPlan";break;default:throw new Error(`Unsupported product type: ${e.productTierType}`)}return`${i}InvLimitReached${t}`}navigateToPaymentMethod(e){return b(this,void 0,void 0,function*(){yield this.router.navigate(["organizations",`${e.id}`,"billing","payment-method"],{state:{launchPaymentModalAutomatically:!0}})})}}f.ɵfac=function(e){return new(e||f)(d.KVO(h.W),d.KVO(p.o3),d.KVO(m.f),d.KVO(g.Ix))},f.ɵprov=d.jDH({token:f,factory:f.ɵfac});var v=i(1094),S=i(72932),I=i(5326),y=i(51757),k=i(66046),R=i(72245),w=i(33338),$=i(44500),M=i(3204),F=i(27442),T=i(93695),E=i(14803),G=i(23965),U=i(67553),j=i(43978),C=i(95919),x=i(3633),D=i(82468),X=i(15639),N=i(81525),P=i(81667),V=i(38766),A=i(31857),z=function(e,t,i,n){return new(i||(i=Promise))(function(s,r){function o(e){try{c(n.next(e))}catch(t){r(t)}}function a(e){try{c(n.throw(e))}catch(t){r(t)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(o,a)}c((n=n.apply(e,t||[])).next())})};const B=new A.Ok(A.BA,"showDeleteManagedUserWarning",{deserializer:e=>e,clearOn:[]});class Y{constructor(e,t){this.stateProvider=e,this.dialogService=t,this._acknowledged=this.stateProvider.getActive(B),this.acknowledgedState$=this._acknowledged.state$}acknowledgeWarning(e){return z(this,void 0,void 0,function*(){yield this._acknowledged.update(t=>e?t?t.includes(e)?t:[...t,e]:[e]:t)})}showWarning(){return z(this,void 0,void 0,function*(){const e=yield this.dialogService.openSimpleDialog({title:{key:"deleteManagedUserWarning"},content:{key:"deleteManagedUserWarningDesc"},type:"danger",icon:"bwi-exclamation-triangle",acceptButtonText:{key:"continue"},cancelButtonText:{key:"cancel"}});return e||!1})}warningAcknowledged(e){return this.acknowledgedState$.pipe((0,M.T)(t=>{var i;return null!==(i=null==t?void 0:t.includes(e))&&void 0!==i&&i}))}}function O(e){return""!==e.value&&e.value&&void 0!==e.value.split(",").map(e=>y.k0.email({value:e.trim()})).find(e=>null!==e)?{multipleEmails:{message:"multipleInputEmails"}}:null}function J(e,t){return i=>{var n;if(!(null===(n=i.value)||void 0===n?void 0:n.trim()))return null;const s=e.productTierType===a.K_.TeamsStarter?10:20,r=function(e){const t=e.value.split(",").filter(e=>e&&""!==e.trim());return Array.from(new Set(t))}(i);return r.length<=s?null:{tooManyEmails:{message:t(s)}}}}Y.ɵfac=function(e){return new(e||Y)(d.KVO(A.v2),d.KVO(p.o3))},Y.ɵprov=d.jDH({token:Y,factory:Y.ɵfac,providedIn:"root"});var W=i(33812),Q=i(35500),L=i(1601),q=i(77468),K=i(54471),_=i(3892),H=i(26657),Z=i(45154),ee=i(47696),te=i(56898),ie=i(50352),ne=i(68016),se=i(90246),re=i(86226),oe=i(93199),ae=i(97553),ce=i(43759),le=i(57178),ue=i(24374),de=i(17721),he=i(88516),pe=i(49608),me=i(58806),ge=i(43184),be=i(78781),fe=i(88016);function ve(e,t){if(1&e){const e=W.RV6();W.j41(0,"div")(1,"bit-form-control")(2,"input",5),W.bIt("change",function(){d.eBV(e);const t=W.XpG(2);return d.Njj(t.onChildCheck())}),W.k0s(),W.j41(3,"bit-label"),W.EFF(4),W.nI1(5,"i18n"),W.k0s()()()}if(2&e){const e=W.XpG().$implicit;W.R7$(2),W.Y8G("formControl",e.value),W.R7$(2),W.JRh(W.bMT(5,2,e.key))}}function Se(e,t){if(1&e&&(W.qex(0),W.DNE(1,ve,6,4,"div",4),W.bVm()),2&e){const e=t.$implicit,i=W.XpG();W.R7$(),W.Y8G("ngIf",e.key!=i.parentId)}}class Ie{constructor(){this.destroy$=new k.B}get parentIndeterminate(){return this.children.some(([e,t])=>1==t.value)&&!this.children.every(([e,t])=>1==t.value)}ngOnInit(){this.checkboxes.controls[this.parentId].valueChanges.pipe((0,E.Q)(this.destroy$)).subscribe(e=>{Object.values(this.checkboxes.controls).forEach(t=>t.setValue(e,{emitEvent:!1}))})}get parentCheckbox(){return this.checkboxes.controls[this.parentId]}get children(){return Object.entries(this.checkboxes.controls).filter(([e,t])=>e!=this.parentId)}onChildCheck(){const e=this.children.every(([e,t])=>1==t.value);this.parentCheckbox.setValue(e,{emitEvent:!1})}key(e,t){return t.key}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}pascalize(e){return be.A.camelToPascalCase(e)}}Ie.ɵfac=function(e){return new(e||Ie)},Ie.ɵcmp=W.VBU({type:Ie,selectors:[["app-nested-checkbox"]],inputs:{parentId:"parentId",checkboxes:"checkboxes"},standalone:!1,decls:9,vars:10,consts:[[3,"formGroup"],["type","checkbox","bitCheckbox","",3,"formControlName","indeterminate"],[1,"tw-ml-4"],[4,"ngFor","ngForOf","ngForTrackBy"],[4,"ngIf"],["type","checkbox","bitCheckbox","",3,"change","formControl"]],template:function(e,t){1&e&&(W.j41(0,"div",0)(1,"bit-form-control"),W.nrm(2,"input",1),W.j41(3,"bit-label"),W.EFF(4),W.nI1(5,"i18n"),W.k0s()(),W.j41(6,"div",2),W.DNE(7,Se,2,1,"ng-container",3),W.nI1(8,"keyvalue"),W.k0s()()),2&e&&(W.Y8G("formGroup",t.checkboxes),W.R7$(2),W.Y8G("formControlName",t.parentId)("indeterminate",t.parentIndeterminate),W.R7$(2),W.JRh(W.bMT(5,6,t.parentId)),W.R7$(3),W.Y8G("ngForOf",W.bMT(8,8,t.checkboxes.controls))("ngForTrackBy",t.key))},dependencies:[q.Sq,q.bT,y.Zm,y.BC,y.cb,y.l_,y.j4,y.JD,ie.P,se.f,re.j,q.lG,fe.$],encapsulation:2});var ye=function(e,t,i,n){return new(i||(i=Promise))(function(s,r){function o(e){try{c(n.next(e))}catch(t){r(t)}}function a(e){try{c(n.throw(e))}catch(t){r(t)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(o,a)}c((n=n.apply(e,t||[])).next())})};const ke=e=>({seats:e});function Re(e,t){if(1&e&&(W.j41(0,"span",15),W.EFF(1),W.nI1(2,"async"),W.k0s()),2&e){let e;const t=W.XpG();W.R7$(),W.JRh(null==(e=W.bMT(2,1,t.editParams$))?null:e.name)}}function we(e,t){1&e&&(W.j41(0,"span",16),W.EFF(1),W.nI1(2,"i18n"),W.k0s()),2&e&&(W.R7$(),W.JRh(W.bMT(2,1,"revoked")))}function $e(e,t){1&e&&(W.qex(0),W.nrm(1,"i",17),W.nI1(2,"i18n"),W.j41(3,"span",18),W.EFF(4),W.nI1(5,"i18n"),W.k0s(),W.bVm()),2&e&&(W.R7$(),W.Y8G("title",W.mNQ(W.bMT(2,3,"loading"))),W.R7$(3),W.JRh(W.bMT(5,5,"loading")))}function Me(e,t){if(1&e&&(W.j41(0,"bit-hint"),W.EFF(1),W.nI1(2,"i18n"),W.k0s()),2&e){const e=W.XpG().ngIf;W.R7$(),W.JRh(W.i5U(2,1,"inviteMultipleEmailDesc",e.seats))}}function Fe(e,t){1&e&&(W.j41(0,"bit-hint"),W.EFF(1),W.nI1(2,"i18n"),W.k0s()),2&e&&(W.R7$(),W.JRh(W.bMT(2,1,"inviteSingleEmailDesc")))}function Te(e,t){1&e&&(W.j41(0,"bit-hint"),W.EFF(1),W.nI1(2,"i18n"),W.k0s()),2&e&&(W.R7$(),W.JRh(W.bMT(2,1,"inviteZeroEmailDesc")))}function Ee(e,t){if(1&e&&(W.j41(0,"bit-form-field")(1,"bit-label"),W.EFF(2),W.nI1(3,"i18n"),W.k0s(),W.nrm(4,"input",33),W.DNE(5,Me,3,4,"bit-hint",7)(6,Fe,3,3,"bit-hint",7)(7,Te,3,3,"bit-hint",7),W.k0s()),2&e){const e=t.ngIf;W.R7$(2),W.JRh(W.bMT(3,4,"email")),W.R7$(3),W.Y8G("ngIf",e.seats>1),W.R7$(),W.Y8G("ngIf",1===e.seats),W.R7$(),W.Y8G("ngIf",0===e.seats)}}function Ge(e,t){if(1&e&&(W.qex(0),W.j41(1,"p",32),W.EFF(2),W.nI1(3,"i18n"),W.k0s(),W.DNE(4,Ee,8,6,"bit-form-field",7),W.nI1(5,"async"),W.bVm()),2&e){const e=W.XpG(2);W.R7$(2),W.JRh(W.bMT(3,2,"inviteUserDesc")),W.R7$(2),W.Y8G("ngIf",W.eq3(6,ke,W.bMT(5,4,e.remainingSeats$)))}}function Ue(e,t){1&e&&(W.qex(0),W.j41(1,"p"),W.EFF(2),W.nI1(3,"i18n"),W.j41(4,"a",34),W.EFF(5),W.nI1(6,"i18n"),W.k0s(),W.EFF(7),W.nI1(8,"i18n"),W.k0s(),W.bVm()),2&e&&(W.R7$(2),W.SpI(" ",W.bMT(3,3,"customDescNonEnterpriseStart")),W.R7$(3),W.JRh(W.bMT(6,5,"customDescNonEnterpriseLink")),W.R7$(2),W.SpI("",W.bMT(8,7,"customDescNonEnterpriseEnd")," "))}function je(e,t){1&e&&(W.j41(0,"p"),W.EFF(1),W.nI1(2,"i18n"),W.k0s()),2&e&&(W.R7$(),W.JRh(W.bMT(2,1,"customDesc")))}function Ce(e,t){if(1&e&&(W.qex(0),W.j41(1,"div",35)(2,"div",36)(3,"bit-form-control"),W.nrm(4,"input",37),W.j41(5,"bit-label"),W.EFF(6),W.nI1(7,"i18n"),W.k0s()(),W.j41(8,"bit-form-control"),W.nrm(9,"input",38),W.j41(10,"bit-label"),W.EFF(11),W.nI1(12,"i18n"),W.k0s()(),W.j41(13,"bit-form-control"),W.nrm(14,"input",39),W.j41(15,"bit-label"),W.EFF(16),W.nI1(17,"i18n"),W.k0s()()(),W.j41(18,"div",36),W.nrm(19,"app-nested-checkbox",40),W.k0s(),W.j41(20,"div",36)(21,"div",41)(22,"bit-form-control"),W.nrm(23,"input",42),W.j41(24,"bit-label"),W.EFF(25),W.nI1(26,"i18n"),W.k0s()(),W.j41(27,"bit-form-control"),W.nrm(28,"input",43),W.j41(29,"bit-label"),W.EFF(30),W.nI1(31,"i18n"),W.k0s()(),W.j41(32,"bit-form-control"),W.nrm(33,"input",44),W.j41(34,"bit-label"),W.EFF(35),W.nI1(36,"i18n"),W.k0s()(),W.j41(37,"bit-form-control"),W.nrm(38,"input",45),W.j41(39,"bit-label"),W.EFF(40),W.nI1(41,"i18n"),W.k0s()(),W.j41(42,"bit-form-control"),W.nrm(43,"input",46),W.j41(44,"bit-label"),W.EFF(45),W.nI1(46,"i18n"),W.k0s()()()()(),W.bVm()),2&e){const e=W.XpG(2);W.R7$(),W.Y8G("formGroup",e.permissionsGroup),W.R7$(5),W.JRh(W.bMT(7,10,"accessEventLogs")),W.R7$(5),W.JRh(W.bMT(12,12,"accessImportExport")),W.R7$(5),W.JRh(W.bMT(17,14,"accessReports")),W.R7$(3),W.Y8G("checkboxes",e.permissionsGroup.controls.manageAllCollectionsGroup),W.R7$(6),W.JRh(W.bMT(26,16,"manageGroups")),W.R7$(5),W.JRh(W.bMT(31,18,"manageSso")),W.R7$(5),W.JRh(W.bMT(36,20,"managePolicies")),W.R7$(5),W.JRh(W.bMT(41,22,"manageUsers")),W.R7$(5),W.JRh(W.bMT(46,24,"manageAccountRecovery"))}}function xe(e,t){if(1&e&&(W.qex(0),W.j41(1,"h3",47),W.EFF(2),W.nI1(3,"i18n"),W.j41(4,"a",48),W.nI1(5,"i18n"),W.nrm(6,"i",23),W.k0s()(),W.j41(7,"p",49),W.EFF(8),W.nI1(9,"i18n"),W.k0s(),W.j41(10,"bit-form-control"),W.nrm(11,"input",50),W.j41(12,"bit-label"),W.EFF(13),W.nI1(14,"i18n"),W.k0s()(),W.bVm()),2&e){const e=W.XpG(2);W.R7$(2),W.SpI(" ",W.bMT(3,6,"secretsManager")," "),W.R7$(2),W.Y8G("appA11yTitle",W.mNQ(W.bMT(5,8,"learnMore"))),W.R7$(4),W.JRh(W.bMT(9,10,"secretsManagerAccessDescription")),W.R7$(3),W.Y8G("disabled",e.isOnSecretsManagerStandalone),W.R7$(2),W.SpI(" ",W.bMT(14,12,"userAccessSecretsManagerGA")," ")}}function De(e,t){1&e&&(W.j41(0,"bit-form-field")(1,"bit-label"),W.EFF(2),W.nI1(3,"i18n"),W.k0s(),W.nrm(4,"input",51),W.j41(5,"bit-hint"),W.EFF(6),W.nI1(7,"i18n"),W.k0s()()),2&e&&(W.R7$(2),W.JRh(W.bMT(3,2,"externalId")),W.R7$(4),W.JRh(W.bMT(7,4,"externalIdDesc")))}function Xe(e,t){1&e&&(W.j41(0,"bit-form-field")(1,"bit-label"),W.EFF(2),W.nI1(3,"i18n"),W.k0s(),W.nrm(4,"input",52),W.j41(5,"bit-hint"),W.EFF(6),W.nI1(7,"i18n"),W.k0s()()),2&e&&(W.R7$(2),W.JRh(W.bMT(3,2,"ssoExternalId")),W.R7$(4),W.JRh(W.bMT(7,4,"ssoExternalIdDesc")))}function Ne(e,t){if(1&e&&(W.j41(0,"bit-tab",20),W.nI1(1,"i18n"),W.j41(2,"div",53),W.EFF(3),W.nI1(4,"async"),W.nI1(5,"i18n"),W.nI1(6,"i18n"),W.k0s(),W.nrm(7,"bit-access-selector",54),W.nI1(8,"i18n"),W.nI1(9,"i18n"),W.nI1(10,"i18n"),W.nI1(11,"async"),W.k0s()),2&e){const e=W.XpG(2);W.Y8G("label",W.bMT(1,7,"groups")),W.R7$(3),W.SpI(" ",W.bMT(4,9,e.restrictEditingSelf$)?W.bMT(5,11,"restrictedGroupAccess"):W.bMT(6,13,"groupAccessUserDesc")," "),W.R7$(4),W.Y8G("items",e.groupAccessItems)("columnHeader",W.bMT(8,15,"groups"))("selectorLabelText",W.bMT(9,17,"selectGroups"))("emptySelectionText",W.bMT(10,19,"noGroupsAdded"))("hideMultiSelect",W.bMT(11,21,e.restrictEditingSelf$))}}function Pe(e,t){1&e&&(W.j41(0,"div",53),W.EFF(1),W.nI1(2,"i18n"),W.k0s()),2&e&&(W.R7$(),W.SpI(" ",W.bMT(2,1,"cannotAddYourselfToCollections")," "))}function Ve(e,t){1&e&&(W.j41(0,"span"),W.EFF(1),W.nI1(2,"i18n"),W.k0s()),2&e&&(W.R7$(),W.SpI(" ",W.bMT(2,1,"userPermissionOverrideHelperDesc")," "))}function Ae(e,t){1&e&&(W.j41(0,"span"),W.EFF(1),W.nI1(2,"i18n"),W.k0s()),2&e&&(W.R7$(),W.SpI(" ",W.bMT(2,1,"restrictedCollectionAssignmentDesc")," "))}function ze(e,t){if(1&e&&(W.j41(0,"div",53),W.DNE(1,Ve,3,3,"span",7)(2,Ae,3,3,"span",7),W.nI1(3,"async"),W.k0s()),2&e){const e=W.XpG().ngIf,t=W.XpG();W.R7$(),W.Y8G("ngIf",e.useGroups),W.R7$(),W.Y8G("ngIf",!W.bMT(3,2,t.canAssignAccessToAnyCollection$))}}function Be(e,t){if(1&e){const e=W.RV6();W.j41(0,"bit-tab-group",19),W.mxI("selectedIndexChange",function(t){d.eBV(e);const i=W.XpG();return W.DH7(i.tabIndex,t)||(i.tabIndex=t),d.Njj(t)}),W.j41(1,"bit-tab",20),W.nI1(2,"i18n"),W.DNE(3,Ge,6,8,"ng-container",7),W.j41(4,"bit-radio-group",21)(5,"bit-label"),W.EFF(6),W.nI1(7,"i18n"),W.j41(8,"a",22),W.nI1(9,"i18n"),W.nrm(10,"i",23),W.k0s()(),W.j41(11,"bit-radio-button",24)(12,"bit-label"),W.EFF(13),W.nI1(14,"i18n"),W.k0s(),W.j41(15,"bit-hint"),W.EFF(16),W.nI1(17,"i18n"),W.k0s()(),W.j41(18,"bit-radio-button",25)(19,"bit-label"),W.EFF(20),W.nI1(21,"i18n"),W.k0s(),W.j41(22,"bit-hint"),W.EFF(23),W.nI1(24,"i18n"),W.k0s()(),W.j41(25,"bit-radio-button",26)(26,"bit-label"),W.EFF(27),W.nI1(28,"i18n"),W.k0s(),W.j41(29,"bit-hint"),W.EFF(30),W.nI1(31,"i18n"),W.k0s()(),W.j41(32,"bit-radio-button",27)(33,"bit-label"),W.EFF(34),W.nI1(35,"i18n"),W.k0s(),W.j41(36,"bit-hint"),W.DNE(37,Ue,9,9,"ng-container",28)(38,je,3,3,"ng-template",null,0,W.C5r),W.k0s()()(),W.DNE(40,Ce,47,26,"ng-container",7)(41,xe,15,14,"ng-container",7)(42,De,8,6,"bit-form-field",7)(43,Xe,8,6,"bit-form-field",7),W.k0s(),W.DNE(44,Ne,12,23,"bit-tab",29),W.j41(45,"bit-tab",20),W.nI1(46,"i18n"),W.DNE(47,Pe,3,3,"div",30),W.nI1(48,"async"),W.DNE(49,ze,4,4,"div",30),W.nI1(50,"async"),W.nI1(51,"async"),W.nrm(52,"bit-access-selector",31),W.nI1(53,"i18n"),W.nI1(54,"i18n"),W.nI1(55,"i18n"),W.nI1(56,"async"),W.k0s()()}if(2&e){const e=t.ngIf,i=W.sdS(39),n=W.XpG();W.R50("selectedIndex",n.tabIndex),W.R7$(),W.Y8G("label",W.bMT(2,35,"role")),W.R7$(2),W.Y8G("ngIf",!n.editMode),W.R7$(3),W.SpI(" ",W.bMT(7,37,"memberRole")," "),W.R7$(2),W.Y8G("appA11yTitle",W.mNQ(W.bMT(9,39,"learnMoreAboutMemberRoles"))),W.R7$(3),W.Y8G("value",n.organizationUserType.User),W.R7$(2),W.JRh(W.bMT(14,41,"user")),W.R7$(3),W.JRh(W.bMT(17,43,"userDesc")),W.R7$(2),W.Y8G("value",n.organizationUserType.Admin),W.R7$(2),W.JRh(W.bMT(21,45,"admin")),W.R7$(3),W.JRh(W.bMT(24,47,"adminDesc")),W.R7$(2),W.Y8G("value",n.organizationUserType.Owner),W.R7$(2),W.JRh(W.bMT(28,49,"owner")),W.R7$(3),W.JRh(W.bMT(31,51,"ownerDesc")),W.R7$(2),W.Y8G("value",n.organizationUserType.Custom)("disabled",!e.useCustomPermissions||null),W.R7$(2),W.JRh(W.bMT(35,53,"custom")),W.R7$(3),W.Y8G("ngIf",!e.useCustomPermissions)("ngIfElse",i),W.R7$(3),W.Y8G("ngIf",n.customUserTypeSelected),W.R7$(),W.Y8G("ngIf",e.useSecretsManager),W.R7$(),W.Y8G("ngIf",n.isExternalIdVisible),W.R7$(),W.Y8G("ngIf",n.isSsoExternalIdVisible),W.R7$(),W.Y8G("ngIf",e.useGroups),W.R7$(),W.Y8G("label",W.bMT(46,55,"collections")),W.R7$(2),W.Y8G("ngIf",W.bMT(48,57,n.restrictEditingSelf$)),W.R7$(2),W.Y8G("ngIf",!W.bMT(50,59,n.restrictEditingSelf$)&&(e.useGroups||!W.bMT(51,61,n.canAssignAccessToAnyCollection$))),W.R7$(3),W.Y8G("permissionMode",n.PermissionMode.Edit)("showGroupColumn",e.useGroups)("items",n.collectionAccessItems)("columnHeader",W.bMT(53,63,"collection"))("selectorLabelText",W.bMT(54,65,"selectCollections"))("emptySelectionText",W.bMT(55,67,"noCollectionsAdded"))("hideMultiSelect",W.bMT(56,69,n.restrictEditingSelf$))}}function Ye(e,t){if(1&e&&(W.j41(0,"button",55),W.EFF(1),W.nI1(2,"i18n"),W.k0s()),2&e){const e=W.XpG();W.Y8G("bitAction",e.restore)("disabled",e.loading),W.R7$(),W.SpI(" ",W.bMT(2,3,"restore")," ")}}function Oe(e,t){if(1&e&&(W.j41(0,"button",55),W.EFF(1),W.nI1(2,"i18n"),W.k0s()),2&e){const e=W.XpG();W.Y8G("bitAction",e.revoke)("disabled",e.loading),W.R7$(),W.SpI(" ",W.bMT(2,3,"revoke")," ")}}function Je(e,t){if(1&e&&(W.j41(0,"button",56),W.EFF(1),W.nI1(2,"i18n"),W.k0s()),2&e){const e=W.XpG();W.Y8G("bitAction",e.remove)("disabled",e.loading),W.R7$(),W.SpI(" ",W.bMT(2,3,"remove")," ")}}function We(e,t){if(1&e&&(W.j41(0,"button",56),W.EFF(1),W.nI1(2,"i18n"),W.k0s()),2&e){const e=W.XpG();W.Y8G("bitAction",e.delete)("disabled",e.loading),W.R7$(),W.SpI(" ",W.bMT(2,3,"delete")," ")}}var Qe,Le;!function(e){e[e.Role=0]="Role",e[e.Groups=1]="Groups",e[e.Collections=2]="Collections"}(Qe||(Qe={})),function(e){e.Saved="saved",e.Canceled="canceled",e.Deleted="deleted",e.Revoked="revoked",e.Restored="restored"}(Le||(Le={}));class qe{get isExternalIdVisible(){var e;return!!(null===(e=this.formGroup.get("externalId"))||void 0===e?void 0:e.value)}get isSsoExternalIdVisible(){var e;return!!(null===(e=this.formGroup.get("ssoExternalId"))||void 0===e?void 0:e.value)}get customUserTypeSelected(){return this.formGroup.value.type===j.D7.Custom}isEditDialogParams(e){return"Edit"===e.kind}constructor(e,t,i,n,s,r,o,c,l,u,d,h,p,m,g){let b;this.params=e,this.dialogRef=t,this.i18nService=i,this.formBuilder=n,this.collectionAdminService=s,this.groupService=r,this.userService=o,this.organizationUserApiService=c,this.dialogService=l,this.accountService=u,this.toastService=h,this.configService=p,this.deleteManagedMemberWarningService=m,this.organizationUserService=g,this.loading=!0,this.editMode=!1,this.isRevoked=!1,this.access="selected",this.collections=[],this.organizationUserType=j.D7,this.PermissionMode=V.ZC,this.showNoMasterPasswordWarning=!1,this.collectionAccessItems=[],this.groupAccessItems=[],this.formGroup=this.formBuilder.group({emails:[""],type:j.D7.User,externalId:this.formBuilder.control({value:"",disabled:!0}),ssoExternalId:this.formBuilder.control({value:"",disabled:!0}),accessSecretsManager:!1,access:[[]],groups:[[]]}),this.permissionsGroup=this.formBuilder.group({manageAllCollectionsGroup:this.formBuilder.group({manageAllCollections:!1,createNewCollections:!1,editAnyCollection:!1,deleteAnyCollection:!1}),accessEventLogs:!1,accessImportExport:!1,accessReports:!1,manageGroups:!1,manageSso:!1,managePolicies:!1,manageUsers:!1,manageResetPassword:!1}),this.destroy$=new k.B,this.submit=()=>ye(this,void 0,void 0,function*(){if(this.formGroup.markAllAsTouched(),this.formGroup.invalid)return void(this.tabIndex!==Qe.Role&&this.toastService.showToast({variant:"error",title:null,message:this.i18nService.t("fieldOnTabRequiresAttention",this.i18nService.t("role"))}));const e=yield(0,R._)(this.organization$);if(!e.useCustomPermissions&&this.customUserTypeSelected)return void this.toastService.showToast({variant:"error",title:null,message:this.i18nService.t("customNonEnterpriseError")});const t=yield this.getUserView();this.isEditDialogParams(this.params)?yield this.handleEditUser(t,this.params):yield this.handleInviteUsers(t,e)}),this.remove=()=>ye(this,void 0,void 0,function*(){if(!this.isEditDialogParams(this.params))return;const e=this.params.usesKeyConnector?"removeUserConfirmationKeyConnector":"removeOrgUserConfirmation";let t=yield this.dialogService.openSimpleDialog({title:{key:"removeUserIdAccess",placeholders:[this.params.name]},content:{key:e},type:"warning"});return!!t&&(!(this.showNoMasterPasswordWarning&&(t=yield this.noMasterPasswordConfirmationDialog(this.params.name),!t))&&(yield this.organizationUserApiService.removeOrganizationUser(this.params.organizationId,this.params.organizationUserId),this.toastService.showToast({variant:"success",title:null,message:this.i18nService.t("removedUserId",this.params.name)}),void this.close(Le.Deleted)))}),this.revoke=()=>ye(this,void 0,void 0,function*(){if(!this.isEditDialogParams(this.params))return;let e=yield this.dialogService.openSimpleDialog({title:{key:"revokeUserId",placeholders:[this.params.name]},content:{key:"revokeUserConfirmation"},acceptButtonText:{key:"revokeAccess"},type:"warning"});return!!e&&(!(this.showNoMasterPasswordWarning&&(e=yield this.noMasterPasswordConfirmationDialog(this.params.name),!e))&&(yield this.organizationUserApiService.revokeOrganizationUser(this.params.organizationId,this.params.organizationUserId),this.toastService.showToast({variant:"success",title:null,message:this.i18nService.t("revokedUserId",this.params.name)}),this.isRevoked=!0,void this.close(Le.Revoked)))}),this.restore=()=>ye(this,void 0,void 0,function*(){this.isEditDialogParams(this.params)&&(yield(0,R._)((0,w.z)([this.configService.getFeatureFlag$(D.TO.DefaultUserCollectionRestore),this.organization$,this.editParams$]).pipe((0,$.n)(([e,t,i])=>e?this.organizationUserService.restoreUser(t,i.organizationUserId):this.organizationUserApiService.restoreOrganizationUser(i.organizationId,i.organizationUserId)))),this.toastService.showToast({variant:"success",title:null,message:this.i18nService.t("restoredUserId",this.params.name)}),this.isRevoked=!1,this.close(Le.Restored))}),this.delete=()=>ye(this,void 0,void 0,function*(){if(!this.isEditDialogParams(this.params))return;const e=(0,w.z)([this.organization$,this.deleteManagedMemberWarningService.warningAcknowledged(this.params.organizationId)]).pipe((0,M.T)(([e,t])=>e.canManageUsers&&e.productTierType===a.K_.Enterprise&&!t));if(yield(0,R._)(e)){if(!(yield this.deleteManagedMemberWarningService.showWarning()))return}if(!(yield this.dialogService.openSimpleDialog({title:{key:"deleteOrganizationUser",placeholders:[this.params.name]},content:{key:"deleteOrganizationUserWarningDesc",placeholders:[this.params.name]},type:"warning",acceptButtonText:{key:"delete"},cancelButtonText:{key:"cancel"}})))return!1;yield this.organizationUserApiService.deleteOrganizationUser(this.params.organizationId,this.params.organizationUserId),this.toastService.showToast({variant:"success",title:null,message:this.i18nService.t("organizationUserDeleted",this.params.name)}),yield this.deleteManagedMemberWarningService.acknowledgeWarning(this.params.organizationId),this.close(Le.Deleted)}),this.ProductTierType=a.K_,this.organization$=u.activeAccount$.pipe(x.F6,(0,$.n)(e=>d.organizations$(e)),(0,X.Hc)(this.params.organizationId),(0,M.T)(e=>{if(null==e)throw new Error("Organization not found");return e}),(0,F.t)({refCount:!0,bufferSize:1})),this.isEditDialogParams(this.params)?(this.editMode=!0,this.title=this.i18nService.t("editMember"),b=this.userService.get(this.params.organizationId,this.params.organizationUserId),this.tabIndex=this.params.initialTab,this.editParams$=(0,T.of)(this.params)):(this.editMode=!1,this.title=this.i18nService.t("inviteMember"),this.editParams$=(0,T.of)(null),b=(0,T.of)(null),this.tabIndex=Qe.Role),this.isOnSecretsManagerStandalone=this.params.isOnSecretsManagerStandalone,this.isOnSecretsManagerStandalone&&this.formGroup.patchValue({accessSecretsManager:!0});const f=this.organization$.pipe((0,$.n)(e=>e.useGroups?this.groupService.getAllDetails(this.params.organizationId):(0,T.of)([])));this.allowAdminAccessToAllCollectionItems$=this.organization$.pipe((0,M.T)(e=>e.allowAdminAccessToAllCollectionItems)),this.restrictEditingSelf$=(0,w.z)([this.allowAdminAccessToAllCollectionItems$,b,this.accountService.activeAccount$]).pipe((0,M.T)(([e,t,i])=>!e&&null!=t&&t.userId==i.id),(0,F.t)({refCount:!0,bufferSize:1})),this.restrictEditingSelf$.pipe((0,E.Q)(this.destroy$)).subscribe(e=>{e?this.formGroup.controls.groups.disable():this.formGroup.controls.groups.enable()}),this.canAssignAccessToAnyCollection$=(0,w.z)([this.organization$,this.allowAdminAccessToAllCollectionItems$]).pipe((0,M.T)(([e,t])=>e.canEditAnyCollection||e.permissions.manageUsers&&t));const v=this.accountService.activeAccount$.pipe(x.F6,(0,$.n)(e=>this.collectionAdminService.collectionAdminViews$(this.params.organizationId,e)));(0,w.z)({organization:this.organization$,collections:v,userDetails:b,groups:f}).pipe((0,E.Q)(this.destroy$)).subscribe(({organization:e,collections:t,userDetails:i,groups:n})=>{this.setFormValidators(e),this.groupAccessItems=[].concat(n.map(e=>{return t=e,{type:V.Uv.Group,id:t.id,labelName:t.name,listName:t.name};var t})),this.collectionAccessItems=t.map(t=>Ke(t,e,null==i?void 0:t.users.find(e=>e.id===i.id))).filter(e=>!e.readonly||(null==i?void 0:i.collections.some(t=>t.id==e.id))),null!=i&&this.loadOrganizationUser(i,n,t,e),this.loading=!1}),this.remainingSeats$=this.organization$.pipe((0,M.T)(e=>this.isEditDialogParams(this.params)?e.seats:e.seats-this.params.occupiedSeatCount))}setFormValidators(e){if(this.isEditDialogParams(this.params))return;const t=[y.k0.required,O,J(e,e=>this.i18nService.t("tooManyEmails",e)),c(e,this.params.allOrganizationUserEmails,this.i18nService.t("subscriptionUpgrade",e.seats),this.params.occupiedSeatCount)],i=this.formGroup.get("emails");i.setValidators(t),i.updateValueAndValidity()}loadOrganizationUser(e,t,i,n){if(!e)throw new Error("Could not find user to edit.");this.isRevoked=e.status===j.Zx.Revoked,this.showNoMasterPasswordWarning=e.status>j.Zx.Invited&&!1===e.hasMasterPassword;const s={createNewCollections:e.permissions.createNewCollections,editAnyCollection:e.permissions.editAnyCollection,deleteAnyCollection:e.permissions.deleteAnyCollection,manageAllCollections:e.permissions.createNewCollections&&e.permissions.editAnyCollection&&e.permissions.deleteAnyCollection};e.type===j.D7.Custom&&this.permissionsGroup.patchValue({accessEventLogs:e.permissions.accessEventLogs,accessImportExport:e.permissions.accessImportExport,accessReports:e.permissions.accessReports,manageGroups:e.permissions.manageGroups,manageSso:e.permissions.manageSso,managePolicies:e.permissions.managePolicies,manageUsers:e.permissions.manageUsers,manageResetPassword:e.permissions.manageResetPassword,manageAllCollectionsGroup:s});const r=t.filter(t=>e.groups.includes(t.id)).flatMap(e=>e.collections.map(t=>{const n=i.find(e=>e.id===t.id);return{group:e,collection:n,accessSelection:t}}));this.collectionAccessItems=this.collectionAccessItems.concat(r.map(({collection:e,accessSelection:t,group:i})=>Ke(e,n,t,i)));const o=function(e,t){if(null==e)return[];return e.collections.filter(e=>!t.find(t=>t.id==e.id).readonly).map(e=>({id:e.id,type:V.Uv.Collection,permission:(0,V.Jh)(e)}))}(e,this.collectionAccessItems),a=function(e){if(null==e)return[];return[].concat(e.map(e=>({id:e,type:V.Uv.Group})))}(e.groups);this.formGroup.removeControl("emails"),this.formGroup.patchValue({type:e.type,externalId:e.externalId,ssoExternalId:e.ssoExternalId,access:o,accessSecretsManager:e.accessSecretsManager,groups:a})}check(e,t){e.checked=null==t?!e.checked:t,e.checked||(e.readOnly=!1)}selectAll(e){this.collections.forEach(t=>this.check(t,e))}setRequestPermissions(e,t){if(t)return new C.n;const i={accessEventLogs:this.permissionsGroup.value.accessEventLogs,accessImportExport:this.permissionsGroup.value.accessImportExport,accessReports:this.permissionsGroup.value.accessReports,manageGroups:this.permissionsGroup.value.manageGroups,manageSso:this.permissionsGroup.value.manageSso,managePolicies:this.permissionsGroup.value.managePolicies,manageUsers:this.permissionsGroup.value.manageUsers,manageResetPassword:this.permissionsGroup.value.manageResetPassword,createNewCollections:this.permissionsGroup.value.manageAllCollectionsGroup.createNewCollections,editAnyCollection:this.permissionsGroup.value.manageAllCollectionsGroup.editAnyCollection,deleteAnyCollection:this.permissionsGroup.value.manageAllCollectionsGroup.deleteAnyCollection};return Object.assign(e,i)}getUserView(){return ye(this,void 0,void 0,function*(){var e;const t=new P.dc;return t.organizationId=this.params.organizationId,t.type=this.formGroup.value.type,t.permissions=this.setRequestPermissions(null!==(e=t.permissions)&&void 0!==e?e:new C.n,t.type!==j.D7.Custom),t.collections=this.formGroup.value.access.filter(e=>e.type===V.Uv.Collection).map(V.yo),t.groups=(yield(0,R._)(this.restrictEditingSelf$))?null:this.formGroup.value.groups.map(e=>e.id),t.accessSecretsManager=this.formGroup.value.accessSecretsManager,t})}handleEditUser(e,t){return ye(this,void 0,void 0,function*(){e.id=t.organizationUserId,yield this.userService.save(e),this.toastService.showToast({variant:"success",title:null,message:this.i18nService.t("editedUserId",t.name)}),this.close(Le.Saved)})}handleInviteUsers(e,t){return ye(this,void 0,void 0,function*(){const t=[...new Set(this.formGroup.value.emails.trim().split(/\s*,\s*/))];yield this.userService.invite(t,e),this.toastService.showToast({variant:"success",title:null,message:this.i18nService.t("invitedUsers")}),this.close(Le.Saved)})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}cancel(){return ye(this,void 0,void 0,function*(){this.close(Le.Canceled)})}close(e){this.dialogRef.close(e)}noMasterPasswordConfirmationDialog(e){return this.dialogService.openSimpleDialog({title:{key:"removeOrgUserNoMasterPasswordTitle"},content:{key:"removeOrgUserNoMasterPasswordDesc",placeholders:[e]},type:"warning"})}}function Ke(e,t,i,n){return{type:V.Uv.Collection,id:n?`${e.id}-${n.id}`:e.id,labelName:e.name,listName:e.name,readonly:void 0!==n||!e.canEditUserAccess(t),readonlyPermission:i?(0,V.Jh)(i):void 0,viaGroupName:null==n?void 0:n.name}}function _e(e,t){return e.open(qe,t)}qe.ɵfac=function(e){return new(e||qe)(W.rXU(N.Qs),W.rXU(p.ce),W.rXU(h.W),W.rXU(y.ok),W.rXU(G.vE),W.rXU(P.nK),W.rXU(P.WW),W.rXU(G.uB),W.rXU(p.o3),W.rXU(Q.D),W.rXU(U.PV),W.rXU(m.f),W.rXU(L.w),W.rXU(Y),W.rXU(G.Ki))},qe.ɵcmp=W.VBU({type:qe,selectors:[["ng-component"]],standalone:!1,decls:25,vars:28,consts:[["enterprise",""],[3,"formGroup","bitSubmit"],["dialogSize","large",3,"disablePadding"],["bitDialogTitle",""],["class","tw-text-sm tw-normal-case tw-text-muted",4,"ngIf"],["bitBadge","","variant","secondary",4,"ngIf"],["bitDialogContent",""],[4,"ngIf"],[3,"selectedIndex","selectedIndexChange",4,"ngIf"],["bitDialogFooter",""],["type","submit","bitButton","","bitFormButton","","buttonType","primary",3,"disabled"],["type","button","bitButton","","bitFormButton","","buttonType","secondary",3,"click","disabled"],[1,"tw-flex","tw-gap-2","tw-ml-auto"],["type","button","bitButton","","bitFormButton","","buttonType","secondary",3,"bitAction","disabled",4,"ngIf"],["type","button","buttonType","danger","bitButton","","bitFormButton","",3,"bitAction","disabled",4,"ngIf"],[1,"tw-text-sm","tw-normal-case","tw-text-muted"],["bitBadge","","variant","secondary"],["aria-hidden","true",1,"bwi","bwi-spinner","bwi-spin","tw-text-muted",3,"title"],[1,"tw-sr-only"],[3,"selectedIndexChange","selectedIndex"],[3,"label"],["formControlName","type"],["bitLink","","target","_blank","rel","noreferrer","href","https://bitwarden.com/help/user-types-access-control/","slot","end",3,"appA11yTitle"],["aria-hidden","true",1,"bwi","bwi-question-circle"],["id","userTypeUser",3,"value"],["id","userTypeAdmin",3,"value"],["id","userTypeOwner",3,"value"],["id","userTypeCustom",3,"value","disabled"],[4,"ngIf","ngIfElse"],[3,"label",4,"ngIf"],["class","tw-mb-6",4,"ngIf"],["formControlName","access",3,"permissionMode","showGroupColumn","items","columnHeader","selectorLabelText","emptySelectionText","hideMultiSelect"],["bitTypography","body1"],["id","emails","type","text","appAutoFocus","","bitInput","","formControlName","emails"],["bitLink","","href","https://bitwarden.com/contact/","target","_blank","rel","noreferrer"],[1,"tw-grid","tw-grid-cols-12","tw-gap-4",3,"formGroup"],[1,"tw-col-span-4"],["type","checkbox","bitCheckbox","","formControlName","accessEventLogs"],["type","checkbox","bitCheckbox","","formControlName","accessImportExport"],["type","checkbox","bitCheckbox","","formControlName","accessReports"],["parentId","manageAllCollections",3,"checkboxes"],[1,"tw-mb-3"],["type","checkbox","bitCheckbox","","formControlName","manageGroups"],["type","checkbox","bitCheckbox","","formControlName","manageSso"],["type","checkbox","bitCheckbox","","formControlName","managePolicies"],["id","manageUsers","type","checkbox","bitCheckbox","","formControlName","manageUsers"],["type","checkbox","bitCheckbox","","formControlName","manageResetPassword"],[1,"tw-mt-4"],["bitLink","","target","_blank","rel","noreferrer","href","https://bitwarden.com/help/manage-your-organization/#access-to-secrets-manager",3,"appA11yTitle"],[1,"tw-text-muted"],["type","checkbox","bitCheckbox","","formControlName","accessSecretsManager",3,"disabled"],["bitInput","","type","text","formControlName","externalId"],["bitInput","","type","text","formControlName","ssoExternalId"],[1,"tw-mb-6"],["formControlName","groups",3,"items","columnHeader","selectorLabelText","emptySelectionText","hideMultiSelect"],["type","button","bitButton","","bitFormButton","","buttonType","secondary",3,"bitAction","disabled"],["type","button","buttonType","danger","bitButton","","bitFormButton","",3,"bitAction","disabled"]],template:function(e,t){if(1&e&&(W.j41(0,"form",1)(1,"bit-dialog",2)(2,"span",3),W.EFF(3),W.DNE(4,Re,3,3,"span",4),W.nI1(5,"async"),W.DNE(6,we,3,3,"span",5),W.k0s(),W.j41(7,"div",6),W.DNE(8,$e,6,7,"ng-container",7)(9,Be,57,71,"bit-tab-group",8),W.nI1(10,"async"),W.k0s(),W.qex(11,9),W.j41(12,"button",10),W.EFF(13),W.nI1(14,"i18n"),W.k0s(),W.j41(15,"button",11),W.bIt("click",function(){return t.cancel()}),W.EFF(16),W.nI1(17,"i18n"),W.k0s(),W.j41(18,"div",12),W.DNE(19,Ye,3,5,"button",13)(20,Oe,3,5,"button",13)(21,Je,3,5,"button",14),W.nI1(22,"async"),W.DNE(23,We,3,5,"button",14),W.nI1(24,"async"),W.k0s(),W.bVm(),W.k0s()()),2&e){let e,i,n;W.Y8G("formGroup",t.formGroup)("bitSubmit",t.submit),W.R7$(),W.Y8G("disablePadding",!t.loading),W.R7$(2),W.SpI(" ",t.title," "),W.R7$(),W.Y8G("ngIf",!t.loading&&t.editParams$&&(null==(e=W.bMT(5,16,t.editParams$))?null:e.name)),W.R7$(2),W.Y8G("ngIf",t.isRevoked),W.R7$(2),W.Y8G("ngIf",t.loading),W.R7$(),W.Y8G("ngIf",W.bMT(10,18,!t.loading&&t.organization$)),W.R7$(3),W.Y8G("disabled",t.loading),W.R7$(),W.SpI(" ",W.bMT(14,20,"save")," "),W.R7$(2),W.Y8G("disabled",t.loading),W.R7$(),W.SpI(" ",W.bMT(17,22,"cancel")," "),W.R7$(3),W.Y8G("ngIf",t.editMode&&t.isRevoked),W.R7$(),W.Y8G("ngIf",t.editMode&&!t.isRevoked),W.R7$(),W.Y8G("ngIf",t.editMode&&!(null!=(i=W.bMT(22,24,t.editParams$))&&i.managedByOrganization)),W.R7$(2),W.Y8G("ngIf",t.editMode&&(null==(n=W.bMT(24,26,t.editParams$))?null:n.managedByOrganization))}},dependencies:[q.bT,y.qT,y.me,y.Zm,y.BC,y.cb,y.j4,y.JD,K.C,_.p,H.$,Z.L,ee.n,te.Q,ie.P,ne.m,se.f,re.j,oe.I,ae.J,ce.h,le.g,ue.d,de.Y,he.W,pe.j,me.r,ge.t,Ie,q.Jj,fe.$],encapsulation:2});var He=i(8297);class Ze{}Ze.ɵfac=function(e){return new(e||Ze)},Ze.ɵmod=W.$C({type:Ze}),Ze.ɵinj=d.G2t({imports:[I.R,He.K]});var et=i(6056),tt=i(28756),it=i(83731),nt=i(20246),st=i(39306),rt=i(56962),ot=i(22848),at=i(58625),ct=i(29029),lt=i(81573),ut=i(26411),dt=i(12012),ht=i(89105),pt=i(65963),mt=i(7730),gt=function(e,t,i,n){return new(i||(i=Promise))(function(s,r){function o(e){try{c(n.next(e))}catch(t){r(t)}}function a(e){try{c(n.throw(e))}catch(t){r(t)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(o,a)}c((n=n.apply(e,t||[])).next())})};class bt{constructor(e,t,i,n,s,r,o,a){var c;this.dialogRef=e,this.formBuilder=t,this.i18nService=i,this.organizationUserApiService=n,this.toastService=s,this.apiService=r,this.encryptService=o,this.dialogParams=a,this.loading=!1,this.organizationId=null===(c=this.dialogParams)||void 0===c?void 0:c.organizationId,this.organizationKey=this.dialogParams.organizationKey,this.sponsorshipForm=this.formBuilder.group({sponsorshipEmail:new y.MJ("",{validators:[y.k0.email,y.k0.required],asyncValidators:[this.isOrganizationMember.bind(this)],updateOn:"change"}),sponsorshipNote:new y.MJ("",{validators:[y.k0.maxLength(1e3)]})})}static open(e,t){return e.open(bt,Object.assign(Object.assign({},t),{data:t.data}))}save(){return gt(this,void 0,void 0,function*(){if(this.sponsorshipEmailControl.markAllAsTouched(),!this.sponsorshipForm.invalid){this.loading=!0;try{const e=this.sponsorshipForm.value.sponsorshipNote||"",t=this.sponsorshipForm.value.sponsorshipEmail||"",i=yield this.encryptService.encryptString(e,this.organizationKey),n=!0;yield this.apiService.postCreateSponsorship(this.organizationId,{sponsoredEmail:t,planSponsorshipType:a.MM.FamiliesForEnterprise,friendlyName:t,isAdminInitiated:n,notes:i.encryptedString}),this.toastService.showToast({variant:"success",title:void 0,message:this.i18nService.t("sponsorshipCreated")}),yield this.resetForm()}catch(e){this.toastService.showToast({variant:"error",title:this.i18nService.t("errorOccurred"),message:(null==e?void 0:e.message)||this.i18nService.t("unexpectedError")})}this.loading=!1,this.dialogRef.close()}})}resetForm(){return gt(this,void 0,void 0,function*(){this.sponsorshipForm.reset()})}get sponsorshipEmailControl(){return this.sponsorshipForm.controls.sponsorshipEmail}get sponsorshipNoteControl(){return this.sponsorshipForm.controls.sponsorshipNote}isOrganizationMember(e){return gt(this,void 0,void 0,function*(){const t=e.value;return(yield this.organizationUserApiService.getAllMiniUserDetails(this.organizationId)).data.some(e=>e.email.toLowerCase()===t.toLowerCase())?{isOrganizationMember:{message:this.i18nService.t("organizationHasMemberMessage",t)}}:null})}}bt.ɵfac=function(e){return new(e||bt)(W.rXU(p.ce),W.rXU(y.ok),W.rXU(h.W),W.rXU(G.uB),W.rXU(m.f),W.rXU(dt.G),W.rXU(ht.N),W.rXU(N.Qs))},bt.ɵcmp=W.VBU({type:bt,selectors:[["ng-component"]],decls:27,vars:21,consts:[["bitDialogTitle",""],["bitDialogContent",""],[3,"formGroup"],[1,"tw-grid","tw-grid-cols-12","tw-gap-4"],[1,"tw-col-span-12"],["bitInput","","inputmode","email","formControlName","sponsorshipEmail","appInputStripSpaces",""],["bitInput","","inputmode","text","formControlName","sponsorshipNote"],["bitDialogFooter",""],["bitButton","","bitFormButton","","type","button","buttonType","primary",3,"click","loading","disabled"],["bitButton","","type","button","buttonType","secondary",3,"bitDialogClose"]],template:function(e,t){1&e&&(W.j41(0,"form")(1,"bit-dialog")(2,"span",0),W.EFF(3),W.nI1(4,"i18n"),W.k0s(),W.j41(5,"div",1)(6,"form",2)(7,"div",3)(8,"div",4)(9,"bit-form-field")(10,"bit-label"),W.EFF(11),W.nI1(12,"i18n"),W.k0s(),W.nrm(13,"input",5),W.k0s()(),W.j41(14,"div",4)(15,"bit-form-field")(16,"bit-label"),W.EFF(17),W.nI1(18,"i18n"),W.k0s(),W.nrm(19,"input",6),W.k0s()()()()(),W.qex(20,7),W.j41(21,"button",8),W.bIt("click",function(){return t.save()}),W.EFF(22),W.nI1(23,"i18n"),W.k0s(),W.j41(24,"button",9),W.EFF(25),W.nI1(26,"i18n"),W.k0s(),W.bVm(),W.k0s()()),2&e&&(W.R7$(3),W.JRh(W.bMT(4,11,"addSponsorship")),W.R7$(3),W.Y8G("formGroup",t.sponsorshipForm),W.R7$(5),W.JRh(W.bMT(12,13,"email")),W.R7$(2),W.BMQ("aria-invalid",t.sponsorshipEmailControl.invalid),W.R7$(4),W.JRh(W.bMT(18,15,"notes")),W.R7$(2),W.BMQ("aria-invalid",t.sponsorshipNoteControl.invalid),W.R7$(2),W.Y8G("loading",t.loading)("disabled",t.loading),W.R7$(),W.SpI(" ",W.bMT(23,17,"save")," "),W.R7$(2),W.Y8G("bitDialogClose",!1),W.R7$(),W.SpI(" ",W.bMT(26,19,"cancel")," "))},dependencies:[at.p,pt.J,ct.t,te.Q,lt.P,mt.I,ne.m,y.YN,y.qT,y.me,y.BC,y.cb,y.cV,y.X1,y.j4,y.JD,ut.L,re.j,ae.J,ce.h,fe.$],encapsulation:2});var ft=i(37115),vt=i(304),St=i(10672),It=i(36288),yt=i(13496),kt=i(53997),Rt=i(78952),wt=i(38410),$t=i(22466),Mt=i(36572),Ft=i(93748),Tt=function(e,t,i,n){return new(i||(i=Promise))(function(s,r){function o(e){try{c(n.next(e))}catch(t){r(t)}}function a(e){try{c(n.throw(e))}catch(t){r(t)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(o,a)}c((n=n.apply(e,t||[])).next())})};function Et(e,t){1&e&&(W.qex(0),W.nrm(1,"i",8),W.nI1(2,"i18n"),W.j41(3,"span",9),W.EFF(4),W.nI1(5,"i18n"),W.k0s(),W.bVm()),2&e&&(W.R7$(),W.Y8G("title",W.mNQ(W.bMT(2,3,"loading"))),W.R7$(3),W.JRh(W.bMT(5,5,"loading")))}function Gt(e,t){if(1&e){const e=W.RV6();W.j41(0,"button",18),W.nI1(1,"i18n"),W.bIt("click",function(){d.eBV(e);const t=W.XpG().$implicit,i=W.XpG(3);return d.Njj(i.resendEmail(t))}),W.nrm(2,"i",21),W.EFF(3),W.nI1(4,"i18n"),W.k0s()}2&e&&(W.BMQ("aria-label",W.bMT(1,2,"resendEmailLabel")),W.R7$(3),W.SpI(" ",W.bMT(4,4,"resendInvitation")," "))}function Ut(e,t){1&e&&W.nrm(0,"hr",17)}function jt(e,t){if(1&e){const e=W.RV6();W.qex(0),W.j41(1,"tr",14)(2,"td",11),W.EFF(3),W.k0s(),W.j41(4,"td",11),W.EFF(5),W.k0s(),W.j41(6,"td",11),W.EFF(7),W.k0s(),W.j41(8,"td",11),W.nrm(9,"button",15),W.nI1(10,"i18n"),W.j41(11,"bit-menu",null,0),W.nVh(13,Gt,5,6,"button",16),W.nVh(14,Ut,1,0,"hr",17),W.j41(15,"button",18),W.nI1(16,"i18n"),W.bIt("click",function(){const t=d.eBV(e).$implicit,i=W.XpG(3);return d.Njj(i.removeSponsorship(t))}),W.nrm(17,"i",19),W.j41(18,"span",20),W.EFF(19),W.nI1(20,"i18n"),W.k0s()()()()(),W.bVm()}if(2&e){const e=t.$implicit,i=W.sdS(12),n=W.XpG(3);W.R7$(3),W.JRh(e.friendlyName),W.R7$(),W.HbH(e.statusClass),W.R7$(),W.SpI(" ",e.statusMessage," "),W.R7$(2),W.JRh(e.notes),W.R7$(2),W.Y8G("label",W.mNQ(W.bMT(10,12,"options")))("bitMenuTriggerFor",i),W.R7$(4),W.vxM(n.isSelfHosted||e.validUntil?-1:13),W.R7$(),W.vxM(n.isSelfHosted||e.validUntil?-1:14),W.R7$(),W.BMQ("aria-label",W.bMT(16,14,"revokeAccountMessage")),W.R7$(4),W.JRh(W.bMT(20,16,"remove"))}}function Ct(e,t){if(1&e&&W.Z7z(0,jt,21,18,"ng-container",null,W.Vm6),2&e){const e=W.XpG(2);W.Dyx(e.sponsoredFamilies)}}function xt(e,t){1&e&&(W.qex(0),W.j41(1,"bit-table"),W.qex(2,10),W.j41(3,"tr")(4,"th",11),W.EFF(5),W.nI1(6,"i18n"),W.k0s(),W.j41(7,"th",11),W.EFF(8),W.nI1(9,"i18n"),W.k0s(),W.j41(10,"th",11),W.EFF(11),W.nI1(12,"i18n"),W.k0s(),W.nrm(13,"th",11),W.k0s(),W.bVm(),W.DNE(14,Ct,2,0,"ng-template",12),W.k0s(),W.nrm(15,"hr",13),W.bVm()),2&e&&(W.R7$(5),W.JRh(W.bMT(6,3,"recipient")),W.R7$(3),W.JRh(W.bMT(9,5,"status")),W.R7$(3),W.JRh(W.bMT(12,7,"notes")))}function Dt(e,t){1&e&&(W.j41(0,"div",6),W.nrm(1,"img",22),W.j41(2,"h4",23),W.EFF(3),W.nI1(4,"i18n"),W.k0s(),W.j41(5,"p",7),W.EFF(6),W.nI1(7,"i18n"),W.k0s()()),2&e&&(W.R7$(3),W.JRh(W.bMT(4,2,"noSponsoredFamiliesMessage")),W.R7$(3),W.JRh(W.bMT(7,4,"nosponsoredFamiliesDetails")))}function Xt(e,t){1&e&&(W.j41(0,"p",7),W.EFF(1),W.nI1(2,"i18n"),W.k0s()),2&e&&(W.R7$(),W.JRh(W.bMT(2,1,"sponsoredFamiliesRemoveActiveSponsorship")))}class Nt{constructor(e,t,i,n,s,r,o,a,c,l,u){this.route=e,this.dialogService=t,this.apiService=i,this.encryptService=n,this.keyService=s,this.platformUtilsService=r,this.i18nService=o,this.logService=a,this.toastService=c,this.organizationSponsorshipApiService=l,this.stateProvider=u,this.loading=(0,d.vPA)(!0),this.tabIndex=0,this.sponsoredFamilies=[],this.organizationId="",this.locale="",this.organizationId=this.route.snapshot.params.organizationId||"",this.organizationKey$=this.stateProvider.activeUserId$.pipe((0,$.n)(e=>this.keyService.orgKeys$(e)),(0,M.T)(e=>e[this.organizationId]),(0,it.pQ)())}ngOnInit(){return Tt(this,void 0,void 0,function*(){this.locale=yield(0,R._)(this.i18nService.locale$),yield this.loadSponsorships(),this.loading.set(!1)})}loadSponsorships(){return Tt(this,void 0,void 0,function*(){if(!this.organizationId)return;const[e,t]=yield Promise.all([this.organizationSponsorshipApiService.getOrganizationSponsorship(this.organizationId),(0,R._)(this.organizationKey$)]);if(!t)return void this.logService.error("Organization key not found");const i=e.data;this.sponsoredFamilies=yield Promise.all(i.map(e=>Tt(this,void 0,void 0,function*(){let i="";try{i=yield this.encryptService.decryptString(new st.k(e.notes),t)}catch(o){this.logService.error(o)}const{statusMessage:n,statusClass:s}=this.getStatus(this.isSelfHosted,e.toDelete,e.validUntil,e.lastSyncDate,this.locale),r=Object.assign(Object.assign({},e),{notes:i,statusMessage:n||"",statusClass:s||"tw-text-success",status:n||""});return new nt.B(r)})))})}addSponsorship(){return Tt(this,void 0,void 0,function*(){const e=bt.open(this.dialogService,{data:{organizationId:this.organizationId,organizationKey:yield(0,R._)(this.organizationKey$)}});yield(0,R._)(e.closed),yield this.loadSponsorships()})}removeSponsorship(e){return Tt(this,void 0,void 0,function*(){try{yield this.doRevokeSponsorship(e)}catch(t){this.logService.error(t)}})}get isSelfHosted(){return this.platformUtilsService.isSelfHost()}resendEmail(e){return Tt(this,void 0,void 0,function*(){yield this.organizationSponsorshipApiService.postResendSponsorshipOffer(this.organizationId,e.friendlyName),this.toastService.showToast({variant:"success",title:void 0,message:this.i18nService.t("emailSent")})})}doRevokeSponsorship(e){return Tt(this,void 0,void 0,function*(){const t=e.validUntil?this.i18nService.t("revokeActiveSponsorshipConfirmation",e.friendlyName,(0,q.Yq)(e.validUntil,"MM/dd/yyyy",this.locale)):this.i18nService.t("updatedRevokeSponsorshipConfirmationForSentSponsorship",e.friendlyName);(yield this.dialogService.openSimpleDialog({title:`${this.i18nService.t("removeSponsorship")}?`,content:t,acceptButtonText:{key:"remove"},type:"warning"}))&&(yield this.organizationSponsorshipApiService.deleteAdminInitiatedRevokeSponsorship(this.organizationId,e.friendlyName),this.toastService.showToast({variant:"success",title:void 0,message:this.i18nService.t("reclaimedFreePlan")}),yield this.loadSponsorships())})}getStatus(e,t,i,n,s=""){return t&&i?{statusMessage:this.i18nService.t("revokeWhenExpired",(0,q.Yq)(i,"MM/dd/yyyy",s)),statusClass:"tw-text-danger"}:t?{statusMessage:this.i18nService.t("requestRemoved"),statusClass:"tw-text-danger"}:i?{statusMessage:this.i18nService.t("active"),statusClass:"tw-text-success"}:e&&n?{statusMessage:this.i18nService.t("sent"),statusClass:"tw-text-success"}:e?{statusMessage:this.i18nService.t("requested"),statusClass:"tw-text-success"}:{statusMessage:this.i18nService.t("sent"),statusClass:"tw-text-success"}}}Nt.ɵfac=function(e){return new(e||Nt)(W.rXU(g.nX),W.rXU(p.o3),W.rXU(dt.G),W.rXU(ht.N),W.rXU(ot.Lu),W.rXU(ft.y),W.rXU(h.W),W.rXU(rt.K),W.rXU(m.f),W.rXU(vt.l),W.rXU(A.v2))},Nt.ɵcmp=W.VBU({type:Nt,selectors:[["app-free-bitwarden-families"]],standalone:!1,decls:27,vars:21,consts:[["appListDropdown",""],["type","button","bitButton","","buttonType","primary",3,"click"],["aria-hidden","true",1,"bwi","bwi-plus","bwi-fw"],["bitTypography","body1"],[1,"tw-list-outside"],["bitTypography","h2",1,""],[1,"tw-my-5","tw-py-5","tw-flex","tw-flex-col","tw-items-center"],["bitTypography","body2"],[1,"bwi","bwi-spinner","bwi-spin","tw-text-muted",3,"title"],[1,"tw-sr-only"],["header",""],["bitCell",""],["body","","alignContent","middle"],[1,"tw-mt-0"],["bitRow",""],["type","button","bitIconButton","bwi-ellipsis-v","buttonType","main",3,"bitMenuTriggerFor","label"],["type","button","bitMenuItem",""],[1,"tw-m-0"],["type","button","bitMenuItem","",3,"click"],["aria-hidden","true",1,"bwi","bwi-close","tw-text-danger"],[1,"tw-text-danger","tw-pl-1"],["aria-hidden","true",1,"bwi","bwi-envelope"],["src","./../../../images/search.svg","alt","Search",1,"tw-w-32"],["bitTypography","h4",1,"tw-mt-3"]],template:function(e,t){1&e&&(W.j41(0,"app-header")(1,"button",1),W.bIt("click",function(){return t.addSponsorship()}),W.nrm(2,"i",2),W.EFF(3),W.nI1(4,"i18n"),W.k0s()(),W.j41(5,"bit-container"),W.qex(6),W.j41(7,"p",3),W.EFF(8),W.nI1(9,"i18n"),W.k0s(),W.j41(10,"div",3),W.EFF(11),W.nI1(12,"i18n"),W.j41(13,"ul",4)(14,"li"),W.EFF(15),W.nI1(16,"i18n"),W.k0s(),W.j41(17,"li"),W.EFF(18),W.nI1(19,"i18n"),W.k0s()()(),W.j41(20,"h2",5),W.EFF(21),W.nI1(22,"i18n"),W.k0s(),W.nVh(23,Et,6,7,"ng-container"),W.nVh(24,xt,16,9,"ng-container")(25,Dt,8,6,"div",6),W.nVh(26,Xt,3,3,"p",7),W.bVm(),W.k0s()),2&e&&(W.R7$(3),W.SpI(" ",W.bMT(4,9,"addSponsorship")," "),W.R7$(5),W.SpI(" ",W.bMT(9,11,"sponsorshipFreeBitwardenFamilies")," "),W.R7$(3),W.SpI(" ",W.bMT(12,13,"sponsoredFamiliesIncludeMessage"),": "),W.R7$(4),W.JRh(W.bMT(16,15,"sponsoredFamiliesPremiumAccess")),W.R7$(3),W.JRh(W.bMT(19,17,"sponsoredFamiliesSharedCollectionsForFamilyMembers")),W.R7$(3),W.JRh(W.bMT(22,19,"sponsoredBitwardenFamilies")),W.R7$(2),W.vxM(t.loading()?23:-1),W.R7$(),W.vxM(!t.loading()&&(null==t.sponsoredFamilies?null:t.sponsoredFamilies.length)>0?24:t.loading()?-1:25),W.R7$(2),W.vxM(!t.loading()&&t.sponsoredFamilies.length>0?26:-1))},dependencies:[te.Q,St.H,It.s,yt.Z,kt.O,Rt.S,wt.Q,$t.Y,Mt._,Mt.O,me.r,Ft.f,fe.$],encapsulation:2});var Pt=i(77259),Vt=i(69194),At=i(33189),zt=function(e,t,i,n){return new(i||(i=Promise))(function(s,r){function o(e){try{c(n.next(e))}catch(t){r(t)}}function a(e){try{c(n.throw(e))}catch(t){r(t)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(o,a)}c((n=n.apply(e,t||[])).next())})};var Bt=i(33277),Yt=i(73276),Ot=i(84079),Jt=i(83892),Wt=i(58363),Qt=i(90171),Lt=i(38449),qt=i(29377),Kt=i(27760),_t=i(16878),Ht=i(36006),Zt=i(12277),ei=i(25065),ti=i(35631),ii=function(e,t,i,n){return new(i||(i=Promise))(function(s,r){function o(e){try{c(n.next(e))}catch(t){r(t)}}function a(e){try{c(n.throw(e))}catch(t){r(t)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(o,a)}c((n=n.apply(e,t||[])).next())})};class ni{constructor(e,t,i,n,s,r){this.data=e,this.dialogRef=t,this.keyService=i,this.logService=n,this.organizationManagementPreferencesService=s,this.configService=r,this.loading=!0,this.formGroup=new y.gE({dontAskAgain:new y.MJ(!1)}),this.submit=()=>ii(this,void 0,void 0,function*(){if(this.loading)return!1;this.formGroup.value.dontAskAgain&&(yield this.organizationManagementPreferencesService.autoConfirmFingerPrints.set(!0));(yield(0,R._)(this.configService.getFeatureFlag$(D.TO.MembersComponentRefactor)))||(yield this.data.confirmUser(this.publicKey)),this.dialogRef.close(!0)}),this.name=e.name,this.userId=e.userId,this.publicKey=e.publicKey}ngOnInit(){return ii(this,void 0,void 0,function*(){try{if(null!=this.publicKey){const e=yield this.keyService.getFingerprint(this.userId,this.publicKey);null!=e&&(this.fingerprint=e.join("-"))}}catch(e){this.logService.error(e)}this.loading=!1})}static open(e,t){return e.open(ni,t)}}ni.ɵfac=function(e){return new(e||ni)(W.rXU(N.Qs),W.rXU(p.ce),W.rXU(ot.Lu),W.rXU(rt.K),W.rXU(ti.y),W.rXU(L.w))},ni.ɵcmp=W.VBU({type:ni,selectors:[["ng-component"]],decls:29,vars:22,consts:[[3,"formGroup","bitSubmit"],["dialogSize","default"],["bitDialogTitle",""],["bitTypography","body1",1,"tw-text-muted"],["bitDialogContent",""],["bitTypography","body1"],["bitLink","","href","https://bitwarden.com/help/fingerprint-phrase/","target","_blank","rel","noreferrer"],["type","checkbox","bitCheckbox","","formControlName","dontAskAgain"],["bitDialogFooter",""],["bitButton","","bitFormButton","","type","submit","buttonType","primary"],["bitButton","","bitFormButton","","type","button","buttonType","secondary","bitDialogClose",""]],template:function(e,t){1&e&&(W.j41(0,"form",0)(1,"bit-dialog",1)(2,"span",2),W.EFF(3),W.nI1(4,"i18n"),W.j41(5,"span",3),W.EFF(6),W.k0s()(),W.qex(7,4),W.j41(8,"p",5),W.EFF(9),W.nI1(10,"i18n"),W.j41(11,"a",6),W.EFF(12),W.nI1(13,"i18n"),W.k0s()(),W.j41(14,"p",5)(15,"code"),W.EFF(16),W.k0s()(),W.j41(17,"bit-form-control"),W.nrm(18,"input",7),W.j41(19,"bit-label"),W.EFF(20),W.nI1(21,"i18n"),W.k0s()(),W.bVm(),W.qex(22,8),W.j41(23,"button",9),W.EFF(24),W.nI1(25,"i18n"),W.k0s(),W.j41(26,"button",10),W.EFF(27),W.nI1(28,"i18n"),W.k0s(),W.bVm(),W.k0s()()),2&e&&(W.Y8G("formGroup",t.formGroup)("bitSubmit",t.submit),W.R7$(3),W.SpI(" ",W.bMT(4,10,"confirmUser")," "),W.R7$(3),W.JRh(t.name),W.R7$(3),W.SpI(" ",W.bMT(10,12,"fingerprintEnsureIntegrityVerify")," "),W.R7$(3),W.SpI(" ",W.bMT(13,14,"learnMore")),W.R7$(4),W.JRh(t.fingerprint),W.R7$(4),W.JRh(W.bMT(21,16,"dontAskFingerprintAgain")),W.R7$(4),W.SpI(" ",W.bMT(25,18,"confirm")," "),W.R7$(3),W.SpI(" ",W.bMT(28,20,"cancel")," "))},dependencies:[ei.G,y.qT,y.Zm,y.BC,y.cb,y.j4,y.JD,H.$,Z.L,te.Q,ie.P,mt.I,ne.m,se.f,re.j,le.g,me.r,fe.$],encapsulation:2});var si=i(55542);const ri=500,oi=8e3;function ai(e,t){return i=>function(e,t){return null==t?e.status!=j.Zx.Revoked:e.status===t}(i,t)&&function(e,t){var i;const n=null==t?void 0:t.toLowerCase();return!n||e.email.toLowerCase().includes(n)||e.id.toLowerCase().includes(n)||(null===(i=e.name)||void 0===i?void 0:i.toLowerCase().includes(n))}(i,e)}class ci extends si.s{constructor(e){super(),this.checkedUsersUpdated$=new k.B,this.isIncreasedBulkLimitEnabled=(0,it.ot)(e.environment$.pipe((0,M.T)(e=>e.isCloud())))}set data(e){var t,i,n,s,r,o,a,c,l,u;super.data=e,this.activeUserCount=null!==(i=null===(t=this.data)||void 0===t?void 0:t.filter(e=>e.status!==this.statusType.Revoked).length)&&void 0!==i?i:0,this.invitedUserCount=null!==(s=null===(n=this.data)||void 0===n?void 0:n.filter(e=>e.status===this.statusType.Invited).length)&&void 0!==s?s:0,this.acceptedUserCount=null!==(o=null===(r=this.data)||void 0===r?void 0:r.filter(e=>e.status===this.statusType.Accepted).length)&&void 0!==o?o:0,this.confirmedUserCount=null!==(c=null===(a=this.data)||void 0===a?void 0:a.filter(e=>e.status===this.statusType.Confirmed).length)&&void 0!==c?c:0,this.revokedUserCount=null!==(u=null===(l=this.data)||void 0===l?void 0:l.filter(e=>e.status===this.statusType.Revoked).length)&&void 0!==u?u:0,this.checkedUsersUpdated$.next()}get data(){return super.data}checkUser(e,t){this.setUserChecked(e,t),this.checkedUsersUpdated$.next()}setUserChecked(e,t){e.checked=null==t?!e.checked:t}getCheckedUsers(){return this.data.filter(e=>e.checked)}usersUpdated(){return this.checkedUsersUpdated$.asObservable().pipe((0,M.T)(()=>this.getCheckedUsers()))}getCheckedUsersInVisibleOrder(){return this.filteredData.filter(e=>e.checked)}checkAllFilteredUsers(e){e&&this.uncheckAllUsers();const t=this.filteredData,i=this.isIncreasedBulkLimitEnabled()?t.length:Math.min(t.length,ri);for(let n=0;n<i;n++)this.setUserChecked(t[n],e);this.checkedUsersUpdated$.next()}uncheckAllUsers(){this.data.forEach(e=>e.checked=!1)}removeUser(e){this.data=this.data.filter(t=>t!=e)}replaceUser(e){const t=this.data.findIndex(t=>t.id===e.id);if(t>-1){const i=this.data.slice();i[t]=e,this.data=i}}limitAndUncheckExcess(e,t){return e.length<=t?e:(e.slice(t).forEach(e=>this.setUserChecked(e,!1)),this.checkedUsersUpdated$.next(),e.slice(0,t))}getCheckedUsersWithLimit(e){if(this.isIncreasedBulkLimitEnabled()){const t=this.getCheckedUsersInVisibleOrder();return this.limitAndUncheckExcess(t,e)}return this.getCheckedUsers()}}class li extends ci{constructor(){super(...arguments),this.statusType=j.Zx}}var ui=i(2471),di=function(e,t,i,n){return new(i||(i=Promise))(function(s,r){function o(e){try{c(n.next(e))}catch(t){r(t)}}function a(e){try{c(n.throw(e))}catch(t){r(t)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(o,a)}c((n=n.apply(e,t||[])).next())})};class hi{get showConfirmUsers(){return this.dataSource.activeUserCount>1&&this.dataSource.confirmedUserCount>0&&this.dataSource.confirmedUserCount<3&&this.dataSource.acceptedUserCount>0}get showBulkConfirmUsers(){return this.dataSource.getCheckedUsers().every(e=>e.status==this.userStatusType.Accepted)}get showBulkReinviteUsers(){return this.dataSource.getCheckedUsers().every(e=>e.status==this.userStatusType.Invited)}constructor(e,t,i,n,s,r,o,a,c){this.apiService=e,this.i18nService=t,this.keyService=i,this.validationService=n,this.logService=s,this.userNamePipe=r,this.dialogService=o,this.organizationManagementPreferencesService=a,this.toastService=c,this.firstLoaded=!1,this.searchControl=new y.MJ("",{nonNullable:!0}),this.statusToggle=new _t.t(void 0),(0,w.z)([this.searchControl.valueChanges.pipe((0,Ht.B)(200)),this.statusToggle]).pipe((0,it.pQ)()).subscribe(([e,t])=>this.dataSource.filter=ai(e,t))}load(e){return di(this,void 0,void 0,function*(){const t=yield this.getUsers(e);t instanceof Zt.s?this.dataSource.data=null!=t.data&&t.data.length>0?t.data:[]:Array.isArray(t)&&(this.dataSource.data=t),this.firstLoaded=!0})}removeUserConfirmationDialog(e){return di(this,void 0,void 0,function*(){return this.dialogService.openSimpleDialog({title:this.userNamePipe.transform(e),content:{key:"removeUserConfirmation"},type:"warning"})})}remove(e,t){return di(this,void 0,void 0,function*(){if(!(yield this.removeUserConfirmationDialog(e)))return!1;this.actionPromise=this.removeUser(e.id,t);try{const t=yield this.actionPromise;if(!t.success)throw new Error(t.error);this.toastService.showToast({variant:"success",message:this.i18nService.t("removedUserId",this.userNamePipe.transform(e))}),this.dataSource.removeUser(e)}catch(i){this.validationService.showError(i)}this.actionPromise=void 0})}reinvite(e,t){return di(this,void 0,void 0,function*(){if(null==this.actionPromise){this.actionPromise=this.reinviteUser(e.id,t);try{const t=yield this.actionPromise;if(!t.success)throw new Error(t.error);this.toastService.showToast({variant:"success",message:this.i18nService.t("hasBeenReinvited",this.userNamePipe.transform(e))})}catch(i){this.validationService.showError(i)}this.actionPromise=void 0}})}confirm(e,t){return di(this,void 0,void 0,function*(){const i=i=>di(this,void 0,void 0,function*(){try{this.actionPromise=this.confirmUser(e,i,t);const n=yield this.actionPromise;if(!n.success)throw new Error(n.error);e.status=this.userStatusType.Confirmed,this.dataSource.replaceUser(e),this.toastService.showToast({variant:"success",message:this.i18nService.t("hasBeenConfirmed",this.userNamePipe.transform(e))})}catch(n){throw this.validationService.showError(n),n}finally{this.actionPromise=void 0}});if(null==this.actionPromise)try{const t=yield this.apiService.getUserPublicKey(e.userId),s=be.A.fromB64ToArray(t.publicKey),r=yield(0,R._)(this.organizationManagementPreferencesService.autoConfirmFingerPrints.state$);if(null==e)throw new Error("Cannot confirm null user.");if(null==r||!r){const t=ni.open(this.dialogService,{data:{name:this.userNamePipe.transform(e),userId:e.userId,publicKey:s,confirmUser:()=>i(s)}});return void(yield(0,o.s)(t.closed))}try{const t=yield this.keyService.getFingerprint(e.userId,s);this.logService.info(`User's fingerprint: ${t.join("-")}`)}catch(n){this.logService.error(n)}yield i(s)}catch(n){this.logService.error(`Handled exception: ${n}`)}})}}hi.ɵfac=function(e){return new(e||hi)(W.rXU(dt.G),W.rXU(h.W),W.rXU(ot.Lu),W.rXU(ui.B),W.rXU(rt.K),W.rXU(Qt.b),W.rXU(p.o3),W.rXU(ti.y),W.rXU(m.f))},hi.ɵdir=W.FsC({type:hi});var pi=i(37579),mi=i(80351),gi=i(36801),bi=i(45151),fi=i(18499),vi=i(44432),Si=function(e,t,i,n){return new(i||(i=Promise))(function(s,r){function o(e){try{c(n.next(e))}catch(t){r(t)}}function a(e){try{c(n.throw(e))}catch(t){r(t)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(o,a)}c((n=n.apply(e,t||[])).next())})};const Ii="ok";class yi{get loggedOutWarningName(){return null!=this.dialogData.name?this.dialogData.name:this.i18nService.t("thisUser")}constructor(e,t,i,n,s,o,a){this.dialogData=e,this.accountService=t,this.dialogRef=i,this.i18nService=n,this.policyService=s,this.resetPasswordService=o,this.toastService=a,this.inputPasswordComponent=void 0,this.masterPasswordPolicyOptions$=this.accountService.activeAccount$.pipe(x.F6,(0,$.n)(e=>this.policyService.masterPasswordPolicyOptions$(e))),this.inputPasswordFlow=r.m5.ChangePasswordDelegation,this.handlePrimaryButtonClick=()=>Si(this,void 0,void 0,function*(){if(!this.inputPasswordComponent)throw new Error("InputPasswordComponent is not initialized");const e=yield this.inputPasswordComponent.submit();e&&(yield this.resetPasswordService.resetMasterPassword(e.newPassword,this.dialogData.email,this.dialogData.organizationUserId,this.dialogData.organizationId),this.toastService.showToast({variant:"success",title:"",message:this.i18nService.t("resetPasswordSuccess")}),this.dialogRef.close(Ii))})}}yi.open=(e,t)=>e.open(yi,t),yi.ɵfac=function(e){return new(e||yi)(W.rXU(N.Qs),W.rXU(Q.D),W.rXU(p.ce),W.rXU(h.W),W.rXU(fi.m),W.rXU(bi.w),W.rXU(m.f))},yi.ɵcmp=W.VBU({type:yi,selectors:[["app-account-recovery-dialog"]],viewQuery:function(e,t){if(1&e&&W.GBs(r.tu,5),2&e){let e;W.mGM(e=W.lsd())&&(t.inputPasswordComponent=e.first)}},decls:15,vars:19,consts:[[3,"title","subtitle"],["bitDialogContent",""],["type","warning"],[3,"flow","masterPasswordPolicyOptions"],["bitDialogFooter",""],["type","button","bitButton","","buttonType","primary",3,"bitAction"],["type","button","bitButton","","buttonType","secondary","bitDialogClose",""]],template:function(e,t){1&e&&(W.j41(0,"bit-dialog",0),W.nI1(1,"i18n"),W.qex(2,1),W.j41(3,"bit-callout",2),W.EFF(4),W.nI1(5,"i18n"),W.k0s(),W.nrm(6,"auth-input-password",3),W.nI1(7,"async"),W.bVm(),W.qex(8,4),W.j41(9,"button",5),W.EFF(10),W.nI1(11,"i18n"),W.k0s(),W.j41(12,"button",6),W.EFF(13),W.nI1(14,"i18n"),W.k0s(),W.bVm(),W.k0s()),2&e&&(W.Y8G("title",W.bMT(1,8,"recoverAccount"))("subtitle",t.dialogData.name),W.R7$(4),W.SpI("",W.i5U(5,10,"resetPasswordLoggedOutWarning",t.loggedOutWarningName)," "),W.R7$(2),W.Y8G("flow",t.inputPasswordFlow)("masterPasswordPolicyOptions",W.bMT(7,13,t.masterPasswordPolicyOptions$)),W.R7$(3),W.Y8G("bitAction",t.handlePrimaryButtonClick),W.R7$(),W.SpI(" ",W.bMT(11,15,"save")," "),W.R7$(3),W.SpI(" ",W.bMT(14,17,"cancel")," "))},dependencies:[pi.C,_.p,ct.t,te.Q,mi.j,vi.G,q.MD,lt.P,mt.I,ne.m,r.tu,q.Jj,gi.$Z],encapsulation:2});var ki=i(52237),Ri=i(65551),wi=function(e,t,i,n){return new(i||(i=Promise))(function(s,r){function o(e){try{c(n.next(e))}catch(t){r(t)}}function a(e){try{c(n.throw(e))}catch(t){r(t)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(o,a)}c((n=n.apply(e,t||[])).next())})};class $i{constructor(e,t,i,n,s,r){this.organizationUserApiService=e,this.groupService=t,this.apiService=i,this.keyService=n,this.accountService=s,this.collectionService=r}loadUsers(e){return wi(this,void 0,void 0,function*(){var t,i;let n,s;const r=this.organizationUserApiService.getAllUsers(e.id,{includeGroups:e.useGroups,includeCollections:!e.useGroups});e.useGroups?n=this.getGroupNameMap(e):s=this.getCollectionNameMap(e);const[o,a,c]=yield Promise.all([r,n,s]);return null!==(i=null===(t=o.data)||void 0===t?void 0:t.map(e=>{const t=Ri.i.fromResponse(e);return t.groupNames=t.groups.map(e=>null==a?void 0:a.get(e)).filter(e=>null!=e).sort(),t.collectionNames=t.collections.map(e=>null==c?void 0:c.get(e.id)).filter(e=>null!=e).sort(),t}))&&void 0!==i?i:[]})}getGroupNameMap(e){return wi(this,void 0,void 0,function*(){const t=yield this.groupService.getAll(e.id),i=new Map;return t.forEach(e=>i.set(e.id,e.name)),i})}getCollectionNameMap(e){return wi(this,void 0,void 0,function*(){const t=(0,Ot.H)(this.apiService.getCollections(e.id)).pipe((0,M.T)(e=>e.data.map(e=>ki.pM.fromCollectionData(new ki.Fw(e))))),i=this.accountService.activeAccount$.pipe(x.F6,(0,$.n)(e=>this.keyService.orgKeys$(e)),(0,M.T)(e=>{if(null==e)throw new Error("Organization keys not found for provided User.");return e}));return yield(0,R._)((0,w.z)([i,t]).pipe((0,$.n)(([e,t])=>this.collectionService.decryptMany$(t,e)),(0,M.T)(e=>{const t=new Map;return e.forEach(e=>{t.set(e.id,e.name)}),t})))})}}$i.ɵfac=function(e){return new(e||$i)(d.KVO(G.uB),d.KVO(P.nK),d.KVO(dt.G),d.KVO(ot.Lu),d.KVO(Q.D),d.KVO(G.YD))},$i.ɵprov=d.jDH({token:$i,factory:$i.ɵfac});var Mi=i(60512),Fi=i(41445),Ti=function(e,t,i,n){return new(i||(i=Promise))(function(s,r){function o(e){try{c(n.next(e))}catch(t){r(t)}}function a(e){try{c(n.throw(e))}catch(t){r(t)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(o,a)}c((n=n.apply(e,t||[])).next())})};class Ei{constructor(){this.organizationUserApiService=(0,d.WQX)(G.uB),this.organizationUserService=(0,d.WQX)(G.Ki),this.configService=(0,d.WQX)(L.w),this.organizationMetadataService=(0,d.WQX)(Fi.Q),this.apiService=(0,d.WQX)(dt.G),this.dialogService=(0,d.WQX)(p.o3),this.keyService=(0,d.WQX)(ot.Lu),this.logService=(0,d.WQX)(rt.K),this.orgManagementPrefs=(0,d.WQX)(ti.y),this.userNamePipe=(0,d.WQX)(Qt.b),this.isProcessing=(0,d.vPA)(!1)}startProcessing(){this.isProcessing.set(!0)}endProcessing(){this.isProcessing.set(!1)}inviteUser(e,t,i,n,s,r){return Ti(this,void 0,void 0,function*(){var o;this.startProcessing();try{return yield this.organizationUserApiService.postOrganizationUserInvite(e.id,{emails:[t],type:i,accessSecretsManager:!1,collections:null!=s?s:[],groups:null!=r?r:[],permissions:n}),{success:!0}}catch(a){return{success:!1,error:null!==(o=a.message)&&void 0!==o?o:String(a)}}finally{this.endProcessing()}})}removeUser(e,t){return Ti(this,void 0,void 0,function*(){var i;this.startProcessing();try{return yield this.organizationUserApiService.removeOrganizationUser(e.id,t),this.organizationMetadataService.refreshMetadataCache(),{success:!0}}catch(n){return{success:!1,error:null!==(i=n.message)&&void 0!==i?i:String(n)}}finally{this.endProcessing()}})}revokeUser(e,t){return Ti(this,void 0,void 0,function*(){var i;this.startProcessing();try{return yield this.organizationUserApiService.revokeOrganizationUser(e.id,t),this.organizationMetadataService.refreshMetadataCache(),{success:!0}}catch(n){return{success:!1,error:null!==(i=n.message)&&void 0!==i?i:String(n)}}finally{this.endProcessing()}})}restoreUser(e,t){return Ti(this,void 0,void 0,function*(){var i;this.startProcessing();try{return yield(0,R._)(this.configService.getFeatureFlag$(D.TO.DefaultUserCollectionRestore).pipe((0,$.n)(i=>i?this.organizationUserService.restoreUser(e,t):this.organizationUserApiService.restoreOrganizationUser(e.id,t)))),this.organizationMetadataService.refreshMetadataCache(),{success:!0}}catch(n){return{success:!1,error:null!==(i=n.message)&&void 0!==i?i:String(n)}}finally{this.endProcessing()}})}deleteUser(e,t){return Ti(this,void 0,void 0,function*(){var i;this.startProcessing();try{return yield this.organizationUserApiService.deleteOrganizationUser(e.id,t),this.organizationMetadataService.refreshMetadataCache(),{success:!0}}catch(n){return{success:!1,error:null!==(i=n.message)&&void 0!==i?i:String(n)}}finally{this.endProcessing()}})}reinviteUser(e,t){return Ti(this,void 0,void 0,function*(){var i;this.startProcessing();try{return yield this.organizationUserApiService.postOrganizationUserReinvite(e.id,t),{success:!0}}catch(n){return{success:!1,error:null!==(i=n.message)&&void 0!==i?i:String(n)}}finally{this.endProcessing()}})}confirmUser(e,t,i){return Ti(this,void 0,void 0,function*(){var n;this.startProcessing();try{return yield(0,R._)(this.organizationUserService.confirmUser(i,e.id,t)),{success:!0}}catch(s){return{success:!1,error:null!==(n=s.message)&&void 0!==n?n:String(s)}}finally{this.endProcessing()}})}bulkReinvite(e,t){return Ti(this,void 0,void 0,function*(){this.startProcessing();try{return this.processBatchedOperation(t,500,t=>this.organizationUserApiService.postManyOrganizationUserReinvite(e.id,t))}catch(i){return{failed:t.map(e=>{var t;return{id:e,error:null!==(t=i.message)&&void 0!==t?t:String(i)}})}}finally{this.endProcessing()}})}allowResetPassword(e,t,i){let n=!1;switch(t.type){case j.D7.Owner:n=!0;break;case j.D7.Admin:n=e.type!==j.D7.Owner;break;case j.D7.Custom:n=e.type!==j.D7.Owner&&e.type!==j.D7.Admin}return t.canManageUsersPassword&&n&&t.useResetPassword&&t.hasPublicAndPrivateKeys&&e.resetPasswordEnrolled&&i&&e.status===j.Zx.Confirmed}processBatchedOperation(e,t,i){return Ti(this,void 0,void 0,function*(){const n=[],s=[];for(let o=0;o<e.length;o+=t){const a=e.slice(o,o+t);try{const e=yield i(a);if(null==e?void 0:e.data)for(const t of e.data)t.error?s.push({id:t.id,error:t.error}):n.push(t)}catch(r){s.push(...a.map(e=>{var t;return{id:e,error:null!==(t=r.message)&&void 0!==t?t:String(r)}}))}}return{successful:n.length>0?new Zt.s(n,G.ME):void 0,failed:s}})}getPublicKeyForConfirm(e){return Ti(this,void 0,void 0,function*(){try{(0,Mi.x)(e,"Cannot confirm null user.");const t=yield(0,R._)(this.orgManagementPrefs.autoConfirmFingerPrints.state$),i=yield this.apiService.getUserPublicKey(e.userId),n=be.A.fromB64ToArray(i.publicKey);if(null==t||!t){const t=yield this.keyService.getFingerprint(e.userId,n);this.logService.info(`User's fingerprint: ${t.join("-")}`);const i=ni.open(this.dialogService,{data:{name:this.userNamePipe.transform(e),userId:e.userId,publicKey:n}});if(!(yield(0,o.s)(i.closed)))return}return n}catch(t){this.logService.error(`Handled exception: ${t}`)}})}}Ei.ɵfac=function(e){return new(e||Ei)},Ei.ɵprov=d.jDH({token:Ei,factory:Ei.ɵfac});var Gi=i(76876),Ui=function(e,t,i,n){return new(i||(i=Promise))(function(s,r){function o(e){try{c(n.next(e))}catch(t){r(t)}}function a(e){try{c(n.throw(e))}catch(t){r(t)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(o,a)}c((n=n.apply(e,t||[])).next())})};class ji{constructor(e,t,i){this.keyService=e,this.encryptService=t,this.i18nService=i,this.publicKeys=new Map,this.fingerprints=new Map,this.statuses=new Map,this.done=!1,this.loading=!0,this.submit=()=>Ui(this,void 0,void 0,function*(){this.loading=!0;try{const e=yield this.getCryptoKey(),t=[];for(const i of this.filteredUsers){const n=this.publicKeys.get(i.id);if(null==n)continue;const s=yield this.encryptService.encapsulateKeyUnsigned(e,n);t.push({id:i.id,key:s.encryptedString})}(yield this.postConfirmRequest(t)).data.forEach(e=>{const t=""!==e.error?e.error:this.i18nService.t("bulkConfirmMessage");this.statuses.set(e.id,t)}),this.done=!0}catch(e){this.error=e.message}this.loading=!1})}ngOnInit(){return Ui(this,void 0,void 0,function*(){this.excludedUsers=this.users.filter(e=>!this.isAccepted(e)),this.filteredUsers=this.users.filter(e=>this.isAccepted(e)),this.filteredUsers.length<=0&&(this.done=!0);const e=yield this.getPublicKeys();for(const t of e.data){const e=be.A.fromB64ToArray(t.key),i=yield this.keyService.getFingerprint(t.userId,e);null!=i&&(this.publicKeys.set(t.id,e),this.fingerprints.set(t.id,i.join("-")))}this.loading=!1})}}ji.ɵfac=function(e){return new(e||ji)(W.rXU(ot.Lu),W.rXU(ht.N),W.rXU(h.W))},ji.ɵdir=W.FsC({type:ji});var Ci=i(57144),xi=function(e,t,i,n){return new(i||(i=Promise))(function(s,r){function o(e){try{c(n.next(e))}catch(t){r(t)}}function a(e){try{c(n.throw(e))}catch(t){r(t)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(o,a)}c((n=n.apply(e,t||[])).next())})};function Di(e,t){1&e&&(W.j41(0,"bit-callout",8),W.EFF(1),W.nI1(2,"i18n"),W.k0s()),2&e&&(W.R7$(),W.SpI(" ",W.bMT(2,1,"noSelectedUsersApplicable")," "))}function Xi(e,t){if(1&e&&(W.j41(0,"bit-callout",9),W.nI1(1,"i18n"),W.EFF(2),W.k0s()),2&e){const e=W.XpG();W.Y8G("title",W.bMT(1,2,"error")),W.R7$(2),W.SpI(" ",e.error," ")}}function Ni(e,t){if(1&e&&(W.j41(0,"p",22),W.EFF(1),W.k0s()),2&e){const e=W.XpG().$implicit;W.R7$(),W.JRh(e.name)}}function Pi(e,t){if(1&e&&(W.j41(0,"tr",18)(1,"td",19),W.nrm(2,"bit-avatar",20),W.nI1(3,"userName"),W.k0s(),W.j41(4,"td",14),W.EFF(5),W.DNE(6,Ni,2,1,"p",21),W.k0s(),W.j41(7,"td",14),W.EFF(8),W.k0s()()),2&e){const e=t.$implicit,i=W.XpG(3);W.R7$(2),W.Y8G("text",W.bMT(3,5,e))("id",e.id),W.R7$(3),W.SpI(" ",e.email," "),W.R7$(),W.Y8G("ngIf",e.name),W.R7$(2),W.SpI(" ",i.fingerprints.get(e.id)," ")}}function Vi(e,t){if(1&e&&(W.j41(0,"p",22),W.EFF(1),W.k0s()),2&e){const e=W.XpG().$implicit;W.R7$(),W.JRh(e.name)}}function Ai(e,t){if(1&e&&(W.j41(0,"tr",23)(1,"td",19),W.nrm(2,"bit-avatar",20),W.nI1(3,"userName"),W.k0s(),W.j41(4,"td",14),W.EFF(5),W.DNE(6,Vi,2,1,"p",21),W.k0s(),W.j41(7,"td",14),W.EFF(8),W.nI1(9,"i18n"),W.k0s()()),2&e){const e=t.$implicit;W.R7$(2),W.Y8G("text",W.bMT(3,5,e))("id",e.id),W.R7$(3),W.SpI(" ",e.email," "),W.R7$(),W.Y8G("ngIf",e.name),W.R7$(2),W.SpI(" ",W.bMT(9,7,"bulkFilteredMessage")," ")}}function zi(e,t){if(1&e&&W.DNE(0,Pi,9,7,"tr",16)(1,Ai,10,9,"tr",17),2&e){const e=W.XpG(2);W.Y8G("ngForOf",e.filteredUsers),W.R7$(),W.Y8G("ngForOf",e.excludedUsers)}}function Bi(e,t){1&e&&(W.qex(0),W.j41(1,"p",10),W.EFF(2),W.nI1(3,"i18n"),W.j41(4,"a",11),W.EFF(5),W.nI1(6,"i18n"),W.k0s()(),W.j41(7,"bit-table"),W.qex(8,12),W.j41(9,"tr")(10,"th",13),W.EFF(11),W.nI1(12,"i18n"),W.k0s(),W.j41(13,"th",14),W.EFF(14),W.nI1(15,"i18n"),W.k0s()(),W.bVm(),W.DNE(16,zi,2,2,"ng-template",15),W.k0s(),W.bVm()),2&e&&(W.R7$(2),W.SpI(" ",W.bMT(3,4,"fingerprintEnsureIntegrityVerify")," "),W.R7$(3),W.SpI(" ",W.bMT(6,6,"learnMore")),W.R7$(6),W.JRh(W.bMT(12,8,"user")),W.R7$(3),W.JRh(W.bMT(15,10,"fingerprint")))}function Yi(e,t){if(1&e&&(W.j41(0,"p",22),W.EFF(1),W.k0s()),2&e){const e=W.XpG().$implicit;W.R7$(),W.JRh(e.name)}}function Oi(e,t){if(1&e&&(W.j41(0,"td",14),W.EFF(1),W.k0s()),2&e){const e=W.XpG().$implicit,t=W.XpG(3);W.R7$(),W.SpI(" ",t.statuses.get(e.id)," ")}}function Ji(e,t){1&e&&(W.j41(0,"td",14),W.EFF(1),W.nI1(2,"i18n"),W.k0s()),2&e&&(W.R7$(),W.SpI(" ",W.bMT(2,1,"bulkFilteredMessage")," "))}function Wi(e,t){if(1&e&&(W.j41(0,"tr",18)(1,"td",19),W.nrm(2,"bit-avatar",20),W.nI1(3,"userName"),W.k0s(),W.j41(4,"td",14),W.EFF(5),W.DNE(6,Yi,2,1,"p",21),W.k0s(),W.DNE(7,Oi,2,1,"td",24)(8,Ji,3,3,"td",24),W.k0s()),2&e){const e=t.$implicit,i=W.XpG(3);W.R7$(2),W.Y8G("text",W.bMT(3,6,e))("id",e.id),W.R7$(3),W.SpI(" ",e.email," "),W.R7$(),W.Y8G("ngIf",e.name),W.R7$(),W.Y8G("ngIf",i.statuses.has(e.id)),W.R7$(),W.Y8G("ngIf",!i.statuses.has(e.id))}}function Qi(e,t){if(1&e&&W.DNE(0,Wi,9,8,"tr",16),2&e){const e=W.XpG(2);W.Y8G("ngForOf",e.filteredUsers)}}function Li(e,t){1&e&&(W.qex(0),W.j41(1,"bit-table"),W.qex(2,12),W.j41(3,"tr")(4,"th",13),W.EFF(5),W.nI1(6,"i18n"),W.k0s(),W.j41(7,"th",14),W.EFF(8),W.nI1(9,"i18n"),W.k0s()(),W.bVm(),W.DNE(10,Qi,1,1,"ng-template",15),W.k0s(),W.bVm()),2&e&&(W.R7$(5),W.JRh(W.bMT(6,2,"user")),W.R7$(3),W.JRh(W.bMT(9,4,"status")))}function qi(e,t){if(1&e){const e=W.RV6();W.j41(0,"button",25),W.bIt("click",function(){d.eBV(e);const t=W.XpG();return d.Njj(t.submit())}),W.EFF(1),W.nI1(2,"i18n"),W.k0s()}if(2&e){const e=W.XpG();W.Y8G("disabled",e.loading),W.R7$(),W.SpI(" ",W.bMT(2,2,"confirm")," ")}}class Ki extends ji{constructor(e,t,i,n,s,r,o){super(e,i,s),this.keyService=e,this.dialogParams=t,this.encryptService=i,this.organizationUserApiService=n,this.i18nService=s,this.stateProvider=r,this.organizationUserService=o,this.getCryptoKey=()=>xi(this,void 0,void 0,function*(){return yield(0,R._)(this.organizationKey$)}),this.getPublicKeys=()=>xi(this,void 0,void 0,function*(){return yield this.organizationUserApiService.postOrganizationUsersPublicKey(this.organization.id,this.filteredUsers.map(e=>e.id))}),this.isAccepted=e=>e.status===j.Zx.Accepted,this.postConfirmRequest=e=>xi(this,void 0,void 0,function*(){return yield(0,R._)(this.organizationUserService.bulkConfirmUsers(this.organization,e))}),this.organization=t.organization,this.organizationKey$=this.stateProvider.activeUserId$.pipe((0,$.n)(e=>this.keyService.orgKeys$(e)),(0,M.T)(e=>e[this.organization.id]),(0,it.pQ)()),this.users=t.users}static open(e,t){return e.open(Ki,t)}}Ki.ɵfac=function(e){return new(e||Ki)(W.rXU(ot.Lu),W.rXU(N.Qs),W.rXU(ht.N),W.rXU(G.uB),W.rXU(h.W),W.rXU(A.v2),W.rXU(G.Ki))},Ki.ɵcmp=W.VBU({type:Ki,selectors:[["member-bulk-comfirm-dialog"]],standalone:!1,features:[W.Vt3],decls:12,vars:12,consts:[["dialogSize","large",3,"title","loading"],["bitDialogContent",""],["type","danger",4,"ngIf"],["type","danger",3,"title",4,"ngIf"],[4,"ngIf"],["bitDialogFooter",""],["bitButton","","type","submit","buttonType","primary",3,"disabled","click",4,"ngIf"],["bitButton","","type","button","buttonType","secondary","bitDialogClose",""],["type","danger"],["type","danger",3,"title"],["bitTypography","body1"],["bitLink","","href","https://bitwarden.com/help/fingerprint-phrase/","target","_blank","rel","noreferrer"],["header",""],["bitCell","","colspan","2"],["bitCell",""],["body",""],["bitRow","","alignContent","middle",4,"ngFor","ngForOf"],["alignContent","middle",4,"ngFor","ngForOf"],["bitRow","","alignContent","middle"],["bitCell","",1,"tw-w-5"],["size","small",3,"text","id"],["class","tw-text-muted tw-text-sm",4,"ngIf"],[1,"tw-text-muted","tw-text-sm"],["alignContent","middle"],["bitCell","",4,"ngIf"],["bitButton","","type","submit","buttonType","primary",3,"click","disabled"]],template:function(e,t){1&e&&(W.j41(0,"bit-dialog",0),W.nI1(1,"i18n"),W.qex(2,1),W.DNE(3,Di,3,3,"bit-callout",2)(4,Xi,3,4,"bit-callout",3)(5,Bi,17,12,"ng-container",4)(6,Li,11,6,"ng-container",4),W.bVm(),W.qex(7,5),W.DNE(8,qi,3,4,"button",6),W.j41(9,"button",7),W.EFF(10),W.nI1(11,"i18n"),W.k0s(),W.bVm(),W.k0s()),2&e&&(W.Y8G("title",W.bMT(1,8,"confirmUsers"))("loading",t.loading),W.R7$(3),W.Y8G("ngIf",t.filteredUsers.length<=0),W.R7$(),W.Y8G("ngIf",t.error),W.R7$(),W.Y8G("ngIf",!t.loading&&!t.done),W.R7$(),W.Y8G("ngIf",!t.loading&&t.done),W.R7$(2),W.Y8G("ngIf",!t.done),W.R7$(2),W.SpI(" ",W.bMT(11,10,"close")," "))},dependencies:[q.Sq,q.bT,Ci.f,te.Q,vi.G,mt.I,ne.m,le.g,wt.Q,$t.Y,Mt._,Mt.O,me.r,fe.$,Qt.b],encapsulation:2});var _i=function(e,t,i,n){return new(i||(i=Promise))(function(s,r){function o(e){try{c(n.next(e))}catch(t){r(t)}}function a(e){try{c(n.throw(e))}catch(t){r(t)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(o,a)}c((n=n.apply(e,t||[])).next())})};function Hi(e,t){1&e&&(W.j41(0,"bit-callout",8),W.EFF(1),W.nI1(2,"i18n"),W.k0s()),2&e&&(W.R7$(),W.SpI(" ",W.bMT(2,1,"noSelectedMembersApplicable")," "))}function Zi(e,t){if(1&e&&(W.j41(0,"bit-callout",9),W.nI1(1,"i18n"),W.EFF(2),W.k0s()),2&e){const e=W.XpG();W.Y8G("title",W.bMT(1,2,"error")),W.R7$(2),W.SpI(" ",e.error," ")}}function en(e,t){1&e&&(W.j41(0,"p",14),W.EFF(1),W.nI1(2,"i18n"),W.k0s()),2&e&&(W.R7$(),W.SpI(" ",W.bMT(2,1,"deleteManyOrganizationUsersWarningDesc")," "))}function tn(e,t){1&e&&(W.j41(0,"span",22),W.EFF(1),W.nI1(2,"i18n"),W.k0s()),2&e&&(W.R7$(),W.SpI(" ",W.bMT(2,1,"invited")," "))}function nn(e,t){if(1&e&&(W.j41(0,"small",23),W.EFF(1),W.k0s()),2&e){const e=W.XpG().$implicit;W.R7$(),W.JRh(e.name)}}function sn(e,t){if(1&e&&(W.j41(0,"tr",16)(1,"td",17),W.nrm(2,"bit-avatar",18),W.nI1(3,"userName"),W.k0s(),W.j41(4,"td",19)(5,"div"),W.EFF(6),W.DNE(7,tn,3,3,"span",20),W.k0s(),W.DNE(8,nn,2,1,"small",21),W.k0s()()),2&e){const e=t.$implicit,i=W.XpG(3);W.R7$(2),W.Y8G("text",W.bMT(3,5,e))("id",e.id),W.R7$(4),W.SpI(" ",e.email," "),W.R7$(),W.Y8G("ngIf",e.status===i.userStatusType.Invited),W.R7$(),W.Y8G("ngIf",e.name)}}function rn(e,t){if(1&e&&W.DNE(0,sn,9,7,"tr",15),2&e){const e=W.XpG(2);W.Y8G("ngForOf",e.users)}}function on(e,t){if(1&e&&(W.qex(0),W.DNE(1,en,3,3,"p",10),W.j41(2,"bit-table"),W.qex(3,11),W.j41(4,"tr")(5,"th",12),W.EFF(6),W.nI1(7,"i18n"),W.k0s()(),W.bVm(),W.DNE(8,rn,1,1,"ng-template",13),W.k0s(),W.bVm()),2&e){const e=W.XpG();W.R7$(),W.Y8G("ngIf",e.users.length>0&&!e.error),W.R7$(5),W.JRh(W.bMT(7,2,"member"))}}function an(e,t){if(1&e&&(W.j41(0,"small",23),W.EFF(1),W.k0s()),2&e){const e=W.XpG().$implicit;W.R7$(),W.JRh(e.name)}}function cn(e,t){if(1&e&&(W.j41(0,"td",19),W.EFF(1),W.k0s()),2&e){const e=W.XpG().$implicit,t=W.XpG(3);W.R7$(),W.SpI(" ",t.statuses.get(e.id)," ")}}function ln(e,t){1&e&&(W.j41(0,"td",19),W.EFF(1),W.nI1(2,"i18n"),W.k0s()),2&e&&(W.R7$(),W.SpI(" ",W.bMT(2,1,"bulkFilteredMessage")," "))}function un(e,t){if(1&e&&(W.j41(0,"tr",16)(1,"td",17),W.nrm(2,"bit-avatar",18),W.nI1(3,"userName"),W.k0s(),W.j41(4,"td",19),W.EFF(5),W.DNE(6,an,2,1,"small",21),W.k0s(),W.DNE(7,cn,2,1,"td",24)(8,ln,3,3,"td",24),W.k0s()),2&e){const e=t.$implicit,i=W.XpG(3);W.R7$(2),W.Y8G("text",W.bMT(3,6,e))("id",e.id),W.R7$(3),W.SpI(" ",e.email," "),W.R7$(),W.Y8G("ngIf",e.name),W.R7$(),W.Y8G("ngIf",i.statuses.has(e.id)),W.R7$(),W.Y8G("ngIf",!i.statuses.has(e.id))}}function dn(e,t){if(1&e&&W.DNE(0,un,9,8,"tr",15),2&e){const e=W.XpG(2);W.Y8G("ngForOf",e.users)}}function hn(e,t){1&e&&(W.qex(0),W.j41(1,"bit-table"),W.qex(2,11),W.j41(3,"tr")(4,"th",12),W.EFF(5),W.nI1(6,"i18n"),W.k0s(),W.j41(7,"th",19),W.EFF(8),W.nI1(9,"i18n"),W.k0s()(),W.bVm(),W.DNE(10,dn,1,1,"ng-template",13),W.k0s(),W.bVm()),2&e&&(W.R7$(5),W.JRh(W.bMT(6,2,"member")),W.R7$(3),W.JRh(W.bMT(9,4,"status")))}function pn(e,t){if(1&e){const e=W.RV6();W.j41(0,"button",25),W.bIt("click",function(){d.eBV(e);const t=W.XpG();return d.Njj(t.submit())}),W.EFF(1),W.nI1(2,"i18n"),W.k0s()}if(2&e){const e=W.XpG();W.Y8G("disabled",e.loading),W.R7$(),W.SpI(" ",W.bMT(2,2,"deleteMembers")," ")}}class mn{constructor(e,t,i,n){this.dialogParams=e,this.i18nService=t,this.organizationUserApiService=i,this.deleteManagedMemberWarningService=n,this.loading=!1,this.done=!1,this.error=null,this.statuses=new Map,this.userStatusType=j.Zx,this.organizationId=e.organizationId,this.users=e.users}submit(){return _i(this,void 0,void 0,function*(){yield this.deleteManagedMemberWarningService.acknowledgeWarning(this.organizationId);try{this.loading=!0,this.error=null;(yield this.organizationUserApiService.deleteManyOrganizationUsers(this.organizationId,this.users.map(e=>e.id))).data.forEach(e=>{this.statuses.set(e.id,e.error?e.error:this.i18nService.t("deletedSuccessfully"))}),this.done=!0}catch(e){this.error=e.message}finally{this.loading=!1}})}static open(e,t){return e.open(mn,t)}}mn.ɵfac=function(e){return new(e||mn)(W.rXU(N.Qs),W.rXU(h.W),W.rXU(G.uB),W.rXU(Y))},mn.ɵcmp=W.VBU({type:mn,selectors:[["member-bulk-delete-dialog"]],standalone:!1,decls:12,vars:11,consts:[["dialogSize","large",3,"title"],["bitDialogContent",""],["type","danger",4,"ngIf"],["type","danger",3,"title",4,"ngIf"],[4,"ngIf"],["bitDialogFooter",""],["bitButton","","type","submit","buttonType","primary",3,"disabled","click",4,"ngIf"],["bitButton","","type","button","buttonType","secondary","bitDialogClose",""],["type","danger"],["type","danger",3,"title"],["bitTypography","body1",4,"ngIf"],["header",""],["bitCell","","colspan","2"],["body",""],["bitTypography","body1"],["bitRow","",4,"ngFor","ngForOf"],["bitRow",""],["bitCell","",1,"tw-w-5"],["size","small",3,"text","id"],["bitCell",""],["bitBadge","","class","tw-text-xs","variant","secondary",4,"ngIf"],["class","tw-text-muted tw-block",4,"ngIf"],["bitBadge","","variant","secondary",1,"tw-text-xs"],[1,"tw-text-muted","tw-block"],["bitCell","",4,"ngIf"],["bitButton","","type","submit","buttonType","primary",3,"click","disabled"]],template:function(e,t){1&e&&(W.j41(0,"bit-dialog",0),W.nI1(1,"i18n"),W.qex(2,1),W.DNE(3,Hi,3,3,"bit-callout",2)(4,Zi,3,4,"bit-callout",3)(5,on,9,4,"ng-container",4)(6,hn,11,6,"ng-container",4),W.bVm(),W.qex(7,5),W.DNE(8,pn,3,4,"button",6),W.j41(9,"button",7),W.EFF(10),W.nI1(11,"i18n"),W.k0s(),W.bVm(),W.k0s()),2&e&&(W.Y8G("title",W.bMT(1,7,"deleteMembers")),W.R7$(3),W.Y8G("ngIf",t.users.length<=0),W.R7$(),W.Y8G("ngIf",t.error),W.R7$(),W.Y8G("ngIf",!t.done),W.R7$(),W.Y8G("ngIf",t.done),W.R7$(2),W.Y8G("ngIf",!t.done&&t.users.length>0),W.R7$(2),W.SpI(" ",W.bMT(11,9,"close")," "))},dependencies:[q.Sq,q.bT,Ci.f,ee.n,te.Q,vi.G,mt.I,ne.m,wt.Q,$t.Y,Mt._,Mt.O,me.r,fe.$,Qt.b],encapsulation:2});var gn=i(58270),bn=function(e,t,i,n){return new(i||(i=Promise))(function(s,r){function o(e){try{c(n.next(e))}catch(t){r(t)}}function a(e){try{c(n.throw(e))}catch(t){r(t)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(o,a)}c((n=n.apply(e,t||[])).next())})};function fn(e,t){if(1&e&&(W.j41(0,"div",16),W.EFF(1),W.k0s()),2&e){const e=W.XpG().$implicit;W.R7$(),W.SpI(" ",e.email," ")}}function vn(e,t){if(1&e&&(W.j41(0,"tr",11)(1,"td",5)(2,"div",12),W.nrm(3,"bit-avatar",13),W.nI1(4,"userName"),W.j41(5,"div",14)(6,"div"),W.EFF(7),W.nI1(8,"userName"),W.k0s(),W.DNE(9,fn,2,1,"div",15),W.k0s()()(),W.j41(10,"td",5),W.EFF(11),W.nI1(12,"userType"),W.k0s()()),2&e){const e=t.$implicit;W.R7$(3),W.Y8G("text",W.bMT(4,6,e))("id",e.userId)("color",e.avatarColor),W.R7$(4),W.SpI(" ",W.bMT(8,8,e)," "),W.R7$(2),W.Y8G("ngIf",e.name),W.R7$(2),W.JRh(W.bMT(12,10,e.type))}}function Sn(e,t){if(1&e&&(W.DNE(0,vn,13,12,"tr",10),W.nI1(1,"async")),2&e){const e=t.$implicit;W.Y8G("ngForOf",W.bMT(1,1,e))}}class In{constructor(e,t,i,n,s,r){this.dialogRef=e,this.data=t,this.organizationUserApiService=i,this.platformUtilsService=n,this.i18nService=s,this.toastService=r,this.dataSource=new si.s,this.submit=()=>bn(this,void 0,void 0,function*(){yield this.organizationUserApiService.putOrganizationUserBulkEnableSecretsManager(this.data.orgId,this.dataSource.data.map(e=>e.id)),this.toastService.showToast({variant:"success",title:null,message:this.i18nService.t("activatedAccessToSecretsManager")}),this.dialogRef.close()})}ngOnInit(){this.dataSource.data=this.data.users}static open(e,t){return e.open(In,{data:t})}}In.ɵfac=function(e){return new(e||In)(W.rXU(p.ce),W.rXU(N.Qs),W.rXU(G.uB),W.rXU(ft.y),W.rXU(h.W),W.rXU(m.f))},In.ɵcmp=W.VBU({type:In,selectors:[["member-bulk-enable-sm-dialog"]],standalone:!1,decls:25,vars:20,consts:[["dialogSize","large"],["bitDialogTitle",""],["bitDialogContent",""],[3,"dataSource"],["header",""],["bitCell",""],["body",""],["bitDialogFooter",""],["type","button","bitButton","","buttonType","primary",3,"bitAction"],["type","button","bitButton","","buttonType","secondary","bitDialogClose",""],["bitRow","",4,"ngFor","ngForOf"],["bitRow",""],[1,"tw-flex","tw-items-center"],["size","small",1,"tw-mr-3",3,"text","id","color"],[1,"tw-flex","tw-flex-col"],["class","tw-text-sm tw-text-muted",4,"ngIf"],[1,"tw-text-sm","tw-text-muted"]],template:function(e,t){1&e&&(W.j41(0,"bit-dialog",0)(1,"span",1),W.EFF(2),W.nI1(3,"i18n"),W.k0s(),W.j41(4,"span",2)(5,"p"),W.EFF(6),W.nI1(7,"i18n"),W.k0s(),W.j41(8,"bit-table",3),W.qex(9,4),W.j41(10,"tr")(11,"th",5),W.EFF(12),W.nI1(13,"i18n"),W.k0s(),W.j41(14,"th",5),W.EFF(15),W.nI1(16,"i18n"),W.k0s()(),W.bVm(),W.DNE(17,Sn,2,3,"ng-template",6),W.k0s()(),W.qex(18,7),W.j41(19,"button",8),W.EFF(20),W.nI1(21,"i18n"),W.k0s(),W.j41(22,"button",9),W.EFF(23),W.nI1(24,"i18n"),W.k0s(),W.bVm(),W.k0s()),2&e&&(W.R7$(2),W.JRh(W.bMT(3,8,"activateSecretsManager")),W.R7$(4),W.JRh(W.bMT(7,10,"bulkEnableSecretsManagerDescription")),W.R7$(2),W.Y8G("dataSource",t.dataSource),W.R7$(4),W.JRh(W.bMT(13,12,"member")),W.R7$(3),W.JRh(W.bMT(16,14,"role")),W.R7$(4),W.Y8G("bitAction",t.submit),W.R7$(),W.SpI(" ",W.bMT(21,16,"activateAccess")," "),W.R7$(3),W.SpI(" ",W.bMT(24,18,"close")," "))},dependencies:[q.Sq,q.bT,_.p,Ci.f,te.Q,mt.I,ne.m,wt.Q,$t.Y,Mt._,Mt.O,q.Jj,fe.$,Qt.b,gn.c],encapsulation:2});var yn=function(e,t,i,n){return new(i||(i=Promise))(function(s,r){function o(e){try{c(n.next(e))}catch(t){r(t)}}function a(e){try{c(n.throw(e))}catch(t){r(t)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(o,a)}c((n=n.apply(e,t||[])).next())})};class kn{constructor(e){this.i18nService=e,this.statuses=new Map,this.done=!1,this.loading=!1,this.submit=()=>yn(this,void 0,void 0,function*(){this.loading=!0;try{(yield this.deleteUsers()).data.forEach(e=>{const t=""!==e.error?e.error:this.i18nService.t("bulkRemovedMessage");this.statuses.set(e.id,t)}),this.done=!0}catch(e){this.error=e.message}this.loading=!1})}}function Rn(e,t){1&e&&(W.j41(0,"bit-callout",8),W.EFF(1),W.nI1(2,"i18n"),W.k0s()),2&e&&(W.R7$(),W.SpI(" ",W.bMT(2,1,"noSelectedUsersApplicable")," "))}function wn(e,t){if(1&e&&(W.j41(0,"bit-callout",9),W.nI1(1,"i18n"),W.EFF(2),W.k0s()),2&e){const e=W.XpG();W.Y8G("title",W.bMT(1,2,"error")),W.R7$(2),W.SpI(" ",e.error," ")}}function $n(e,t){1&e&&(W.j41(0,"p",16),W.EFF(1),W.nI1(2,"i18n"),W.k0s()),2&e&&(W.R7$(),W.SpI(" ",W.bMT(2,1,"removeMembersWithoutMasterPasswordWarning")," "))}function Mn(e,t){if(1&e&&(W.j41(0,"bit-callout",15)(1,"p",16),W.EFF(2),W.k0s(),W.DNE(3,$n,3,3,"p",17),W.k0s()),2&e){const e=W.XpG(2);W.R7$(2),W.JRh(e.removeUsersWarning),W.R7$(),W.Y8G("ngIf",e.showNoMasterPasswordWarning)}}function Fn(e,t){1&e&&(W.j41(0,"th",18),W.EFF(1),W.nI1(2,"i18n"),W.k0s()),2&e&&(W.R7$(),W.JRh(W.bMT(2,1,"details")))}function Tn(e,t){if(1&e&&(W.j41(0,"small",24),W.EFF(1),W.k0s()),2&e){const e=W.XpG().$implicit;W.R7$(),W.JRh(e.name)}}function En(e,t){1&e&&(W.qex(0),W.EFF(1," - "),W.bVm())}function Gn(e,t){1&e&&(W.qex(0),W.nrm(1,"i",26),W.EFF(2),W.nI1(3,"i18n"),W.bVm()),2&e&&(W.R7$(2),W.SpI(" ",W.bMT(3,1,"noMasterPassword")," "))}function Un(e,t){if(1&e&&(W.j41(0,"td",18)(1,"span",25),W.DNE(2,En,2,0,"ng-container",4)(3,Gn,4,3,"ng-container",4),W.k0s()()),2&e){const e=W.XpG().$implicit;W.R7$(2),W.Y8G("ngIf",!0===e.hasMasterPassword),W.R7$(),W.Y8G("ngIf",!1===e.hasMasterPassword)}}function jn(e,t){if(1&e&&(W.j41(0,"tr",20)(1,"td",21),W.nrm(2,"bit-avatar",22),W.nI1(3,"userName"),W.k0s(),W.j41(4,"td",18),W.EFF(5),W.DNE(6,Tn,2,1,"small",23),W.k0s(),W.DNE(7,Un,4,2,"td",13),W.k0s()),2&e){const e=t.$implicit,i=W.XpG(3);W.R7$(2),W.Y8G("text",W.bMT(3,5,e))("id",e.id),W.R7$(3),W.SpI(" ",e.email," "),W.R7$(),W.Y8G("ngIf",e.name),W.R7$(),W.Y8G("ngIf",i.showNoMasterPasswordWarning)}}function Cn(e,t){if(1&e&&W.DNE(0,jn,8,7,"tr",19),2&e){const e=W.XpG(2);W.Y8G("ngForOf",e.users)}}function xn(e,t){if(1&e&&(W.qex(0),W.DNE(1,Mn,4,2,"bit-callout",10),W.j41(2,"bit-table"),W.qex(3,11),W.j41(4,"tr")(5,"th",12),W.EFF(6),W.nI1(7,"i18n"),W.k0s(),W.DNE(8,Fn,3,3,"th",13),W.k0s(),W.bVm(),W.DNE(9,Cn,1,1,"ng-template",14),W.k0s(),W.bVm()),2&e){const e=W.XpG();W.R7$(),W.Y8G("ngIf",e.users.length>0&&!e.error),W.R7$(5),W.JRh(W.bMT(7,3,"user")),W.R7$(2),W.Y8G("ngIf",e.showNoMasterPasswordWarning)}}function Dn(e,t){if(1&e&&(W.j41(0,"small",24),W.EFF(1),W.k0s()),2&e){const e=W.XpG().$implicit;W.R7$(),W.JRh(e.name)}}function Xn(e,t){if(1&e&&(W.j41(0,"td",18),W.EFF(1),W.k0s()),2&e){const e=W.XpG().$implicit,t=W.XpG(3);W.R7$(),W.SpI(" ",t.statuses.get(e.id)," ")}}function Nn(e,t){1&e&&(W.j41(0,"td",18),W.EFF(1),W.nI1(2,"i18n"),W.k0s()),2&e&&(W.R7$(),W.SpI(" ",W.bMT(2,1,"bulkFilteredMessage")," "))}function Pn(e,t){if(1&e&&(W.j41(0,"tr",20)(1,"td",21),W.nrm(2,"bit-avatar",22),W.nI1(3,"userName"),W.k0s(),W.j41(4,"td",18),W.EFF(5),W.DNE(6,Dn,2,1,"small",23),W.k0s(),W.DNE(7,Xn,2,1,"td",13)(8,Nn,3,3,"td",13),W.k0s()),2&e){const e=t.$implicit,i=W.XpG(3);W.R7$(2),W.Y8G("text",W.bMT(3,6,e))("id",e.id),W.R7$(3),W.SpI(" ",e.email," "),W.R7$(),W.Y8G("ngIf",e.name),W.R7$(),W.Y8G("ngIf",i.statuses.has(e.id)),W.R7$(),W.Y8G("ngIf",!i.statuses.has(e.id))}}function Vn(e,t){if(1&e&&W.DNE(0,Pn,9,8,"tr",19),2&e){const e=W.XpG(2);W.Y8G("ngForOf",e.users)}}function An(e,t){1&e&&(W.qex(0),W.j41(1,"bit-table"),W.qex(2,11),W.j41(3,"tr")(4,"th",12),W.EFF(5),W.nI1(6,"i18n"),W.k0s(),W.j41(7,"th",18),W.EFF(8),W.nI1(9,"i18n"),W.k0s()(),W.bVm(),W.DNE(10,Vn,1,1,"ng-template",14),W.k0s(),W.bVm()),2&e&&(W.R7$(5),W.JRh(W.bMT(6,2,"user")),W.R7$(3),W.JRh(W.bMT(9,4,"status")))}function zn(e,t){if(1&e&&(W.j41(0,"button",27),W.EFF(1),W.nI1(2,"i18n"),W.k0s()),2&e){const e=W.XpG();W.Y8G("disabled",e.loading)("bitAction",e.submit),W.R7$(),W.SpI(" ",W.bMT(2,3,"removeMembers")," ")}}kn.ɵfac=function(e){return new(e||kn)(W.rXU(h.W))},kn.ɵdir=W.FsC({type:kn});class Bn extends kn{constructor(e,t,i){super(t),this.dialogParams=e,this.i18nService=t,this.organizationUserApiService=i,this.deleteUsers=()=>this.organizationUserApiService.removeManyOrganizationUsers(this.organizationId,this.users.map(e=>e.id)),this.organizationId=e.organizationId,this.users=e.users,this.showNoMasterPasswordWarning=this.users.some(e=>e.status>j.Zx.Invited&&!1===e.hasMasterPassword)}get removeUsersWarning(){return this.i18nService.t("removeOrgUsersConfirmation")}static open(e,t){return e.open(Bn,t)}}Bn.ɵfac=function(e){return new(e||Bn)(W.rXU(N.Qs),W.rXU(h.W),W.rXU(G.uB))},Bn.ɵcmp=W.VBU({type:Bn,selectors:[["member-bulk-remove-dialog"]],standalone:!1,features:[W.Vt3],decls:12,vars:11,consts:[["dialogSize","large",3,"title"],["bitDialogContent",""],["type","danger",4,"ngIf"],["type","danger",3,"title",4,"ngIf"],[4,"ngIf"],["bitDialogFooter",""],["bitButton","","type","submit","buttonType","primary",3,"disabled","bitAction",4,"ngIf"],["bitButton","","type","button","buttonType","secondary","bitDialogClose",""],["type","danger"],["type","danger",3,"title"],["type","warning",4,"ngIf"],["header",""],["bitCell","","colspan","2"],["bitCell","",4,"ngIf"],["body",""],["type","warning"],["bitTypography","body1"],["bitTypography","body1",4,"ngIf"],["bitCell",""],["bitRow","",4,"ngFor","ngForOf"],["bitRow",""],["bitCell","",1,"tw-w-5"],["size","small",3,"text","id"],["class","tw-text-muted tw-block",4,"ngIf"],[1,"tw-text-muted","tw-block"],[1,"tw-text-muted","tw-block","tw-lowercase"],["aria-hidden","true",1,"bwi","bwi-exclamation-triangle"],["bitButton","","type","submit","buttonType","primary",3,"disabled","bitAction"]],template:function(e,t){1&e&&(W.j41(0,"bit-dialog",0),W.nI1(1,"i18n"),W.qex(2,1),W.DNE(3,Rn,3,3,"bit-callout",2)(4,wn,3,4,"bit-callout",3)(5,xn,10,5,"ng-container",4)(6,An,11,6,"ng-container",4),W.bVm(),W.qex(7,5),W.DNE(8,zn,3,5,"button",6),W.j41(9,"button",7),W.EFF(10),W.nI1(11,"i18n"),W.k0s(),W.bVm(),W.k0s()),2&e&&(W.Y8G("title",W.bMT(1,7,"removeMembers")),W.R7$(3),W.Y8G("ngIf",t.users.length<=0),W.R7$(),W.Y8G("ngIf",t.error),W.R7$(),W.Y8G("ngIf",!t.done),W.R7$(),W.Y8G("ngIf",t.done),W.R7$(2),W.Y8G("ngIf",!t.done&&t.users.length>0),W.R7$(2),W.SpI(" ",W.bMT(11,9,"close")," "))},dependencies:[q.Sq,q.bT,_.p,Ci.f,te.Q,vi.G,mt.I,ne.m,wt.Q,$t.Y,Mt._,Mt.O,me.r,fe.$,Qt.b],encapsulation:2});var Yn=function(e,t,i,n){return new(i||(i=Promise))(function(s,r){function o(e){try{c(n.next(e))}catch(t){r(t)}}function a(e){try{c(n.throw(e))}catch(t){r(t)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(o,a)}c((n=n.apply(e,t||[])).next())})};const On=e=>({$implicit:e});function Jn(e,t){1&e&&(W.j41(0,"bit-callout",11),W.EFF(1),W.nI1(2,"i18n"),W.k0s()),2&e&&(W.R7$(),W.SpI(" ",W.bMT(2,1,"noSelectedUsersApplicable")," "))}function Wn(e,t){if(1&e&&(W.j41(0,"bit-callout",11),W.EFF(1),W.k0s()),2&e){const e=W.XpG();W.R7$(),W.SpI(" ",e.error," ")}}function Qn(e,t){1&e&&(W.j41(0,"bit-callout",12),W.nI1(1,"i18n"),W.EFF(2),W.nI1(3,"i18n"),W.k0s()),2&e&&(W.Y8G("title",W.mNQ(W.bMT(1,3,"nonCompliantMembersTitle"))),W.R7$(2),W.SpI(" ",W.bMT(3,5,"nonCompliantMembersError")," "))}function Ln(e,t){if(1&e&&(W.qex(0),W.j41(1,"div",17),W.EFF(2),W.j41(3,"small",18),W.EFF(4),W.k0s()(),W.bVm()),2&e){const e=W.XpG().$implicit;W.R7$(),W.Y8G("title",e.name+" "+e.email),W.R7$(),W.SpI(" ",e.name," "),W.R7$(2),W.SpI(" ",e.email," ")}}function qn(e,t){if(1&e&&(W.j41(0,"div",17),W.EFF(1),W.k0s()),2&e){const e=W.XpG().$implicit;W.Y8G("title",e.email),W.R7$(),W.JRh(e.email)}}function Kn(e,t){if(1&e&&(W.j41(0,"div",13)(1,"div",14),W.nrm(2,"bit-avatar",15),W.nI1(3,"userName"),W.k0s(),W.DNE(4,Ln,5,3,"ng-container",16)(5,qn,2,2,"ng-template",null,1,W.C5r),W.k0s()),2&e){const e=t.$implicit,i=W.sdS(6);W.R7$(2),W.Y8G("text",W.bMT(3,4,e))("id",e.id),W.R7$(2),W.Y8G("ngIf",e.name)("ngIfElse",i)}}function _n(e,t){1&e&&(W.j41(0,"p"),W.EFF(1),W.nI1(2,"i18n"),W.k0s()),2&e&&(W.R7$(),W.JRh(W.bMT(2,1,"revokeUsersWarning")))}function Hn(e,t){1&e&&(W.j41(0,"th",23),W.EFF(1),W.nI1(2,"i18n"),W.k0s()),2&e&&(W.R7$(),W.SpI(" ",W.bMT(2,1,"details")," "))}function Zn(e,t){1&e&&W.eu8(0)}function es(e,t){1&e&&(W.qex(0),W.EFF(1," - "),W.bVm())}function ts(e,t){1&e&&(W.qex(0),W.nrm(1,"i",29),W.EFF(2),W.nI1(3,"i18n"),W.bVm()),2&e&&(W.R7$(2),W.SpI(" ",W.bMT(3,1,"noMasterPassword")," "))}function is(e,t){if(1&e&&(W.j41(0,"td",23)(1,"span",28),W.DNE(2,es,2,0,"ng-container",7)(3,ts,4,3,"ng-container",7),W.k0s()()),2&e){const e=W.XpG().$implicit;W.R7$(2),W.Y8G("ngIf",!0===e.hasMasterPassword),W.R7$(),W.Y8G("ngIf",!1===e.hasMasterPassword)}}function ns(e,t){if(1&e&&(W.j41(0,"tr",25)(1,"td",26),W.DNE(2,Zn,1,0,"ng-container",27),W.k0s(),W.DNE(3,is,4,2,"td",21),W.k0s()),2&e){const e=t.$implicit,i=W.XpG(3),n=W.sdS(9);W.R7$(2),W.Y8G("ngTemplateOutlet",n)("ngTemplateOutletContext",W.eq3(3,On,e)),W.R7$(),W.Y8G("ngIf",i.showNoMasterPasswordWarning)}}function ss(e,t){if(1&e&&W.DNE(0,ns,4,5,"tr",24),2&e){const e=W.XpG(2);W.Y8G("ngForOf",e.users)}}function rs(e,t){if(1&e&&(W.qex(0),W.DNE(1,_n,3,3,"p",7),W.j41(2,"bit-table"),W.qex(3,19),W.j41(4,"tr")(5,"th",20),W.EFF(6),W.nI1(7,"i18n"),W.k0s(),W.DNE(8,Hn,3,3,"th",21),W.k0s(),W.bVm(),W.DNE(9,ss,1,1,"ng-template",22),W.k0s(),W.bVm()),2&e){const e=W.XpG();W.R7$(),W.Y8G("ngIf",e.users.length>0&&!e.error&&e.isRevoking),W.R7$(5),W.JRh(W.bMT(7,3,"member")),W.R7$(2),W.Y8G("ngIf",e.showNoMasterPasswordWarning)}}function os(e,t){1&e&&W.eu8(0)}function as(e,t){if(1&e&&(W.j41(0,"td",20),W.EFF(1),W.k0s()),2&e){const e=W.XpG().$implicit,t=W.XpG(3);W.R7$(),W.SpI(" ",t.statuses.get(e.id)," ")}}function cs(e,t){1&e&&(W.j41(0,"td",20),W.EFF(1),W.nI1(2,"i18n"),W.k0s()),2&e&&(W.R7$(),W.SpI(" ",W.bMT(2,1,"bulkFilteredMessage")," "))}function ls(e,t){if(1&e&&(W.j41(0,"tr",25)(1,"td",26),W.DNE(2,os,1,0,"ng-container",27),W.k0s(),W.DNE(3,as,2,1,"td",30)(4,cs,3,3,"td",30),W.k0s()),2&e){const e=t.$implicit,i=W.XpG(3),n=W.sdS(9);W.R7$(2),W.Y8G("ngTemplateOutlet",n)("ngTemplateOutletContext",W.eq3(4,On,e)),W.R7$(),W.Y8G("ngIf",i.statuses.has(e.id)),W.R7$(),W.Y8G("ngIf",!i.statuses.has(e.id))}}function us(e,t){if(1&e&&W.DNE(0,ls,5,6,"tr",24),2&e){const e=W.XpG(2);W.Y8G("ngForOf",e.users)}}function ds(e,t){1&e&&(W.qex(0),W.j41(1,"bit-table"),W.qex(2,19),W.j41(3,"tr")(4,"th",23),W.EFF(5),W.nI1(6,"i18n"),W.k0s(),W.j41(7,"th",23),W.EFF(8),W.nI1(9,"i18n"),W.k0s()(),W.bVm(),W.DNE(10,us,1,1,"ng-template",22),W.k0s(),W.bVm()),2&e&&(W.R7$(5),W.SpI(" ",W.bMT(6,2,"member")," "),W.R7$(3),W.JRh(W.bMT(9,4,"status")))}function hs(e,t){if(1&e&&(W.j41(0,"button",31),W.EFF(1),W.k0s()),2&e){const e=W.XpG();W.Y8G("bitAction",e.submit),W.R7$(),W.SpI(" ",e.bulkTitle," ")}}class ps{constructor(e,t,i,n,s,r,o){this.i18nService=e,this.organizationUserApiService=t,this.organizationUserService=i,this.accountService=n,this.organizationService=s,this.configService=r,this.data=o,this.statuses=new Map,this.loading=!1,this.done=!1,this.showNoMasterPasswordWarning=!1,this.nonCompliantMembers=!1,this.submit=()=>Yn(this,void 0,void 0,function*(){try{const e=yield this.performBulkUserAction(),t=this.isRevoking?"bulkRevokedMessage":"bulkRestoredMessage";e.data.forEach(e=>Yn(this,void 0,void 0,function*(){const i=""!==e.error?e.error:this.i18nService.t(t);this.statuses.set(e.id,i),""===e.error||this.isRevoking||(this.nonCompliantMembers=!0)})),this.done=!0}catch(e){this.error=e.message}}),this.isRevoking=o.isRevoking,this.organizationId=o.organizationId,this.users=o.users,this.showNoMasterPasswordWarning=this.users.some(e=>e.status>j.Zx.Invited&&!1===e.hasMasterPassword),this.organization$=n.activeAccount$.pipe(x.F6,(0,$.n)(e=>s.organizations$(e)),(0,X.Hc)(this.organizationId),(0,M.T)(e=>{if(null==e)throw new Error("Organization not found");return e}))}get bulkTitle(){const e=this.isRevoking?"revokeMembers":"restoreMembers";return this.i18nService.t(e)}performBulkUserAction(){return Yn(this,void 0,void 0,function*(){const e=this.users.map(e=>e.id);return this.isRevoking?yield this.organizationUserApiService.revokeManyOrganizationUsers(this.organizationId,e):yield(0,R._)((0,w.z)([this.configService.getFeatureFlag$(D.TO.DefaultUserCollectionRestore),this.organization$]).pipe((0,$.n)(([t,i])=>t?this.organizationUserService.bulkRestoreUsers(i,e):this.organizationUserApiService.restoreManyOrganizationUsers(this.organizationId,e))))})}static open(e,t){return e.open(ps,{data:t})}}ps.ɵfac=function(e){return new(e||ps)(W.rXU(h.W),W.rXU(G.uB),W.rXU(G.Ki),W.rXU(Q.D),W.rXU(U.PV),W.rXU(L.w),W.rXU(N.Qs))},ps.ɵcmp=W.VBU({type:ps,selectors:[["member-bulk-restore-revoke"]],standalone:!1,decls:17,vars:10,consts:[["userDisplay",""],["emailOnly",""],["dialogSize","large"],["bitDialogTitle",""],["bitDialogContent",""],["type","danger",4,"ngIf"],["type","danger",3,"title",4,"ngIf"],[4,"ngIf"],["bitDialogFooter",""],["type","button","bitButton","","buttonType","primary",3,"bitAction",4,"ngIf"],["type","button","bitButton","","buttonType","secondary","bitDialogClose",""],["type","danger"],["type","danger",3,"title"],[1,"tw-flex","tw-items-center"],[1,"tw-mr-6"],["size","small",3,"text","id"],[4,"ngIf","ngIfElse"],[1,"tw-truncate",3,"title"],[1,"tw-block","tw-text-muted","tw-truncate"],["header",""],["bitCell",""],["bitCell","","class","tw-w-1/2",4,"ngIf"],["body",""],["bitCell","",1,"tw-w-1/2"],["bitRow","",4,"ngFor","ngForOf"],["bitRow",""],["bitCell","",1,"tw-max-w-0"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"tw-block","tw-lowercase","tw-text-muted"],["aria-hidden","true",1,"bwi","bwi-exclamation-triangle"],["bitCell","",4,"ngIf"],["type","button","bitButton","","buttonType","primary",3,"bitAction"]],template:function(e,t){1&e&&(W.j41(0,"bit-dialog",2),W.qex(1,3),W.j41(2,"span"),W.EFF(3),W.k0s(),W.bVm(),W.j41(4,"div",4),W.DNE(5,Jn,3,3,"bit-callout",5)(6,Wn,2,1,"bit-callout",5)(7,Qn,4,7,"bit-callout",6)(8,Kn,7,6,"ng-template",null,0,W.C5r)(10,rs,10,5,"ng-container",7)(11,ds,11,6,"ng-container",7),W.k0s(),W.qex(12,8),W.DNE(13,hs,2,2,"button",9),W.j41(14,"button",10),W.EFF(15),W.nI1(16,"i18n"),W.k0s(),W.bVm(),W.k0s()),2&e&&(W.R7$(3),W.JRh(t.bulkTitle),W.R7$(2),W.Y8G("ngIf",t.users.length<=0),W.R7$(),W.Y8G("ngIf",t.error),W.R7$(),W.Y8G("ngIf",t.nonCompliantMembers&&!t.isRevoking),W.R7$(3),W.Y8G("ngIf",!t.done),W.R7$(),W.Y8G("ngIf",t.done),W.R7$(2),W.Y8G("ngIf",!t.done&&t.users.length>0),W.R7$(2),W.SpI(" ",W.bMT(16,8,"close")," "))},dependencies:[q.Sq,q.bT,q.T3,_.p,Ci.f,te.Q,vi.G,mt.I,ne.m,wt.Q,$t.Y,Mt._,Mt.O,fe.$,Qt.b],encapsulation:2});var ms=function(e,t,i,n){return new(i||(i=Promise))(function(s,r){function o(e){try{c(n.next(e))}catch(t){r(t)}}function a(e){try{c(n.throw(e))}catch(t){r(t)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(o,a)}c((n=n.apply(e,t||[])).next())})};function gs(e,t){1&e&&(W.j41(0,"div",6),W.nrm(1,"i",7),W.nI1(2,"i18n"),W.EFF(3),W.nI1(4,"i18n"),W.k0s()),2&e&&(W.R7$(),W.Y8G("title",W.mNQ(W.bMT(2,3,"loading"))),W.R7$(2),W.SpI(" ",W.bMT(4,5,"loading")," "))}function bs(e,t){if(1&e&&(W.j41(0,"small",19),W.EFF(1),W.k0s()),2&e){const e=W.XpG().$implicit;W.R7$(),W.JRh(e.user.name)}}function fs(e,t){if(1&e&&(W.j41(0,"td",20),W.EFF(1),W.k0s()),2&e){const e=W.XpG().$implicit;W.R7$(),W.SpI(" ",e.message," ")}}function vs(e,t){if(1&e&&(W.j41(0,"td",10),W.EFF(1),W.k0s()),2&e){const e=W.XpG().$implicit;W.R7$(),W.SpI(" ",e.message," ")}}function Ss(e,t){if(1&e&&(W.j41(0,"tr",13)(1,"td",14),W.nrm(2,"bit-avatar",15),W.nI1(3,"userName"),W.k0s(),W.j41(4,"td",10),W.EFF(5),W.DNE(6,bs,2,1,"small",16),W.k0s(),W.DNE(7,fs,2,1,"td",17)(8,vs,2,1,"td",18),W.k0s()),2&e){const e=t.$implicit;W.R7$(2),W.Y8G("text",W.bMT(3,6,e.user))("id",e.user.id),W.R7$(3),W.SpI(" ",e.user.email," "),W.R7$(),W.Y8G("ngIf",e.user.name),W.R7$(),W.Y8G("ngIf",e.error),W.R7$(),W.Y8G("ngIf",!e.error)}}function Is(e,t){if(1&e&&W.DNE(0,Ss,9,8,"tr",12),2&e){const e=W.XpG(2);W.Y8G("ngForOf",e.users)}}function ys(e,t){1&e&&(W.j41(0,"bit-table"),W.qex(1,8),W.j41(2,"tr")(3,"th",9),W.EFF(4),W.nI1(5,"i18n"),W.k0s(),W.j41(6,"th",10),W.EFF(7),W.nI1(8,"i18n"),W.k0s()(),W.bVm(),W.DNE(9,Is,1,1,"ng-template",11),W.k0s()),2&e&&(W.R7$(4),W.JRh(W.bMT(5,2,"user")),W.R7$(3),W.JRh(W.bMT(8,4,"status")))}class ks{constructor(e,t,i){this.data=e,this.i18nService=t,this.logService=i,this.loading=!1}ngOnInit(){return ms(this,void 0,void 0,function*(){this.loading=!0,yield this.showBulkStatus(this.data)})}showBulkStatus(e){return ms(this,void 0,void 0,function*(){try{const t=(yield e.request).data.filter(e=>""!==e.error).reduce((e,t)=>Object.assign(Object.assign({},e),{[t.id]:t.error}),{}),i=e.filteredUsers.reduce((e,t)=>Object.assign(Object.assign({},e),{[t.id]:t}),{});this.users=e.users.map(n=>{var s;let r=null!==(s=t[n.id])&&void 0!==s?s:e.successfulMessage;return i.hasOwnProperty(n.id)||(r=this.i18nService.t("bulkFilteredMessage")),{user:n,error:t.hasOwnProperty(n.id),message:r}}),this.loading=!1}catch(t){this.logService.error(t)}})}static open(e,t){return e.open(ks,t)}}ks.ɵfac=function(e){return new(e||ks)(W.rXU(N.Qs),W.rXU(h.W),W.rXU(rt.K))},ks.ɵcmp=W.VBU({type:ks,selectors:[["member-bulk-status"]],standalone:!1,decls:9,vars:8,consts:[["dialogSize","large",3,"title"],["bitDialogContent",""],["class","tw-text-center",4,"ngIf"],[4,"ngIf"],["bitDialogFooter",""],["bitButton","","type","button","buttonType","secondary","bitDialogClose",""],[1,"tw-text-center"],["aria-hidden","true",1,"bwi","bwi-spinner","bwi-spin",3,"title"],["header",""],["colspan","2","bitCell",""],["bitCell",""],["body",""],["bitRow","",4,"ngFor","ngForOf"],["bitRow",""],["width","30","bitCell",""],["size","small",3,"text","id"],["class","tw-text-muted tw-block",4,"ngIf"],["class","tw-text-danger","bitCell","",4,"ngIf"],["bitCell","",4,"ngIf"],[1,"tw-text-muted","tw-block"],["bitCell","",1,"tw-text-danger"]],template:function(e,t){1&e&&(W.j41(0,"bit-dialog",0),W.nI1(1,"i18n"),W.qex(2,1),W.DNE(3,gs,5,7,"div",2)(4,ys,10,6,"bit-table",3),W.bVm(),W.qex(5,4),W.j41(6,"button",5),W.EFF(7),W.nI1(8,"i18n"),W.k0s(),W.bVm(),W.k0s()),2&e&&(W.Y8G("title",W.bMT(1,4,"bulkConfirmStatus")),W.R7$(3),W.Y8G("ngIf",t.loading),W.R7$(),W.Y8G("ngIf",!t.loading),W.R7$(3),W.SpI(" ",W.bMT(8,6,"close")," "))},dependencies:[q.Sq,q.bT,Ci.f,te.Q,mt.I,ne.m,wt.Q,$t.Y,Mt._,Mt.O,fe.$,Qt.b],encapsulation:2});var Rs=function(e,t,i,n){return new(i||(i=Promise))(function(s,r){function o(e){try{c(n.next(e))}catch(t){r(t)}}function a(e){try{c(n.throw(e))}catch(t){r(t)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(o,a)}c((n=n.apply(e,t||[])).next())})};class ws{constructor(e,t,i,n,s){this.dialogService=e,this.i18nService=t,this.toastService=i,this.userNamePipe=n,this.deleteManagedMemberWarningService=s}openInviteDialog(e,t,i){return Rs(this,void 0,void 0,function*(){var n,s;const r=_e(this.dialogService,{data:{kind:"Add",organizationId:e.id,allOrganizationUserEmails:i,occupiedSeatCount:null!==(n=null==t?void 0:t.organizationOccupiedSeats)&&void 0!==n?n:0,isOnSecretsManagerStandalone:null!==(s=null==t?void 0:t.isOnSecretsManagerStandalone)&&void 0!==s&&s}}),a=yield(0,o.s)(r.closed);return null!=a?a:Le.Canceled})}openEditDialog(e,t,i){return Rs(this,arguments,void 0,function*(e,t,i,n=Qe.Role){var s;const r=_e(this.dialogService,{data:{kind:"Edit",name:this.userNamePipe.transform(e),organizationId:t.id,organizationUserId:e.id,usesKeyConnector:e.usesKeyConnector,isOnSecretsManagerStandalone:null!==(s=null==i?void 0:i.isOnSecretsManagerStandalone)&&void 0!==s&&s,initialTab:n,managedByOrganization:e.managedByOrganization}}),a=yield(0,o.s)(r.closed);return null!=a?a:Le.Canceled})}openAccountRecoveryDialog(e,t){return Rs(this,void 0,void 0,function*(){const i=yi.open(this.dialogService,{data:{name:this.userNamePipe.transform(e),email:e.email,organizationId:t.id,organizationUserId:e.id}}),n=yield(0,o.s)(i.closed);return null!=n?n:Ii})}openBulkConfirmDialog(e,t){return Rs(this,void 0,void 0,function*(){const i=Ki.open(this.dialogService,{data:{organization:e,users:t}});yield(0,o.s)(i.closed)})}openBulkRemoveDialog(e,t){return Rs(this,void 0,void 0,function*(){const i=Bn.open(this.dialogService,{data:{organizationId:e.id,users:t}});yield(0,o.s)(i.closed)})}openBulkDeleteDialog(e,t){return Rs(this,void 0,void 0,function*(){if(!(yield(0,R._)(this.deleteManagedMemberWarningService.warningAcknowledged(e.id)))&&e.canManageUsers&&e.productTierType===a.K_.Enterprise){if(!(yield this.deleteManagedMemberWarningService.showWarning()))return}const i=mn.open(this.dialogService,{data:{organizationId:e.id,users:t}});yield(0,o.s)(i.closed)})}openBulkRestoreRevokeDialog(e,t,i){return Rs(this,void 0,void 0,function*(){const n=ps.open(this.dialogService,{organizationId:e.id,users:t,isRevoking:i});yield(0,R._)(n.closed)})}openBulkEnableSecretsManagerDialog(e,t){return Rs(this,void 0,void 0,function*(){const i=t.filter(e=>!e.accessSecretsManager);if(0===i.length)return void this.toastService.showToast({variant:"error",title:this.i18nService.t("errorOccurred"),message:this.i18nService.t("noSelectedUsersApplicable")});const n=In.open(this.dialogService,{orgId:e.id,users:i});yield(0,o.s)(n.closed)})}openBulkStatusDialog(e,t,i,n){return Rs(this,void 0,void 0,function*(){const s=ks.open(this.dialogService,{data:{users:e,filteredUsers:t,request:i,successfulMessage:n}});yield(0,o.s)(s.closed)})}openEventsDialog(e,t){(0,Gi.l)(this.dialogService,{data:{name:this.userNamePipe.transform(e),organizationId:t.id,entityId:e.id,showUser:!1,entity:"user"}})}openRemoveUserConfirmationDialog(e){return Rs(this,void 0,void 0,function*(){const t=e.usesKeyConnector?"removeUserConfirmationKeyConnector":"removeOrgUserConfirmation";return!!(yield this.dialogService.openSimpleDialog({title:{key:"removeUserIdAccess",placeholders:[this.userNamePipe.transform(e)]},content:{key:t},type:"warning"}))&&(!(e.status>0&&!1===e.hasMasterPassword)||(yield this.openNoMasterPasswordConfirmationDialog(e)))})}openRevokeUserConfirmationDialog(e){return Rs(this,void 0,void 0,function*(){return!!(yield this.dialogService.openSimpleDialog({title:{key:"revokeAccess",placeholders:[this.userNamePipe.transform(e)]},content:this.i18nService.t("revokeUserConfirmation"),acceptButtonText:{key:"revokeAccess"},type:"warning"}))&&(!(e.status>0&&!1===e.hasMasterPassword)||(yield this.openNoMasterPasswordConfirmationDialog(e)))})}openDeleteUserConfirmationDialog(e,t){return Rs(this,void 0,void 0,function*(){if(!(yield(0,R._)(this.deleteManagedMemberWarningService.warningAcknowledged(t.id)))&&t.canManageUsers&&t.productTierType===a.K_.Enterprise){if(!(yield this.deleteManagedMemberWarningService.showWarning()))return!1}const i=yield this.dialogService.openSimpleDialog({title:{key:"deleteOrganizationUser",placeholders:[this.userNamePipe.transform(e)]},content:{key:"deleteOrganizationUserWarningDesc",placeholders:[this.userNamePipe.transform(e)]},type:"warning",acceptButtonText:{key:"delete"},cancelButtonText:{key:"cancel"}});return i&&(yield this.deleteManagedMemberWarningService.acknowledgeWarning(t.id)),i})}openNoMasterPasswordConfirmationDialog(e){return Rs(this,void 0,void 0,function*(){return this.dialogService.openSimpleDialog({title:{key:"removeOrgUserNoMasterPasswordTitle"},content:{key:"removeOrgUserNoMasterPasswordDesc",placeholders:[this.userNamePipe.transform(e)]},type:"warning"})})}}ws.ɵfac=function(e){return new(e||ws)(d.KVO(p.o3),d.KVO(h.W),d.KVO(m.f),d.KVO(Qt.b),d.KVO(Y))},ws.ɵprov=d.jDH({token:ws,factory:ws.ɵfac});var $s=i(98869),Ms=i(53127),Fs=i(67253);class Ts{constructor(e){this.i18nService=e}transform(e){if(null==e)return this.i18nService.t("unknown");switch(e){case j.Zx.Invited:return this.i18nService.t("invited");case j.Zx.Accepted:return this.i18nService.t("accepted");case j.Zx.Confirmed:return this.i18nService.t("confirmed");case j.Zx.Revoked:return this.i18nService.t("revoked");default:return this.i18nService.t("unknown")}}}Ts.ɵfac=function(e){return new(e||Ts)(W.rXU(h.W,16))},Ts.ɵpipe=W.EJ8({name:"userStatus",type:Ts,pure:!0,standalone:!1});class Es{static fromOrganizationUserView(e,t,i,n){var s,r,o;return{[e.t("email")]:n.email,[e.t("name")]:null!==(s=n.name)&&void 0!==s?s:"",[e.t("status")]:i.transform(n.status),[e.t("role")]:t.transform(n.type),[e.t("twoStepLogin")]:n.twoFactorEnabled?e.t("optionEnabled"):e.t("disabled"),[e.t("accountRecovery")]:n.resetPasswordEnrolled?e.t("enrolled"):e.t("notEnrolled"),[e.t("secretsManager")]:n.accessSecretsManager?e.t("optionEnabled"):e.t("disabled"),[e.t("groups")]:null!==(o=null===(r=n.groupNames)||void 0===r?void 0:r.join(", "))&&void 0!==o?o:""}}}class Gs{constructor(){this.i18nService=(0,d.WQX)(h.W),this.userTypePipe=(0,d.WQX)(gn.c),this.userStatusPipe=(0,d.WQX)(Ts),this.fileDownloadService=(0,d.WQX)(Ms.y),this.logService=(0,d.WQX)(rt.K)}getMemberExport(e){try{const t=e;if(!t||0===t.length)return{success:!1,error:{message:this.i18nService.t("noMembersToExport")}};const i=t.map(e=>Es.fromOrganizationUserView(this.i18nService,this.userTypePipe,this.userStatusPipe,e)),n=[this.i18nService.t("email"),this.i18nService.t("name"),this.i18nService.t("status"),this.i18nService.t("role"),this.i18nService.t("twoStepLogin"),this.i18nService.t("accountRecovery"),this.i18nService.t("secretsManager"),this.i18nService.t("groups")],s=$s.unparse(i,{columns:n,header:!0}),r=this.getFileName("org-members");return this.fileDownloadService.download({fileName:r,blobData:s,blobOptions:{type:"text/plain"}}),{success:!0}}catch(t){this.logService.error(`Failed to export members: ${t}`);return{success:!1,error:{message:t instanceof Error?t.message:this.i18nService.t("unexpectedError")}}}}getFileName(e=null,t="csv"){return Fs.Ly.getFileName(null!=e?e:"",t)}}Gs.ɵfac=function(e){return new(e||Gs)},Gs.ɵprov=d.jDH({token:Gs,factory:Gs.ɵfac});var Us=i(27866),js=i(94438),Cs=i(32924),xs=i(32316),Ds=i(12694),Xs=i(16496),Ns=i(5520),Ps=i(69672),Vs=i(440),As=function(e,t,i,n){return new(i||(i=Promise))(function(s,r){function o(e){try{c(n.next(e))}catch(t){r(t)}}function a(e){try{c(n.throw(e))}catch(t){r(t)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(o,a)}c((n=n.apply(e,t||[])).next())})};function zs(e,t){if(1&e){const e=W.RV6();W.j41(0,"button",11),W.bIt("click",function(){d.eBV(e);const t=W.XpG(2),i=W.r8f(0);return d.Njj(t.invite(i))}),W.nrm(1,"i",12),W.EFF(2),W.nI1(3,"i18n"),W.k0s()}if(2&e){const e=W.XpG(2);W.Y8G("disabled",!e.firstLoaded),W.R7$(2),W.SpI(" ",W.bMT(3,2,"inviteMember")," ")}}function Bs(e,t){if(1&e&&(W.j41(0,"span",16),W.EFF(1),W.k0s()),2&e){const e=t.ngIf;W.R7$(),W.JRh(e)}}function Ys(e,t){if(1&e&&(W.j41(0,"span",16),W.EFF(1),W.k0s()),2&e){const e=t.ngIf;W.R7$(),W.JRh(e)}}function Os(e,t){if(1&e&&(W.j41(0,"span",16),W.EFF(1),W.k0s()),2&e){const e=t.ngIf;W.R7$(),W.JRh(e)}}function Js(e,t){if(1&e&&(W.j41(0,"span",16),W.EFF(1),W.k0s()),2&e){const e=t.ngIf;W.R7$(),W.JRh(e)}}function Ws(e,t){if(1&e){const e=W.RV6();W.j41(0,"bit-toggle-group",13),W.nI1(1,"i18n"),W.bIt("selectedChange",function(t){d.eBV(e);const i=W.XpG(2);return d.Njj(i.statusToggle.next(t))}),W.j41(2,"bit-toggle",14),W.EFF(3),W.nI1(4,"i18n"),W.DNE(5,Bs,2,1,"span",15),W.k0s(),W.j41(6,"bit-toggle",14),W.EFF(7),W.nI1(8,"i18n"),W.DNE(9,Ys,2,1,"span",15),W.k0s(),W.j41(10,"bit-toggle",14),W.EFF(11),W.nI1(12,"i18n"),W.DNE(13,Os,2,1,"span",15),W.k0s(),W.j41(14,"bit-toggle",14),W.EFF(15),W.nI1(16,"i18n"),W.DNE(17,Js,2,1,"span",15),W.k0s()()}if(2&e){const e=W.XpG(2);W.Y8G("selected",e.status),W.BMQ("aria-label",W.bMT(1,14,"memberStatusFilter")),W.R7$(2),W.Y8G("value",null),W.R7$(),W.SpI(" ",W.bMT(4,16,"all")," "),W.R7$(2),W.Y8G("ngIf",e.dataSource.activeUserCount),W.R7$(),W.Y8G("value",e.userStatusType.Invited),W.R7$(),W.SpI(" ",W.bMT(8,18,"invited")," "),W.R7$(2),W.Y8G("ngIf",e.dataSource.invitedUserCount),W.R7$(),W.Y8G("value",e.userStatusType.Accepted),W.R7$(),W.SpI(" ",W.bMT(12,20,"needsConfirmation")," "),W.R7$(2),W.Y8G("ngIf",e.dataSource.acceptedUserCount),W.R7$(),W.Y8G("value",e.userStatusType.Revoked),W.R7$(),W.SpI(" ",W.bMT(16,22,"revoked")," "),W.R7$(2),W.Y8G("ngIf",e.dataSource.revokedUserCount)}}function Qs(e,t){1&e&&(W.qex(0),W.nrm(1,"i",17),W.nI1(2,"i18n"),W.j41(3,"span",18),W.EFF(4),W.nI1(5,"i18n"),W.k0s(),W.bVm()),2&e&&(W.R7$(),W.Y8G("title",W.mNQ(W.bMT(2,3,"loading"))),W.R7$(3),W.JRh(W.bMT(5,5,"loading")))}function Ls(e,t){1&e&&(W.j41(0,"p"),W.EFF(1),W.nI1(2,"i18n"),W.k0s()),2&e&&(W.R7$(),W.JRh(W.bMT(2,1,"noMembersInList")))}function qs(e,t){1&e&&(W.j41(0,"bit-callout",32),W.nI1(1,"i18n"),W.EFF(2),W.nI1(3,"i18n"),W.k0s()),2&e&&(W.Y8G("title",W.mNQ(W.bMT(1,3,"confirmUsers"))),W.R7$(2),W.SpI(" ",W.bMT(3,5,"usersNeedConfirmed")," "))}function Ks(e,t){if(1&e){const e=W.RV6();W.j41(0,"th",33)(1,"input",34),W.bIt("change",function(t){d.eBV(e);const i=W.XpG(4);return d.Njj(i.dataSource.checkAllFilteredUsers(t.target.checked))}),W.k0s(),W.j41(2,"label",35),W.EFF(3),W.nI1(4,"i18n"),W.k0s()()}2&e&&(W.R7$(3),W.JRh(W.bMT(4,1,"all")))}function _s(e,t){if(1&e&&(W.nrm(0,"button",36),W.nI1(1,"i18n")),2&e){W.XpG();const e=W.sdS(25);W.Y8G("label",W.mNQ(W.bMT(1,3,"options")))("bitMenuTriggerFor",e)}}function Hs(e,t){if(1&e){const e=W.RV6();W.qex(0),W.j41(1,"button",37),W.bIt("click",function(){d.eBV(e);const t=W.XpG(4),i=W.r8f(0);return d.Njj(t.bulkEnableSM(i))}),W.EFF(2),W.nI1(3,"i18n"),W.k0s(),W.nrm(4,"bit-menu-divider"),W.bVm()}2&e&&(W.R7$(2),W.SpI(" ",W.bMT(3,1,"activateSecretsManager")," "))}function Zs(e,t){if(1&e){const e=W.RV6();W.j41(0,"button",37),W.bIt("click",function(){d.eBV(e);const t=W.XpG(4),i=W.r8f(0);return d.Njj(t.bulkReinvite(i))}),W.nrm(1,"i",38),W.EFF(2),W.nI1(3,"i18n"),W.k0s()}if(2&e){const e=W.XpG(4);W.R7$(2),W.SpI(" ",W.bMT(3,1,e.isSingleInvite?"resendInvitation":"reinviteSelected")," ")}}function er(e,t){if(1&e){const e=W.RV6();W.j41(0,"button",37),W.bIt("click",function(){d.eBV(e);const t=W.XpG(4),i=W.r8f(0);return d.Njj(t.bulkConfirm(i))}),W.j41(1,"span",39),W.nrm(2,"i",40),W.EFF(3),W.nI1(4,"i18n"),W.k0s()()}2&e&&(W.R7$(3),W.SpI(" ",W.bMT(4,1,"confirmSelected")," "))}function tr(e,t){if(1&e){const e=W.RV6();W.j41(0,"button",37),W.bIt("click",function(){d.eBV(e);const t=W.XpG(4),i=W.r8f(0);return d.Njj(t.bulkRestore(i))}),W.nrm(1,"i",41),W.EFF(2),W.nI1(3,"i18n"),W.k0s()}2&e&&(W.R7$(2),W.SpI(" ",W.bMT(3,1,"restoreAccess")," "))}function ir(e,t){if(1&e){const e=W.RV6();W.j41(0,"button",37),W.bIt("click",function(){d.eBV(e);const t=W.XpG(4),i=W.r8f(0);return d.Njj(t.bulkRevoke(i))}),W.nrm(1,"i",42),W.EFF(2),W.nI1(3,"i18n"),W.k0s()}2&e&&(W.R7$(2),W.SpI(" ",W.bMT(3,1,"revokeAccess")," "))}function nr(e,t){if(1&e){const e=W.RV6();W.j41(0,"button",37),W.bIt("click",function(){d.eBV(e);const t=W.XpG(4),i=W.r8f(0);return d.Njj(t.bulkRemove(i))}),W.j41(1,"span",43),W.nrm(2,"i",44),W.EFF(3),W.nI1(4,"i18n"),W.k0s()()}2&e&&(W.R7$(3),W.SpI(" ",W.bMT(4,1,"remove")," "))}function sr(e,t){if(1&e){const e=W.RV6();W.j41(0,"button",37),W.bIt("click",function(){d.eBV(e);const t=W.XpG(4),i=W.r8f(0);return d.Njj(t.bulkDelete(i))}),W.j41(1,"span",43),W.nrm(2,"i",45),W.EFF(3),W.nI1(4,"i18n"),W.k0s()()}2&e&&(W.R7$(3),W.SpI(" ",W.bMT(4,1,"delete")," "))}function rr(e,t){if(1&e){const e=W.RV6();W.j41(0,"td",52),W.bIt("click",function(){d.eBV(e);const t=W.XpG().$implicit,i=W.XpG(5);return d.Njj(i.dataSource.checkUser(t))}),W.j41(1,"input",53),W.mxI("ngModelChange",function(t){d.eBV(e);const i=W.XpG().$implicit;return W.DH7(i.checked,t)||(i.checked=t),d.Njj(t)}),W.k0s()()}if(2&e){const e=W.XpG().$implicit;W.R7$(),W.R50("ngModel",e.checked)}}function or(e,t){1&e&&(W.j41(0,"span",63),W.EFF(1),W.nI1(2,"i18n"),W.k0s()),2&e&&(W.R7$(),W.SpI(" ",W.bMT(2,1,"invited")," "))}function ar(e,t){1&e&&(W.j41(0,"span",64),W.EFF(1),W.nI1(2,"i18n"),W.k0s()),2&e&&(W.R7$(),W.SpI(" ",W.bMT(2,1,"needsConfirmation")," "))}function cr(e,t){1&e&&(W.j41(0,"span",63),W.EFF(1),W.nI1(2,"i18n"),W.k0s()),2&e&&(W.R7$(),W.SpI(" ",W.bMT(2,1,"revoked")," "))}function lr(e,t){if(1&e&&(W.j41(0,"div",65),W.EFF(1),W.k0s()),2&e){const e=W.XpG(2).$implicit;W.R7$(),W.SpI(" ",e.email," ")}}function ur(e,t){var i;if(1&e){const e=W.RV6();W.qex(0),W.j41(1,"td",54),W.bIt("click",function(){d.eBV(e);const t=W.XpG().$implicit,i=W.XpG(5),n=W.r8f(0);return d.Njj(i.edit(t,n))}),W.j41(2,"div",55),W.nrm(3,"bit-avatar",56),W.nI1(4,"userName"),W.j41(5,"div",57)(6,"div",58)(7,"button",59),W.EFF(8),W.k0s(),W.DNE(9,or,3,3,"span",60)(10,ar,3,3,"span",61)(11,cr,3,3,"span",60),W.k0s(),W.DNE(12,lr,2,1,"div",62),W.k0s()()(),W.bVm()}if(2&e){const e=W.XpG().$implicit,t=W.XpG(5);W.R7$(3),W.Y8G("text",W.bMT(4,8,e))("id",e.userId)("color",e.avatarColor),W.R7$(5),W.SpI(" ",null!==(i=e.name)&&void 0!==i?i:e.email," "),W.R7$(),W.Y8G("ngIf",e.status===t.userStatusType.Invited),W.R7$(),W.Y8G("ngIf",e.status===t.userStatusType.Accepted),W.R7$(),W.Y8G("ngIf",e.status===t.userStatusType.Revoked),W.R7$(),W.Y8G("ngIf",e.name)}}function dr(e,t){1&e&&(W.j41(0,"span",63),W.EFF(1),W.nI1(2,"i18n"),W.k0s()),2&e&&(W.R7$(),W.SpI(" ",W.bMT(2,1,"invited")," "))}function hr(e,t){1&e&&(W.j41(0,"span",64),W.EFF(1),W.nI1(2,"i18n"),W.k0s()),2&e&&(W.R7$(),W.SpI(" ",W.bMT(2,1,"needsConfirmation")," "))}function pr(e,t){1&e&&(W.j41(0,"span",63),W.EFF(1),W.nI1(2,"i18n"),W.k0s()),2&e&&(W.R7$(),W.SpI(" ",W.bMT(2,1,"revoked")," "))}function mr(e,t){if(1&e&&(W.j41(0,"div",65),W.EFF(1),W.k0s()),2&e){const e=W.XpG(2).$implicit;W.R7$(),W.SpI(" ",e.email," ")}}function gr(e,t){var i;if(1&e&&(W.j41(0,"td",25)(1,"div",55),W.nrm(2,"bit-avatar",56),W.nI1(3,"userName"),W.j41(4,"div",57)(5,"div",58)(6,"span"),W.EFF(7),W.k0s(),W.DNE(8,dr,3,3,"span",60)(9,hr,3,3,"span",61)(10,pr,3,3,"span",60),W.k0s(),W.DNE(11,mr,2,1,"div",62),W.k0s()()()),2&e){const e=W.XpG().$implicit,t=W.XpG(5);W.R7$(2),W.Y8G("text",W.bMT(3,8,e))("id",e.userId)("color",e.avatarColor),W.R7$(5),W.JRh(null!==(i=e.name)&&void 0!==i?i:e.email),W.R7$(),W.Y8G("ngIf",e.status===t.userStatusType.Invited),W.R7$(),W.Y8G("ngIf",e.status===t.userStatusType.Accepted),W.R7$(),W.Y8G("ngIf",e.status===t.userStatusType.Revoked),W.R7$(),W.Y8G("ngIf",e.name)}}function br(e,t){if(1&e){const e=W.RV6();W.qex(0),W.j41(1,"td",54),W.bIt("click",function(){d.eBV(e);const t=W.XpG().$implicit,i=W.XpG(5),n=W.r8f(0);return d.Njj(i.edit(t,n,n.useGroups?i.memberTab.Groups:i.memberTab.Collections))}),W.nrm(2,"bit-badge-list",66),W.k0s(),W.bVm()}if(2&e){const e=W.XpG().$implicit;W.XpG(5);const t=W.r8f(0);W.R7$(2),W.Y8G("items",t.useGroups?e.groupNames:e.collectionNames)("maxItems",3)}}function fr(e,t){if(1&e&&(W.j41(0,"td",25),W.nrm(1,"bit-badge-list",66),W.k0s()),2&e){const e=W.XpG().$implicit;W.XpG(5);const t=W.r8f(0);W.R7$(),W.Y8G("items",t.useGroups?e.groupNames:e.collectionNames)("maxItems",3)}}function vr(e,t){if(1&e){const e=W.RV6();W.qex(0),W.j41(1,"td",67),W.bIt("click",function(){d.eBV(e);const t=W.XpG().$implicit,i=W.XpG(5),n=W.r8f(0);return d.Njj(i.edit(t,n,i.memberTab.Role))}),W.EFF(2),W.nI1(3,"userType"),W.k0s(),W.bVm()}if(2&e){const e=W.XpG().$implicit;W.R7$(2),W.SpI(" ",W.bMT(3,1,e.type)," ")}}function Sr(e,t){if(1&e&&(W.j41(0,"td",68),W.EFF(1),W.nI1(2,"userType"),W.k0s()),2&e){const e=W.XpG().$implicit;W.R7$(),W.SpI(" ",W.bMT(2,1,e.type)," ")}}function Ir(e,t){1&e&&(W.qex(0),W.nrm(1,"i",69),W.nI1(2,"i18n"),W.j41(3,"span",18),W.EFF(4),W.nI1(5,"i18n"),W.k0s(),W.bVm()),2&e&&(W.R7$(),W.Y8G("title",W.mNQ(W.bMT(2,3,"userUsingTwoStep"))),W.R7$(3),W.JRh(W.bMT(5,5,"userUsingTwoStep")))}function yr(e,t){1&e&&(W.qex(0),W.nrm(1,"i",70),W.nI1(2,"i18n"),W.j41(3,"span",18),W.EFF(4),W.nI1(5,"i18n"),W.k0s(),W.bVm()),2&e&&(W.R7$(),W.Y8G("title",W.mNQ(W.bMT(2,3,"enrolledAccountRecovery"))),W.R7$(3),W.JRh(W.bMT(5,5,"enrolledAccountRecovery")))}function kr(e,t){if(1&e){const e=W.RV6();W.j41(0,"button",37),W.bIt("click",function(){d.eBV(e);const t=W.XpG(2).$implicit,i=W.XpG(5),n=W.r8f(0);return d.Njj(i.reinvite(t,n))}),W.nrm(1,"i",73),W.EFF(2),W.nI1(3,"i18n"),W.k0s()}2&e&&(W.R7$(2),W.SpI(" ",W.bMT(3,1,"resendInvitation")," "))}function Rr(e,t){if(1&e){const e=W.RV6();W.j41(0,"button",37),W.bIt("click",function(){d.eBV(e);const t=W.XpG(2).$implicit,i=W.XpG(5),n=W.r8f(0);return d.Njj(i.confirm(t,n))}),W.j41(1,"span",39),W.nrm(2,"i",74),W.EFF(3),W.nI1(4,"i18n"),W.k0s()()}2&e&&(W.R7$(3),W.SpI(" ",W.bMT(4,1,"confirm")," "))}function wr(e,t){1&e&&W.nrm(0,"bit-menu-divider")}function $r(e,t){if(1&e){const e=W.RV6();W.j41(0,"button",37),W.bIt("click",function(){d.eBV(e);const t=W.XpG(2).$implicit,i=W.XpG(5),n=W.r8f(0);return d.Njj(i.edit(t,n,i.memberTab.Groups))}),W.nrm(1,"i",75),W.EFF(2),W.nI1(3,"i18n"),W.k0s()}2&e&&(W.R7$(2),W.SpI(" ",W.bMT(3,1,"groups")," "))}function Mr(e,t){if(1&e){const e=W.RV6();W.j41(0,"button",37),W.bIt("click",function(){d.eBV(e);const t=W.XpG(2).$implicit,i=W.XpG(5),n=W.r8f(0);return d.Njj(i.openEventsDialog(t,n))}),W.nrm(1,"i",76),W.EFF(2),W.nI1(3,"i18n"),W.k0s()}2&e&&(W.R7$(2),W.SpI(" ",W.bMT(3,1,"eventLogs")," "))}function Fr(e,t){if(1&e){const e=W.RV6();W.qex(0),W.DNE(1,kr,4,3,"button",30)(2,Rr,5,3,"button",30)(3,wr,1,0,"bit-menu-divider",10),W.j41(4,"button",37),W.bIt("click",function(){d.eBV(e);const t=W.XpG().$implicit,i=W.XpG(5),n=W.r8f(0);return d.Njj(i.edit(t,n,i.memberTab.Role))}),W.nrm(5,"i",71),W.EFF(6),W.nI1(7,"i18n"),W.k0s(),W.DNE(8,$r,4,3,"button",30),W.j41(9,"button",37),W.bIt("click",function(){d.eBV(e);const t=W.XpG().$implicit,i=W.XpG(5),n=W.r8f(0);return d.Njj(i.edit(t,n,i.memberTab.Collections))}),W.nrm(10,"i",72),W.EFF(11),W.nI1(12,"i18n"),W.k0s(),W.nrm(13,"bit-menu-divider"),W.DNE(14,Mr,4,3,"button",30),W.bVm()}if(2&e){const e=W.XpG().$implicit,t=W.XpG(5),i=W.r8f(0);W.R7$(),W.Y8G("ngIf",e.status===t.userStatusType.Invited),W.R7$(),W.Y8G("ngIf",e.status===t.userStatusType.Accepted),W.R7$(),W.Y8G("ngIf",e.status===t.userStatusType.Accepted||e.status===t.userStatusType.Invited),W.R7$(3),W.SpI(" ",W.bMT(7,7,"memberRole")," "),W.R7$(2),W.Y8G("ngIf",i.useGroups),W.R7$(3),W.SpI(" ",W.bMT(12,9,"collections")," "),W.R7$(3),W.Y8G("ngIf",i.useEvents&&e.status===t.userStatusType.Confirmed)}}function Tr(e,t){if(1&e){const e=W.RV6();W.j41(0,"button",37),W.bIt("click",function(){d.eBV(e);const t=W.XpG().$implicit,i=W.XpG(5),n=W.r8f(0);return d.Njj(i.resetPassword(t,n))}),W.nrm(1,"i",77),W.EFF(2),W.nI1(3,"i18n"),W.k0s()}2&e&&(W.R7$(2),W.SpI(" ",W.bMT(3,1,"recoverAccount")," "))}function Er(e,t){if(1&e){const e=W.RV6();W.j41(0,"button",37),W.bIt("click",function(){d.eBV(e);const t=W.XpG(2).$implicit,i=W.XpG(5),n=W.r8f(0);return d.Njj(i.restore(t,n))}),W.nrm(1,"i",78),W.EFF(2),W.nI1(3,"i18n"),W.k0s()}2&e&&(W.R7$(2),W.SpI(" ",W.bMT(3,1,"restoreAccess")," "))}function Gr(e,t){if(1&e){const e=W.RV6();W.j41(0,"button",37),W.bIt("click",function(){d.eBV(e);const t=W.XpG(2).$implicit,i=W.XpG(5),n=W.r8f(0);return d.Njj(i.revoke(t,n))}),W.nrm(1,"i",79),W.EFF(2),W.nI1(3,"i18n"),W.k0s()}2&e&&(W.R7$(2),W.SpI(" ",W.bMT(3,1,"revokeAccess")," "))}function Ur(e,t){if(1&e){const e=W.RV6();W.j41(0,"button",37),W.bIt("click",function(){d.eBV(e);const t=W.XpG(2).$implicit,i=W.XpG(5),n=W.r8f(0);return d.Njj(i.remove(t,n))}),W.j41(1,"span",43),W.nrm(2,"i",80),W.EFF(3),W.nI1(4,"i18n"),W.k0s()()}2&e&&(W.R7$(3),W.SpI(" ",W.bMT(4,1,"remove")," "))}function jr(e,t){if(1&e){const e=W.RV6();W.j41(0,"button",37),W.bIt("click",function(){d.eBV(e);const t=W.XpG(2).$implicit,i=W.XpG(5),n=W.r8f(0);return d.Njj(i.deleteUser(t,n))}),W.j41(1,"span",43),W.nrm(2,"i",81),W.EFF(3),W.nI1(4,"i18n"),W.k0s()()}2&e&&(W.R7$(3),W.SpI(" ",W.bMT(4,1,"delete")," "))}function Cr(e,t){if(1&e&&(W.qex(0),W.DNE(1,Er,4,3,"button",30)(2,Gr,4,3,"button",30)(3,Ur,5,3,"button",30)(4,jr,5,3,"button",30),W.bVm()),2&e){const e=W.XpG().$implicit,t=W.XpG(5);W.R7$(),W.Y8G("ngIf",e.status===t.userStatusType.Revoked),W.R7$(),W.Y8G("ngIf",e.status!==t.userStatusType.Revoked),W.R7$(),W.Y8G("ngIf",!e.managedByOrganization),W.R7$(),W.Y8G("ngIf",e.managedByOrganization)}}function xr(e,t){if(1&e&&(W.j41(0,"tr",47),W.DNE(1,rr,2,1,"td",48)(2,ur,13,10,"ng-container",49)(3,gr,12,10,"ng-template",null,1,W.C5r)(5,br,3,2,"ng-container",49)(6,fr,2,2,"ng-template",null,2,W.C5r)(8,vr,4,3,"ng-container",49)(9,Sr,3,3,"ng-template",null,3,W.C5r),W.j41(11,"td",50),W.DNE(12,Ir,6,7,"ng-container",10),W.SS7(13),W.nI1(14,"async"),W.DNE(15,yr,6,7,"ng-container",10),W.k0s(),W.j41(16,"td",25)(17,"div",27),W.nrm(18,"div",51)(19,"button",36),W.nI1(20,"i18n"),W.k0s(),W.j41(21,"bit-menu",null,4),W.DNE(23,Fr,15,11,"ng-container",10)(24,Tr,4,3,"button",30)(25,Cr,5,4,"ng-container",10),W.k0s()()()),2&e){const e=t.$implicit,i=W.sdS(4),n=W.sdS(7),s=W.sdS(10),r=W.sdS(22),o=W.XpG(5),a=W.r8f(0);W.Y8G("ngClass",o.rowHeightClass),W.R7$(),W.Y8G("ngIf",o.showUserManagementControls()),W.R7$(),W.Y8G("ngIf",o.showUserManagementControls())("ngIfElse",i),W.R7$(3),W.Y8G("ngIf",o.showUserManagementControls())("ngIfElse",n),W.R7$(3),W.Y8G("ngIf",o.showUserManagementControls())("ngIfElse",s),W.R7$(4),W.Y8G("ngIf",e.twoFactorEnabled);const c=W.bMT(14,16,o.resetPasswordPolicyEnabled$);W.R7$(3),W.Y8G("ngIf",o.showEnrolledStatus(e,a,c)),W.R7$(4),W.Y8G("label",W.mNQ(W.bMT(20,18,"options")))("bitMenuTriggerFor",r),W.R7$(4),W.Y8G("ngIf",o.showUserManagementControls()),W.R7$(),W.Y8G("ngIf",o.allowResetPassword(e,a,c)),W.R7$(),W.Y8G("ngIf",o.showUserManagementControls())}}function Dr(e,t){if(1&e&&W.DNE(0,xr,26,20,"tr",46),2&e){const e=t.$implicit;W.Y8G("cdkVirtualForOf",e)}}function Xr(e,t){if(1&e&&(W.qex(0),W.DNE(1,qs,4,7,"bit-callout",19),W.j41(2,"cdk-virtual-scroll-viewport",20)(3,"bit-table",21),W.qex(4,22),W.j41(5,"tr"),W.DNE(6,Ks,5,3,"th",23),W.j41(7,"th",24),W.EFF(8),W.nI1(9,"i18n"),W.k0s(),W.j41(10,"th",25),W.EFF(11),W.nI1(12,"i18n"),W.k0s(),W.j41(13,"th",26),W.EFF(14),W.nI1(15,"i18n"),W.k0s(),W.j41(16,"th",25),W.EFF(17),W.nI1(18,"i18n"),W.k0s(),W.j41(19,"th",25)(20,"div",27),W.nrm(21,"button",28),W.nI1(22,"i18n"),W.DNE(23,_s,2,5,"button",29),W.k0s(),W.j41(24,"bit-menu",null,0),W.DNE(26,Hs,5,3,"ng-container",10)(27,Zs,4,3,"button",30)(28,er,5,3,"button",30)(29,tr,4,3,"button",30)(30,ir,4,3,"button",30)(31,nr,5,3,"button",30)(32,sr,5,3,"button",30),W.k0s()()(),W.bVm(),W.DNE(33,Dr,1,1,"ng-template",31),W.k0s()(),W.bVm()),2&e){const e=W.XpG(3),t=W.r8f(0);W.R7$(),W.Y8G("ngIf",e.showConfirmUsers),W.R7$(),W.Y8G("itemSize",e.rowHeight),W.R7$(),W.Y8G("dataSource",e.dataSource),W.R7$(3),W.Y8G("ngIf",e.showUserManagementControls()),W.R7$(2),W.JRh(W.bMT(9,20,"name")),W.R7$(3),W.JRh(W.bMT(12,22,t.useGroups?"groups":"collections")),W.R7$(3),W.JRh(W.bMT(15,24,"role")),W.R7$(3),W.JRh(W.bMT(18,26,"policies")),W.R7$(4),W.Y8G("label",W.mNQ(W.bMT(22,28,"export")))("bitAction",e.exportMembers)("disabled",!e.firstLoaded),W.R7$(2),W.Y8G("ngIf",e.showUserManagementControls()),W.R7$(3),W.Y8G("ngIf",e.canUseSecretsManager()),W.R7$(),W.Y8G("ngIf",e.showBulkReinviteUsers),W.R7$(),W.Y8G("ngIf",e.showBulkConfirmUsers),W.R7$(),W.Y8G("ngIf",e.showBulkRestoreUsers),W.R7$(),W.Y8G("ngIf",e.showBulkRevokeUsers),W.R7$(),W.Y8G("ngIf",e.showBulkRemoveUsers),W.R7$(),W.Y8G("ngIf",e.showBulkDeleteUsers)}}function Nr(e,t){if(1&e&&(W.qex(0),W.DNE(1,Ls,3,3,"p",10)(2,Xr,34,30,"ng-container",10),W.bVm()),2&e){const e=W.XpG(2);W.R7$(),W.Y8G("ngIf",!e.dataSource.filteredData.length),W.R7$(),W.Y8G("ngIf",e.dataSource.filteredData.length)}}function Pr(e,t){if(1&e){const e=W.RV6();W.j41(0,"app-organization-free-trial-warning",5),W.bIt("clicked",function(){d.eBV(e);const t=W.XpG(),i=W.r8f(0);return d.Njj(t.billingConstraint.navigateToPaymentMethod(i))}),W.k0s(),W.j41(1,"app-header"),W.nrm(2,"bit-search",6),W.nI1(3,"i18n"),W.DNE(4,zs,4,4,"button",7),W.k0s(),W.j41(5,"div",8),W.DNE(6,Ws,18,24,"bit-toggle-group",9),W.k0s(),W.DNE(7,Qs,6,7,"ng-container",10)(8,Nr,3,2,"ng-container",10)}if(2&e){const e=W.XpG(),t=W.r8f(0);W.Y8G("organization",t),W.R7$(2),W.Y8G("formControl",e.searchControl)("placeholder",W.bMT(3,7,"searchMembers")),W.R7$(2),W.Y8G("ngIf",e.showUserManagementControls()),W.R7$(2),W.Y8G("ngIf",e.showUserManagementControls()),W.R7$(),W.Y8G("ngIf",!e.firstLoaded),W.R7$(),W.Y8G("ngIf",e.firstLoaded)}}class Vr extends ci{constructor(){super(...arguments),this.statusType=j.Zx}}class Ar extends hi{constructor(e,t,i,n,s,r,o,a,c,l,u,d,h,p,m,g,b,f,v,S,I,y,k){super(e,t,n,s,r,o,a,i,c),this.route=l,this.deleteManagedMemberWarningService=u,this.organizationWarningsService=d,this.memberActionsService=h,this.memberDialogManager=p,this.billingConstraint=m,this.memberService=g,this.organizationService=b,this.accountService=f,this.policyService=v,this.policyApiService=S,this.organizationMetadataService=I,this.memberExportService=y,this.environmentService=k,this.userType=j.D7,this.userStatusType=j.Zx,this.memberTab=Qe,this.userId$=this.accountService.activeAccount$.pipe(x.F6),this.canUseSecretsManager=(0,Bt.EW)(()=>{var e,t;return null!==(t=null===(e=this.organization())||void 0===e?void 0:e.useSecretsManager)&&void 0!==t&&t}),this.showUserManagementControls=(0,Bt.EW)(()=>{var e,t;return null!==(t=null===(e=this.organization())||void 0===e?void 0:e.canManageUsers)&&void 0!==t&&t}),this.rowHeight=66,this.rowHeightClass="tw-h-[66px]",this.exportMembers=()=>{const e=this.memberExportService.getMemberExport(this.dataSource.data);e.success&&this.toastService.showToast({variant:"success",title:void 0,message:this.i18nService.t("dataExportSuccess")}),null!=e.error&&this.validationService.showError(e.error.message)},this.dataSource=new Vr(this.environmentService);const R=this.route.params.pipe((0,Yt.H)(e=>this.userId$.pipe((0,$.n)(t=>this.organizationService.organizations$(t).pipe((0,X.Hc)(e.organizationId))),(0,Vt.p)(e=>null!=e),(0,F.t)({refCount:!0,bufferSize:1}))));this.organization=(0,it.ot)(R);const T=(0,w.z)([this.userId$,R]).pipe((0,$.n)(([e,t])=>t.isProviderUser?(0,Ot.H)(this.policyApiService.getPolicies(t.id)).pipe((0,M.T)(e=>Lt.P.fromListResponse(e))):this.policyService.policies$(e)));this.resetPasswordPolicyEnabled$=(0,w.z)([R,T]).pipe((0,M.T)(([e,t])=>{var i,n;return null!==(n=null===(i=t.filter(e=>e.type===j.tt.ResetPassword).find(t=>t.organizationId===e.id))||void 0===i?void 0:i.enabled)&&void 0!==n&&n})),(0,w.z)([this.route.queryParams,R]).pipe((0,Yt.H)(e=>As(this,[e],void 0,function*([e,t]){if(yield this.load(t),this.searchControl.setValue(e.search),null!=e.viewEvents){const i=this.dataSource.data.filter(t=>t.id===e.viewEvents);i.length>0&&i[0].status===j.Zx.Confirmed&&this.openEventsDialog(i[0],t)}})),(0,it.pQ)()).subscribe(),R.pipe((0,$.n)(e=>(0,Jt.h)(this.organizationWarningsService.showInactiveSubscriptionDialog$(e),this.organizationWarningsService.showSubscribeBeforeFreeTrialEndsDialog$(e))),(0,it.pQ)()).subscribe(),this.billingMetadata$=R.pipe((0,$.n)(e=>this.organizationMetadataService.getOrganizationMetadata$(e.id)),(0,F.t)({bufferSize:1,refCount:!1})),this.billingMetadata$.pipe((0,Wt.s)(1),(0,it.pQ)()).subscribe()}load(e){const t=Object.create(null,{load:{get:()=>super.load}});return As(this,void 0,void 0,function*(){yield t.load.call(this,e)})}getUsers(e){return As(this,void 0,void 0,function*(){return yield this.memberService.loadUsers(e)})}removeUser(e,t){return As(this,void 0,void 0,function*(){return yield this.memberActionsService.removeUser(t,e)})}revokeUser(e,t){return As(this,void 0,void 0,function*(){return yield this.memberActionsService.revokeUser(t,e)})}restoreUser(e,t){return As(this,void 0,void 0,function*(){return yield this.memberActionsService.restoreUser(t,e)})}reinviteUser(e,t){return As(this,void 0,void 0,function*(){return yield this.memberActionsService.reinviteUser(t,e)})}confirmUser(e,t,i){return As(this,void 0,void 0,function*(){return yield this.memberActionsService.confirmUser(e,t,i)})}revoke(e,t){return As(this,void 0,void 0,function*(){if(!(yield this.revokeUserConfirmationDialog(e)))return!1;this.actionPromise=this.revokeUser(e.id,t);try{const i=yield this.actionPromise;if(!i.success)throw new Error(i.error);this.toastService.showToast({variant:"success",message:this.i18nService.t("revokedUserId",this.userNamePipe.transform(e))}),yield this.load(t)}catch(i){this.validationService.showError(i)}this.actionPromise=void 0})}restore(e,t){return As(this,void 0,void 0,function*(){this.actionPromise=this.restoreUser(e.id,t);try{const i=yield this.actionPromise;if(!i.success)throw new Error(i.error);this.toastService.showToast({variant:"success",message:this.i18nService.t("restoredUserId",this.userNamePipe.transform(e))}),yield this.load(t)}catch(i){this.validationService.showError(i)}this.actionPromise=void 0})}allowResetPassword(e,t,i){return this.memberActionsService.allowResetPassword(e,t,i)}showEnrolledStatus(e,t,i){return t.useResetPassword&&e.resetPasswordEnrolled&&i}handleInviteDialog(e){return As(this,void 0,void 0,function*(){var t,i;const n=yield(0,R._)(this.billingMetadata$),s=null!==(i=null===(t=this.dataSource.data)||void 0===t?void 0:t.map(e=>e.email))&&void 0!==i?i:[];(yield this.memberDialogManager.openInviteDialog(e,n,s))===Le.Saved&&(yield this.load(e))})}invite(e){return As(this,void 0,void 0,function*(){const t=yield(0,R._)(this.billingMetadata$),i=this.billingConstraint.checkSeatLimit(e,t);(yield this.billingConstraint.seatLimitReached(i,e))||(yield this.handleInviteDialog(e),this.organizationMetadataService.refreshMetadataCache())})}edit(e,t){return As(this,arguments,void 0,function*(e,t,i=Qe.Role){const n=yield(0,R._)(this.billingMetadata$);switch(yield this.memberDialogManager.openEditDialog(e,t,n,i)){case Le.Deleted:this.dataSource.removeUser(e);break;case Le.Saved:case Le.Revoked:case Le.Restored:yield this.load(t)}})}bulkRemove(e){return As(this,void 0,void 0,function*(){if(null!=this.actionPromise)return;const t=this.dataSource.getCheckedUsersWithLimit(ri);yield this.memberDialogManager.openBulkRemoveDialog(e,t),this.organizationMetadataService.refreshMetadataCache(),yield this.load(e)})}bulkDelete(e){return As(this,void 0,void 0,function*(){if(null!=this.actionPromise)return;const t=this.dataSource.getCheckedUsersWithLimit(ri);yield this.memberDialogManager.openBulkDeleteDialog(e,t),yield this.load(e)})}bulkRevoke(e){return As(this,void 0,void 0,function*(){yield this.bulkRevokeOrRestore(!0,e)})}bulkRestore(e){return As(this,void 0,void 0,function*(){yield this.bulkRevokeOrRestore(!1,e)})}bulkRevokeOrRestore(e,t){return As(this,void 0,void 0,function*(){if(null!=this.actionPromise)return;const i=this.dataSource.getCheckedUsersWithLimit(ri);yield this.memberDialogManager.openBulkRestoreRevokeDialog(t,i,e),yield this.load(t)})}bulkReinvite(e){return As(this,void 0,void 0,function*(){if(null!=this.actionPromise)return;let t;t=this.dataSource.isIncreasedBulkLimitEnabled()?this.dataSource.getCheckedUsersInVisibleOrder():this.dataSource.getCheckedUsers();const i=t.filter(e=>e.status===j.Zx.Invited),n=i.length;let s;if(s=this.dataSource.isIncreasedBulkLimitEnabled()?this.dataSource.limitAndUncheckExcess(i,oi):i,s.length<=0)this.toastService.showToast({variant:"error",title:this.i18nService.t("errorOccurred"),message:this.i18nService.t("noSelectedUsersApplicable")});else{try{const i=yield this.memberActionsService.bulkReinvite(e,s.map(e=>e.id));if(!i.successful)throw new Error;if(this.dataSource.isIncreasedBulkLimitEnabled()){const e=n,t=s.length;if(e>oi){const t=e-oi;this.toastService.showToast({variant:"success",message:this.i18nService.t("bulkReinviteLimitedSuccessToast",oi.toLocaleString(),e.toLocaleString(),t.toLocaleString())})}else this.toastService.showToast({variant:"success",message:this.i18nService.t("bulkReinviteSuccessToast",t.toString())})}else yield this.memberDialogManager.openBulkStatusDialog(t,s,Promise.resolve(i.successful),this.i18nService.t("bulkReinviteMessage"))}catch(r){this.validationService.showError(r)}this.actionPromise=void 0}})}bulkConfirm(e){return As(this,void 0,void 0,function*(){if(null!=this.actionPromise)return;const t=this.dataSource.getCheckedUsersWithLimit(ri);yield this.memberDialogManager.openBulkConfirmDialog(e,t),yield this.load(e)})}bulkEnableSM(e){return As(this,void 0,void 0,function*(){const t=this.dataSource.getCheckedUsersWithLimit(ri);yield this.memberDialogManager.openBulkEnableSecretsManagerDialog(e,t),this.dataSource.uncheckAllUsers(),yield this.load(e)})}openEventsDialog(e,t){this.memberDialogManager.openEventsDialog(e,t)}resetPassword(e,t){return As(this,void 0,void 0,function*(){if(!e||!e.email||!e.id)return this.toastService.showToast({variant:"error",title:this.i18nService.t("errorOccurred"),message:this.i18nService.t("orgUserDetailsNotFound")}),void this.logService.error("Org user details not found when attempting account recovery");(yield this.memberDialogManager.openAccountRecoveryDialog(e,t))===Ii&&(yield this.load(t))})}removeUserConfirmationDialog(e){return As(this,void 0,void 0,function*(){return yield this.memberDialogManager.openRemoveUserConfirmationDialog(e)})}revokeUserConfirmationDialog(e){return As(this,void 0,void 0,function*(){return yield this.memberDialogManager.openRevokeUserConfirmationDialog(e)})}deleteUser(e,t){return As(this,void 0,void 0,function*(){if(!(yield this.memberDialogManager.openDeleteUserConfirmationDialog(e,t)))return!1;this.actionPromise=this.memberActionsService.deleteUser(t,e.id);try{const t=yield this.actionPromise;if(!t.success)throw new Error(t.error);this.toastService.showToast({variant:"success",message:this.i18nService.t("organizationUserDeleted",this.userNamePipe.transform(e))}),this.dataSource.removeUser(e)}catch(i){this.validationService.showError(i)}this.actionPromise=void 0})}get showBulkRestoreUsers(){return this.dataSource.getCheckedUsers().every(e=>e.status==this.userStatusType.Revoked)}get showBulkRevokeUsers(){return this.dataSource.getCheckedUsers().every(e=>e.status!=this.userStatusType.Revoked)}get showBulkRemoveUsers(){return this.dataSource.getCheckedUsers().every(e=>!e.managedByOrganization)}get showBulkDeleteUsers(){const e=[this.userStatusType.Accepted,this.userStatusType.Confirmed,this.userStatusType.Revoked];return this.dataSource.getCheckedUsers().every(t=>t.managedByOrganization&&e.includes(t.status))}get selectedInvitedCount(){return this.dataSource.getCheckedUsers().filter(e=>e.status===this.userStatusType.Invited).length}get isSingleInvite(){return 1===this.selectedInvitedCount}}Ar.ɵfac=function(e){return new(e||Ar)(W.rXU(dt.G),W.rXU(h.W),W.rXU(ti.y),W.rXU(ot.Lu),W.rXU(ui.B),W.rXU(rt.K),W.rXU(Qt.b),W.rXU(p.o3),W.rXU(m.f),W.rXU(g.nX),W.rXU(Y),W.rXU(Kt.S),W.rXU(Ei),W.rXU(ws),W.rXU(f),W.rXU($i),W.rXU(U.PV),W.rXU(Q.D),W.rXU(fi.m),W.rXU(Us.m),W.rXU(Fi.Q),W.rXU(Gs),W.rXU(qt.v))},Ar.ɵcmp=W.VBU({type:Ar,selectors:[["ng-component"]],standalone:!1,features:[W.Vt3],decls:2,vars:2,consts:[["headerMenu",""],["readOnlyUserInfo",""],["readOnlyGroupsCell",""],["readOnlyRoleCell",""],["rowMenu",""],[3,"clicked","organization"],[1,"tw-grow",3,"formControl","placeholder"],["type","button","bitButton","","buttonType","primary",3,"disabled","click",4,"ngIf"],[1,"tw-mb-4","tw-flex","tw-flex-col","tw-space-y-4"],[3,"selected","selectedChange",4,"ngIf"],[4,"ngIf"],["type","button","bitButton","","buttonType","primary",3,"click","disabled"],["aria-hidden","true",1,"bwi","bwi-plus","bwi-fw"],[3,"selectedChange","selected"],[3,"value"],["bitBadge","","variant","info",4,"ngIf"],["bitBadge","","variant","info"],["aria-hidden","true",1,"bwi","bwi-spinner","bwi-spin","tw-text-muted",3,"title"],[1,"tw-sr-only"],["type","info","icon","bwi-check-circle",3,"title",4,"ngIf"],["bitScrollLayout","",1,"tw-pb-8",3,"itemSize"],[3,"dataSource"],["header",""],["bitCell","","class","tw-w-20",4,"ngIf"],["bitCell","","bitSortable","email","default",""],["bitCell",""],["bitCell","","bitSortable","type"],[1,"tw-flex","tw-flex-row","tw-items-center","tw-justify-end","tw-gap-2"],["type","button","bitIconButton","bwi-download","size","small",3,"bitAction","disabled","label"],["type","button","bitIconButton","bwi-ellipsis-v","size","small",3,"bitMenuTriggerFor","label",4,"ngIf"],["type","button","bitMenuItem","",3,"click",4,"ngIf"],["body",""],["type","info","icon","bwi-check-circle",3,"title"],["bitCell","",1,"tw-w-20"],["type","checkbox","bitCheckbox","","id","selectAll",1,"tw-mr-1",3,"change"],["for","selectAll",1,"tw-mb-0","!tw-font-medium","!tw-text-muted"],["type","button","bitIconButton","bwi-ellipsis-v","size","small",3,"bitMenuTriggerFor","label"],["type","button","bitMenuItem","",3,"click"],["aria-hidden","true",1,"bwi","bwi-fw","bwi-envelope"],[1,"tw-text-success"],["aria-hidden","true",1,"bwi","bwi-fw","bwi-check"],["aria-hidden","true",1,"bwi","bwi-fw","bwi-plus-circle"],["aria-hidden","true",1,"bwi","bwi-fw","bwi-minus-circle"],[1,"tw-text-danger"],["aria-hidden","true",1,"bwi","bwi-fw","bwi-close"],["aria-hidden","true",1,"bwi","bwi-fw","bwi-trash"],["bitRow","","alignContent","middle",3,"ngClass",4,"cdkVirtualFor","cdkVirtualForOf"],["bitRow","","alignContent","middle",3,"ngClass"],["bitCell","",3,"click",4,"ngIf"],[4,"ngIf","ngIfElse"],["bitCell","",1,"tw-text-muted"],[1,"tw-w-[32px]"],["bitCell","",3,"click"],["type","checkbox","bitCheckbox","",3,"ngModelChange","ngModel"],["bitCell","",1,"tw-cursor-pointer",3,"click"],[1,"tw-flex","tw-items-center"],["size","small",1,"tw-mr-3",3,"text","id","color"],[1,"tw-flex","tw-flex-col"],[1,"tw-flex","tw-flex-row","tw-gap-2"],["type","button","bitLink",""],["bitBadge","","class","tw-text-xs","variant","secondary",4,"ngIf"],["bitBadge","","class","tw-text-xs","variant","warning",4,"ngIf"],["class","tw-text-sm tw-text-muted",4,"ngIf"],["bitBadge","","variant","secondary",1,"tw-text-xs"],["bitBadge","","variant","warning",1,"tw-text-xs"],[1,"tw-text-sm","tw-text-muted"],["variant","secondary",3,"items","maxItems"],["bitCell","",1,"tw-cursor-pointer","tw-text-sm","tw-text-muted",3,"click"],["bitCell","",1,"tw-text-sm","tw-text-muted"],["aria-hidden","true",1,"bwi","bwi-lock",3,"title"],["aria-hidden","true",1,"bwi","bwi-key",3,"title"],["aria-hidden","true",1,"bwi","bwi-user"],["aria-hidden","true",1,"bwi","bwi-collection-shared"],["aria-hidden","true",1,"bwi","bwi-envelope"],["aria-hidden","true",1,"bwi","bwi-check"],["aria-hidden","true",1,"bwi","bwi-users"],["aria-hidden","true",1,"bwi","bwi-file-text"],["aria-hidden","true",1,"bwi","bwi-key"],["aria-hidden","true",1,"bwi","bwi-plus-circle"],["aria-hidden","true",1,"bwi","bwi-minus-circle"],["aria-hidden","true",1,"bwi","bwi-close"],["aria-hidden","true",1,"bwi","bwi-trash"]],template:function(e,t){if(1&e&&(W.SS7(0),W.nVh(1,Pr,9,9)),2&e){const e=W.bH3(t.organization());W.R7$(),W.vxM(e?1:-1)}},dependencies:[q.YU,q.bT,y.Zm,y.BC,y.vS,y.l_,_.p,Ci.f,js.p,ee.n,te.Q,vi.G,ie.P,It.s,le.g,yt.Z,kt.O,Rt.S,Cs.M,wt.Q,$t.Y,xs.O,Mt._,Mt.O,Ds.H,Xs.a,Ns.S,Ft.f,n.yg,n.E$,n.d6,Ps.lp,Vs.z,q.Jj,fe.$,Qt.b,gn.c],encapsulation:2});var zr=function(e,t,i,n){return new(i||(i=Promise))(function(s,r){function o(e){try{c(n.next(e))}catch(t){r(t)}}function a(e){try{c(n.throw(e))}catch(t){r(t)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(o,a)}c((n=n.apply(e,t||[])).next())})};function Br(e,t){if(1&e){const e=W.RV6();W.j41(0,"button",7),W.bIt("click",function(){d.eBV(e);const t=W.XpG(2),i=W.r8f(0);return d.Njj(t.invite(i))}),W.nrm(1,"i",8),W.EFF(2),W.nI1(3,"i18n"),W.k0s()}if(2&e){const e=W.XpG(2);W.Y8G("disabled",!e.firstLoaded()),W.R7$(2),W.SpI(" ",W.bMT(3,2,"inviteMember")," ")}}function Yr(e,t){1&e&&(W.j41(0,"span",11),W.EFF(1),W.k0s()),2&e&&(W.R7$(),W.JRh(t))}function Or(e,t){1&e&&(W.j41(0,"span",11),W.EFF(1),W.k0s()),2&e&&(W.R7$(),W.JRh(t))}function Jr(e,t){1&e&&(W.j41(0,"span",11),W.EFF(1),W.k0s()),2&e&&(W.R7$(),W.JRh(t))}function Wr(e,t){1&e&&(W.j41(0,"span",11),W.EFF(1),W.k0s()),2&e&&(W.R7$(),W.JRh(t))}function Qr(e,t){if(1&e){const e=W.RV6();W.j41(0,"bit-toggle-group",9),W.nI1(1,"async"),W.nI1(2,"i18n"),W.bIt("selectedChange",function(t){d.eBV(e);const i=W.XpG(2);return d.Njj(i.statusToggle.next(t))}),W.j41(3,"bit-toggle",10),W.EFF(4),W.nI1(5,"i18n"),W.nVh(6,Yr,2,1,"span",11),W.k0s(),W.j41(7,"bit-toggle",10),W.EFF(8),W.nI1(9,"i18n"),W.nVh(10,Or,2,1,"span",11),W.k0s(),W.j41(11,"bit-toggle",10),W.EFF(12),W.nI1(13,"i18n"),W.nVh(14,Jr,2,1,"span",11),W.k0s(),W.j41(15,"bit-toggle",10),W.EFF(16),W.nI1(17,"i18n"),W.nVh(18,Wr,2,1,"span",11),W.k0s()()}if(2&e){let e,t,i,n;const s=W.XpG(2),r=W.r8f(1);W.Y8G("selected",W.bMT(1,14,s.statusToggle)),W.BMQ("aria-label",W.bMT(2,16,"memberStatusFilter")),W.R7$(3),W.Y8G("value",void 0),W.R7$(),W.SpI(" ",W.bMT(5,18,"all")," "),W.R7$(2),W.vxM((e=r.activeUserCount)?6:-1,e),W.R7$(),W.Y8G("value",s.userStatusType.Invited),W.R7$(),W.SpI(" ",W.bMT(9,20,"invited")," "),W.R7$(2),W.vxM((t=r.invitedUserCount)?10:-1,t),W.R7$(),W.Y8G("value",s.userStatusType.Accepted),W.R7$(),W.SpI(" ",W.bMT(13,22,"needsConfirmation")," "),W.R7$(2),W.vxM((i=r.acceptedUserCount)?14:-1,i),W.R7$(),W.Y8G("value",s.userStatusType.Revoked),W.R7$(),W.SpI(" ",W.bMT(17,24,"revoked")," "),W.R7$(2),W.vxM((n=r.revokedUserCount)?18:-1,n)}}function Lr(e,t){1&e&&(W.nrm(0,"i",12),W.nI1(1,"i18n"),W.j41(2,"span",13),W.EFF(3),W.nI1(4,"i18n"),W.k0s()),2&e&&(W.Y8G("title",W.mNQ(W.bMT(1,3,"loading"))),W.R7$(3),W.JRh(W.bMT(4,5,"loading")))}function qr(e,t){1&e&&(W.j41(0,"p"),W.EFF(1),W.nI1(2,"i18n"),W.k0s()),2&e&&(W.R7$(),W.JRh(W.bMT(2,1,"noMembersInList")))}function Kr(e,t){1&e&&(W.j41(0,"bit-callout",14),W.nI1(1,"i18n"),W.EFF(2),W.nI1(3,"i18n"),W.k0s()),2&e&&(W.Y8G("title",W.mNQ(W.bMT(1,3,"confirmUsers"))),W.R7$(2),W.SpI(" ",W.bMT(3,5,"usersNeedConfirmed")," "))}function _r(e,t){if(1&e){const e=W.RV6();W.j41(0,"th",18)(1,"input",25),W.bIt("change",function(t){d.eBV(e),W.XpG(4);const i=W.r8f(1);return d.Njj(i.checkAllFilteredUsers(t.target.checked))}),W.k0s(),W.j41(2,"label",26),W.EFF(3),W.nI1(4,"i18n"),W.k0s()()}2&e&&(W.R7$(3),W.JRh(W.bMT(4,1,"all")))}function Hr(e,t){if(1&e&&(W.j41(0,"th",20)(1,"div",27),W.nrm(2,"button",28),W.nI1(3,"i18n"),W.nrm(4,"button",29),W.nI1(5,"i18n"),W.k0s()()),2&e){W.XpG();const e=W.sdS(21),t=W.XpG(3);W.R7$(2),W.Y8G("label",W.mNQ(W.bMT(3,7,"export")))("bitAction",t.exportMembers)("disabled",!t.firstLoaded),W.R7$(2),W.Y8G("label",W.mNQ(W.bMT(5,9,"options")))("bitMenuTriggerFor",e)}}function Zr(e,t){if(1&e){const e=W.RV6();W.j41(0,"button",30),W.bIt("click",function(){d.eBV(e);const t=W.XpG(4),i=W.r8f(0),n=W.r8f(6);return d.Njj(n?null:t.bulkEnableSM(i))}),W.EFF(1),W.nI1(2,"i18n"),W.k0s(),W.nrm(3,"bit-menu-divider")}2&e&&(W.R7$(),W.SpI(" ",W.bMT(2,1,"activateSecretsManager")," "))}function eo(e,t){if(1&e){const e=W.RV6();W.j41(0,"button",30),W.bIt("click",function(){d.eBV(e);const t=W.XpG(4),i=W.r8f(0),n=W.r8f(6);return d.Njj(n?null:t.bulkReinvite(i))}),W.nrm(1,"i",31),W.EFF(2),W.nI1(3,"i18n"),W.k0s()}if(2&e){W.XpG(4);const e=W.r8f(7);W.R7$(2),W.SpI(" ",W.bMT(3,1,e?"resendInvitation":"reinviteSelected")," ")}}function to(e,t){if(1&e){const e=W.RV6();W.j41(0,"button",30),W.bIt("click",function(){d.eBV(e);const t=W.XpG(4),i=W.r8f(0),n=W.r8f(6);return d.Njj(n?null:t.bulkConfirm(i))}),W.j41(1,"span",32),W.nrm(2,"i",33),W.EFF(3),W.nI1(4,"i18n"),W.k0s()()}2&e&&(W.R7$(3),W.SpI(" ",W.bMT(4,1,"confirmSelected")," "))}function io(e,t){if(1&e){const e=W.RV6();W.j41(0,"button",30),W.bIt("click",function(){d.eBV(e);const t=W.XpG(4),i=W.r8f(0),n=W.r8f(6);return d.Njj(n?null:t.bulkRevokeOrRestore(!1,i))}),W.nrm(1,"i",34),W.EFF(2),W.nI1(3,"i18n"),W.k0s()}2&e&&(W.R7$(2),W.SpI(" ",W.bMT(3,1,"restoreAccess")," "))}function no(e,t){if(1&e){const e=W.RV6();W.j41(0,"button",30),W.bIt("click",function(){d.eBV(e);const t=W.XpG(4),i=W.r8f(0),n=W.r8f(6);return d.Njj(n?null:t.bulkRevokeOrRestore(!0,i))}),W.nrm(1,"i",35),W.EFF(2),W.nI1(3,"i18n"),W.k0s()}2&e&&(W.R7$(2),W.SpI(" ",W.bMT(3,1,"revokeAccess")," "))}function so(e,t){if(1&e){const e=W.RV6();W.j41(0,"button",30),W.bIt("click",function(){d.eBV(e);const t=W.XpG(4),i=W.r8f(0),n=W.r8f(6);return d.Njj(n?null:t.bulkRemove(i))}),W.j41(1,"span",36),W.nrm(2,"i",37),W.EFF(3),W.nI1(4,"i18n"),W.k0s()()}2&e&&(W.R7$(3),W.SpI(" ",W.bMT(4,1,"remove")," "))}function ro(e,t){if(1&e){const e=W.RV6();W.j41(0,"button",30),W.bIt("click",function(){d.eBV(e);const t=W.XpG(4),i=W.r8f(0),n=W.r8f(6);return d.Njj(n?null:t.bulkDelete(i))}),W.j41(1,"span",36),W.nrm(2,"i",38),W.EFF(3),W.nI1(4,"i18n"),W.k0s()()}2&e&&(W.R7$(3),W.SpI(" ",W.bMT(4,1,"delete")," "))}function oo(e,t){1&e&&(W.j41(0,"span",54),W.EFF(1),W.nI1(2,"i18n"),W.k0s()),2&e&&(W.R7$(),W.SpI(" ",W.bMT(2,1,"invited")," "))}function ao(e,t){1&e&&(W.j41(0,"span",55),W.EFF(1),W.nI1(2,"i18n"),W.k0s()),2&e&&(W.R7$(),W.SpI(" ",W.bMT(2,1,"needsConfirmation")," "))}function co(e,t){1&e&&(W.j41(0,"span",54),W.EFF(1),W.nI1(2,"i18n"),W.k0s()),2&e&&(W.R7$(),W.SpI(" ",W.bMT(2,1,"revoked")," "))}function lo(e,t){if(1&e&&(W.j41(0,"div",56),W.EFF(1),W.k0s()),2&e){const e=W.XpG(2).$implicit;W.R7$(),W.SpI(" ",e.email," ")}}function uo(e,t){var i;if(1&e){const e=W.RV6();W.j41(0,"td",46),W.bIt("click",function(){d.eBV(e);const t=W.XpG().$implicit;W.XpG(5);const i=W.r8f(1);return d.Njj(i.checkUser(t))}),W.j41(1,"input",47),W.mxI("ngModelChange",function(t){d.eBV(e);const i=W.XpG().$implicit;return W.DH7(i.checked,t)||(i.checked=t),d.Njj(t)}),W.k0s()(),W.j41(2,"td",48),W.bIt("click",function(){d.eBV(e);const t=W.XpG().$implicit,i=W.XpG(5),n=W.r8f(0);return d.Njj(i.edit(t,n))}),W.j41(3,"div",49),W.nrm(4,"bit-avatar",50),W.nI1(5,"userName"),W.j41(6,"div",51)(7,"div",52)(8,"button",53),W.EFF(9),W.k0s(),W.nVh(10,oo,3,3,"span",54),W.nVh(11,ao,3,3,"span",55),W.nVh(12,co,3,3,"span",54),W.k0s(),W.nVh(13,lo,2,1,"div",56),W.k0s()()()}if(2&e){const e=W.XpG().$implicit,t=W.XpG(5);W.R7$(),W.R50("ngModel",e.checked),W.R7$(3),W.Y8G("text",W.bMT(5,9,e))("id",e.userId)("color",e.avatarColor),W.R7$(5),W.SpI(" ",null!==(i=e.name)&&void 0!==i?i:e.email," "),W.R7$(),W.vxM(e.status===t.userStatusType.Invited?10:-1),W.R7$(),W.vxM(e.status===t.userStatusType.Accepted?11:-1),W.R7$(),W.vxM(e.status===t.userStatusType.Revoked?12:-1),W.R7$(),W.vxM(e.name?13:-1)}}function ho(e,t){1&e&&(W.j41(0,"span",54),W.EFF(1),W.nI1(2,"i18n"),W.k0s()),2&e&&(W.R7$(),W.SpI(" ",W.bMT(2,1,"invited")," "))}function po(e,t){1&e&&(W.j41(0,"span",55),W.EFF(1),W.nI1(2,"i18n"),W.k0s()),2&e&&(W.R7$(),W.SpI(" ",W.bMT(2,1,"needsConfirmation")," "))}function mo(e,t){1&e&&(W.j41(0,"span",54),W.EFF(1),W.nI1(2,"i18n"),W.k0s()),2&e&&(W.R7$(),W.SpI(" ",W.bMT(2,1,"revoked")," "))}function go(e,t){if(1&e&&(W.j41(0,"div",56),W.EFF(1),W.k0s()),2&e){const e=W.XpG(2).$implicit;W.R7$(),W.SpI(" ",e.email," ")}}function bo(e,t){var i;if(1&e&&(W.j41(0,"td",20)(1,"div",49),W.nrm(2,"bit-avatar",50),W.nI1(3,"userName"),W.j41(4,"div",51)(5,"div",52)(6,"span"),W.EFF(7),W.k0s(),W.nVh(8,ho,3,3,"span",54),W.nVh(9,po,3,3,"span",55),W.nVh(10,mo,3,3,"span",54),W.k0s(),W.nVh(11,go,2,1,"div",56),W.k0s()()()),2&e){const e=W.XpG().$implicit,t=W.XpG(5);W.R7$(2),W.Y8G("text",W.bMT(3,8,e))("id",e.userId)("color",e.avatarColor),W.R7$(5),W.JRh(null!==(i=e.name)&&void 0!==i?i:e.email),W.R7$(),W.vxM(e.status===t.userStatusType.Invited?8:-1),W.R7$(),W.vxM(e.status===t.userStatusType.Accepted?9:-1),W.R7$(),W.vxM(e.status===t.userStatusType.Revoked?10:-1),W.R7$(),W.vxM(e.name?11:-1)}}function fo(e,t){if(1&e){const e=W.RV6();W.j41(0,"td",48),W.bIt("click",function(){d.eBV(e);const t=W.XpG().$implicit,i=W.XpG(5),n=W.r8f(0);return d.Njj(i.edit(t,n,n.useGroups?i.memberTab.Groups:i.memberTab.Collections))}),W.nrm(1,"bit-badge-list",57),W.k0s()}if(2&e){const e=W.XpG().$implicit;W.XpG(5);const t=W.r8f(0);W.R7$(),W.Y8G("items",t.useGroups?e.groupNames:e.collectionNames)("maxItems",3)}}function vo(e,t){if(1&e&&(W.j41(0,"td",20),W.nrm(1,"bit-badge-list",57),W.k0s()),2&e){const e=W.XpG().$implicit;W.XpG(5);const t=W.r8f(0);W.R7$(),W.Y8G("items",t.useGroups?e.groupNames:e.collectionNames)("maxItems",3)}}function So(e,t){if(1&e){const e=W.RV6();W.j41(0,"td",58),W.bIt("click",function(){d.eBV(e);const t=W.XpG().$implicit,i=W.XpG(5),n=W.r8f(0);return d.Njj(i.edit(t,n,i.memberTab.Role))}),W.EFF(1),W.nI1(2,"userType"),W.k0s()}if(2&e){const e=W.XpG().$implicit;W.R7$(),W.SpI(" ",W.bMT(2,1,e.type)," ")}}function Io(e,t){if(1&e&&(W.j41(0,"td",43),W.EFF(1),W.nI1(2,"userType"),W.k0s()),2&e){const e=W.XpG().$implicit;W.R7$(),W.SpI(" ",W.bMT(2,1,e.type)," ")}}function yo(e,t){1&e&&(W.nrm(0,"i",59),W.nI1(1,"i18n"),W.j41(2,"span",13),W.EFF(3),W.nI1(4,"i18n"),W.k0s()),2&e&&(W.Y8G("title",W.mNQ(W.bMT(1,3,"userUsingTwoStep"))),W.R7$(3),W.JRh(W.bMT(4,5,"userUsingTwoStep")))}function ko(e,t){1&e&&(W.nrm(0,"i",60),W.nI1(1,"i18n"),W.j41(2,"span",13),W.EFF(3),W.nI1(4,"i18n"),W.k0s()),2&e&&(W.Y8G("title",W.mNQ(W.bMT(1,3,"enrolledAccountRecovery"))),W.R7$(3),W.JRh(W.bMT(4,5,"enrolledAccountRecovery")))}function Ro(e,t){if(1&e){const e=W.RV6();W.j41(0,"button",30),W.bIt("click",function(){d.eBV(e);const t=W.XpG(2).$implicit,i=W.XpG(5),n=W.r8f(0),s=W.r8f(6);return d.Njj(s?null:i.reinvite(t,n))}),W.nrm(1,"i",63),W.EFF(2),W.nI1(3,"i18n"),W.k0s()}2&e&&(W.R7$(2),W.SpI(" ",W.bMT(3,1,"resendInvitation")," "))}function wo(e,t){if(1&e){const e=W.RV6();W.j41(0,"button",30),W.bIt("click",function(){d.eBV(e);const t=W.XpG(2).$implicit,i=W.XpG(5),n=W.r8f(0),s=W.r8f(6);return d.Njj(s?null:i.confirm(t,n))}),W.j41(1,"span",32),W.nrm(2,"i",64),W.EFF(3),W.nI1(4,"i18n"),W.k0s()()}2&e&&(W.R7$(3),W.SpI(" ",W.bMT(4,1,"confirm")," "))}function $o(e,t){1&e&&W.nrm(0,"bit-menu-divider")}function Mo(e,t){if(1&e){const e=W.RV6();W.j41(0,"button",30),W.bIt("click",function(){d.eBV(e);const t=W.XpG(2).$implicit,i=W.XpG(5),n=W.r8f(0),s=W.r8f(6);return d.Njj(s?null:i.edit(t,n,i.memberTab.Groups))}),W.nrm(1,"i",65),W.EFF(2),W.nI1(3,"i18n"),W.k0s()}2&e&&(W.R7$(2),W.SpI(" ",W.bMT(3,1,"groups")," "))}function Fo(e,t){if(1&e){const e=W.RV6();W.j41(0,"button",30),W.bIt("click",function(){d.eBV(e);const t=W.XpG(2).$implicit,i=W.XpG(5),n=W.r8f(0),s=W.r8f(6);return d.Njj(s?null:i.openEventsDialog(t,n))}),W.nrm(1,"i",66),W.EFF(2),W.nI1(3,"i18n"),W.k0s()}2&e&&(W.R7$(2),W.SpI(" ",W.bMT(3,1,"eventLogs")," "))}function To(e,t){if(1&e){const e=W.RV6();W.nVh(0,Ro,4,3,"button",23),W.nVh(1,wo,5,3,"button",23),W.nVh(2,$o,1,0,"bit-menu-divider"),W.j41(3,"button",30),W.bIt("click",function(){d.eBV(e);const t=W.XpG().$implicit,i=W.XpG(5),n=W.r8f(0),s=W.r8f(6);return d.Njj(s?null:i.edit(t,n,i.memberTab.Role))}),W.nrm(4,"i",61),W.EFF(5),W.nI1(6,"i18n"),W.k0s(),W.nVh(7,Mo,4,3,"button",23),W.j41(8,"button",30),W.bIt("click",function(){d.eBV(e);const t=W.XpG().$implicit,i=W.XpG(5),n=W.r8f(0),s=W.r8f(6);return d.Njj(s?null:i.edit(t,n,i.memberTab.Collections))}),W.nrm(9,"i",62),W.EFF(10),W.nI1(11,"i18n"),W.k0s(),W.nrm(12,"bit-menu-divider"),W.nVh(13,Fo,4,3,"button",23)}if(2&e){const e=W.XpG().$implicit,t=W.XpG(5),i=W.r8f(0);W.vxM(e.status===t.userStatusType.Invited?0:-1),W.R7$(),W.vxM(e.status===t.userStatusType.Accepted?1:-1),W.R7$(),W.vxM(e.status===t.userStatusType.Accepted||e.status===t.userStatusType.Invited?2:-1),W.R7$(3),W.SpI(" ",W.bMT(6,7,"memberRole")," "),W.R7$(2),W.vxM(i.useGroups?7:-1),W.R7$(3),W.SpI(" ",W.bMT(11,9,"collections")," "),W.R7$(3),W.vxM(i.useEvents&&e.status===t.userStatusType.Confirmed?13:-1)}}function Eo(e,t){if(1&e){const e=W.RV6();W.j41(0,"button",30),W.bIt("click",function(){d.eBV(e);const t=W.XpG().$implicit,i=W.XpG(5),n=W.r8f(0),s=W.r8f(6);return d.Njj(s?null:i.resetPassword(t,n))}),W.nrm(1,"i",67),W.EFF(2),W.nI1(3,"i18n"),W.k0s()}2&e&&(W.R7$(2),W.SpI(" ",W.bMT(3,1,"recoverAccount")," "))}function Go(e,t){if(1&e){const e=W.RV6();W.j41(0,"button",30),W.bIt("click",function(){d.eBV(e);const t=W.XpG(2).$implicit,i=W.XpG(5),n=W.r8f(0),s=W.r8f(6);return d.Njj(s?null:i.restore(t,n))}),W.nrm(1,"i",68),W.EFF(2),W.nI1(3,"i18n"),W.k0s()}2&e&&(W.R7$(2),W.SpI(" ",W.bMT(3,1,"restoreAccess")," "))}function Uo(e,t){if(1&e){const e=W.RV6();W.j41(0,"button",30),W.bIt("click",function(){d.eBV(e);const t=W.XpG(2).$implicit,i=W.XpG(5),n=W.r8f(0),s=W.r8f(6);return d.Njj(s?null:i.revoke(t,n))}),W.nrm(1,"i",69),W.EFF(2),W.nI1(3,"i18n"),W.k0s()}2&e&&(W.R7$(2),W.SpI(" ",W.bMT(3,1,"revokeAccess")," "))}function jo(e,t){if(1&e){const e=W.RV6();W.j41(0,"button",30),W.bIt("click",function(){d.eBV(e);const t=W.XpG(2).$implicit,i=W.XpG(5),n=W.r8f(0),s=W.r8f(6);return d.Njj(s?null:i.remove(t,n))}),W.j41(1,"span",36),W.nrm(2,"i",70),W.EFF(3),W.nI1(4,"i18n"),W.k0s()()}2&e&&(W.R7$(3),W.SpI(" ",W.bMT(4,1,"remove")," "))}function Co(e,t){if(1&e){const e=W.RV6();W.j41(0,"button",30),W.bIt("click",function(){d.eBV(e);const t=W.XpG(2).$implicit,i=W.XpG(5),n=W.r8f(0),s=W.r8f(6);return d.Njj(s?null:i.deleteUser(t,n))}),W.j41(1,"span",36),W.nrm(2,"i",71),W.EFF(3),W.nI1(4,"i18n"),W.k0s()()}2&e&&(W.R7$(3),W.SpI(" ",W.bMT(4,1,"delete")," "))}function xo(e,t){if(1&e&&(W.nVh(0,Go,4,3,"button",23),W.nVh(1,Uo,4,3,"button",23),W.nVh(2,jo,5,3,"button",23)(3,Co,5,3,"button",23)),2&e){const e=W.XpG().$implicit,t=W.XpG(5);W.vxM(e.status===t.userStatusType.Revoked?0:-1),W.R7$(),W.vxM(e.status!==t.userStatusType.Revoked?1:-1),W.R7$(),W.vxM(e.managedByOrganization?3:2)}}function Do(e,t){if(1&e&&(W.j41(0,"tr",40),W.nVh(1,uo,14,11)(2,bo,12,10,"td",20),W.nVh(3,fo,2,2,"td",41)(4,vo,2,2,"td",20),W.nVh(5,So,3,3,"td",42)(6,Io,3,3,"td",43),W.j41(7,"td",44),W.nVh(8,yo,5,7),W.SS7(9),W.nI1(10,"async"),W.nVh(11,ko,5,7),W.k0s(),W.j41(12,"td",20)(13,"div",27),W.nrm(14,"div",45)(15,"button",29),W.nI1(16,"i18n"),W.k0s(),W.j41(17,"bit-menu",null,1),W.nVh(19,To,14,11),W.nVh(20,Eo,4,3,"button",23),W.nVh(21,xo,4,3),W.k0s()()()),2&e){const e=t.$implicit,i=W.sdS(18),n=W.XpG(5),s=W.r8f(0);W.Y8G("ngClass",n.rowHeightClass),W.R7$(),W.vxM(n.showUserManagementControls()?1:2),W.R7$(2),W.vxM(n.showUserManagementControls()?3:4),W.R7$(2),W.vxM(n.showUserManagementControls()?5:6),W.R7$(3),W.vxM(e.twoFactorEnabled?8:-1);const r=W.bMT(10,12,n.resetPasswordPolicyEnabled$);W.R7$(3),W.vxM(n.showEnrolledStatus(e,s,r)?11:-1),W.R7$(4),W.Y8G("label",W.mNQ(W.bMT(16,14,"options")))("bitMenuTriggerFor",i),W.R7$(4),W.vxM(n.showUserManagementControls()?19:-1),W.R7$(),W.vxM(n.allowResetPassword(e,s,r)?20:-1),W.R7$(),W.vxM(n.showUserManagementControls()?21:-1)}}function Xo(e,t){if(1&e&&W.DNE(0,Do,22,16,"tr",39),2&e){const e=t.$implicit;W.Y8G("cdkVirtualForOf",e)}}function No(e,t){if(1&e&&(W.nVh(0,Kr,4,7,"bit-callout",14),W.j41(1,"cdk-virtual-scroll-viewport",15)(2,"bit-table",16),W.qex(3,17),W.j41(4,"tr"),W.nVh(5,_r,5,3,"th",18),W.j41(6,"th",19),W.EFF(7),W.nI1(8,"i18n"),W.k0s(),W.j41(9,"th",20),W.EFF(10),W.nI1(11,"i18n"),W.k0s(),W.j41(12,"th",21),W.EFF(13),W.nI1(14,"i18n"),W.k0s(),W.j41(15,"th",20),W.EFF(16),W.nI1(17,"i18n"),W.k0s(),W.j41(18,"th",22),W.nVh(19,Hr,6,11,"th",20),W.j41(20,"bit-menu",null,0),W.nVh(22,Zr,4,3),W.nVh(23,eo,4,3,"button",23),W.nVh(24,to,5,3,"button",23),W.nVh(25,io,4,3,"button",23),W.nVh(26,no,4,3,"button",23),W.nVh(27,so,5,3,"button",23),W.nVh(28,ro,5,3,"button",23),W.k0s()()(),W.bVm(),W.DNE(29,Xo,1,1,"ng-template",24),W.k0s()()),2&e){const e=W.XpG(3),t=W.r8f(0),i=W.r8f(1),n=W.r8f(2),s=W.r8f(4);W.vxM(s?0:-1),W.R7$(),W.Y8G("itemSize",e.rowHeight),W.R7$(),W.Y8G("dataSource",i),W.R7$(3),W.vxM(e.showUserManagementControls()?5:-1),W.R7$(2),W.JRh(W.bMT(8,16,"name")),W.R7$(3),W.JRh(W.bMT(11,18,t.useGroups?"groups":"collections")),W.R7$(3),W.JRh(W.bMT(14,20,"role")),W.R7$(3),W.JRh(W.bMT(17,22,"policies")),W.R7$(3),W.vxM(e.showUserManagementControls()?19:-1),W.R7$(3),W.vxM(e.canUseSecretsManager()?22:-1),W.R7$(),W.vxM(n.showBulkReinviteUsers?23:-1),W.R7$(),W.vxM(n.showBulkConfirmUsers?24:-1),W.R7$(),W.vxM(n.showBulkRestoreUsers?25:-1),W.R7$(),W.vxM(n.showBulkRevokeUsers?26:-1),W.R7$(),W.vxM(n.showBulkRemoveUsers?27:-1),W.R7$(),W.vxM(n.showBulkDeleteUsers?28:-1)}}function Po(e,t){if(1&e&&(W.nVh(0,qr,3,3,"p"),W.nVh(1,No,30,24)),2&e){W.XpG(2);const e=W.r8f(1);W.vxM(null!=e.filteredData&&e.filteredData.length?-1:0),W.R7$(),W.vxM(null!=e.filteredData&&e.filteredData.length?1:-1)}}function Vo(e,t){if(1&e){const e=W.RV6();W.j41(0,"app-organization-free-trial-warning",2),W.bIt("clicked",function(){d.eBV(e);const t=W.XpG(),i=W.r8f(0);return d.Njj(t.billingConstraint.navigateToPaymentMethod(i))}),W.k0s(),W.j41(1,"app-header"),W.nrm(2,"bit-search",3),W.nI1(3,"i18n"),W.nVh(4,Br,4,4,"button",4),W.k0s(),W.j41(5,"div",5),W.nVh(6,Qr,19,26,"bit-toggle-group",6),W.k0s(),W.nVh(7,Lr,5,7)(8,Po,2,2)}if(2&e){const e=W.XpG(),t=W.r8f(0),i=W.r8f(1);W.Y8G("organization",t),W.R7$(2),W.Y8G("formControl",e.searchControl)("placeholder",W.bMT(3,6,"searchMembers")),W.R7$(2),W.vxM(e.showUserManagementControls()?4:-1),W.R7$(2),W.vxM(e.showUserManagementControls()?6:-1),W.R7$(),W.vxM(e.firstLoaded()&&t&&i?8:7)}}class Ao{constructor(){this.i18nService=(0,d.WQX)(h.W),this.validationService=(0,d.WQX)(ui.B),this.logService=(0,d.WQX)(rt.K),this.userNamePipe=(0,d.WQX)(Qt.b),this.dialogService=(0,d.WQX)(p.o3),this.toastService=(0,d.WQX)(m.f),this.route=(0,d.WQX)(g.nX),this.deleteManagedMemberWarningService=(0,d.WQX)(Y),this.organizationWarningsService=(0,d.WQX)(Kt.S),this.memberActionsService=(0,d.WQX)(Ei),this.memberDialogManager=(0,d.WQX)(ws),this.billingConstraint=(0,d.WQX)(f),this.memberService=(0,d.WQX)($i),this.organizationService=(0,d.WQX)(U.PV),this.accountService=(0,d.WQX)(Q.D),this.policyService=(0,d.WQX)(fi.m),this.policyApiService=(0,d.WQX)(Us.m),this.organizationMetadataService=(0,d.WQX)(Fi.Q),this.environmentService=(0,d.WQX)(qt.v),this.memberExportService=(0,d.WQX)(Gs),this.userId$=this.accountService.activeAccount$.pipe(x.F6),this.userType=j.D7,this.userStatusType=j.Zx,this.memberTab=Qe,this.searchControl=new y.MJ("",{nonNullable:!0}),this.statusToggle=new _t.t(void 0),this.dataSource=(0,d.vPA)(new li(this.environmentService)),this.firstLoaded=(0,d.vPA)(!1),this.bulkMenuOptions$=this.dataSource().usersUpdated().pipe((0,M.T)(e=>this.bulkMenuOptions(e))),this.showConfirmBanner$=this.dataSource().usersUpdated().pipe((0,M.T)(()=>{return(e=this.dataSource()).activeUserCount>1&&e.confirmedUserCount>0&&e.confirmedUserCount<3&&e.acceptedUserCount>0;var e})),this.selectedInvitedCount$=this.dataSource().usersUpdated().pipe((0,M.T)(e=>e.filter(e=>e.status===j.Zx.Invited).length)),this.isSingleInvite$=this.selectedInvitedCount$.pipe((0,M.T)(e=>1===e)),this.isProcessing=this.memberActionsService.isProcessing,this.canUseSecretsManager=(0,Bt.EW)(()=>{var e,t;return null!==(t=null===(e=this.organization())||void 0===e?void 0:e.useSecretsManager)&&void 0!==t&&t}),this.showUserManagementControls=(0,Bt.EW)(()=>{var e,t;return null!==(t=null===(e=this.organization())||void 0===e?void 0:e.canManageUsers)&&void 0!==t&&t}),this.rowHeight=66,this.rowHeightClass="tw-h-[66px]",this.exportMembers=()=>{const e=this.memberExportService.getMemberExport(this.dataSource().data);e.success&&this.toastService.showToast({variant:"success",title:void 0,message:this.i18nService.t("dataExportSuccess")}),null!=e.error&&this.validationService.showError(e.error.message)},(0,w.z)([this.searchControl.valueChanges.pipe((0,Ht.B)(200)),this.statusToggle]).pipe((0,it.pQ)()).subscribe(([e,t])=>this.dataSource().filter=ai(e,t));const e=this.route.params.pipe((0,Yt.H)(e=>this.userId$.pipe((0,$.n)(t=>this.organizationService.organizations$(t).pipe((0,X.Hc)(e.organizationId))),(0,Vt.p)(e=>null!=e),(0,F.t)({refCount:!0,bufferSize:1}))));this.organization=(0,it.ot)(e);const t=(0,w.z)([this.userId$,e]).pipe((0,$.n)(([e,t])=>t.isProviderUser?(0,Ot.H)(this.policyApiService.getPolicies(t.id)).pipe((0,M.T)(e=>Lt.P.fromListResponse(e))):this.policyService.policies$(e)));this.resetPasswordPolicyEnabled$=(0,w.z)([e,t]).pipe((0,M.T)(([e,t])=>{var i,n;return null!==(n=null===(i=t.filter(e=>e.type===j.tt.ResetPassword).find(t=>t.organizationId===e.id))||void 0===i?void 0:i.enabled)&&void 0!==n&&n})),(0,w.z)([this.route.queryParams,e]).pipe((0,Yt.H)(e=>zr(this,[e],void 0,function*([e,t]){if(yield this.load(t),this.searchControl.setValue(e.search),null!=e.viewEvents){const i=this.dataSource().data.filter(t=>t.id===e.viewEvents);i.length>0&&i[0].status===j.Zx.Confirmed&&this.openEventsDialog(i[0],t)}})),(0,it.pQ)()).subscribe(),e.pipe((0,$.n)(e=>(0,Jt.h)(this.organizationWarningsService.showInactiveSubscriptionDialog$(e),this.organizationWarningsService.showSubscribeBeforeFreeTrialEndsDialog$(e))),(0,it.pQ)()).subscribe(),this.billingMetadata$=e.pipe((0,$.n)(e=>this.organizationMetadataService.getOrganizationMetadata$(e.id)),(0,F.t)({bufferSize:1,refCount:!1})),this.billingMetadata$.pipe((0,Wt.s)(1),(0,it.pQ)()).subscribe()}load(e){return zr(this,void 0,void 0,function*(){const t=yield this.memberService.loadUsers(e);this.dataSource().data=t,this.firstLoaded.set(!0)})}remove(e,t){return zr(this,void 0,void 0,function*(){if(!(yield this.memberDialogManager.openRemoveUserConfirmationDialog(e)))return!1;const i=yield this.memberActionsService.removeUser(t,e.id);yield this.handleMemberActionResult(i,"removedUserId",e,()=>this.dataSource().removeUser(e))})}reinvite(e,t){return zr(this,void 0,void 0,function*(){const i=yield this.memberActionsService.reinviteUser(t,e.id);yield this.handleMemberActionResult(i,"hasBeenReinvited",e)})}confirm(e,t){return zr(this,void 0,void 0,function*(){const i=yield this.memberActionsService.getPublicKeyForConfirm(e);if(null==i)return void this.logService.warning("Public key not found");const n=yield this.memberActionsService.confirmUser(e,i,t);yield this.handleMemberActionResult(n,"hasBeenConfirmed",e,()=>{e.status=this.userStatusType.Confirmed,this.dataSource().replaceUser(e)})})}revoke(e,t){return zr(this,void 0,void 0,function*(){if(!(yield this.memberDialogManager.openRevokeUserConfirmationDialog(e)))return!1;const i=yield this.memberActionsService.revokeUser(t,e.id);yield this.handleMemberActionResult(i,"revokedUserId",e,()=>zr(this,void 0,void 0,function*(){return yield this.load(t)}))})}restore(e,t){return zr(this,void 0,void 0,function*(){const i=yield this.memberActionsService.restoreUser(t,e.id);yield this.handleMemberActionResult(i,"restoredUserId",e,()=>zr(this,void 0,void 0,function*(){return yield this.load(t)}))})}allowResetPassword(e,t,i){return this.memberActionsService.allowResetPassword(e,t,i)}showEnrolledStatus(e,t,i){return t.useResetPassword&&e.resetPasswordEnrolled&&i}invite(e){return zr(this,void 0,void 0,function*(){var t,i;const n=yield(0,R._)(this.billingMetadata$),s=this.billingConstraint.checkSeatLimit(e,n);if(yield this.billingConstraint.seatLimitReached(s,e))return;const r=null!==(i=null===(t=this.dataSource().data)||void 0===t?void 0:t.map(e=>e.email))&&void 0!==i?i:[];(yield this.memberDialogManager.openInviteDialog(e,n,r))===Le.Saved&&(yield this.load(e),this.organizationMetadataService.refreshMetadataCache())})}edit(e,t){return zr(this,arguments,void 0,function*(e,t,i=Qe.Role){const n=yield(0,R._)(this.billingMetadata$);switch(yield this.memberDialogManager.openEditDialog(e,t,n,i)){case Le.Deleted:this.dataSource().removeUser(e);break;case Le.Saved:case Le.Revoked:case Le.Restored:yield this.load(t)}})}bulkRemove(e){return zr(this,void 0,void 0,function*(){const t=this.dataSource().getCheckedUsersWithLimit(ri);yield this.memberDialogManager.openBulkRemoveDialog(e,t),this.organizationMetadataService.refreshMetadataCache(),yield this.load(e)})}bulkDelete(e){return zr(this,void 0,void 0,function*(){const t=this.dataSource().getCheckedUsersWithLimit(ri);yield this.memberDialogManager.openBulkDeleteDialog(e,t),yield this.load(e)})}bulkRevokeOrRestore(e,t){return zr(this,void 0,void 0,function*(){const i=this.dataSource().getCheckedUsersWithLimit(ri);yield this.memberDialogManager.openBulkRestoreRevokeDialog(t,i,e),yield this.load(t)})}bulkReinvite(e){return zr(this,void 0,void 0,function*(){let t;t=this.dataSource().isIncreasedBulkLimitEnabled()?this.dataSource().getCheckedUsersInVisibleOrder():this.dataSource().getCheckedUsers();const i=t.filter(e=>e.status===j.Zx.Invited),n=i.length;let s;if(s=this.dataSource().isIncreasedBulkLimitEnabled()?this.dataSource().limitAndUncheckExcess(i,oi):i,s.length<=0)return void this.toastService.showToast({variant:"error",title:this.i18nService.t("errorOccurred"),message:this.i18nService.t("noSelectedUsersApplicable")});const r=yield this.memberActionsService.bulkReinvite(e,s.map(e=>e.id));if(r.successful||this.validationService.showError(r.failed),this.dataSource().isIncreasedBulkLimitEnabled()){const e=n,t=s.length;if(e>oi){const t=e-oi;this.toastService.showToast({variant:"success",message:this.i18nService.t("bulkReinviteLimitedSuccessToast",oi.toLocaleString(),e.toLocaleString(),t.toLocaleString())})}else this.toastService.showToast({variant:"success",message:this.i18nService.t("bulkReinviteSuccessToast",t.toString())})}else yield this.memberDialogManager.openBulkStatusDialog(t,s,Promise.resolve(r.successful),this.i18nService.t("bulkReinviteMessage"))})}bulkConfirm(e){return zr(this,void 0,void 0,function*(){const t=this.dataSource().getCheckedUsersWithLimit(ri);yield this.memberDialogManager.openBulkConfirmDialog(e,t),yield this.load(e)})}bulkEnableSM(e){return zr(this,void 0,void 0,function*(){const t=this.dataSource().getCheckedUsersWithLimit(ri);yield this.memberDialogManager.openBulkEnableSecretsManagerDialog(e,t),this.dataSource().uncheckAllUsers(),yield this.load(e)})}openEventsDialog(e,t){this.memberDialogManager.openEventsDialog(e,t)}resetPassword(e,t){return zr(this,void 0,void 0,function*(){if(!e||!e.email||!e.id)return this.toastService.showToast({variant:"error",title:this.i18nService.t("errorOccurred"),message:this.i18nService.t("orgUserDetailsNotFound")}),void this.logService.error("Org user details not found when attempting account recovery");(yield this.memberDialogManager.openAccountRecoveryDialog(e,t))===Ii&&(yield this.load(t))})}deleteUser(e,t){return zr(this,void 0,void 0,function*(){if(!(yield this.memberDialogManager.openDeleteUserConfirmationDialog(e,t)))return!1;const i=yield this.memberActionsService.deleteUser(t,e.id);yield this.handleMemberActionResult(i,"organizationUserDeleted",e,()=>{this.dataSource().removeUser(e)})})}handleMemberActionResult(e,t,i,n){return zr(this,void 0,void 0,function*(){if(null!=e.error)return this.toastService.showToast({variant:"error",message:e.error}),void this.logService.error(e.error);e.success&&(this.toastService.showToast({variant:"success",message:this.i18nService.t(t,this.userNamePipe.transform(i))}),n&&(yield n()))})}bulkMenuOptions(e){const t=[j.Zx.Accepted,j.Zx.Confirmed,j.Zx.Revoked];return{showBulkConfirmUsers:e.every(e=>e.status==j.Zx.Accepted),showBulkReinviteUsers:e.every(e=>e.status==j.Zx.Invited),showBulkRestoreUsers:e.every(e=>e.status==j.Zx.Revoked),showBulkRevokeUsers:e.every(e=>e.status!=j.Zx.Revoked),showBulkRemoveUsers:e.every(e=>!e.managedByOrganization),showBulkDeleteUsers:e.every(e=>e.managedByOrganization&&t.includes(e.status))}}}Ao.ɵfac=function(e){return new(e||Ao)},Ao.ɵcmp=W.VBU({type:Ao,selectors:[["ng-component"]],standalone:!1,decls:10,vars:13,consts:[["headerMenu",""],["rowMenu",""],[3,"clicked","organization"],[1,"tw-grow",3,"formControl","placeholder"],["type","button","bitButton","","buttonType","primary",3,"disabled"],[1,"tw-mb-4","tw-flex","tw-flex-col","tw-space-y-4"],[3,"selected"],["type","button","bitButton","","buttonType","primary",3,"click","disabled"],["aria-hidden","true",1,"bwi","bwi-plus","bwi-fw","tw-me-2"],[3,"selectedChange","selected"],[3,"value"],["bitBadge","","variant","info"],["aria-hidden","true",1,"bwi","bwi-spinner","bwi-spin","tw-text-muted",3,"title"],[1,"tw-sr-only"],["type","info","icon","bwi-check-circle",3,"title"],["bitScrollLayout","",1,"tw-pb-8",3,"itemSize"],[3,"dataSource"],["header",""],["bitCell","",1,"tw-w-20"],["bitCell","","bitSortable","email","default",""],["bitCell",""],["bitCell","","bitSortable","type"],["bitCell","",1,"tw-w-10"],["type","button","bitMenuItem",""],["body",""],["type","checkbox","bitCheckbox","","id","selectAll",1,"tw-mr-1",3,"change"],["for","selectAll",1,"tw-mb-0","!tw-font-medium","!tw-text-muted"],[1,"tw-flex","tw-flex-row","tw-items-center","tw-justify-end","tw-gap-2"],["type","button","bitIconButton","bwi-download","size","small",3,"bitAction","disabled","label"],["type","button","bitIconButton","bwi-ellipsis-v","size","small",3,"bitMenuTriggerFor","label"],["type","button","bitMenuItem","",3,"click"],["aria-hidden","true",1,"bwi","bwi-fw","bwi-envelope"],[1,"tw-text-success"],["aria-hidden","true",1,"bwi","bwi-fw","bwi-check"],["aria-hidden","true",1,"bwi","bwi-fw","bwi-plus-circle"],["aria-hidden","true",1,"bwi","bwi-fw","bwi-minus-circle"],[1,"tw-text-danger"],["aria-hidden","true",1,"bwi","bwi-fw","bwi-close"],["aria-hidden","true",1,"bwi","bwi-fw","bwi-trash"],["bitRow","","alignContent","middle",3,"ngClass",4,"cdkVirtualFor","cdkVirtualForOf"],["bitRow","","alignContent","middle",3,"ngClass"],["bitCell","",1,"tw-cursor-pointer"],["bitCell","",1,"tw-cursor-pointer","tw-text-sm","tw-text-muted"],["bitCell","",1,"tw-text-sm","tw-text-muted"],["bitCell","",1,"tw-text-muted"],[1,"tw-w-[32px]"],["bitCell","",3,"click"],["type","checkbox","bitCheckbox","",3,"ngModelChange","ngModel"],["bitCell","",1,"tw-cursor-pointer",3,"click"],[1,"tw-flex","tw-items-center"],["size","small",1,"tw-mr-3",3,"text","id","color"],[1,"tw-flex","tw-flex-col"],[1,"tw-flex","tw-flex-row","tw-gap-2"],["type","button","bitLink",""],["bitBadge","","variant","secondary",1,"tw-text-xs"],["bitBadge","","variant","warning",1,"tw-text-xs"],[1,"tw-text-sm","tw-text-muted"],["variant","secondary",3,"items","maxItems"],["bitCell","",1,"tw-cursor-pointer","tw-text-sm","tw-text-muted",3,"click"],["aria-hidden","true",1,"bwi","bwi-lock",3,"title"],["aria-hidden","true",1,"bwi","bwi-key",3,"title"],["aria-hidden","true",1,"bwi","bwi-user"],["aria-hidden","true",1,"bwi","bwi-collection-shared"],["aria-hidden","true",1,"bwi","bwi-envelope"],["aria-hidden","true",1,"bwi","bwi-check"],["aria-hidden","true",1,"bwi","bwi-users"],["aria-hidden","true",1,"bwi","bwi-file-text"],["aria-hidden","true",1,"bwi","bwi-key"],["aria-hidden","true",1,"bwi","bwi-plus-circle"],["aria-hidden","true",1,"bwi","bwi-minus-circle"],["aria-hidden","true",1,"bwi","bwi-close"],["aria-hidden","true",1,"bwi","bwi-trash"]],template:function(e,t){if(1&e&&(W.SS7(0)(1)(2),W.nI1(3,"async"),W.SS7(4),W.nI1(5,"async"),W.SS7(6)(7),W.nI1(8,"async"),W.nVh(9,Vo,9,8)),2&e){const e=W.bH3(t.organization());W.R7$();const i=W.bH3(t.dataSource());W.R7$(),W.bH3(W.bMT(3,3,t.bulkMenuOptions$)),W.R7$(2),W.bH3(W.bMT(5,6,t.showConfirmBanner$)),W.R7$(2),W.bH3(t.isProcessing()),W.R7$(),W.bH3(W.bMT(8,10,t.isSingleInvite$)),W.R7$(2),W.vxM(e&&i?9:-1)}},dependencies:[q.YU,y.Zm,y.BC,y.vS,y.l_,_.p,Ci.f,js.p,ee.n,te.Q,vi.G,ie.P,It.s,le.g,yt.Z,kt.O,Rt.S,Cs.M,wt.Q,$t.Y,xs.O,Mt._,Mt.O,Ds.H,Xs.a,Ns.S,Ft.f,n.yg,n.E$,n.d6,Ps.lp,Vs.z,q.Jj,fe.$,Qt.b,gn.c],encapsulation:2});const zo=[...(0,tt.w)({defaultComponent:Ar,flaggedComponent:Ao,featureFlag:D.TO.MembersComponentRefactor,routeOptions:{path:"",canActivate:[(0,Pt.V)(U.pe)],data:{titleId:"members"}}}),{path:"sponsored-families",component:Nt,canActivate:[(0,Pt.V)(U.pe),e=>zt(void 0,void 0,void 0,function*(){const t=(0,d.WQX)(At.A),i=(0,d.WQX)(U.PV),n=(0,d.WQX)(Q.D).activeAccount$.pipe(x.F6,(0,$.n)(e=>i.organizations$(e)),(0,X.Hc)(e.params.organizationId),(0,Vt.p)(e=>void 0!==e));return yield(0,R._)(t.showSponsoredFamiliesDropdown$(n))})],data:{titleId:"sponsoredFamilies"}}];class Bo{}Bo.ɵfac=function(e){return new(e||Bo)},Bo.ɵmod=W.$C({type:Bo}),Bo.ɵinj=d.G2t({imports:[et.iI.forChild(zo),et.iI]});class Yo{}Yo.ɵfac=function(e){return new(e||Yo)},Yo.ɵmod=W.$C({type:Yo}),Yo.ɵinj=d.G2t({providers:[$i,Ei,f,ws,Gs,Ts],imports:[I.R,Bo,Ze,r.Rz,S.G,n.E9,s.k,v.z]})}}]);
//# sourceMappingURL=586.7330283616ea133eafd3.js.map