(()=>{var t,e,i={49701:()=>{},54836:()=>{},61016:(t,e,i)=>{"use strict";var n;!function(t){t[t.SignalR=0]="SignalR",t[t.WebPush=1]="WebPush"}(n||(n={}));class r{constructor(t){var e,i;this.featureStates={},this.version=t.version,this.gitHash=t.gitHash,this.server=t.server,this.utcDate=new Date(t.utcDate),this.environment=t.environment,this.featureStates=t.featureStates,this.push=null==t.push?{pushTechnology:n.SignalR}:{pushTechnology:t.push.pushTechnology,vapidPublicKey:t.push.vapidPublicKey},this.settings=t.settings,null==(null===(e=this.server)||void 0===e?void 0:e.name)&&null==(null===(i=this.server)||void 0===i?void 0:i.url)&&(this.server=null)}getAgeInMilliseconds(){var t;return(new Date).getTime()-(null===(t=this.utcDate)||void 0===t?void 0:t.getTime())}isValid(){return this.getAgeInMilliseconds()<=864e5}static fromJSON(t){return null==t?null:new r(t)}}var s=i(58803),o=i(97763),a=i(93695),l=i(44500),u=i(76144),c=i(45202);const d="undefined"==typeof self?i(10967):null;class h{static init(){h.inited||(h.inited=!0,h.isNode=void 0!==c&&null!=c.release&&"node"===c.release.name,h.isBrowser="undefined"!=typeof window,h.isMobileBrowser=h.isBrowser&&this.isMobile(window),h.isAppleMobileBrowser=h.isBrowser&&this.isAppleMobile(window),h.isNode?h.global=i.g:h.isBrowser?h.global=window:h.global=self)}static fromB64ToArray(t){if(null==t)return null;if(h.isNode)return new Uint8Array(Buffer.from(t,"base64"));{const e=h.global.atob(t),i=new Uint8Array(e.length);for(let t=0;t<e.length;t++)i[t]=e.charCodeAt(t);return i}}static fromUrlB64ToArray(t){return h.fromB64ToArray(h.fromUrlB64ToB64(t))}static fromHexToArray(t){if(h.isNode)return new Uint8Array(Buffer.from(t,"hex"));{const e=new Uint8Array(t.length/2);for(let i=0;i<t.length;i+=2)e[i/2]=parseInt(t.substr(i,2),16);return e}}static fromUtf8ToArray(t){if(h.isNode)return new Uint8Array(Buffer.from(t,"utf8"));{const e=unescape(encodeURIComponent(t)),i=new Uint8Array(e.length);for(let t=0;t<e.length;t++)i[t]=e.charCodeAt(t);return i}}static fromByteStringToArray(t){if(null==t)return null;const e=new Uint8Array(t.length);for(let i=0;i<t.length;i++)e[i]=t.charCodeAt(i);return e}static fromBufferToB64(t){if(null==t)return null;if(h.isNode)return Buffer.from(t).toString("base64");{let e="";const i=new Uint8Array(t);for(let t=0;t<i.byteLength;t++)e+=String.fromCharCode(i[t]);return h.global.btoa(e)}}static fromBufferToUrlB64(t){return h.fromB64toUrlB64(h.fromBufferToB64(t))}static fromB64toUrlB64(t){return t.replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}static fromBufferToUtf8(t){return o.hp.from(t).toString("utf8")}static fromBufferToByteString(t){return String.fromCharCode.apply(null,new Uint8Array(t))}static fromBufferToHex(t){if(h.isNode)return Buffer.from(t).toString("hex");{const e=new Uint8Array(t);return Array.prototype.map.call(e,(t=>("00"+t.toString(16)).slice(-2))).join("")}}static hexStringToArrayBuffer(t){if(t.length%2!=0)throw"HexString has to be an even length";const e=new ArrayBuffer(t.length/2),i=new Uint8Array(e);for(let n=0;n<i.length;n++){const e=t.substr(2*n,2),r=parseInt(e,16);i[n]=r}return e}static fromUrlB64ToB64(t){let e=t.replace(/-/g,"+").replace(/_/g,"/");switch(e.length%4){case 0:break;case 2:e+="==";break;case 3:e+="=";break;default:throw new Error("Illegal base64url string!")}return e}static fromUrlB64ToUtf8(t){return h.fromB64ToUtf8(h.fromUrlB64ToB64(t))}static fromUtf8ToB64(t){return h.isNode?Buffer.from(t,"utf8").toString("base64"):o.hp.from(t,"utf8").toString("base64")}static fromUtf8ToUrlB64(t){return h.fromBufferToUrlB64(h.fromUtf8ToArray(t))}static fromB64ToUtf8(t){return h.isNode?Buffer.from(t,"base64").toString("utf8"):o.hp.from(t,"base64").toString("utf8")}static newGuid(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(t=>{const e=16*Math.random()|0;return("x"===t?e:3&e|8).toString(16)}))}static isGuid(t){return RegExp(h.guidRegex,"i").test(t)}static getHostname(t){if(h.isNullOrWhitespace(t))return null;if((t=t.trim()).startsWith("data:"))return null;if(t.startsWith("about:"))return null;if(t.startsWith("file:"))return null;if(t.indexOf("!")>0)return null;try{const e=(0,u.EW)(t,{validHosts:this.validHosts});if(null!=e)return e}catch(e){return null}return null}static getHost(t){const e=h.getUrl(t);try{return null!=e&&""!==e.host?e.host:null}catch(i){return null}}static getDomain(t){if(h.isNullOrWhitespace(t))return null;if((t=t.trim()).startsWith("data:"))return null;if(t.startsWith("about:"))return null;try{const e=(0,u.qg)(t,{validHosts:this.validHosts,allowPrivateDomains:!0});if(null!=e&&null!=e.hostname)return"localhost"===e.hostname||e.isIp?e.hostname:null!=e.domain?e.domain:null}catch(e){return null}return null}static getQueryParams(t){const e=h.getUrl(t);if(null==e||null==e.search||""===e.search)return null;const i=new Map;return("?"===e.search[0]?e.search.substr(1):e.search).split("&").forEach((t=>{const e=t.split("=");e.length<1||i.set(decodeURIComponent(e[0]).toLowerCase(),null==e[1]?"":decodeURIComponent(e[1]))})),i}static getSortFunction(t,e){return(i,n)=>null==i[e]&&null!=n[e]?-1:null!=i[e]&&null==n[e]?1:null==i[e]&&null==n[e]?0:t.collator?t.collator.compare(i[e],n[e]):i[e].localeCompare(n[e])}static isNullOrWhitespace(t){return null==t||"string"!=typeof t||""===t.trim()}static isNullOrEmpty(t){return null==t||"string"!=typeof t||""==t}static isPromise(t){return null!=t&&"function"==typeof t.then&&"function"==typeof t.catch}static nameOf(t){return t}static assign(t,e){return Object.assign(t,e)}static iterateEnum(t){return Object.keys(t).filter((t=>Number.isNaN(+t))).map((e=>t[e]))}static getUrl(t){return this.isNullOrWhitespace(t)?null:(t=t.trim(),h.getUrlObject(t))}static camelToPascalCase(t){return t.charAt(0).toUpperCase()+t.slice(1)}static pickTextColorBasedOnBgColor(t,e=186,i=!1){const n="#"===t.charAt(0)?t.substring(1,7):t;return.299*parseInt(n.substring(0,2),16)+.587*parseInt(n.substring(2,4),16)+.114*parseInt(n.substring(4,6),16)>e?i?"black":"black !important":i?"white":"white !important"}static stringToColor(t){let e=0;for(let n=0;n<t.length;n++)e=t.charCodeAt(n)+((e<<5)-e);let i="#";for(let n=0;n<3;n++){i+=("00"+(e>>8*n&255).toString(16)).substr(-2)}return i}static getContainerService(){if(null==this.global.bitwardenContainerService)throw new Error("global bitwardenContainerService not initialized.");return this.global.bitwardenContainerService}static validateHexColor(t){return/^#([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$/.test(t)}static mapToRecord(t){return null==t?null:t instanceof Map?Object.fromEntries(t):t}static recordToMap(t){if(null==t)return null;if(t instanceof Map)return t;const e=Object.entries(t);return 0===e.length?new Map:isNaN(Number(e[0][0]))?new Map(e):new Map(e.map((t=>[Number(t[0]),t[1]])))}static merge(t,e){return Object.assign(t,e)}static encodeRFC3986URIComponent(t){return encodeURIComponent(t).replace(/[!'()*]/g,(t=>`%${t.charCodeAt(0).toString(16).toUpperCase()}`))}static normalizePath(t){return s.normalize(decodeURIComponent(t)).replace(/^(\.\.(\/|\\|$))+/,"")}static isMobile(t){let e=!1;var i;return i=t.navigator.userAgent||t.navigator.vendor||t.opera,(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(i)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(i.substr(0,4)))&&(e=!0),e||null!=t.navigator.userAgent.match(/iPad/i)}static delay(t){return new Promise((e=>setTimeout(e,t)))}static asyncToObservable(t){return(0,a.of)(void 0).pipe((0,l.n)((()=>t())))}static daysRemaining(t){const e=t.getTime()-Date.now();return Math.max(0,Math.floor(e/864e5))}static isAppleMobile(t){return null!=t.navigator.userAgent.match(/iPhone/i)||null!=t.navigator.userAgent.match(/iPad/i)}static getUrlObject(t){const e=t.indexOf("://")>-1;if(!e&&t.indexOf(".")>-1)t="http://"+t;else if(!e)return null;try{return null!=d?new d.URL(t):new URL(t)}catch(i){}return null}}var p;function y(t){return t in p?p[t]:"Unknown encryption type "+t}h.inited=!1,h.isNode=!1,h.isBrowser=!0,h.isMobileBrowser=!1,h.isAppleMobileBrowser=!1,h.global=null,h.regexpEmojiPresentation=/(?:[\u231A\u231B\u23E9-\u23EC\u23F0\u23F3\u25FD\u25FE\u2614\u2615\u2648-\u2653\u267F\u2693\u26A1\u26AA\u26AB\u26BD\u26BE\u26C4\u26C5\u26CE\u26D4\u26EA\u26F2\u26F3\u26F5\u26FA\u26FD\u2705\u270A\u270B\u2728\u274C\u274E\u2753-\u2755\u2757\u2795-\u2797\u27B0\u27BF\u2B1B\u2B1C\u2B50\u2B55]|\uD83C[\uDC04\uDCCF\uDD8E\uDD91-\uDD9A\uDDE6-\uDDFF\uDE01\uDE1A\uDE2F\uDE32-\uDE36\uDE38-\uDE3A\uDE50\uDE51\uDF00-\uDF20\uDF2D-\uDF35\uDF37-\uDF7C\uDF7E-\uDF93\uDFA0-\uDFCA\uDFCF-\uDFD3\uDFE0-\uDFF0\uDFF4\uDFF8-\uDFFF]|\uD83D[\uDC00-\uDC3E\uDC40\uDC42-\uDCFC\uDCFF-\uDD3D\uDD4B-\uDD4E\uDD50-\uDD67\uDD7A\uDD95\uDD96\uDDA4\uDDFB-\uDE4F\uDE80-\uDEC5\uDECC\uDED0-\uDED2\uDED5-\uDED7\uDEEB\uDEEC\uDEF4-\uDEFC\uDFE0-\uDFEB]|\uD83E[\uDD0C-\uDD3A\uDD3C-\uDD45\uDD47-\uDD78\uDD7A-\uDDCB\uDDCD-\uDDFF\uDE70-\uDE74\uDE78-\uDE7A\uDE80-\uDE86\uDE90-\uDEA8\uDEB0-\uDEB6\uDEC0-\uDEC2\uDED0-\uDED6])/g,h.validHosts=["localhost"],h.originalMinimumPasswordLength=8,h.minimumPasswordLength=12,h.DomainMatchBlacklist=new Map([["google.com",new Set(["script.google.com"])]]),h.guidRegex=/^[0-9a-f]{8}-(?:[0-9a-f]{4}-){3}[0-9a-f]{12}$/,h.init(),function(t){t[t.AesCbc256_B64=0]="AesCbc256_B64",t[t.AesCbc256_HmacSha256_B64=2]="AesCbc256_HmacSha256_B64",t[t.CoseEncrypt0=7]="CoseEncrypt0",t[t.Rsa2048_OaepSha256_B64=3]="Rsa2048_OaepSha256_B64",t[t.Rsa2048_OaepSha1_B64=4]="Rsa2048_OaepSha1_B64",t[t.Rsa2048_OaepSha256_HmacSha256_B64=5]="Rsa2048_OaepSha256_HmacSha256_B64",t[t.Rsa2048_OaepSha1_HmacSha256_B64=6]="Rsa2048_OaepSha1_HmacSha256_B64"}(p||(p={}));const m={[p.AesCbc256_B64]:2,[p.AesCbc256_HmacSha256_B64]:3,[p.Rsa2048_OaepSha256_B64]:1,[p.Rsa2048_OaepSha1_B64]:1,[p.Rsa2048_OaepSha256_HmacSha256_B64]:2,[p.Rsa2048_OaepSha1_HmacSha256_B64]:2,[p.CoseEncrypt0]:1};var f,v,g;!function(t){t[t.Direct=0]="Direct",t[t.Azure=1]="Azure"}(f||(f={})),function(t){t[t.ServerAuthorization=1]="ServerAuthorization",t[t.LocalAuthorization=2]="LocalAuthorization"}(v||(v={})),function(t){t.Local="local",t.Memory="memory",t.Session="session"}(g||(g={}));i(66046);var w,b,S,D;!function(t){t.Both="both",t.Disk="disk",t.Memory="memory"}(w||(w={})),function(t){t.Auto="auto",t.Pin="pin"}(b||(b={})),function(t){t[t.Debug=0]="Debug",t[t.Info=1]="Info",t[t.Warning=2]="Warning",t[t.Error=3]="Error"}(S||(S={})),function(t){t.System="system",t.Light="light",t.Dark="dark"}(D||(D={}));class N{constructor(t){if(null==t)throw new Error("Must provide key");if(32===t.byteLength)this.innerKey={type:p.AesCbc256_B64,encryptionKey:t},this.keyB64=this.toBase64();else if(64===t.byteLength)this.innerKey={type:p.AesCbc256_HmacSha256_B64,encryptionKey:t.slice(0,32),authenticationKey:t.slice(32)},this.keyB64=this.toBase64();else{if(!(t.byteLength>64))throw new Error(`Unsupported encType/key length ${t.byteLength}`);this.innerKey={type:p.CoseEncrypt0,encryptionKey:t},this.keyB64=this.toBase64()}}toJSON(){return{keyB64:this.keyB64}}inner(){return this.innerKey}toBase64(){return h.fromBufferToB64(this.toEncoded())}toEncoded(){if(this.innerKey.type===p.AesCbc256_B64)return this.innerKey.encryptionKey;if(this.innerKey.type===p.AesCbc256_HmacSha256_B64){const t=new Uint8Array(64);return t.set(this.innerKey.encryptionKey,0),t.set(this.innerKey.authenticationKey,32),t}if(this.innerKey.type===p.CoseEncrypt0)return this.innerKey.encryptionKey;throw new Error("Unsupported encryption type.")}static fromString(t){if(null==t)return null;const e=h.fromB64ToArray(t);return new N(e)}static fromJSON(t){return N.fromString(null==t?void 0:t.keyB64)}}class k{constructor(t,e=null){this.isDev=t,this.filter=e,this.timersMap=new Map}debug(t,...e){this.isDev&&this.write(S.Debug,t,...e)}info(t,...e){this.write(S.Info,t,...e)}warning(t,...e){this.write(S.Warning,t,...e)}error(t,...e){this.write(S.Error,t,...e)}write(t,e,...i){if(null==this.filter||!this.filter(t))switch(t){case S.Debug:case S.Info:console.log(e,...i);break;case S.Warning:console.warn(e,...i);break;case S.Error:console.error(e,...i)}}}class O{constructor(t,e){this.keyService=t,this.encryptService=e}attachToGlobal(t){t.bitwardenContainerService||(t.bitwardenContainerService=this)}getKeyService(){if(null==this.keyService)throw new Error("ContainerService.keyService not initialized.");return this.keyService}getEncryptService(){if(null==this.encryptService)throw new Error("ContainerService.encryptService not initialized.");return this.encryptService}}var C=function(t,e,i,n){return new(i||(i=Promise))((function(r,s){function o(t){try{l(n.next(t))}catch(e){s(e)}}function a(t){try{l(n.throw(t))}catch(e){s(e)}}function l(t){var e;t.done?r(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(o,a)}l((n=n.apply(t,e||[])).next())}))};const B="[error: cannot decrypt]";class A{constructor(t,e,i,n){null!=e?this.initFromData(t,e,i,n):this.initFromEncryptedString(t)}get ivBytes(){return null==this.iv?null:h.fromB64ToArray(this.iv)}get macBytes(){return null==this.mac?null:h.fromB64ToArray(this.mac)}get dataBytes(){return null==this.data?null:h.fromB64ToArray(this.data)}toJSON(){return this.encryptedString}static fromJSON(t){return null==t?null:new A(t)}initFromData(t,e,i,n){this.encryptedString=null!=i?t+"."+i+"|"+e:t+"."+e,null!=n&&(this.encryptedString=this.encryptedString+"|"+n),this.encryptionType=t,this.data=e,this.iv=i,this.mac=n}initFromEncryptedString(t){if(this.encryptedString=t,!this.encryptedString)return;const{encType:e,encPieces:i}=A.parseEncryptedString(this.encryptedString);if(this.encryptionType=e,i.length===m[e])switch(e){case p.AesCbc256_HmacSha256_B64:this.iv=i[0],this.data=i[1],this.mac=i[2];break;case p.AesCbc256_B64:this.iv=i[0],this.data=i[1];break;case p.Rsa2048_OaepSha256_B64:case p.Rsa2048_OaepSha1_B64:this.data=i[0];break;case p.Rsa2048_OaepSha256_HmacSha256_B64:case p.Rsa2048_OaepSha1_HmacSha256_B64:this.data=i[0],this.mac=i[1];break;default:return}}static parseEncryptedString(t){const e=t.split(".");let i,n=null;if(2===e.length)try{i=parseInt(e[0],null),n=e[1].split("|")}catch(r){return{encType:NaN,encPieces:[]}}else n=t.split("|"),i=p.AesCbc256_B64;return{encType:i,encPieces:n}}static isSerializedEncString(t){if(null==t)return!1;const{encType:e,encPieces:i}=this.parseEncryptedString(t);return!isNaN(e)&&0!==i.length&&m[e]===i.length}decrypt(t){return C(this,arguments,void 0,(function*(t,e=null,i){if(null!=this.decryptedValue)return this.decryptedValue;try{if(null==e&&(e=yield this.getKeyForDecryption(t)),null==e)throw new Error("No key to decrypt EncString with orgId "+t);const i=h.getContainerService().getEncryptService();this.decryptedValue=yield i.decryptString(this,e)}catch(n){this.decryptedValue=B}return this.decryptedValue}))}decryptWithKey(t,e){return C(this,arguments,void 0,(function*(t,e,i="domain-withkey"){try{if(null==t)throw new Error("No key to decrypt EncString");this.decryptedValue=yield e.decryptString(this,t)}catch(n){this.decryptedValue=B}return this.decryptedValue}))}getKeyForDecryption(t){return C(this,void 0,void 0,(function*(){const e=h.getContainerService().getKeyService();return null!=t?yield e.getOrgKey(t):yield e.getUserKeyWithLegacySupport()}))}}var E,x=function(t,e,i,n){return new(i||(i=Promise))((function(r,s){function o(t){try{l(n.next(t))}catch(e){s(e)}}function a(t){try{l(n.throw(t))}catch(e){s(e)}}function l(t){var e;t.done?r(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(o,a)}l((n=n.apply(t,e||[])).next())}))};class P{buildDomainModel(t,e,i,n=[]){for(const r in i){if(!i.hasOwnProperty(r))continue;const s=e[i[r]||r];n.indexOf(r)>-1?t[r]=s||null:t[r]=s?new A(s):null}}buildDataModel(t,e,i,n=[]){for(const r in i){if(!i.hasOwnProperty(r))continue;const s=t[i[r]||r];n.indexOf(r)>-1?e[r]=null!=s?s:null:e[r]=null!=s?s.encryptedString:null}}decryptObj(t,e,i,n){return x(this,arguments,void 0,(function*(t,e,i,n,r=null,s="No Domain Context"){var o,a;for(const l of i)e[l]=null!==(a=yield null===(o=t[l])||void 0===o?void 0:o.decrypt(n,r,`Property: ${l}; ObjectContext: ${s}`))&&void 0!==a?a:null;return e}))}decryptObjWithKey(t,e,i){return x(this,arguments,void 0,(function*(t,e,i,n=this.constructor,r="No Domain Context"){const s=[];for(const o of t){const t=this[o],n=yield this.decryptProperty(o,t,e,i,`Property: ${o.toString()}; ObjectContext: ${r}`);s.push(n)}return s.reduce(((t,e)=>Object.assign(Object.assign({},t),e)),Object.assign({},this))}))}decryptProperty(t,e,i,n,r){return x(this,void 0,void 0,(function*(){let s=null;return e&&(s=yield e.decryptWithKey(i,n,r)),{[t]:s}}))}}!function(t){t[t.Cipher=0]="Cipher",t[t.CipherView=1]="CipherView"}(E||(E={}));const _=Object.freeze({Login:1,SecureNote:2,Card:3,Identity:4,SshKey:5});Object.freeze(Object.fromEntries(Object.entries(_).map((([t,e])=>[e,t]))));class K{constructor(t){this.response=t}getResponseProperty(t,e=null,i=!1){if(null==t||""===t)throw new Error("propertyName must not be null/empty.");if(null==e&&null!=this.response&&(e=this.response),null==e)return null;if(!i&&void 0===e[t]){let i=null;i=t.charAt(0)===t.charAt(0).toUpperCase()?t.charAt(0).toLowerCase():t.charAt(0).toUpperCase(),t.length>1&&(i+=t.slice(1)),void 0===e[t=i]&&(t=t.toLowerCase()),void 0===e[t]&&(t=t.toUpperCase())}return e[t]}}class U extends K{constructor(t=null){super(t),this.delete=!1,this.restore=!1,null!=t&&(this.delete=this.getResponseProperty("Delete"),this.restore=this.getResponseProperty("Restore"))}static fromJSON(t){return Object.assign(new U,t)}static fromSdkCipherPermissions(t){if(!t)return;const e=new U;return e.delete=t.delete,e.restore=t.restore,e}}class I{constructor(t){null!=t&&(this.id=t.id,this.url=t.url,this.fileName=t.fileName,this.key=t.key,this.size=t.size,this.sizeName=t.sizeName)}}class T{constructor(t){null!=t&&(this.cardholderName=t.cardholderName,this.brand=t.brand,this.number=t.number,this.expMonth=t.expMonth,this.expYear=t.expYear,this.code=t.code)}}class F{constructor(t){null!=t&&(this.type=t.type,this.name=t.name,this.value=t.value,this.linkedId=t.linkedId)}}class J{constructor(t){null!=t&&(this.title=t.title,this.firstName=t.firstName,this.middleName=t.middleName,this.lastName=t.lastName,this.address1=t.address1,this.address2=t.address2,this.address3=t.address3,this.city=t.city,this.state=t.state,this.postalCode=t.postalCode,this.country=t.country,this.company=t.company,this.email=t.email,this.phone=t.phone,this.ssn=t.ssn,this.username=t.username,this.passportNumber=t.passportNumber,this.licenseNumber=t.licenseNumber)}}class R{constructor(t){null!=t&&(this.credentialId=t.credentialId,this.keyType=t.keyType,this.keyAlgorithm=t.keyAlgorithm,this.keyCurve=t.keyCurve,this.keyValue=t.keyValue,this.rpId=t.rpId,this.userHandle=t.userHandle,this.userName=t.userName,this.counter=t.counter,this.rpName=t.rpName,this.userDisplayName=t.userDisplayName,this.discoverable=t.discoverable,this.creationDate=t.creationDate)}}class M{constructor(t){this.match=null,null!=t&&(this.uri=t.uri,this.uriChecksum=t.uriChecksum,this.match=t.match)}}class L{constructor(t){var e;null!=t&&(this.username=t.username,this.password=t.password,this.passwordRevisionDate=t.passwordRevisionDate,this.totp=t.totp,this.autofillOnPageLoad=t.autofillOnPageLoad,t.uris&&(this.uris=t.uris.map((t=>new M(t)))),t.fido2Credentials&&(this.fido2Credentials=null===(e=t.fido2Credentials)||void 0===e?void 0:e.map((t=>new R(t)))))}}class z{constructor(t){null!=t&&(this.password=t.password,this.lastUsedDate=t.lastUsedDate)}}class j{constructor(t){null!=t&&(this.type=t.type)}}class H{constructor(t){null!=t&&(this.privateKey=t.privateKey,this.publicKey=t.publicKey,this.keyFingerprint=t.keyFingerprint)}}class W{constructor(t,e){if(null!=t){switch(this.id=t.id,this.organizationId=t.organizationId,this.folderId=t.folderId,this.edit=t.edit,this.viewPassword=t.viewPassword,this.permissions=t.permissions,this.organizationUseTotp=t.organizationUseTotp,this.favorite=t.favorite,this.revisionDate=t.revisionDate,this.type=t.type,this.name=t.name,this.notes=t.notes,this.collectionIds=null!=e?e:t.collectionIds,this.creationDate=t.creationDate,this.deletedDate=t.deletedDate,this.reprompt=t.reprompt,this.key=t.key,this.type){case _.Login:this.login=new L(t.login);break;case _.SecureNote:this.secureNote=new j(t.secureNote);break;case _.Card:this.card=new T(t.card);break;case _.Identity:this.identity=new J(t.identity);break;case _.SshKey:this.sshKey=new H(t.sshKey)}null!=t.fields&&(this.fields=t.fields.map((t=>new F(t)))),null!=t.attachments&&(this.attachments=t.attachments.map((t=>new I(t)))),null!=t.passwordHistory&&(this.passwordHistory=t.passwordHistory.map((t=>new z(t))))}}static fromJSON(t){const e=Object.assign(new W,t);return e.permissions=U.fromJSON(t.permissions),e}}const V=0,$=(Object.freeze({Text:0,Hidden:1,Boolean:2,Linked:3}),100),Y=101,q=300,G=301,Z=302,Q=303,X=304,tt=305,et=400,it=401,nt=402,rt=403,st=404,ot=405,at=406,lt=407,ut=408,ct=409,dt=410,ht=411,pt=412,yt=413,mt=414,ft=415,vt=416,gt=417,wt=418;class bt{constructor(t){this.id=null,this.url=null,this.size=null,this.sizeName=null,this.fileName=null,this.key=null,t&&(this.id=t.id,this.url=t.url,this.size=t.size,this.sizeName=t.sizeName)}get fileSize(){try{if(null!=this.size)return parseInt(this.size,null)}catch(t){}return 0}static fromJSON(t){const e=null==t.key?null:N.fromJSON(t.key);return Object.assign(new bt,t,{key:e})}toSdkAttachmentView(){var t;return{id:this.id,url:this.url,size:this.size,sizeName:this.sizeName,fileName:this.fileName,key:null===(t=this.encryptedKey)||void 0===t?void 0:t.toJSON()}}static fromSdkAttachmentView(t){var e,i,n,r,s;if(!t)return;const o=new bt;return o.id=null!==(e=t.id)&&void 0!==e?e:null,o.url=null!==(i=t.url)&&void 0!==i?i:null,o.size=null!==(n=t.size)&&void 0!==n?n:null,o.sizeName=null!==(r=t.sizeName)&&void 0!==r?r:null,o.fileName=null!==(s=t.fileName)&&void 0!==s?s:null,o.encryptedKey=new A(t.key),o}}const St="\\"+["/","-","."," "].join("\\").replace(" ","s");new RegExp(`[${St}]`,"g"),new RegExp(`[^\\d${St}]`,"g"),new RegExp("^(([1]{1}[0-2]{1})|(0?[1-9]{1}))$"),new RegExp("^2[0-1]{1}\\d{2}$");function Dt(t){const e=null==t||""===t;let i=e?null:`${t}`;if(e||i&&/^[1-9]{1}\d{3}$/.test(i))return i;if(i=(i||"").replace(/[^\d]/g,"").replace(/^[0]+(?=.)/,""),""===i&&(i=null),i&&4!==i.length){const t=("00"+i).slice(-2);i=`${(new Date).getFullYear()}`.slice(0,2)+t}return i}class Nt{constructor(t,e){this.propertyKey=t,this._i18nKey=null==e?void 0:e.i18nKey,this.sortPosition=e.sortPosition}get i18nKey(){var t;return null!==(t=this._i18nKey)&&void 0!==t?t:this.propertyKey}}function kt(t,e){return(i,n)=>{null==i.linkedFieldOptions&&(i.linkedFieldOptions=new Map),i.linkedFieldOptions.set(t,new Nt(n,e))}}class Ot{}var Ct=function(t,e,i,n){var r,s=arguments.length,o=s<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(o=(s<3?r(o):s>3?r(e,i,o):r(e,i))||o);return s>3&&o&&Object.defineProperty(e,i,o),o},Bt=function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};class At extends Ot{constructor(){super(...arguments),this.cardholderName=null,this.expMonth=null,this.expYear=null,this.code=null,this._brand=null,this._number=null,this._subTitle=null}get maskedCode(){return null!=this.code?"•".repeat(this.code.length):null}get maskedNumber(){return null!=this.number?"•".repeat(this.number.length):null}get brand(){return this._brand}set brand(t){this._brand=t,this._subTitle=null}get number(){return this._number}set number(t){this._number=t,this._subTitle=null}get subTitle(){if(null==this._subTitle&&(this._subTitle=this.brand,null!=this.number&&this.number.length>=4)){null!=this._subTitle&&""!==this._subTitle?this._subTitle+=", ":this._subTitle="";const t=this.number.length>=5&&null!=this.number.match(new RegExp("^3[47]"))?5:4;this._subTitle+="*"+this.number.substr(this.number.length-t)}return this._subTitle}get expiration(){const t=Dt(this.expYear);if(!this.expMonth&&!t)return null;let e=null!=this.expMonth?("0"+this.expMonth).slice(-2):"__";return e+=" / "+(t||"____"),e}static fromJSON(t){return Object.assign(new At,t)}static getCardBrandByPatterns(t){if(null==t||"string"!=typeof t||""===t.trim())return null;let e=new RegExp("^4");return null!=t.match(e)?"Visa":/^(5[1-5][0-9]{14}|2(22[1-9][0-9]{12}|2[3-9][0-9]{13}|[3-6][0-9]{14}|7[0-1][0-9]{13}|720[0-9]{12}))$/.test(t)?"Mastercard":(e=new RegExp("^3[47]"),null!=t.match(e)?"Amex":(e=new RegExp("^(6011|622(12[6-9]|1[3-9][0-9]|[2-8][0-9]{2}|9[0-1][0-9]|92[0-5]|64[4-9])|65)"),null!=t.match(e)?"Discover":(e=new RegExp("^36"),null!=t.match(e)?"Diners Club":(e=new RegExp("^30[0-5]"),null!=t.match(e)?"Diners Club":(e=new RegExp("^35(2[89]|[3-8][0-9])"),null!=t.match(e)?"JCB":(e=new RegExp("^(4026|417500|4508|4844|491(3|7))"),null!=t.match(e)?"Visa":null))))))}static fromSdkCardView(t){var e,i,n,r,s,o;if(null==t)return;const a=new At;return a.cardholderName=null!==(e=t.cardholderName)&&void 0!==e?e:null,a.brand=null!==(i=t.brand)&&void 0!==i?i:null,a.number=null!==(n=t.number)&&void 0!==n?n:null,a.expMonth=null!==(r=t.expMonth)&&void 0!==r?r:null,a.expYear=null!==(s=t.expYear)&&void 0!==s?s:null,a.code=null!==(o=t.code)&&void 0!==o?o:null,a}}Ct([kt(q,{sortPosition:0}),Bt("design:type",String)],At.prototype,"cardholderName",void 0),Ct([kt(G,{sortPosition:3,i18nKey:"expirationMonth"}),Bt("design:type",String)],At.prototype,"expMonth",void 0),Ct([kt(Z,{sortPosition:4,i18nKey:"expirationYear"}),Bt("design:type",String)],At.prototype,"expYear",void 0),Ct([kt(Q,{sortPosition:5,i18nKey:"securityCode"}),Bt("design:type",String)],At.prototype,"code",void 0),Ct([kt(X,{sortPosition:2}),Bt("design:type",String),Bt("design:paramtypes",[String])],At.prototype,"brand",null),Ct([kt(tt,{sortPosition:1}),Bt("design:type",String),Bt("design:paramtypes",[String])],At.prototype,"number",null);class Et{constructor(t){this.name=null,this.value=null,this.type=null,this.newField=!1,this.showValue=!1,this.showCount=!1,this.linkedId=null,t&&(this.type=t.type,this.linkedId=t.linkedId)}get maskedValue(){return null!=this.value?"••••••••":null}static fromJSON(t){return Object.assign(new Et,t)}static fromSdkFieldView(t){if(!t)return;const e=new Et;return e.name=t.name,e.value=t.value,e.type=t.type,e.linkedId=t.linkedId,e}}var xt=function(t,e,i,n){var r,s=arguments.length,o=s<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(o=(s<3?r(o):s>3?r(e,i,o):r(e,i))||o);return s>3&&o&&Object.defineProperty(e,i,o),o},Pt=function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};class _t extends Ot{constructor(){super(),this.title=null,this.middleName=null,this.address1=null,this.address2=null,this.address3=null,this.city=null,this.state=null,this.postalCode=null,this.country=null,this.company=null,this.email=null,this.phone=null,this.ssn=null,this.username=null,this.passportNumber=null,this.licenseNumber=null,this._firstName=null,this._lastName=null,this._subTitle=null}get firstName(){return this._firstName}set firstName(t){this._firstName=t,this._subTitle=null}get lastName(){return this._lastName}set lastName(t){this._lastName=t,this._subTitle=null}get subTitle(){return null!=this._subTitle||null==this.firstName&&null==this.lastName||(this._subTitle="",null!=this.firstName&&(this._subTitle=this.firstName),null!=this.lastName&&(""!==this._subTitle&&(this._subTitle+=" "),this._subTitle+=this.lastName)),this._subTitle}get fullName(){if(null!=this.title||null!=this.firstName||null!=this.middleName||null!=this.lastName){let t="";return null!=this.title&&(t+=this.title+" "),null!=this.firstName&&(t+=this.firstName+" "),null!=this.middleName&&(t+=this.middleName+" "),null!=this.lastName&&(t+=this.lastName),t.trim()}return null}get fullAddress(){let t=this.address1;return h.isNullOrWhitespace(this.address2)||(h.isNullOrWhitespace(t)||(t+=", "),t+=this.address2),h.isNullOrWhitespace(this.address3)||(h.isNullOrWhitespace(t)||(t+=", "),t+=this.address3),t}get fullAddressPart2(){if(null==this.city&&null==this.state&&null==this.postalCode)return null;const t=this.city||"-",e=this.state,i=this.postalCode||"-";let n=t;return h.isNullOrWhitespace(e)||(n+=", "+e),n+=", "+i,n}get fullAddressForCopy(){let t=this.fullAddress;return null==this.city&&null==this.state&&null==this.postalCode||(t+="\n"+this.fullAddressPart2),null!=this.country&&(t+="\n"+this.country),t}static fromJSON(t){return Object.assign(new _t,t)}static fromSdkIdentityView(t){var e,i,n,r,s,o,a,l,u,c,d,h,p,y,m,f,v,g;if(null==t)return;const w=new _t;return w.title=null!==(e=t.title)&&void 0!==e?e:null,w.firstName=null!==(i=t.firstName)&&void 0!==i?i:null,w.middleName=null!==(n=t.middleName)&&void 0!==n?n:null,w.lastName=null!==(r=t.lastName)&&void 0!==r?r:null,w.address1=null!==(s=t.address1)&&void 0!==s?s:null,w.address2=null!==(o=t.address2)&&void 0!==o?o:null,w.address3=null!==(a=t.address3)&&void 0!==a?a:null,w.city=null!==(l=t.city)&&void 0!==l?l:null,w.state=null!==(u=t.state)&&void 0!==u?u:null,w.postalCode=null!==(c=t.postalCode)&&void 0!==c?c:null,w.country=null!==(d=t.country)&&void 0!==d?d:null,w.company=null!==(h=t.company)&&void 0!==h?h:null,w.email=null!==(p=t.email)&&void 0!==p?p:null,w.phone=null!==(y=t.phone)&&void 0!==y?y:null,w.ssn=null!==(m=t.ssn)&&void 0!==m?m:null,w.username=null!==(f=t.username)&&void 0!==f?f:null,w.passportNumber=null!==(v=t.passportNumber)&&void 0!==v?v:null,w.licenseNumber=null!==(g=t.licenseNumber)&&void 0!==g?g:null,w}}xt([kt(et,{sortPosition:0}),Pt("design:type",String)],_t.prototype,"title",void 0),xt([kt(it,{sortPosition:2}),Pt("design:type",String)],_t.prototype,"middleName",void 0),xt([kt(nt,{sortPosition:12}),Pt("design:type",String)],_t.prototype,"address1",void 0),xt([kt(rt,{sortPosition:13}),Pt("design:type",String)],_t.prototype,"address2",void 0),xt([kt(st,{sortPosition:14}),Pt("design:type",String)],_t.prototype,"address3",void 0),xt([kt(ot,{sortPosition:15,i18nKey:"cityTown"}),Pt("design:type",String)],_t.prototype,"city",void 0),xt([kt(at,{sortPosition:16,i18nKey:"stateProvince"}),Pt("design:type",String)],_t.prototype,"state",void 0),xt([kt(lt,{sortPosition:17,i18nKey:"zipPostalCode"}),Pt("design:type",String)],_t.prototype,"postalCode",void 0),xt([kt(ut,{sortPosition:18}),Pt("design:type",String)],_t.prototype,"country",void 0),xt([kt(ct,{sortPosition:6}),Pt("design:type",String)],_t.prototype,"company",void 0),xt([kt(dt,{sortPosition:10}),Pt("design:type",String)],_t.prototype,"email",void 0),xt([kt(ht,{sortPosition:11}),Pt("design:type",String)],_t.prototype,"phone",void 0),xt([kt(pt,{sortPosition:7}),Pt("design:type",String)],_t.prototype,"ssn",void 0),xt([kt(yt,{sortPosition:5}),Pt("design:type",String)],_t.prototype,"username",void 0),xt([kt(mt,{sortPosition:8}),Pt("design:type",String)],_t.prototype,"passportNumber",void 0),xt([kt(ft,{sortPosition:9}),Pt("design:type",String)],_t.prototype,"licenseNumber",void 0),xt([kt(vt,{sortPosition:1}),Pt("design:type",String),Pt("design:paramtypes",[String])],_t.prototype,"firstName",null),xt([kt(gt,{sortPosition:4}),Pt("design:type",String),Pt("design:paramtypes",[String])],_t.prototype,"lastName",null),xt([kt(wt,{sortPosition:3}),Pt("design:type",String),Pt("design:paramtypes",[])],_t.prototype,"fullName",null);class Kt extends Ot{constructor(){super(...arguments),this.creationDate=null}get subTitle(){return this.userDisplayName}static fromJSON(t){const e=null!=t.creationDate?new Date(t.creationDate):null;return Object.assign(new Kt,t,{creationDate:e})}static fromSdkFido2CredentialView(t){var e;if(!t)return;const i=new Kt;return i.credentialId=t.credentialId,i.keyType=t.keyType,i.keyAlgorithm=t.keyAlgorithm,i.keyCurve=t.keyCurve,i.rpId=t.rpId,i.userHandle=t.userHandle,i.userName=t.userName,i.counter=parseInt(t.counter),i.rpName=t.rpName,i.userDisplayName=t.userDisplayName,i.discoverable="true"===(null===(e=t.discoverable)||void 0===e?void 0:e.toLowerCase()),i.creationDate=t.creationDate?new Date(t.creationDate):null,i}}const Ut=0,It=1,Tt=2,Ft=3,Jt=4,Rt=5,Mt=["https://","http://","ssh://","ftp://","sftp://","irc://","vnc://","rdp://","ms-rd:","chrome://","iosapp://","androidapp://"];class Lt{static canLaunch(t){if(h.isNullOrWhitespace(t))return!1;for(let e=0;e<Mt.length;e++)if(0===t.indexOf(Mt[e]))return!0;return!1}}class zt{constructor(t){this.match=null,this._uri=null,this._domain=null,this._hostname=null,this._host=null,this._canLaunch=null,t&&(this.match=t.match)}get uri(){return this._uri}set uri(t){this._uri=t,this._domain=null,this._canLaunch=null}get domain(){return null==this._domain&&null!=this.uri&&(this._domain=h.getDomain(this.uri),""===this._domain&&(this._domain=null)),this._domain}get hostname(){return this.match===Jt?null:(null==this._hostname&&null!=this.uri&&(this._hostname=h.getHostname(this.uri),""===this._hostname&&(this._hostname=null)),this._hostname)}get host(){return this.match===Jt?null:(null==this._host&&null!=this.uri&&(this._host=h.getHost(this.uri),""===this._host&&(this._host=null)),this._host)}get hostnameOrUri(){return null!=this.hostname?this.hostname:this.uri}get hostOrUri(){return null!=this.host?this.host:this.uri}get isWebsite(){return null!=this.uri&&(0===this.uri.indexOf("http://")||0===this.uri.indexOf("https://")||this.uri.indexOf("://")<0&&!h.isNullOrWhitespace(h.getDomain(this.uri)))}get canLaunch(){return null!=this._canLaunch||(null!=this.uri&&this.match!==Jt?this._canLaunch=Lt.canLaunch(this.launchUri):this._canLaunch=!1),this._canLaunch}get launchUri(){return this.uri.indexOf("://")<0&&!h.isNullOrWhitespace(h.getDomain(this.uri))?"http://"+this.uri:this.uri}static fromJSON(t){return Object.assign(new zt,t)}static fromSdkLoginUriView(t){if(null==t)return;const e=new zt;return e.uri=t.uri,e.match=t.match,e}matchesUri(t,e,i=null){var n;if(!this.uri||!t)return!1;let r=null!==(n=this.match)&&void 0!==n?n:i;null!=r||(r=Ut);const s=h.getDomain(t),o=e.add(s);switch(r){case Ut:return this.matchesDomain(t,o);case It:{const e=h.getHost(t);return null!=e&&e===h.getHost(this.uri)}case Ft:return t===this.uri;case Tt:return t.startsWith(this.uri);case Jt:try{return new RegExp(this.uri,"i").test(t)}catch(a){return!1}case Rt:return!1}return!1}matchesDomain(t,e){if(null==t||null==this.domain||!e.has(this.domain))return!1;if(h.DomainMatchBlacklist.has(this.domain)){const e=h.getHost(t);return!h.DomainMatchBlacklist.get(this.domain).has(e)}return!0}}var jt=function(t,e,i,n){var r,s=arguments.length,o=s<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(o=(s<3?r(o):s>3?r(e,i,o):r(e,i))||o);return s>3&&o&&Object.defineProperty(e,i,o),o},Ht=function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};class Wt extends Ot{constructor(t){super(),this.username=null,this.password=null,this.passwordRevisionDate=null,this.totp=null,this.uris=[],this.autofillOnPageLoad=null,this.fido2Credentials=null,t&&(this.passwordRevisionDate=t.passwordRevisionDate,this.autofillOnPageLoad=t.autofillOnPageLoad)}get uri(){return this.hasUris?this.uris[0].uri:null}get maskedPassword(){return null!=this.password?"••••••••":null}get subTitle(){var t;return h.isNullOrEmpty(this.username)&&(null===(t=this.fido2Credentials)||void 0===t?void 0:t.length)>0?this.fido2Credentials[0].userName:this.username}get canLaunch(){return this.hasUris&&this.uris.some((t=>t.canLaunch))}get hasTotp(){return!h.isNullOrWhitespace(this.totp)}get launchUri(){if(this.hasUris){const t=this.uris.find((t=>t.canLaunch));if(null!=t)return t.launchUri}return null}get hasUris(){return null!=this.uris&&this.uris.length>0}get hasFido2Credentials(){return null!=this.fido2Credentials&&this.fido2Credentials.length>0}matchesUri(t,e,i=null){return null!=this.uris&&this.uris.some((n=>n.matchesUri(t,e,i)))}static fromJSON(t){var e;const i=null==t.passwordRevisionDate?null:new Date(t.passwordRevisionDate),n=t.uris.map((t=>zt.fromJSON(t))),r=null===(e=t.fido2Credentials)||void 0===e?void 0:e.map((t=>Kt.fromJSON(t)));return Object.assign(new Wt,t,{passwordRevisionDate:i,uris:n,fido2Credentials:r})}static fromSdkLoginView(t){var e,i,n,r,s;if(null==t)return;const o=new Wt;return o.username=null!==(e=t.username)&&void 0!==e?e:null,o.password=null!==(i=t.password)&&void 0!==i?i:null,o.passwordRevisionDate=null==t.passwordRevisionDate?null:new Date(t.passwordRevisionDate),o.totp=null!==(n=t.totp)&&void 0!==n?n:null,o.autofillOnPageLoad=null!==(r=t.autofillOnPageLoad)&&void 0!==r?r:null,o.uris=(null===(s=t.uris)||void 0===s?void 0:s.map((t=>zt.fromSdkLoginUriView(t))))||[],o.fido2Credentials=null,o}}jt([kt($,{sortPosition:0}),Ht("design:type",String)],Wt.prototype,"username",void 0),jt([kt(Y,{sortPosition:1}),Ht("design:type",String)],Wt.prototype,"password",void 0);class Vt{constructor(t){this.password=null,this.lastUsedDate=null,t&&(this.lastUsedDate=t.lastUsedDate)}static fromJSON(t){const e=null==t.lastUsedDate?null:new Date(t.lastUsedDate);return Object.assign(new Vt,t,{lastUsedDate:e})}static fromSdkPasswordHistoryView(t){if(!t)return;const e=new Vt;return e.password=t.password,e.lastUsedDate=null==t.lastUsedDate?null:new Date(t.lastUsedDate),e}}class $t extends Ot{constructor(t){super(),this.type=null,t&&(this.type=t.type)}get subTitle(){return null}static fromJSON(t){return Object.assign(new $t,t)}static fromSdkSecureNoteView(t){var e;if(!t)return;const i=new $t;return i.type=null!==(e=t.type)&&void 0!==e?e:null,i}}class Yt extends Ot{constructor(t){super(),this.privateKey=null,this.publicKey=null,this.keyFingerprint=null}get maskedPrivateKey(){if(!this.privateKey||0===this.privateKey.length)return"";let t=this.privateKey.split("\n").filter((t=>""!==t.trim()));return t=t.map(((e,i)=>0===i||i===t.length-1?e:this.maskLine(e))),t.join("\n")}maskLine(t){return"•".repeat(32)}get subTitle(){return this.keyFingerprint}static fromJSON(t){return Object.assign(new Yt,t)}static fromSdkSshKeyView(t){var e,i,n;if(!t)return;const r=new Yt;return r.privateKey=null!==(e=t.privateKey)&&void 0!==e?e:null,r.publicKey=null!==(i=t.publicKey)&&void 0!==i?i:null,r.keyFingerprint=null!==(n=t.fingerprint)&&void 0!==n?n:null,r}}class qt{constructor(t){var e;this.initializerKey=E.CipherView,this.id=null,this.organizationId=null,this.folderId=null,this.name=null,this.notes=null,this.type=null,this.favorite=!1,this.organizationUseTotp=!1,this.permissions=new U,this.edit=!1,this.viewPassword=!0,this.login=new Wt,this.identity=new _t,this.card=new At,this.secureNote=new $t,this.sshKey=new Yt,this.attachments=null,this.fields=null,this.passwordHistory=null,this.collectionIds=null,this.revisionDate=null,this.creationDate=null,this.deletedDate=null,this.reprompt=V,this.decryptionFailure=!1,t&&(this.id=t.id,this.organizationId=t.organizationId,this.folderId=t.folderId,this.favorite=t.favorite,this.organizationUseTotp=t.organizationUseTotp,this.edit=t.edit,this.viewPassword=t.viewPassword,this.permissions=t.permissions,this.type=t.type,this.localData=t.localData,this.collectionIds=t.collectionIds,this.revisionDate=t.revisionDate,this.creationDate=t.creationDate,this.deletedDate=t.deletedDate,this.reprompt=null!==(e=t.reprompt)&&void 0!==e?e:V)}get item(){switch(this.type){case _.Login:return this.login;case _.SecureNote:return this.secureNote;case _.Card:return this.card;case _.Identity:return this.identity;case _.SshKey:return this.sshKey}return null}get subTitle(){var t;return null===(t=this.item)||void 0===t?void 0:t.subTitle}get hasPasswordHistory(){return this.passwordHistory&&this.passwordHistory.length>0}get hasAttachments(){return this.attachments&&this.attachments.length>0}get hasOldAttachments(){if(this.hasAttachments)for(let t=0;t<this.attachments.length;t++)if(null==this.attachments[t].key&&null==this.attachments[t].encryptedKey)return!0;return!1}get hasFields(){return this.fields&&this.fields.length>0}get passwordRevisionDisplayDate(){return this.type!==_.Login||null==this.login||null==this.login.password||""===this.login.password?null:this.login.passwordRevisionDate}get isDeleted(){return null!=this.deletedDate}get linkedFieldOptions(){var t;return null===(t=this.item)||void 0===t?void 0:t.linkedFieldOptions}get isUnassigned(){return null!=this.organizationId&&(null==this.collectionIds||0===this.collectionIds.length)}get canAssignToCollections(){return null==this.organizationId||this.edit&&this.viewPassword}get canLaunch(){return this.type===_.Login&&this.login.canLaunch}linkedFieldValue(t){var e;const i=null===(e=this.linkedFieldOptions)||void 0===e?void 0:e.get(t);if(null==i)return null;this.item;return this.item[i.propertyKey]}linkedFieldI18nKey(t){var e;return null===(e=this.linkedFieldOptions.get(t))||void 0===e?void 0:e.i18nKey}toJSON(){return this}static fromJSON(t){var e,i,n;if(null==t)return null;const r=new qt,s=null==t.creationDate?null:new Date(t.creationDate),o=null==t.revisionDate?null:new Date(t.revisionDate),a=null==t.deletedDate?null:new Date(t.deletedDate),l=null===(e=t.attachments)||void 0===e?void 0:e.map((t=>bt.fromJSON(t))),u=null===(i=t.fields)||void 0===i?void 0:i.map((t=>Et.fromJSON(t))),c=null===(n=t.passwordHistory)||void 0===n?void 0:n.map((t=>Vt.fromJSON(t)));switch(Object.assign(r,t,{creationDate:s,revisionDate:o,deletedDate:a,attachments:l,fields:u,passwordHistory:c}),t.type){case _.Card:r.card=At.fromJSON(t.card);break;case _.Identity:r.identity=_t.fromJSON(t.identity);break;case _.Login:r.login=Wt.fromJSON(t.login);break;case _.SecureNote:r.secureNote=$t.fromJSON(t.secureNote);break;case _.SshKey:r.sshKey=Yt.fromJSON(t.sshKey)}return r}static fromSdkCipherView(t){var e,i,n,r,s,o,a,l,u,c,d,h;if(null==t)return;const p=new qt;switch(p.id=null!==(e=t.id)&&void 0!==e?e:null,p.organizationId=null!==(i=t.organizationId)&&void 0!==i?i:null,p.folderId=null!==(n=t.folderId)&&void 0!==n?n:null,p.name=t.name,p.notes=null!==(r=t.notes)&&void 0!==r?r:null,p.type=t.type,p.favorite=t.favorite,p.organizationUseTotp=t.organizationUseTotp,p.permissions=U.fromSdkCipherPermissions(t.permissions),p.edit=t.edit,p.viewPassword=t.viewPassword,p.localData=t.localData?{lastUsedDate:t.localData.lastUsedDate?new Date(t.localData.lastUsedDate).getTime():void 0,lastLaunched:t.localData.lastLaunched?new Date(t.localData.lastLaunched).getTime():void 0}:void 0,p.attachments=null!==(o=null===(s=t.attachments)||void 0===s?void 0:s.map((t=>bt.fromSdkAttachmentView(t))))&&void 0!==o?o:null,p.fields=null!==(l=null===(a=t.fields)||void 0===a?void 0:a.map((t=>Et.fromSdkFieldView(t))))&&void 0!==l?l:null,p.passwordHistory=null!==(c=null===(u=t.passwordHistory)||void 0===u?void 0:u.map((t=>Vt.fromSdkPasswordHistoryView(t))))&&void 0!==c?c:null,p.collectionIds=null!==(d=t.collectionIds)&&void 0!==d?d:null,p.revisionDate=null==t.revisionDate?null:new Date(t.revisionDate),p.creationDate=null==t.creationDate?null:new Date(t.creationDate),p.deletedDate=null==t.deletedDate?null:new Date(t.deletedDate),p.reprompt=null!==(h=t.reprompt)&&void 0!==h?h:V,t.type){case _.Card:p.card=At.fromSdkCardView(t.card);break;case _.Identity:p.identity=_t.fromSdkIdentityView(t.identity);break;case _.Login:p.login=Wt.fromSdkLoginView(t.login);break;case _.SecureNote:p.secureNote=$t.fromSdkSecureNoteView(t.secureNote);break;case _.SshKey:p.sshKey=Yt.fromSdkSshKeyView(t.sshKey)}return p}}var Gt=function(t,e,i,n){return new(i||(i=Promise))((function(r,s){function o(t){try{l(n.next(t))}catch(e){s(e)}}function a(t){try{l(n.throw(t))}catch(e){s(e)}}function l(t){var e;t.done?r(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(o,a)}l((n=n.apply(t,e||[])).next())}))};class Zt extends P{constructor(t){super(),null!=t&&(this.size=t.size,this.buildDomainModel(this,t,{id:null,url:null,sizeName:null,fileName:null,key:null},["id","url","sizeName"]))}decrypt(t){return Gt(this,arguments,void 0,(function*(t,e="No Cipher Context",i){const n=yield this.decryptObj(this,new bt(this),["fileName"],t,i,"DomainType: Attachment; "+e);return null!=this.key&&(n.key=yield this.decryptAttachmentKey(t,i)),n}))}decryptAttachmentKey(t,e){return Gt(this,void 0,void 0,(function*(){try{null==e&&(e=yield this.getKeyForDecryption(t));const i=h.getContainerService().getEncryptService();return yield i.unwrapSymmetricKey(this.key,e)}catch(i){}}))}getKeyForDecryption(t){return Gt(this,void 0,void 0,(function*(){const e=h.getContainerService().getKeyService();return null!=t?yield e.getOrgKey(t):yield e.getUserKeyWithLegacySupport()}))}toAttachmentData(){const t=new I;return t.size=this.size,this.buildDataModel(this,t,{id:null,url:null,sizeName:null,fileName:null,key:null},["id","url","sizeName"]),t}static fromJSON(t){if(null==t)return null;const e=A.fromJSON(t.key),i=A.fromJSON(t.fileName);return Object.assign(new Zt,t,{key:e,fileName:i})}toSdkAttachment(){var t,e;return{id:this.id,url:this.url,size:this.size,sizeName:this.sizeName,fileName:null===(t=this.fileName)||void 0===t?void 0:t.toJSON(),key:null===(e=this.key)||void 0===e?void 0:e.toJSON()}}}var Qt=function(t,e,i,n){return new(i||(i=Promise))((function(r,s){function o(t){try{l(n.next(t))}catch(e){s(e)}}function a(t){try{l(n.throw(t))}catch(e){s(e)}}function l(t){var e;t.done?r(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(o,a)}l((n=n.apply(t,e||[])).next())}))};class Xt extends P{constructor(t){super(),null!=t&&this.buildDomainModel(this,t,{cardholderName:null,brand:null,number:null,expMonth:null,expYear:null,code:null},[])}decrypt(t){return Qt(this,arguments,void 0,(function*(t,e="No Cipher Context",i){return this.decryptObj(this,new At,["cardholderName","brand","number","expMonth","expYear","code"],t,i,"DomainType: Card; "+e)}))}toCardData(){const t=new T;return this.buildDataModel(this,t,{cardholderName:null,brand:null,number:null,expMonth:null,expYear:null,code:null}),t}static fromJSON(t){if(null==t)return null;const e=A.fromJSON(t.cardholderName),i=A.fromJSON(t.brand),n=A.fromJSON(t.number),r=A.fromJSON(t.expMonth),s=A.fromJSON(t.expYear),o=A.fromJSON(t.code);return Object.assign(new Xt,t,{cardholderName:e,brand:i,number:n,expMonth:r,expYear:s,code:o})}toSdkCard(){var t,e,i,n,r,s;return{cardholderName:null===(t=this.cardholderName)||void 0===t?void 0:t.toJSON(),brand:null===(e=this.brand)||void 0===e?void 0:e.toJSON(),number:null===(i=this.number)||void 0===i?void 0:i.toJSON(),expMonth:null===(n=this.expMonth)||void 0===n?void 0:n.toJSON(),expYear:null===(r=this.expYear)||void 0===r?void 0:r.toJSON(),code:null===(s=this.code)||void 0===s?void 0:s.toJSON()}}}class te extends P{constructor(t){super(),null!=t&&(this.type=t.type,this.linkedId=t.linkedId,this.buildDomainModel(this,t,{name:null,value:null},[]))}decrypt(t,e){return this.decryptObj(this,new Et(this),["name","value"],t,e)}toFieldData(){const t=new F;return this.buildDataModel(this,t,{name:null,value:null,type:null,linkedId:null},["type","linkedId"]),t}static fromJSON(t){if(null==t)return null;const e=A.fromJSON(t.name),i=A.fromJSON(t.value);return Object.assign(new te,t,{name:e,value:i})}toSdkField(){var t,e;return{name:null===(t=this.name)||void 0===t?void 0:t.toJSON(),value:null===(e=this.value)||void 0===e?void 0:e.toJSON(),type:this.type,linkedId:this.linkedId}}}class ee extends P{constructor(t){super(),null!=t&&this.buildDomainModel(this,t,{title:null,firstName:null,middleName:null,lastName:null,address1:null,address2:null,address3:null,city:null,state:null,postalCode:null,country:null,company:null,email:null,phone:null,ssn:null,username:null,passportNumber:null,licenseNumber:null},[])}decrypt(t,e="No Cipher Context",i){return this.decryptObj(this,new _t,["title","firstName","middleName","lastName","address1","address2","address3","city","state","postalCode","country","company","email","phone","ssn","username","passportNumber","licenseNumber"],t,i,"DomainType: Identity; "+e)}toIdentityData(){const t=new J;return this.buildDataModel(this,t,{title:null,firstName:null,middleName:null,lastName:null,address1:null,address2:null,address3:null,city:null,state:null,postalCode:null,country:null,company:null,email:null,phone:null,ssn:null,username:null,passportNumber:null,licenseNumber:null}),t}static fromJSON(t){if(null==t)return null;const e=A.fromJSON(t.title),i=A.fromJSON(t.firstName),n=A.fromJSON(t.middleName),r=A.fromJSON(t.lastName),s=A.fromJSON(t.address1),o=A.fromJSON(t.address2),a=A.fromJSON(t.address3),l=A.fromJSON(t.city),u=A.fromJSON(t.state),c=A.fromJSON(t.postalCode),d=A.fromJSON(t.country),h=A.fromJSON(t.company),p=A.fromJSON(t.email),y=A.fromJSON(t.phone),m=A.fromJSON(t.ssn),f=A.fromJSON(t.username),v=A.fromJSON(t.passportNumber),g=A.fromJSON(t.licenseNumber);return Object.assign(new ee,t,{title:e,firstName:i,middleName:n,lastName:r,address1:s,address2:o,address3:a,city:l,state:u,postalCode:c,country:d,company:h,email:p,phone:y,ssn:m,username:f,passportNumber:v,licenseNumber:g})}toSdkIdentity(){var t,e,i,n,r,s,o,a,l,u,c,d,h,p,y,m,f,v;return{title:null===(t=this.title)||void 0===t?void 0:t.toJSON(),firstName:null===(e=this.firstName)||void 0===e?void 0:e.toJSON(),middleName:null===(i=this.middleName)||void 0===i?void 0:i.toJSON(),lastName:null===(n=this.lastName)||void 0===n?void 0:n.toJSON(),address1:null===(r=this.address1)||void 0===r?void 0:r.toJSON(),address2:null===(s=this.address2)||void 0===s?void 0:s.toJSON(),address3:null===(o=this.address3)||void 0===o?void 0:o.toJSON(),city:null===(a=this.city)||void 0===a?void 0:a.toJSON(),state:null===(l=this.state)||void 0===l?void 0:l.toJSON(),postalCode:null===(u=this.postalCode)||void 0===u?void 0:u.toJSON(),country:null===(c=this.country)||void 0===c?void 0:c.toJSON(),company:null===(d=this.company)||void 0===d?void 0:d.toJSON(),email:null===(h=this.email)||void 0===h?void 0:h.toJSON(),phone:null===(p=this.phone)||void 0===p?void 0:p.toJSON(),ssn:null===(y=this.ssn)||void 0===y?void 0:y.toJSON(),username:null===(m=this.username)||void 0===m?void 0:m.toJSON(),passportNumber:null===(f=this.passportNumber)||void 0===f?void 0:f.toJSON(),licenseNumber:null===(v=this.licenseNumber)||void 0===v?void 0:v.toJSON()}}}var ie=function(t,e,i,n){return new(i||(i=Promise))((function(r,s){function o(t){try{l(n.next(t))}catch(e){s(e)}}function a(t){try{l(n.throw(t))}catch(e){s(e)}}function l(t){var e;t.done?r(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(o,a)}l((n=n.apply(t,e||[])).next())}))};class ne extends P{constructor(t){super(),this.credentialId=null,null!=t&&(this.buildDomainModel(this,t,{credentialId:null,keyType:null,keyAlgorithm:null,keyCurve:null,keyValue:null,rpId:null,userHandle:null,userName:null,counter:null,rpName:null,userDisplayName:null,discoverable:null},[]),this.creationDate=null!=t.creationDate?new Date(t.creationDate):null)}decrypt(t,e){return ie(this,void 0,void 0,(function*(){const i=yield this.decryptObj(this,new Kt,["credentialId","keyType","keyAlgorithm","keyCurve","keyValue","rpId","userHandle","userName","rpName","userDisplayName"],t,e),{counter:n}=yield this.decryptObj(this,{counter:""},["counter"],t,e);i.counter=parseInt(n);const{discoverable:r}=yield this.decryptObj(this,{discoverable:""},["discoverable"],t,e);return i.discoverable="true"===r,i.creationDate=this.creationDate,i}))}toFido2CredentialData(){const t=new R;return t.creationDate=this.creationDate.toISOString(),this.buildDataModel(this,t,{credentialId:null,keyType:null,keyAlgorithm:null,keyCurve:null,keyValue:null,rpId:null,userHandle:null,userName:null,counter:null,rpName:null,userDisplayName:null,discoverable:null}),t}static fromJSON(t){if(null==t)return null;const e=A.fromJSON(t.credentialId),i=A.fromJSON(t.keyType),n=A.fromJSON(t.keyAlgorithm),r=A.fromJSON(t.keyCurve),s=A.fromJSON(t.keyValue),o=A.fromJSON(t.rpId),a=A.fromJSON(t.userHandle),l=A.fromJSON(t.userName),u=A.fromJSON(t.counter),c=A.fromJSON(t.rpName),d=A.fromJSON(t.userDisplayName),h=A.fromJSON(t.discoverable),p=null!=t.creationDate?new Date(t.creationDate):null;return Object.assign(new ne,t,{credentialId:e,keyType:i,keyAlgorithm:n,keyCurve:r,keyValue:s,rpId:o,userHandle:a,userName:l,counter:u,rpName:c,userDisplayName:d,discoverable:h,creationDate:p})}toSdkFido2Credential(){var t,e,i,n,r,s;return{credentialId:null===(t=this.credentialId)||void 0===t?void 0:t.toJSON(),keyType:this.keyType.toJSON(),keyAlgorithm:this.keyAlgorithm.toJSON(),keyCurve:this.keyCurve.toJSON(),keyValue:this.keyValue.toJSON(),rpId:this.rpId.toJSON(),userHandle:null===(e=this.userHandle)||void 0===e?void 0:e.toJSON(),userName:null===(i=this.userName)||void 0===i?void 0:i.toJSON(),counter:this.counter.toJSON(),rpName:null===(n=this.rpName)||void 0===n?void 0:n.toJSON(),userDisplayName:null===(r=this.userDisplayName)||void 0===r?void 0:r.toJSON(),discoverable:null===(s=this.discoverable)||void 0===s?void 0:s.toJSON(),creationDate:this.creationDate.toISOString()}}}var re=function(t,e,i,n){return new(i||(i=Promise))((function(r,s){function o(t){try{l(n.next(t))}catch(e){s(e)}}function a(t){try{l(n.throw(t))}catch(e){s(e)}}function l(t){var e;t.done?r(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(o,a)}l((n=n.apply(t,e||[])).next())}))};class se extends P{constructor(t){super(),null!=t&&(this.match=t.match,this.buildDomainModel(this,t,{uri:null,uriChecksum:null},[]))}decrypt(t,e="No Cipher Context",i){return this.decryptObj(this,new zt(this),["uri"],t,i,e)}validateChecksum(t,e,i){return re(this,void 0,void 0,(function*(){if(null==this.uriChecksum)return!1;const n=h.getContainerService().getEncryptService(),r=yield n.hash(t,"sha256");return(yield this.uriChecksum.decrypt(e,i))===r}))}toLoginUriData(){const t=new M;return this.buildDataModel(this,t,{uri:null,uriChecksum:null,match:null},["match"]),t}static fromJSON(t){if(null==t)return null;const e=A.fromJSON(t.uri),i=A.fromJSON(t.uriChecksum);return Object.assign(new se,t,{uri:e,uriChecksum:i})}toSdkLoginUri(){var t,e;return{uri:null===(t=this.uri)||void 0===t?void 0:t.toJSON(),uriChecksum:null===(e=this.uriChecksum)||void 0===e?void 0:e.toJSON(),match:this.match}}}var oe=function(t,e,i,n){return new(i||(i=Promise))((function(r,s){function o(t){try{l(n.next(t))}catch(e){s(e)}}function a(t){try{l(n.throw(t))}catch(e){s(e)}}function l(t){var e;t.done?r(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(o,a)}l((n=n.apply(t,e||[])).next())}))};class ae extends P{constructor(t){super(),null!=t&&(this.passwordRevisionDate=null!=t.passwordRevisionDate?new Date(t.passwordRevisionDate):null,this.autofillOnPageLoad=t.autofillOnPageLoad,this.buildDomainModel(this,t,{username:null,password:null,totp:null},[]),t.uris&&(this.uris=[],t.uris.forEach((t=>{this.uris.push(new se(t))}))),t.fido2Credentials&&(this.fido2Credentials=t.fido2Credentials.map((t=>new ne(t)))))}decrypt(t,e){return oe(this,arguments,void 0,(function*(t,e,i="No Cipher Context",n){const r=yield this.decryptObj(this,new Wt(this),["username","password","totp"],t,n,`DomainType: Login; ${i}`);if(null!=this.uris){r.uris=[];for(let s=0;s<this.uris.length;s++){if(null==this.uris[s].uri)continue;const o=yield this.uris[s].decrypt(t,i,n);(e||(yield this.uris[s].validateChecksum(o.uri,t,n)))&&r.uris.push(o)}}return null!=this.fido2Credentials&&(r.fido2Credentials=yield Promise.all(this.fido2Credentials.map((e=>e.decrypt(t,n))))),r}))}toLoginData(){const t=new L;return t.passwordRevisionDate=null!=this.passwordRevisionDate?this.passwordRevisionDate.toISOString():null,t.autofillOnPageLoad=this.autofillOnPageLoad,this.buildDataModel(this,t,{username:null,password:null,totp:null}),null!=this.uris&&this.uris.length>0&&(t.uris=[],this.uris.forEach((e=>{t.uris.push(e.toLoginUriData())}))),null!=this.fido2Credentials&&this.fido2Credentials.length>0&&(t.fido2Credentials=this.fido2Credentials.map((t=>t.toFido2CredentialData()))),t}static fromJSON(t){var e,i,n;if(null==t)return null;const r=A.fromJSON(t.username),s=A.fromJSON(t.password),o=A.fromJSON(t.totp),a=null==t.passwordRevisionDate?null:new Date(t.passwordRevisionDate),l=null===(e=t.uris)||void 0===e?void 0:e.map((t=>se.fromJSON(t))),u=null!==(n=null===(i=t.fido2Credentials)||void 0===i?void 0:i.map((t=>ne.fromJSON(t))))&&void 0!==n?n:[];return Object.assign(new ae,t,{username:r,password:s,totp:o,passwordRevisionDate:a,uris:l,fido2Credentials:u})}toSdkLogin(){var t,e,i,n,r,s,o;return{uris:null===(t=this.uris)||void 0===t?void 0:t.map((t=>t.toSdkLoginUri())),username:null===(e=this.username)||void 0===e?void 0:e.toJSON(),password:null===(i=this.password)||void 0===i?void 0:i.toJSON(),passwordRevisionDate:null===(n=this.passwordRevisionDate)||void 0===n?void 0:n.toISOString(),totp:null===(r=this.totp)||void 0===r?void 0:r.toJSON(),autofillOnPageLoad:null!==(s=this.autofillOnPageLoad)&&void 0!==s?s:void 0,fido2Credentials:null===(o=this.fido2Credentials)||void 0===o?void 0:o.map((t=>t.toSdkFido2Credential()))}}}class le extends P{constructor(t){super(),null!=t&&(this.buildDomainModel(this,t,{password:null}),this.lastUsedDate=new Date(t.lastUsedDate))}decrypt(t,e){return this.decryptObj(this,new Vt(this),["password"],t,e,"DomainType: PasswordHistory")}toPasswordHistoryData(){const t=new z;return t.lastUsedDate=this.lastUsedDate.toISOString(),this.buildDataModel(this,t,{password:null}),t}static fromJSON(t){if(null==t)return null;const e=A.fromJSON(t.password),i=null==t.lastUsedDate?null:new Date(t.lastUsedDate);return Object.assign(new le,t,{password:e,lastUsedDate:i})}toSdkPasswordHistory(){return{password:this.password.toJSON(),lastUsedDate:this.lastUsedDate.toISOString()}}}var ue=function(t,e,i,n){return new(i||(i=Promise))((function(r,s){function o(t){try{l(n.next(t))}catch(e){s(e)}}function a(t){try{l(n.throw(t))}catch(e){s(e)}}function l(t){var e;t.done?r(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(o,a)}l((n=n.apply(t,e||[])).next())}))};class ce extends P{constructor(t){super(),null!=t&&(this.type=t.type)}decrypt(t){return ue(this,arguments,void 0,(function*(t,e="No Cipher Context",i){return new $t(this)}))}toSecureNoteData(){const t=new j;return t.type=this.type,t}static fromJSON(t){return null==t?null:Object.assign(new ce,t)}toSdkSecureNote(){return{type:this.type}}}class de extends P{constructor(t){super(),null!=t&&this.buildDomainModel(this,t,{privateKey:null,publicKey:null,keyFingerprint:null},[])}decrypt(t,e="No Cipher Context",i){return this.decryptObj(this,new Yt,["privateKey","publicKey","keyFingerprint"],t,i,"DomainType: SshKey; "+e)}toSshKeyData(){const t=new H;return this.buildDataModel(this,t,{privateKey:null,publicKey:null,keyFingerprint:null}),t}static fromJSON(t){if(null==t)return null;const e=A.fromJSON(t.privateKey),i=A.fromJSON(t.publicKey),n=A.fromJSON(t.keyFingerprint);return Object.assign(new de,t,{privateKey:e,publicKey:i,keyFingerprint:n})}toSdkSshKey(){return{privateKey:this.privateKey.toJSON(),publicKey:this.publicKey.toJSON(),fingerprint:this.keyFingerprint.toJSON()}}}var he=function(t,e,i,n){return new(i||(i=Promise))((function(r,s){function o(t){try{l(n.next(t))}catch(e){s(e)}}function a(t){try{l(n.throw(t))}catch(e){s(e)}}function l(t){var e;t.done?r(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(o,a)}l((n=n.apply(t,e||[])).next())}))};class pe extends P{constructor(t,e=null){if(super(),this.initializerKey=E.Cipher,null!=t){switch(this.buildDomainModel(this,t,{id:null,organizationId:null,folderId:null,name:null,notes:null,key:null},["id","organizationId","folderId"]),this.type=t.type,this.favorite=t.favorite,this.organizationUseTotp=t.organizationUseTotp,this.edit=t.edit,null!=t.viewPassword?this.viewPassword=t.viewPassword:this.viewPassword=!0,this.permissions=t.permissions,this.revisionDate=null!=t.revisionDate?new Date(t.revisionDate):null,this.collectionIds=t.collectionIds,this.localData=e,this.creationDate=null!=t.creationDate?new Date(t.creationDate):null,this.deletedDate=null!=t.deletedDate?new Date(t.deletedDate):null,this.reprompt=t.reprompt,this.type){case _.Login:this.login=new ae(t.login);break;case _.SecureNote:this.secureNote=new ce(t.secureNote);break;case _.Card:this.card=new Xt(t.card);break;case _.Identity:this.identity=new ee(t.identity);break;case _.SshKey:this.sshKey=new de(t.sshKey)}null!=t.attachments?this.attachments=t.attachments.map((t=>new Zt(t))):this.attachments=null,null!=t.fields?this.fields=t.fields.map((t=>new te(t))):this.fields=null,null!=t.passwordHistory?this.passwordHistory=t.passwordHistory.map((t=>new le(t))):this.passwordHistory=null}}decrypt(t){return he(this,void 0,void 0,(function*(){const e=new qt(this);let i=!0;if(null!=this.key){const r=h.getContainerService().getEncryptService();try{const e=yield r.unwrapSymmetricKey(this.key,t);t=e,i=!1}catch(n){return e.name="[error: cannot decrypt]",e.decryptionFailure=!0,e}}switch(yield this.decryptObj(this,e,["name","notes"],this.organizationId,t),this.type){case _.Login:e.login=yield this.login.decrypt(this.organizationId,i,`Cipher Id: ${this.id}`,t);break;case _.SecureNote:e.secureNote=yield this.secureNote.decrypt(this.organizationId,`Cipher Id: ${this.id}`,t);break;case _.Card:e.card=yield this.card.decrypt(this.organizationId,`Cipher Id: ${this.id}`,t);break;case _.Identity:e.identity=yield this.identity.decrypt(this.organizationId,`Cipher Id: ${this.id}`,t);break;case _.SshKey:e.sshKey=yield this.sshKey.decrypt(this.organizationId,`Cipher Id: ${this.id}`,t)}if(null!=this.attachments&&this.attachments.length>0){const i=[];for(const e of this.attachments)i.push(yield e.decrypt(this.organizationId,`Cipher Id: ${this.id}`,t));e.attachments=i}if(null!=this.fields&&this.fields.length>0){const i=[];for(const e of this.fields)i.push(yield e.decrypt(this.organizationId,t));e.fields=i}if(null!=this.passwordHistory&&this.passwordHistory.length>0){const i=[];for(const e of this.passwordHistory)i.push(yield e.decrypt(this.organizationId,t));e.passwordHistory=i}return e}))}toCipherData(){var t;const e=new W;switch(e.id=this.id,e.organizationId=this.organizationId,e.folderId=this.folderId,e.edit=this.edit,e.viewPassword=this.viewPassword,e.organizationUseTotp=this.organizationUseTotp,e.favorite=this.favorite,e.revisionDate=null!=this.revisionDate?this.revisionDate.toISOString():null,e.type=this.type,e.collectionIds=this.collectionIds,e.creationDate=null!=this.creationDate?this.creationDate.toISOString():null,e.deletedDate=null!=this.deletedDate?this.deletedDate.toISOString():null,e.reprompt=this.reprompt,e.key=null===(t=this.key)||void 0===t?void 0:t.encryptedString,e.permissions=this.permissions,this.buildDataModel(this,e,{name:null,notes:null}),e.type){case _.Login:e.login=this.login.toLoginData();break;case _.SecureNote:e.secureNote=this.secureNote.toSecureNoteData();break;case _.Card:e.card=this.card.toCardData();break;case _.Identity:e.identity=this.identity.toIdentityData();break;case _.SshKey:e.sshKey=this.sshKey.toSshKeyData()}return null!=this.fields&&(e.fields=this.fields.map((t=>t.toFieldData()))),null!=this.attachments&&(e.attachments=this.attachments.map((t=>t.toAttachmentData()))),null!=this.passwordHistory&&(e.passwordHistory=this.passwordHistory.map((t=>t.toPasswordHistoryData()))),e}static fromJSON(t){var e,i,n;if(null==t)return null;const r=new pe,s=A.fromJSON(t.name),o=A.fromJSON(t.notes),a=null==t.creationDate?null:new Date(t.creationDate),l=null==t.revisionDate?null:new Date(t.revisionDate),u=null==t.deletedDate?null:new Date(t.deletedDate),c=null===(e=t.attachments)||void 0===e?void 0:e.map((t=>Zt.fromJSON(t))),d=null===(i=t.fields)||void 0===i?void 0:i.map((t=>te.fromJSON(t))),h=null===(n=t.passwordHistory)||void 0===n?void 0:n.map((t=>le.fromJSON(t))),p=A.fromJSON(t.key);switch(Object.assign(r,t,{name:s,notes:o,creationDate:a,revisionDate:l,deletedDate:u,attachments:c,fields:d,passwordHistory:h,key:p}),t.type){case _.Card:r.card=Xt.fromJSON(t.card);break;case _.Identity:r.identity=ee.fromJSON(t.identity);break;case _.Login:r.login=ae.fromJSON(t.login);break;case _.SecureNote:r.secureNote=ce.fromJSON(t.secureNote);break;case _.SshKey:r.sshKey=de.fromJSON(t.sshKey)}return r}toSdkCipher(){var t,e,i,n,r,s,o,a,l,u,c,d,h;const p={id:this.id,organizationId:null!==(t=this.organizationId)&&void 0!==t?t:void 0,folderId:null!==(e=this.folderId)&&void 0!==e?e:void 0,collectionIds:null!==(i=this.collectionIds)&&void 0!==i?i:[],key:null===(n=this.key)||void 0===n?void 0:n.toJSON(),name:this.name.toJSON(),notes:null===(r=this.notes)||void 0===r?void 0:r.toJSON(),type:this.type,favorite:null!==(s=this.favorite)&&void 0!==s&&s,organizationUseTotp:null!==(o=this.organizationUseTotp)&&void 0!==o&&o,edit:this.edit,permissions:this.permissions?{delete:this.permissions.delete,restore:this.permissions.restore}:void 0,viewPassword:this.viewPassword,localData:this.localData?{lastUsedDate:this.localData.lastUsedDate?new Date(this.localData.lastUsedDate).toISOString():void 0,lastLaunched:this.localData.lastLaunched?new Date(this.localData.lastLaunched).toISOString():void 0}:void 0,attachments:null===(a=this.attachments)||void 0===a?void 0:a.map((t=>t.toSdkAttachment())),fields:null===(l=this.fields)||void 0===l?void 0:l.map((t=>t.toSdkField())),passwordHistory:null===(u=this.passwordHistory)||void 0===u?void 0:u.map((t=>t.toSdkPasswordHistory())),revisionDate:null===(c=this.revisionDate)||void 0===c?void 0:c.toISOString(),creationDate:null===(d=this.creationDate)||void 0===d?void 0:d.toISOString(),deletedDate:null===(h=this.deletedDate)||void 0===h?void 0:h.toISOString(),reprompt:this.reprompt,login:void 0,identity:void 0,card:void 0,secureNote:void 0,sshKey:void 0};switch(this.type){case _.Login:p.login=this.login.toSdkLogin();break;case _.SecureNote:p.secureNote=this.secureNote.toSdkSecureNote();break;case _.Card:p.card=this.card.toSdkCard();break;case _.Identity:p.identity=this.identity.toSdkIdentity();break;case _.SshKey:p.sshKey=this.sshKey.toSdkSshKey()}return p}}const ye={[E.Cipher]:pe.fromJSON,[E.CipherView]:qt.fromJSON};const me="decrypt",fe="updateConfig";var ve=function(t,e,i,n){return new(i||(i=Promise))((function(r,s){function o(t){try{l(n.next(t))}catch(e){s(e)}}function a(t){try{l(n.throw(t))}catch(e){s(e)}}function l(t){var e;t.done?r(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(o,a)}l((n=n.apply(t,e||[])).next())}))};const ge=16;class we{constructor(t){this.buffer=t,this.encryptionType=null,this.dataBytes=null,this.ivBytes=null,this.macBytes=null;const e=t,i=e[0];switch(i){case p.AesCbc256_HmacSha256_B64:{const t=50;e.length<t&&this.throwDecryptionError(),this.ivBytes=e.slice(1,17),this.macBytes=e.slice(17,49),this.dataBytes=e.slice(49);break}case p.AesCbc256_B64:{const t=18;e.length<t&&this.throwDecryptionError(),this.ivBytes=e.slice(1,17),this.dataBytes=e.slice(17);break}default:this.throwDecryptionError()}this.encryptionType=i}throwDecryptionError(){throw new Error("Error parsing encrypted ArrayBuffer: data is corrupted or has an invalid format.")}static fromParts(t,e,i,n){if(null==t||null==e||null==i)throw new Error("encryptionType, iv, and data must be provided");switch(t){case p.AesCbc256_B64:case p.AesCbc256_HmacSha256_B64:we.validateIvLength(e),we.validateMacLength(t,n);break;default:throw new Error(`Unknown EncryptionType ${t} for EncArrayBuffer.fromParts`)}let r=0;null!=n&&(r=n.length);const s=new Uint8Array(1+e.byteLength+r+i.byteLength);return s.set([t],0),s.set(e,1),null!=n&&s.set(n,1+e.byteLength),s.set(i,1+e.byteLength+r),new we(s)}static fromResponse(t){return ve(this,void 0,void 0,(function*(){const e=yield t.arrayBuffer();if(null==e)throw new Error("Cannot create EncArrayBuffer from Response - Response is empty");return new we(new Uint8Array(e))}))}static fromB64(t){const e=h.fromB64ToArray(t);return new we(e)}static validateIvLength(t){if(null==t||t.length!==ge)throw new Error("Invalid IV length")}static validateMacLength(t,e){switch(t){case p.AesCbc256_B64:if(null!=e)throw new Error("mac must not be provided for AesCbc256_B64");break;case p.AesCbc256_HmacSha256_B64:if(null==e||32!==e.length)throw new Error("Invalid MAC length");break;default:throw new Error("Invalid encryption type and mac combination")}}}class be{}var Se,De=i(82781);!function(t){t.SeparateCustomRolePermissions="pm-19917-separate-custom-role-permissions",t.CreateDefaultLocation="pm-19467-create-default-location",t.PM16117_SetInitialPasswordRefactor="pm-16117-set-initial-password-refactor",t.PM16117_ChangeExistingPasswordRefactor="pm-16117-change-existing-password-refactor",t.PM9115_TwoFactorExtensionDataPersistence="pm-9115-two-factor-extension-data-persistence",t.PM14938_BrowserExtensionLoginApproval="pm-14938-browser-extension-login-approvals",t.BlockBrowserInjectionsByDomain="block-browser-injections-by-domain",t.EnableNewCardCombinedExpiryAutofill="enable-new-card-combined-expiry-autofill",t.NotificationRefresh="notification-refresh",t.UseTreeWalkerApiForPageDetailsCollection="use-tree-walker-api-for-page-details-collection",t.MacOsNativeCredentialSync="macos-native-credential-sync",t.TrialPaymentOptional="PM-8163-trial-payment",t.PM12276_BreadcrumbEventLogs="pm-12276-breadcrumbing-for-business-features",t.PM17772_AdminInitiatedSponsorships="pm-17772-admin-initiated-sponsorships",t.PM19956_RequireProviderPaymentMethodDuringSetup="pm-19956-require-provider-payment-method-during-setup",t.UseOrganizationWarningsService="use-organization-warnings-service",t.AllowTrialLengthZero="pm-20322-allow-trial-length-0",t.EnableRiskInsightsNotifications="enable-risk-insights-notifications",t.PrivateKeyRegeneration="pm-12241-private-key-regeneration",t.PM4154_BulkEncryptionService="PM-4154-bulk-encryption-service",t.UseSDKForDecryption="use-sdk-for-decryption",t.PM17987_BlockType0="pm-17987-block-type-0",t.EnrollAeadOnKeyRotation="enroll-aead-on-key-rotation",t.DesktopSendUIRefresh="desktop-send-ui-refresh",t.PM8851_BrowserOnboardingNudge="pm-8851-browser-onboarding-nudge",t.PM9111ExtensionPersistAddEditForm="pm-9111-extension-persist-add-edit-form",t.PM19941MigrateCipherDomainToSdk="pm-19941-migrate-cipher-domain-to-sdk",t.CipherKeyEncryption="cipher-key-encryption",t.PM18520_UpdateDesktopCipherForm="pm-18520-desktop-cipher-forms",t.EndUserNotifications="pm-10609-end-user-notifications",t.RemoveCardItemTypePolicy="pm-16442-remove-card-item-type-policy",t.IpcChannelFramework="ipc-channel-framework"}(Se||(Se={}));const Ne=!1,ke={[Se.SeparateCustomRolePermissions]:Ne,[Se.CreateDefaultLocation]:Ne,[Se.BlockBrowserInjectionsByDomain]:Ne,[Se.EnableNewCardCombinedExpiryAutofill]:Ne,[Se.NotificationRefresh]:Ne,[Se.UseTreeWalkerApiForPageDetailsCollection]:Ne,[Se.MacOsNativeCredentialSync]:Ne,[Se.EnableRiskInsightsNotifications]:Ne,[Se.DesktopSendUIRefresh]:Ne,[Se.PM8851_BrowserOnboardingNudge]:Ne,[Se.PM9111ExtensionPersistAddEditForm]:Ne,[Se.CipherKeyEncryption]:Ne,[Se.PM18520_UpdateDesktopCipherForm]:Ne,[Se.EndUserNotifications]:Ne,[Se.PM19941MigrateCipherDomainToSdk]:Ne,[Se.RemoveCardItemTypePolicy]:Ne,[Se.PM16117_SetInitialPasswordRefactor]:Ne,[Se.PM16117_ChangeExistingPasswordRefactor]:Ne,[Se.PM9115_TwoFactorExtensionDataPersistence]:Ne,[Se.PM14938_BrowserExtensionLoginApproval]:Ne,[Se.TrialPaymentOptional]:Ne,[Se.PM12276_BreadcrumbEventLogs]:Ne,[Se.PM17772_AdminInitiatedSponsorships]:Ne,[Se.PM19956_RequireProviderPaymentMethodDuringSetup]:Ne,[Se.UseOrganizationWarningsService]:Ne,[Se.AllowTrialLengthZero]:Ne,[Se.PrivateKeyRegeneration]:Ne,[Se.PM4154_BulkEncryptionService]:Ne,[Se.UseSDKForDecryption]:Ne,[Se.PM17987_BlockType0]:Ne,[Se.EnrollAeadOnKeyRotation]:Ne,[Se.IpcChannelFramework]:Ne};function Oe(t,e){return null==(null==t?void 0:t.featureStates)||null==t.featureStates[e]?ke[e]:t.featureStates[e]}var Ce=function(t,e,i,n){return new(i||(i=Promise))((function(r,s){function o(t){try{l(n.next(t))}catch(e){s(e)}}function a(t){try{l(n.throw(t))}catch(e){s(e)}}function l(t){var e;t.done?r(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(o,a)}l((n=n.apply(t,e||[])).next())}))};class Be extends Error{constructor(t){super(`SDK loading failed: ${t}`)}}class Ae{loadAndInit(){return Ce(this,void 0,void 0,(function*(){try{yield this.load(),(0,De.init_sdk)(),Ae.markAsReady()}catch(t){Ae.markAsFailed(t)}}))}}Ae.Ready=new Promise(((t,e)=>{Ae.markAsReady=t,Ae.markAsFailed=t=>e(new Be(t))}));var Ee=function(t,e,i,n){return new(i||(i=Promise))((function(r,s){function o(t){try{l(n.next(t))}catch(e){s(e)}}function a(t){try{l(n.throw(t))}catch(e){s(e)}}function l(t){var e;t.done?r(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(o,a)}l((n=n.apply(t,e||[])).next())}))};class xe{constructor(t,e,i){this.cryptoFunctionService=t,this.logService=e,this.logMacFailures=i,this.useSDKForDecryption=ke[Se.UseSDKForDecryption],this.blockType0=ke[Se.PM17987_BlockType0]}encryptString(t,e){return Ee(this,void 0,void 0,(function*(){return this.encrypt(t,e)}))}encryptBytes(t,e){return Ee(this,void 0,void 0,(function*(){return this.encrypt(t,e)}))}encryptFileData(t,e){return Ee(this,void 0,void 0,(function*(){return this.encryptToBytes(t,e)}))}decryptString(t,e){return Ee(this,void 0,void 0,(function*(){return this.decryptToUtf8(t,e)}))}decryptBytes(t,e){return Ee(this,void 0,void 0,(function*(){return this.decryptToBytes(t,e)}))}decryptFileData(t,e){return Ee(this,void 0,void 0,(function*(){return this.decryptToBytes(t,e)}))}wrapDecapsulationKey(t,e){return Ee(this,void 0,void 0,(function*(){if(null==t)throw new Error("No decapsulation key provided for wrapping.");if(null==e)throw new Error("No wrappingKey provided for wrapping.");return yield this.encryptUint8Array(t,e)}))}wrapEncapsulationKey(t,e){return Ee(this,void 0,void 0,(function*(){if(null==t)throw new Error("No encapsulation key provided for wrapping.");if(null==e)throw new Error("No wrappingKey provided for wrapping.");return yield this.encryptUint8Array(t,e)}))}wrapSymmetricKey(t,e){return Ee(this,void 0,void 0,(function*(){if(null==t)throw new Error("No keyToBeWrapped provided for wrapping.");if(null==e)throw new Error("No wrappingKey provided for wrapping.");return yield this.encryptUint8Array(t.toEncoded(),e)}))}unwrapDecapsulationKey(t,e){return Ee(this,void 0,void 0,(function*(){return this.decryptBytes(t,e)}))}unwrapEncapsulationKey(t,e){return Ee(this,void 0,void 0,(function*(){return this.decryptBytes(t,e)}))}unwrapSymmetricKey(t,e){return Ee(this,void 0,void 0,(function*(){return new N(yield this.decryptBytes(t,e))}))}hash(t,e){return Ee(this,void 0,void 0,(function*(){const i=yield this.cryptoFunctionService.hash(t,e);return h.fromBufferToB64(i)}))}onServerConfigChange(t){const e=this.useSDKForDecryption;this.useSDKForDecryption=Oe(t,Se.UseSDKForDecryption),this.logService.debug("[EncryptService] Updated sdk decryption flag",e,this.useSDKForDecryption),this.blockType0=Oe(t,Se.PM17987_BlockType0)}encrypt(t,e){return Ee(this,void 0,void 0,(function*(){if(null==e)throw new Error("No encryption key provided.");if(this.blockType0&&e.inner().type===p.AesCbc256_B64)throw new Error("Type 0 encryption is not supported.");return null==t?Promise.resolve(null):"string"==typeof t?this.encryptUint8Array(h.fromUtf8ToArray(t),e):this.encryptUint8Array(t,e)}))}encryptUint8Array(t,e){return Ee(this,void 0,void 0,(function*(){if(null==e)throw new Error("No encryption key provided.");if(this.blockType0&&e.inner().type===p.AesCbc256_B64)throw new Error("Type 0 encryption is not supported.");if(null==t)return Promise.resolve(null);const i=e.inner();if(i.type===p.AesCbc256_HmacSha256_B64){const e=yield this.aesEncrypt(t,i),n=h.fromBufferToB64(e.iv),r=h.fromBufferToB64(e.data),s=h.fromBufferToB64(e.mac);return new A(i.type,r,n,s)}if(i.type===p.AesCbc256_B64){const e=yield this.aesEncryptLegacy(t,i),n=h.fromBufferToB64(e.iv),r=h.fromBufferToB64(e.data);return new A(i.type,r,n)}}))}encryptToBytes(t,e){return Ee(this,void 0,void 0,(function*(){if(null==e)throw new Error("No encryption key provided.");if(this.blockType0&&e.inner().type===p.AesCbc256_B64)throw new Error("Type 0 encryption is not supported.");const i=e.inner();if(i.type===p.AesCbc256_HmacSha256_B64){const e=yield this.aesEncrypt(t,i),n=e.mac.length,r=new Uint8Array(1+e.iv.byteLength+n+e.data.byteLength);return r.set([i.type]),r.set(new Uint8Array(e.iv),1),r.set(new Uint8Array(e.mac),1+e.iv.byteLength),r.set(new Uint8Array(e.data),1+e.iv.byteLength+n),new we(r)}if(i.type===p.AesCbc256_B64){const e=yield this.aesEncryptLegacy(t,i),n=new Uint8Array(1+e.iv.byteLength+e.data.byteLength);return n.set([i.type]),n.set(new Uint8Array(e.iv),1),n.set(new Uint8Array(e.data),1+e.iv.byteLength),new we(n)}}))}decryptToUtf8(t,e){return Ee(this,arguments,void 0,(function*(t,e,i="no context"){if(this.useSDKForDecryption){if(this.logService.debug("decrypting with SDK"),null==t||null==t.encryptedString)throw new Error("encString is null or undefined");return yield Ae.Ready,De.PureCrypto.symmetric_decrypt(t.encryptedString,e.toEncoded())}if(this.logService.debug("decrypting with javascript"),null==e)throw new Error("No key provided for decryption.");const n=e.inner();if(t.encryptionType!==n.type)return this.logDecryptError("Key encryption type does not match payload encryption type",n.type,t.encryptionType,i),null;if(n.type===p.AesCbc256_HmacSha256_B64){const r=this.cryptoFunctionService.aesDecryptFastParameters(t.data,t.iv,t.mac,e),s=yield this.cryptoFunctionService.hmacFast(r.macData,r.macKey,"sha256");return(yield this.cryptoFunctionService.compareFast(r.mac,s))?yield this.cryptoFunctionService.aesDecryptFast({mode:"cbc",parameters:r}):(this.logMacFailed("decryptToUtf8 MAC comparison failed. Key or payload has changed.",n.type,t.encryptionType,i),null)}if(n.type===p.AesCbc256_B64){const i=this.cryptoFunctionService.aesDecryptFastParameters(t.data,t.iv,void 0,e);return yield this.cryptoFunctionService.aesDecryptFast({mode:"cbc",parameters:i})}throw new Error("Unsupported encryption type")}))}decryptToBytes(t,e){return Ee(this,arguments,void 0,(function*(t,e,i="no context"){if(this.useSDKForDecryption){if(this.logService.debug("[EncryptService] Decrypting bytes with SDK"),null==t.encryptionType||null==t.ivBytes||null==t.dataBytes)throw new Error("Cannot decrypt, missing type, IV, or data bytes.");const i=we.fromParts(t.encryptionType,t.ivBytes,t.dataBytes,t.macBytes).buffer;return yield Ae.Ready,De.PureCrypto.symmetric_decrypt_array_buffer(i,e.toEncoded())}if(this.logService.debug("[EncryptService] Decrypting bytes with javascript"),null==e)throw new Error("No encryption key provided.");if(null==t)throw new Error("Nothing provided for decryption.");const n=e.inner();if(t.encryptionType!==n.type)return this.logDecryptError("Encryption key type mismatch",n.type,t.encryptionType,i),null;if(n.type===p.AesCbc256_HmacSha256_B64){if(null==t.macBytes)return this.logDecryptError("Mac missing",n.type,t.encryptionType,i),null;const e=new Uint8Array(t.ivBytes.byteLength+t.dataBytes.byteLength);e.set(new Uint8Array(t.ivBytes),0),e.set(new Uint8Array(t.dataBytes),t.ivBytes.byteLength);const r=yield this.cryptoFunctionService.hmac(e,n.authenticationKey,"sha256");return(yield this.cryptoFunctionService.compare(t.macBytes,r))?yield this.cryptoFunctionService.aesDecrypt(t.dataBytes,t.ivBytes,n.encryptionKey,"cbc"):(this.logMacFailed("MAC comparison failed. Key or payload has changed.",n.type,t.encryptionType,i),null)}return n.type===p.AesCbc256_B64?yield this.cryptoFunctionService.aesDecrypt(t.dataBytes,t.ivBytes,n.encryptionKey,"cbc"):void 0}))}encapsulateKeyUnsigned(t,e){return Ee(this,void 0,void 0,(function*(){if(null==t)throw new Error("No sharedKey provided for encapsulation");return yield this.rsaEncrypt(t.toEncoded(),e)}))}decapsulateKeyUnsigned(t,e){return Ee(this,void 0,void 0,(function*(){const i=yield this.rsaDecrypt(t,e);return new N(i)}))}decryptItems(t,e){return Ee(this,void 0,void 0,(function*(){if(null==t||t.length<1)return[];const i=[];for(let n=0;n<t.length;n++)i.push(yield t[n].decrypt(e));return i}))}aesEncrypt(t,e){return Ee(this,void 0,void 0,(function*(){const i=new be;i.iv=yield this.cryptoFunctionService.randomBytes(16),i.data=yield this.cryptoFunctionService.aesEncrypt(t,i.iv,e.encryptionKey);const n=new Uint8Array(i.iv.byteLength+i.data.byteLength);return n.set(new Uint8Array(i.iv),0),n.set(new Uint8Array(i.data),i.iv.byteLength),i.mac=yield this.cryptoFunctionService.hmac(n,e.authenticationKey,"sha256"),i}))}aesEncryptLegacy(t,e){return Ee(this,void 0,void 0,(function*(){const i=new be;return i.iv=yield this.cryptoFunctionService.randomBytes(16),i.data=yield this.cryptoFunctionService.aesEncrypt(t,i.iv,e.encryptionKey),i}))}logDecryptError(t,e,i,n){this.logService.error(`[Encrypt service] ${t} Key type ${y(e)} Payload type ${y(i)} Decrypt context: ${n}`)}logMacFailed(t,e,i,n){this.logMacFailures&&this.logDecryptError(t,e,i,n)}rsaEncrypt(t,e){return Ee(this,void 0,void 0,(function*(){if(null==t)throw new Error("No data provided for encryption.");if(null==e)throw new Error("No public key provided for encryption.");const i=yield this.cryptoFunctionService.rsaEncrypt(t,e,"sha1");return new A(p.Rsa2048_OaepSha1_B64,h.fromBufferToB64(i))}))}rsaDecrypt(t,e){return Ee(this,void 0,void 0,(function*(){if(null==t)throw new Error("[Encrypt service] rsaDecrypt: No data provided for decryption.");let i;switch(t.encryptionType){case p.Rsa2048_OaepSha1_B64:case p.Rsa2048_OaepSha1_HmacSha256_B64:i="sha1";break;case p.Rsa2048_OaepSha256_B64:case p.Rsa2048_OaepSha256_HmacSha256_B64:i="sha256";break;default:throw new Error("Invalid encryption type.")}if(null==e)throw new Error("[Encrypt service] rsaDecrypt: No private key provided for decryption.");return this.cryptoFunctionService.rsaDecrypt(t.dataBytes,e,i)}))}}var Pe=i(52744),_e=i(55367),Ke=function(t,e,i,n){return new(i||(i=Promise))((function(r,s){function o(t){try{l(n.next(t))}catch(e){s(e)}}function a(t){try{l(n.throw(t))}catch(e){s(e)}}function l(t){var e;t.done?r(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(o,a)}l((n=n.apply(t,e||[])).next())}))};class Ue{constructor(t){var e;if(null==(null===(e=null==t?void 0:t.crypto)||void 0===e?void 0:e.subtle))throw new Error("Could not instantiate WebCryptoFunctionService. Could not locate Subtle crypto.");this.crypto=t.crypto,this.subtle=this.crypto.subtle,this.wasmSupported=this.checkIfWasmSupported()}pbkdf2(t,e,i,n){return Ke(this,void 0,void 0,(function*(){const r="sha256"===i?256:512,s=this.toBuf(t),o={name:"PBKDF2",salt:this.toBuf(e),iterations:n,hash:{name:this.toWebCryptoAlgorithm(i)}},a=yield this.subtle.importKey("raw",s,{name:"PBKDF2"},!1,["deriveBits"]),l=yield this.subtle.deriveBits(o,a,r);return new Uint8Array(l)}))}argon2(t,e,i,n,r){return Ke(this,void 0,void 0,(function*(){if(!this.wasmSupported)throw"Webassembly support is required for the Argon2 KDF feature.";const s=new Uint8Array(this.toBuf(t)),o=new Uint8Array(this.toBuf(e)),a=yield Pe.hash({pass:s,salt:o,time:i,mem:n,parallelism:r,hashLen:32,type:Pe.ArgonType.Argon2id});return Pe.unloadRuntime(),a.hash}))}hkdf(t,e,i,n,r){return Ke(this,void 0,void 0,(function*(){const s={name:"HKDF",salt:this.toBuf(e),info:this.toBuf(i),hash:{name:this.toWebCryptoAlgorithm(r)}},o=yield this.subtle.importKey("raw",t,{name:"HKDF"},!1,["deriveBits"]),a=yield this.subtle.deriveBits(s,o,8*n);return new Uint8Array(a)}))}hkdfExpand(t,e,i,n){return Ke(this,void 0,void 0,(function*(){const r="sha256"===n?32:64;if(i>255*r)throw new Error("outputByteSize is too large.");if(new Uint8Array(t).length<r)throw new Error("prk is too small.");const s=this.toBuf(e),o=new Uint8Array(s);let a=0,l=new Uint8Array(0);const u=Math.ceil(i/r),c=new Uint8Array(u*r);for(let e=0;e<u;e++){const r=new Uint8Array(l.length+o.length+1);if(r.set(l),r.set(o,l.length),r.set([e+1],r.length-1),l=new Uint8Array(yield this.hmac(r,t,n)),c.set(l,a),a+=l.length,a>=i)break}return c.slice(0,i)}))}hash(t,e){return Ke(this,void 0,void 0,(function*(){if("md5"===e){const e=_e.md.md5.create(),i=this.toByteString(t);return e.update(i,"raw"),h.fromByteStringToArray(e.digest().data)}const i=this.toBuf(t),n=yield this.subtle.digest({name:this.toWebCryptoAlgorithm(e)},i);return new Uint8Array(n)}))}hmac(t,e,i){return Ke(this,void 0,void 0,(function*(){const n={name:"HMAC",hash:{name:this.toWebCryptoAlgorithm(i)}},r=yield this.subtle.importKey("raw",e,n,!1,["sign"]),s=yield this.subtle.sign(n,r,t);return new Uint8Array(s)}))}compare(t,e){return Ke(this,void 0,void 0,(function*(){const i=yield this.randomBytes(32),n={name:"HMAC",hash:{name:"SHA-256"}},r=yield this.subtle.importKey("raw",i,n,!1,["sign"]),s=yield this.subtle.sign(n,r,t),o=yield this.subtle.sign(n,r,e);if(s.byteLength!==o.byteLength)return!1;const a=new Uint8Array(s),l=new Uint8Array(o);for(let t=0;t<l.length;t++)if(a[t]!==l[t])return!1;return!0}))}hmacFast(t,e,i){const n=_e.hmac.create();n.start(i,e),n.update(t);const r=n.digest().getBytes();return Promise.resolve(r)}compareFast(t,e){return Ke(this,void 0,void 0,(function*(){const i=yield this.randomBytes(32),n=new Uint32Array(i),r=_e.util.createBuffer();for(let t=0;t<n.length;t++)r.putInt32(n[t]);const s=r.getBytes(),o=_e.hmac.create();o.start("sha256",s),o.update(t);const a=o.digest().getBytes();o.start("sha256",null),o.update(e);return a===o.digest().getBytes()}))}aesEncrypt(t,e,i){return Ke(this,void 0,void 0,(function*(){const n=yield this.subtle.importKey("raw",i,{name:"AES-CBC"},!1,["encrypt"]),r=yield this.subtle.encrypt({name:"AES-CBC",iv:e},n,t);return new Uint8Array(r)}))}aesDecryptFastParameters(t,e,i,n){const r=n.inner();if(r.type===p.AesCbc256_B64)return{iv:_e.util.decode64(e),data:_e.util.decode64(t),encKey:_e.util.createBuffer(r.encryptionKey).getBytes()};if(r.type===p.AesCbc256_HmacSha256_B64){const n=_e.util.decode64(e)+_e.util.decode64(t);return{iv:_e.util.decode64(e),data:_e.util.decode64(t),encKey:_e.util.createBuffer(r.encryptionKey).getBytes(),macKey:_e.util.createBuffer(r.authenticationKey).getBytes(),mac:_e.util.decode64(i),macData:n}}throw new Error("Unsupported encryption type.")}aesDecryptFast({mode:t,parameters:e}){const i=_e.cipher.createDecipher(this.toWebCryptoAesMode(t),e.encKey),n={};"cbc"===t&&(n.iv=e.iv);const r=_e.util.createBuffer(e.data);i.start(n),i.update(r),i.finish();const s=i.output.toString();return Promise.resolve(s)}aesDecrypt(t,e,i,n){return Ke(this,void 0,void 0,(function*(){if("ecb"===n){const e={data:this.toByteString(t),encKey:this.toByteString(i)},n=yield this.aesDecryptFast({mode:"ecb",parameters:e});return h.fromByteStringToArray(n)}const r=yield this.subtle.importKey("raw",i,{name:"AES-CBC"},!1,["decrypt"]);if(null==e)throw new Error("IV is required for CBC mode.");const s=yield this.subtle.decrypt({name:"AES-CBC",iv:e},r,t);return new Uint8Array(s)}))}rsaEncrypt(t,e,i){return Ke(this,void 0,void 0,(function*(){const n={name:"RSA-OAEP",hash:{name:this.toWebCryptoAlgorithm(i)}},r=yield this.subtle.importKey("spki",e,n,!1,["encrypt"]),s=yield this.subtle.encrypt(n,r,t);return new Uint8Array(s)}))}rsaDecrypt(t,e,i){return Ke(this,void 0,void 0,(function*(){const n={name:"RSA-OAEP",hash:{name:this.toWebCryptoAlgorithm(i)}},r=yield this.subtle.importKey("pkcs8",e,n,!1,["decrypt"]),s=yield this.subtle.decrypt(n,r,t);return new Uint8Array(s)}))}rsaExtractPublicKey(t){return Ke(this,void 0,void 0,(function*(){const e={name:"RSA-OAEP",hash:{name:this.toWebCryptoAlgorithm("sha1")}},i=yield this.subtle.importKey("pkcs8",t,e,!0,["decrypt"]),n=yield this.subtle.exportKey("jwk",i),r={kty:"RSA",e:n.e,n:n.n,alg:"RSA-OAEP",ext:!0},s=yield this.subtle.importKey("jwk",r,e,!0,["encrypt"]),o=yield this.subtle.exportKey("spki",s);return new Uint8Array(o)}))}aesGenerateKey(){return Ke(this,arguments,void 0,(function*(t=960){if(512===t){const t=yield this.aesGenerateKey(256),e=yield this.aesGenerateKey(256);return new Uint8Array([...t,...e])}const e={name:"AES-CBC",length:t},i=yield this.subtle.generateKey(e,!0,["encrypt","decrypt"]),n=yield this.subtle.exportKey("raw",i);return new Uint8Array(n)}))}rsaGenerateKeyPair(t){return Ke(this,void 0,void 0,(function*(){const e={name:"RSA-OAEP",modulusLength:t,publicExponent:new Uint8Array([1,0,1]),hash:{name:this.toWebCryptoAlgorithm("sha1")}},i=yield this.subtle.generateKey(e,!0,["encrypt","decrypt"]),n=yield this.subtle.exportKey("spki",i.publicKey),r=yield this.subtle.exportKey("pkcs8",i.privateKey);return[new Uint8Array(n),new Uint8Array(r)]}))}randomBytes(t){const e=new Uint8Array(t);return this.crypto.getRandomValues(e),Promise.resolve(e)}toBuf(t){let e;return e="string"==typeof t?h.fromUtf8ToArray(t):t,e}toByteString(t){let e;return e="string"==typeof t?_e.util.encodeUtf8(t):h.fromBufferToByteString(t),e}toWebCryptoAlgorithm(t){if("md5"===t)throw new Error("MD5 is not supported in WebCrypto.");return"sha1"===t?"SHA-1":"sha256"===t?"SHA-256":"SHA-512"}toWebCryptoAesMode(t){return"cbc"===t?"AES-CBC":"AES-ECB"}checkIfWasmSupported(){try{if("object"==typeof WebAssembly&&"function"==typeof WebAssembly.instantiate){const t=new WebAssembly.Module(Uint8Array.of(0,97,115,109,1,0,0,0));if(t instanceof WebAssembly.Module)return new WebAssembly.Instance(t)instanceof WebAssembly.Instance}}catch(t){return!1}return!1}}var Ie=function(t,e,i,n){return new(i||(i=Promise))((function(r,s){function o(t){try{l(n.next(t))}catch(e){s(e)}}function a(t){try{l(n.throw(t))}catch(e){s(e)}}function l(t){var e;t.done?r(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(o,a)}l((n=n.apply(t,e||[])).next())}))};const Te=self;let Fe,Je,Re=!1;Te.addEventListener("message",(t=>Ie(void 0,void 0,void 0,(function*(){Re||function(){const t=new Ue(self);Je=new k(!1),Fe=new xe(t,Je,!0),new O(null,Fe).attachToGlobal(self),Re=!0}();const e=JSON.parse(t.data);switch(e.command){case me:return yield function(t){return Ie(this,void 0,void 0,(function*(){const e=N.fromJSON(t.key),i=t.items.map((t=>{var e;return(e=t.initializerKey,ye[e])(t)})),n=yield Fe.decryptItems(i,e);Te.postMessage({id:t.id,items:JSON.stringify(n)})}))}(e);case fe:{const t=e.newConfig;return yield function(t){return Ie(this,void 0,void 0,(function*(){Fe.onServerConfigChange(r.fromJSON(t))}))}(t)}default:Je.error("[EncryptWorker] unknown worker command",e.command,e)}}))))},86973:()=>{}},n={};function r(t){var e=n[t];if(void 0!==e)return e.exports;var s=n[t]={id:t,loaded:!1,exports:{}};return i[t].call(s.exports,s,s.exports,r),s.loaded=!0,s.exports}r.m=i,r.c=n,r.x=()=>{var t=r.O(void 0,[577],(()=>r(61016)));return t=r.O(t)},t=[],r.O=(e,i,n,s)=>{if(!i){var o=1/0;for(c=0;c<t.length;c++){for(var[i,n,s]=t[c],a=!0,l=0;l<i.length;l++)(!1&s||o>=s)&&Object.keys(r.O).every((t=>r.O[t](i[l])))?i.splice(l--,1):(a=!1,s<o&&(o=s));if(a){t.splice(c--,1);var u=n();void 0!==u&&(e=u)}}return e}s=s||0;for(var c=t.length;c>0&&t[c-1][2]>s;c--)t[c]=t[c-1];t[c]=[i,n,s]},r.d=(t,e)=>{for(var i in e)r.o(e,i)&&!r.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})},r.f={},r.e=t=>Promise.all(Object.keys(r.f).reduce(((e,i)=>(r.f[i](t,e),e)),[])),r.u=t=>t+".304d02554de6bd1ad2c6.js",r.miniCssF=t=>{},r.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),r.hmd=t=>((t=Object.create(t)).children||(t.children=[]),Object.defineProperty(t,"exports",{enumerable:!0,set:()=>{throw new Error("ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: "+t.id)}}),t),r.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},(()=>{var t;r.g.importScripts&&(t=r.g.location+"");var e=r.g.document;if(!t&&e&&(e.currentScript&&"SCRIPT"===e.currentScript.tagName.toUpperCase()&&(t=e.currentScript.src),!t)){var i=e.getElementsByTagName("script");if(i.length)for(var n=i.length-1;n>-1&&(!t||!/^http(s?):/.test(t));)t=i[n--].src}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/^blob:/,"").replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),r.p=t})(),(()=>{var t={357:1};r.f.i=(e,i)=>{t[e]||importScripts(r.p+r.u(e))};var e=self.webpackChunk_bitwarden_web_vault=self.webpackChunk_bitwarden_web_vault||[],i=e.push.bind(e);e.push=e=>{var[n,s,o]=e;for(var a in s)r.o(s,a)&&(r.m[a]=s[a]);for(o&&o(r);n.length;)t[n.pop()]=1;i(e)}})(),e=r.x,r.x=()=>r.e(577).then(e);r.x()})();
//# sourceMappingURL=encrypt-worker.f26ac70601559c4b1b16.js.map