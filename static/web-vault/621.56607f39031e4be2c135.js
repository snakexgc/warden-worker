"use strict";(self.webpackChunk_bitwarden_web_vault=self.webpackChunk_bitwarden_web_vault||[]).push([[621],{5326:(e,i,t)=>{t.d(i,{R:()=>a});var n=t(60893),o=t(62963),r=t(97434),s=t(3867);class a{}a.ɵfac=function(e){return new(e||a)},a.ɵmod=s.$C({type:a}),a.ɵinj=s.G2t({imports:[o.G,r.m,n.t,o.G,r.m,n.t]})},38766:(e,i,t)=>{t.d(i,{Jh:()=>r.Jh,NU:()=>r.NU,Uv:()=>r.Uv,ZC:()=>n.Z,df:()=>r.df,mH:()=>o.m,yo:()=>r.yo});var n=t(43184),o=t(97434),r=t(45980)},76876:(e,i,t)=>{t.d(i,{l:()=>W});var n=t(72245),o=t(44500),r=t(44451),s=t(90171),a=t(97319),l=t(55542),c=t(81525),d=t(77612),u=t(25065),h=t(3867),p=t(12012),g=t(50700),m=t(56962),v=t(51757),f=t(2471),b=t(69855),w=t(64195),I=t(5253),y=t(54471),S=t(3892),C=t(26657),T=t(45154),k=t(56898),$=t(7730),R=t(34355),F=t(86226),M=t(97553),E=t(43759),D=t(38410),G=t(22466),z=t(36572),A=t(88016),U=function(e,i,t,n){return new(t||(t=Promise))((function(o,r){function s(e){try{l(n.next(e))}catch(i){r(i)}}function a(e){try{l(n.throw(e))}catch(i){r(i)}}function l(e){var i;e.done?o(e.value):(i=e.value,i instanceof t?i:new t((function(e){e(i)}))).then(s,a)}l((n=n.apply(e,i||[])).next())}))};function x(e,i){if(1&e&&(h.j41(0,"small",16),h.EFF(1),h.k0s()),2&e){const e=h.XpG();h.R7$(),h.JRh(e.name)}}function j(e,i){1&e&&(h.j41(0,"div"),h.EFF(1),h.nI1(2,"i18n"),h.k0s()),2&e&&(h.R7$(),h.SpI(" ",h.bMT(2,1,"noEventsInList")," "))}function X(e,i){1&e&&(h.j41(0,"th",19),h.EFF(1),h.nI1(2,"i18n"),h.k0s()),2&e&&(h.R7$(),h.JRh(h.bMT(2,1,"member")))}function V(e,i){if(1&e&&(h.j41(0,"td",19)(1,"span",27),h.EFF(2),h.k0s()()),2&e){const e=h.XpG().$implicit;h.R7$(),h.FS9("appA11yTitle",e.userEmail),h.R7$(),h.JRh(e.userName)}}function B(e,i){if(1&e&&(h.j41(0,"tr",24)(1,"td",19),h.EFF(2),h.nI1(3,"date"),h.k0s(),h.j41(4,"td",19),h.nrm(5,"i",25),h.j41(6,"span",20),h.EFF(7),h.k0s()(),h.DNE(8,V,3,2,"td",21),h.nrm(9,"td",26),h.k0s()),2&e){const e=i.$implicit,t=h.XpG(3);h.R7$(2),h.JRh(h.i5U(3,11,e.date,"medium")),h.R7$(3),h.ZvI("tw-text-muted bwi bwi-lg ",e.appIcon,""),h.FCK("title","",e.appName,", ",e.ip,""),h.R7$(2),h.Lme("",e.appName,", ",e.ip,""),h.R7$(),h.Y8G("ngIf",t.showUser),h.R7$(),h.Y8G("innerHTML",e.message,h.npT)}}function N(e,i){if(1&e&&(h.DNE(0,B,10,14,"tr",23),h.nI1(1,"async")),2&e){const e=i.$implicit;h.Y8G("ngForOf",h.bMT(1,1,e))}}function O(e,i){if(1&e&&(h.j41(0,"bit-table",17),h.qex(1,18),h.j41(2,"tr")(3,"th",19),h.EFF(4),h.nI1(5,"i18n"),h.k0s(),h.j41(6,"th",19)(7,"span",20),h.EFF(8),h.nI1(9,"i18n"),h.k0s()(),h.DNE(10,X,3,3,"th",21),h.j41(11,"th",19),h.EFF(12),h.nI1(13,"i18n"),h.k0s()(),h.bVm(),h.DNE(14,N,2,3,"ng-template",22),h.k0s()),2&e){const e=h.XpG();h.Y8G("dataSource",e.dataSource),h.R7$(4),h.JRh(h.bMT(5,5,"timestamp")),h.R7$(4),h.JRh(h.bMT(9,7,"client")),h.R7$(2),h.Y8G("ngIf",e.showUser),h.R7$(2),h.JRh(h.bMT(13,9,"event"))}}function P(e,i){if(1&e&&(h.j41(0,"button",28),h.EFF(1),h.nI1(2,"i18n"),h.k0s()),2&e){const e=h.XpG();h.Y8G("bitAction",e.loadMoreEvents),h.R7$(),h.SpI(" ",h.bMT(2,2,"loadMore")," ")}}class Y{get name(){return this.params.name}get showUser(){var e;return null!==(e=this.params.showUser)&&void 0!==e&&e}constructor(e,i,t,n,o,r,s,a,c,d,u,h){this.params=e,this.apiService=i,this.i18nService=t,this.eventService=n,this.userNamePipe=o,this.logService=r,this.organizationUserApiService=s,this.formBuilder=a,this.validationService=c,this.toastService=d,this.router=u,this.activeRoute=h,this.loading=!0,this.dataSource=new l.s,this.filterFormGroup=this.formBuilder.group({start:[""],end:[""]}),this.orgUsersUserIdMap=new Map,this.orgUsersIdMap=new Map,this.loadMoreEvents=()=>U(this,void 0,void 0,(function*(){yield this.loadEvents(!1)})),this.refreshEvents=()=>U(this,void 0,void 0,(function*(){yield this.loadEvents(!0)}))}ngOnInit(){return U(this,void 0,void 0,(function*(){const e=this.eventService.getDefaultDateFilters();this.filterFormGroup.setValue({start:e[0],end:e[1]}),yield this.load()}))}ngOnDestroy(){return U(this,void 0,void 0,(function*(){yield(0,n._)(this.activeRoute.queryParams.pipe((0,o.n)((e=>U(this,void 0,void 0,(function*(){yield this.router.navigate([],{queryParams:Object.assign(Object.assign({},e),{viewEvents:null})})}))))))}))}load(){return U(this,void 0,void 0,(function*(){try{if(this.showUser){(yield this.organizationUserApiService.getAllMiniUserDetails(this.params.organizationId)).data.forEach((e=>{const i=this.userNamePipe.transform(e);this.orgUsersIdMap.set(e.id,{name:i,email:e.email}),this.orgUsersUserIdMap.set(e.userId,{name:i,email:e.email})}))}yield this.loadEvents(!0)}catch(e){this.logService.error(e),this.validationService.showError(e)}this.loading=!1}))}loadEvents(e){return U(this,void 0,void 0,(function*(){let i,t=null;try{t=this.eventService.formatDateFilters(this.filterFormGroup.value.start,this.filterFormGroup.value.end)}catch(o){return void this.toastService.showToast({variant:"error",title:this.i18nService.t("errorOccurred"),message:this.i18nService.t("invalidDateRange")})}i="user"===this.params.entity&&this.params.providerId?yield this.apiService.getEventsProviderUser(this.params.providerId,this.params.entityId,t[0],t[1],e?null:this.continuationToken):"user"===this.params.entity?yield this.apiService.getEventsOrganizationUser(this.params.organizationId,this.params.entityId,t[0],t[1],e?null:this.continuationToken):yield this.apiService.getEventsCipher(this.params.entityId,t[0],t[1],e?null:this.continuationToken),this.continuationToken=i.continuationToken;const n=yield Promise.all(i.data.map((e=>U(this,void 0,void 0,(function*(){const i=null==e.actingUserId?e.userId:e.actingUserId,t=yield this.eventService.getEventInfo(e),n=this.showUser&&null!=i&&this.orgUsersUserIdMap.has(i)?this.orgUsersUserIdMap.get(i):null;return new a.g({message:t.message,humanReadableMessage:t.humanReadableMessage,appIcon:t.appIcon,appName:t.appName,userId:i,userName:null!=n?n.name:this.showUser?this.i18nService.t("unknown"):null,userEmail:null!=n?n.email:this.showUser?"":null,date:e.date,ip:e.ipAddress,type:e.type,installationId:e.installationId,systemUser:e.systemUser,serviceAccountId:e.serviceAccountId})})))));!e&&null!=this.dataSource.data&&this.dataSource.data.length>0?this.dataSource.data=this.dataSource.data.concat(n):this.dataSource.data=n}))}}Y.ɵfac=function(e){return new(e||Y)(h.rXU(c.Qs),h.rXU(p.G),h.rXU(g.W),h.rXU(d.US),h.rXU(s.b),h.rXU(m.K),h.rXU(r.uB),h.rXU(v.ok),h.rXU(f.B),h.rXU(b.f),h.rXU(w.Ix),h.rXU(w.nX))},Y.ɵcmp=h.VBU({type:Y,selectors:[["ng-component"]],decls:34,vars:28,consts:[["dialogSize","large",3,"loading"],["bitDialogTitle",""],["class","tw-text-muted",4,"ngIf"],["bitDialogContent",""],[3,"formGroup","bitSubmit"],[1,"tw-flex","tw-items-center","tw-space-x-2"],["bitInput","","type","datetime-local","id","start","formControlName","start",3,"placeholder"],[1,"tw-mx-2"],["bitInput","","type","datetime-local","id","end","formControlName","end",3,"placeholder"],["type","submit","bitButton","","buttonType","primary","bitFormButton",""],["aria-hidden","true",1,"bwi","bwi-refresh","bwi-fw"],[4,"ngIf"],[3,"dataSource",4,"ngIf"],["bitButton","","buttonType","secondary","block","","type","button",3,"bitAction",4,"ngIf"],["bitDialogFooter",""],["bitButton","","buttonType","secondary","type","button","bitDialogClose",""],[1,"tw-text-muted"],[3,"dataSource"],["header",""],["bitCell",""],[1,"tw-sr-only"],["bitCell","",4,"ngIf"],["body",""],["bitRow","",4,"ngFor","ngForOf"],["bitRow",""],["aria-hidden","true",3,"title"],["bitCell","",3,"innerHTML"],[3,"appA11yTitle"],["bitButton","","buttonType","secondary","block","","type","button",3,"bitAction"]],template:function(e,i){1&e&&(h.j41(0,"bit-dialog",0)(1,"span",1),h.EFF(2),h.nI1(3,"i18n"),h.DNE(4,x,2,1,"small",2),h.k0s(),h.j41(5,"div",3)(6,"form",4)(7,"div",5)(8,"bit-form-field")(9,"bit-label"),h.EFF(10),h.nI1(11,"i18n"),h.k0s(),h.nrm(12,"input",6),h.nI1(13,"i18n"),h.k0s(),h.j41(14,"span",7),h.EFF(15,"-"),h.k0s(),h.j41(16,"bit-form-field")(17,"bit-label"),h.EFF(18),h.nI1(19,"i18n"),h.k0s(),h.nrm(20,"input",8),h.nI1(21,"i18n"),h.k0s(),h.j41(22,"button",9),h.nrm(23,"i",10),h.EFF(24),h.nI1(25,"i18n"),h.k0s()()(),h.nrm(26,"hr"),h.DNE(27,j,3,3,"div",11)(28,O,15,11,"bit-table",12)(29,P,3,4,"button",13),h.k0s(),h.qex(30,14),h.j41(31,"button",15),h.EFF(32),h.nI1(33,"i18n"),h.k0s(),h.bVm(),h.k0s()),2&e&&(h.Y8G("loading",i.loading),h.R7$(2),h.SpI(" ",h.bMT(3,14,"eventLogs")," "),h.R7$(2),h.Y8G("ngIf",i.name),h.R7$(2),h.Y8G("formGroup",i.filterFormGroup)("bitSubmit",i.refreshEvents),h.R7$(4),h.JRh(h.bMT(11,16,"from")),h.R7$(2),h.FS9("placeholder",h.bMT(13,18,"startDate")),h.R7$(6),h.JRh(h.bMT(19,20,"to")),h.R7$(2),h.FS9("placeholder",h.bMT(21,22,"endDate")),h.R7$(4),h.SpI(" ",h.bMT(25,24,"refresh")," "),h.R7$(3),h.Y8G("ngIf",!i.dataSource.data||!i.dataSource.data.length),h.R7$(),h.Y8G("ngIf",null==i.dataSource||null==i.dataSource.data?null:i.dataSource.data.length),h.R7$(),h.Y8G("ngIf",i.continuationToken),h.R7$(3),h.SpI(" ",h.bMT(33,26,"close")," "))},dependencies:[u.G,I.Sq,I.bT,v.qT,v.me,v.BC,v.cb,v.j4,v.JD,y.C,S.p,C.$,T.L,k.Q,$.I,R.m,F.m,M.J,E.h,D.Q,G.Y,z._,z.O,I.Jj,I.vh,A.$],encapsulation:2});const W=(e,i)=>e.open(Y,i)},77259:(e,i,t)=>{t.d(i,{V:()=>v});var n=t(3867),o=t(64195),r=t(72245),s=t(44500),a=t(26932),l=t(67553),c=t(35500),d=t(3633),u=t(50700),h=t(15639),p=t(39488),g=t(69855),m=function(e,i,t,n){return new(t||(t=Promise))((function(o,r){function s(e){try{l(n.next(e))}catch(i){r(i)}}function a(e){try{l(n.throw(e))}catch(i){r(i)}}function l(e){var i;e.done?o(e.value):(i=e.value,i instanceof t?i:new t((function(e){e(i)}))).then(s,a)}l((n=n.apply(e,i||[])).next())}))};function v(e){return(i,t)=>m(this,void 0,void 0,(function*(){const m=(0,n.WQX)(o.Ix),v=(0,n.WQX)(l.PV),f=(0,n.WQX)(g.f),b=(0,n.WQX)(u.W),w=(0,n.WQX)(p.H),I=(0,n.WQX)(c.Di),y=(0,n.WQX)(n.uvJ);null==(yield w.getLastSync())&&(yield w.fullSync(!1));const S=yield(0,r._)(I.activeAccount$.pipe(d.F6,(0,s.n)((e=>v.organizations$(e))),(0,h.H)(i.params.organizationId)));if(null==S)return m.createUrlTree(["/"]);if(!S.isOwner&&!S.enabled)return f.showToast({variant:"error",title:null,message:b.t("organizationIsDisabled")}),m.createUrlTree(["/"]);if(null==e)return!0;const C=(0,n.N4e)(y,(()=>e(S))),T=(0,a.A)(C)?yield(0,r._)(C):yield Promise.resolve(C);if(!0!==T&&!1!==T)throw new Error("Permission callback did not resolve to a boolean.");if(!T){const e=t.root.queryParamMap.get("itemId")||t.root.queryParamMap.get("cipherId");return e?m.createUrlTree(["/vault"],{queryParams:{itemId:e}}):(f.showToast({variant:"error",title:null,message:b.t("accessDenied")}),(0,l.OV)(S)?m.createUrlTree(["/organizations",S.id]):m.createUrlTree(["/"]))}return!0}))}},92621:(e,i,t)=>{t.r(i),t.d(i,{OrganizationModule:()=>Ln});var n=t(4170),o=t(25065),r=t(81667),s=t(86842),a=t(58127),l=t(67553),c=t(63629),d=t(73392),u=t(62963),h=t(14092),p=t(53203),g=t(2195),m=t(86561),v=t(79303),f=t(77259),b=t(16878),w=t(66046),I=t(36790),y=t(72245),S=t(33338),C=t(93695),T=t(88565),k=t(3204),$=t(44500),R=t(69194),F=t(36359),M=t(34040),E=t(14803),D=t(27442),G=t(14928),z=t(36006),A=t(73276),U=t(75811),x=t(44451),j=t(34530),X=t(3633),V=t(36502),B=t(82468),N=t(83516),O=t(78781),P=t(24930),Y=t(36501),W=t(23567),L=t(89923),q=t(90097),H=t(59525),_=t(85134),J=t(30082),K=t(58363),Q=t(16452),Z=t(3867),ee=t(21274),ie=t(50700),te=t(11224),ne=t(49247),oe=t(64195),re=function(e,i,t,n){return new(t||(t=Promise))((function(o,r){function s(e){try{l(n.next(e))}catch(i){r(i)}}function a(e){try{l(n.throw(e))}catch(i){r(i)}}function l(e){var i;e.done?o(e.value):(i=e.value,i instanceof t?i:new t((function(e){e(i)}))).then(s,a)}l((n=n.apply(e,i||[])).next())}))};const se=e=>e.toLocaleDateString("en-US",{month:"short",day:"2-digit",year:"numeric"});class ae{constructor(e,i,t,n,o){this.dialogService=e,this.i18nService=i,this.organizationApiService=t,this.organizationBillingApiService=n,this.router=o,this.cache$=new Map,this.getFreeTrialWarning$=e=>this.getWarning$(e,(e=>e.freeTrial)).pipe((0,k.T)((i=>{const{remainingTrialDays:t}=i;return t>=2?{organization:e,message:this.i18nService.t("freeTrialEndPromptCount",t)}:1==t?{organization:e,message:this.i18nService.t("freeTrialEndPromptTomorrowNoOrgName")}:{organization:e,message:this.i18nService.t("freeTrialEndingTodayWithoutOrgName")}}))),this.getResellerRenewalWarning$=e=>this.getWarning$(e,(e=>e.resellerRenewal)).pipe((0,k.T)((i=>{switch(i.type){case"upcoming":return{type:"info",message:this.i18nService.t("resellerRenewalWarningMsg",e.providerName,se(i.upcoming.renewalDate))};case"issued":return{type:"info",message:this.i18nService.t("resellerOpenInvoiceWarningMgs",e.providerName,se(i.issued.issuedDate),se(i.issued.dueDate))};case"past_due":return{type:"warning",message:this.i18nService.t("resellerPastDueWarningMsg",e.providerName,se(i.pastDue.suspensionDate))}}})),(0,R.p)((e=>null!==e))),this.showInactiveSubscriptionDialog$=e=>this.getWarning$(e,(e=>e.inactiveSubscription)).pipe((0,$.n)((i=>re(this,void 0,void 0,(function*(){switch(i.resolution){case"contact_provider":yield this.dialogService.openSimpleDialog({title:this.i18nService.t("suspendedOrganizationTitle",e.name),content:{key:"suspendedManagedOrgMessage",placeholders:[e.providerName]},type:"danger",acceptButtonText:this.i18nService.t("close"),cancelButtonText:null});break;case"add_payment_method":(yield this.dialogService.openSimpleDialog({title:this.i18nService.t("suspendedOrganizationTitle",e.name),content:{key:"suspendedOwnerOrgMessage"},type:"danger",acceptButtonText:this.i18nService.t("continue"),cancelButtonText:this.i18nService.t("close")}))&&(yield this.router.navigate(["organizations",`${e.id}`,"billing","payment-method"],{state:{launchPaymentModalAutomatically:!0}}));break;case"resubscribe":{const i=yield this.organizationApiService.getSubscription(e.id),t=(0,Q.IO)(this.dialogService,{data:{organizationId:e.id,subscription:i,productTierType:e.productTierType}});yield(0,T.s)(t.closed);break}case"contact_owner":yield this.dialogService.openSimpleDialog({title:this.i18nService.t("suspendedOrganizationTitle",e.name),content:{key:"suspendedUserOrgMessage"},type:"danger",acceptButtonText:this.i18nService.t("close"),cancelButtonText:null})}}))))),this.getResponse$=e=>{const i=this.cache$.get(e.id);if(i)return i;const t=(0,I.H)(this.organizationBillingApiService.getWarnings(e.id)).pipe((0,D.t)({bufferSize:1,refCount:!1}));return this.cache$.set(e.id,t),t},this.getWarning$=(e,i)=>this.getResponse$(e).pipe((0,k.T)(i),(0,J.v)((e=>!!e)),(0,K.s)(1))}}ae.ɵfac=function(e){return new(e||ae)(Z.KVO(ee.o3),Z.KVO(ie.W),Z.KVO(te.X),Z.KVO(ne.C),Z.KVO(oe.Ix))},ae.ɵprov=Z.jDH({token:ae,factory:ae.ɵfac,providedIn:"root"});var le=t(5253),ce=(t(84488),t(91326));function de(e,i){if(1&e&&(Z.j41(0,"bit-banner",0),Z.EFF(1),Z.k0s()),2&e){Z.XpG();const e=Z.r8f(0);Z.Y8G("showClose",!1),Z.R7$(),Z.SpI(" ",e.message," ")}}class ue{constructor(e){this.organizationWarningsService=e}ngOnInit(){this.resellerRenewalWarning$=this.organizationWarningsService.getResellerRenewalWarning$(this.organization)}}ue.ɵfac=function(e){return new(e||ue)(Z.rXU(ae))},ue.ɵcmp=Z.VBU({type:ue,selectors:[["app-reseller-renewal-warning"]],inputs:{organization:"organization"},decls:3,vars:4,consts:[["id","reseller-warning-banner","icon","bwi-billing","bannerType","info",1,"-tw-m-6","tw-flex","tw-flex-col","tw-pb-6",3,"showClose"]],template:function(e,i){if(1&e&&(Z.SS7(0),Z.nI1(1,"async"),Z.DNE(2,de,2,2,"bit-banner",0)),2&e){const e=Z.bH3(Z.bMT(1,1,i.resellerRenewalWarning$));Z.R7$(2),Z.vxM(e?2:-1)}},dependencies:[le.Jj,ce.K],encapsulation:2});var he=t(41226);class pe{constructor(e){this.i18nService=e,this.RENEWAL_WARNING_DAYS=14,this.GRACE_PERIOD_DAYS=30}getWarning(e,i){if(!e.hasReseller)return null;if(this.shouldShowPastDueWarning(i)){const t=this.getGracePeriodEndDate(i.invoiceDueDate);return t?{type:"warning",message:this.i18nService.t("resellerPastDueWarningMsg",e.providerName,this.formatDate(t))}:null}if(this.shouldShowInvoiceWarning(i)){const t=i.invoiceCreatedDate,n=i.invoiceDueDate;return t&&n?{type:"info",message:this.i18nService.t("resellerOpenInvoiceWarningMgs",e.providerName,this.formatDate(i.invoiceCreatedDate),this.formatDate(i.invoiceDueDate))}:null}if(this.shouldShowRenewalWarning(i)){return i.subPeriodEndDate?{type:"info",message:this.i18nService.t("resellerRenewalWarningMsg",e.providerName,this.formatDate(i.subPeriodEndDate))}:null}return null}shouldShowRenewalWarning(e){if(!e.hasSubscription||!e.subPeriodEndDate)return!1;const i=new Date(e.subPeriodEndDate);return Math.ceil((i.getTime()-Date.now())/864e5)<=this.RENEWAL_WARNING_DAYS}shouldShowInvoiceWarning(e){if(!e.hasOpenInvoice||!e.invoiceDueDate)return!1;return new Date(e.invoiceDueDate)>new Date}shouldShowPastDueWarning(e){if(!e.hasOpenInvoice||!e.invoiceDueDate)return!1;return new Date(e.invoiceDueDate)<=new Date&&!e.isSubscriptionUnpaid}getGracePeriodEndDate(e){if(!e)return null;const i=new Date(e);return i.setDate(i.getDate()+this.GRACE_PERIOD_DAYS),i}formatDate(e){return e?new Date(e).toLocaleDateString("en-US",{month:"short",day:"2-digit",year:"numeric"}):"N/A"}}pe.ɵfac=function(e){return new(e||pe)(Z.KVO(ie.W))},pe.ɵprov=Z.jDH({token:pe,factory:pe.ɵfac,providedIn:"root"});var ge=t(56108),me=t(59032),ve=t(36801);function fe(e,i){if(1&e){const e=Z.RV6();Z.j41(0,"bit-banner",0),Z.EFF(1),Z.j41(2,"a",1),Z.bIt("click",(function(){Z.eBV(e);const i=Z.XpG();return Z.Njj(i.clicked.emit())})),Z.EFF(3),Z.nI1(4,"i18n"),Z.k0s()()}if(2&e){Z.XpG();const e=Z.r8f(0);Z.Y8G("showClose",!1),Z.R7$(),Z.SpI(" ",e.message," "),Z.R7$(2),Z.SpI(" ",Z.bMT(4,3,"clickHereToAddPaymentMethod")," ")}}class be{constructor(e){this.organizationWarningsService=e,this.clicked=new Z.bkB}ngOnInit(){this.freeTrialWarning$=this.organizationWarningsService.getFreeTrialWarning$(this.organization)}}be.ɵfac=function(e){return new(e||be)(Z.rXU(ae))},be.ɵcmp=Z.VBU({type:be,selectors:[["app-free-trial-warning"]],inputs:{organization:"organization"},outputs:{clicked:"clicked"},decls:3,vars:4,consts:[["id","free-trial-banner","icon","bwi-billing","bannerType","premium",1,"-tw-m-6","tw-flex","tw-flex-col","tw-pb-6",3,"showClose"],["bitLink","","linkType","secondary","rel","noreferrer noopener",1,"tw-cursor-pointer",3,"click"]],template:function(e,i){if(1&e&&(Z.SS7(0),Z.nI1(1,"async"),Z.DNE(2,fe,5,5,"bit-banner",0)),2&e){const e=Z.bH3(Z.bMT(1,1,i.freeTrialWarning$));Z.R7$(2),Z.vxM(e?2:-1)}},dependencies:[me.L,le.Jj,ce.K,ve.$Z],encapsulation:2});var we,Ie=t(85494),ye=t(24593),Se=t(93817),Ce=t(9083),Te=t(39738),ke=t(8144),$e=t(47911),Re=t(30550),Fe=t(51122),Me=t(62819),Ee=t(76876),De=t(81525),Ge=t(38766),ze=t(69855),Ae=t(51757),Ue=t(35500),xe=t(37115),je=t(26657),Xe=t(45154),Ve=t(56898),Be=t(7730),Ne=t(34355),Oe=t(88016),Pe=t(43184),Ye=function(e,i,t,n){return new(t||(t=Promise))((function(o,r){function s(e){try{l(n.next(e))}catch(i){r(i)}}function a(e){try{l(n.throw(e))}catch(i){r(i)}}function l(e){var i;e.done?o(e.value):(i=e.value,i instanceof t?i:new t((function(e){e(i)}))).then(s,a)}l((n=n.apply(e,i||[])).next())}))};function We(e,i){if(1&e&&(Z.nrm(0,"bit-access-selector",10),Z.nI1(1,"i18n"),Z.nI1(2,"i18n"),Z.nI1(3,"i18n"),Z.nI1(4,"i18n")),2&e){const e=Z.XpG();Z.Y8G("permissionMode",e.PermissionMode.Edit)("items",e.accessItems)("columnHeader",Z.bMT(1,6,"groupSlashMemberColumnHeader"))("selectorLabelText",Z.bMT(2,8,"selectGroupsAndMembers"))("selectorHelpText",Z.bMT(3,10,"userPermissionOverrideHelperDesc"))("emptySelectionText",Z.bMT(4,12,"noMembersOrGroupsAdded"))}}function Le(e,i){if(1&e&&(Z.nrm(0,"bit-access-selector",11),Z.nI1(1,"i18n"),Z.nI1(2,"i18n"),Z.nI1(3,"i18n")),2&e){const e=Z.XpG();Z.Y8G("permissionMode",e.PermissionMode.Edit)("items",e.accessItems)("columnHeader",Z.bMT(1,5,"memberColumnHeader"))("selectorLabelText",Z.bMT(2,7,"selectMembers"))("emptySelectionText",Z.bMT(3,9,"noMembersAdded"))}}!function(e){e.Saved="saved",e.Canceled="canceled"}(we||(we={}));class qe{constructor(e,i,t,n,o,r,s,a,c,d,u){this.params=e,this.dialogRef=i,this.formBuilder=t,this.organizationService=n,this.accountService=o,this.groupService=r,this.organizationUserApiService=s,this.platformUtilsService=a,this.i18nService=c,this.collectionAdminService=d,this.toastService=u,this.PermissionMode=Ge.ZC,this.formGroup=this.formBuilder.group({access:[[]]}),this.loading=!0,this.accessItems=[],this.destroy$=new w.B,this.submit=()=>Ye(this,void 0,void 0,(function*(){const e=this.formGroup.controls.access.value.filter((e=>e.type===Ge.Uv.Member)).map(Ge.yo),i=this.formGroup.controls.access.value.filter((e=>e.type===Ge.Uv.Group)).map(Ge.yo);yield this.collectionAdminService.bulkAssignAccess(this.organization.id,this.params.collections.map((e=>e.id)),e,i),this.toastService.showToast({variant:"success",title:null,message:this.i18nService.t("editedCollections")}),this.dialogRef.close(we.Saved)})),this.numCollections=this.params.collections.length;const h=this.accountService.activeAccount$.pipe((0,$.n)((e=>this.organizationService.organizations$(null==e?void 0:e.id).pipe((0,l.Sw)(this.params.organizationId))))),p=h.pipe((0,$.n)((e=>e.useGroups?this.groupService.getAll(e.id):(0,C.of)([]))));(0,S.z)([h,p,this.organizationUserApiService.getAllMiniUserDetails(this.params.organizationId)]).pipe((0,E.Q)(this.destroy$)).subscribe((([e,i,t])=>{this.organization=e,this.accessItems=[].concat(i.map(Ge.NU),t.data.map(Ge.df)),this.loading=!1}))}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}static open(e,i){return e.open(qe,i)}}qe.ɵfac=function(e){return new(e||qe)(Z.rXU(De.Qs),Z.rXU(ee.ce),Z.rXU(Ae.ok),Z.rXU(l.PV),Z.rXU(Ue.Di),Z.rXU(r.nK),Z.rXU(x.uB),Z.rXU(xe.y),Z.rXU(ie.W),Z.rXU(x.vE),Z.rXU(ze.f))},qe.ɵcmp=Z.VBU({type:qe,selectors:[["app-bulk-collections-dialog"]],decls:18,vars:18,consts:[[3,"formGroup","bitSubmit"],["dialogSize","large",3,"loading"],["bitDialogTitle",""],[1,"tw-text-sm","tw-normal-case","tw-text-muted"],["bitDialogContent",""],["formControlName","access",3,"permissionMode","items","columnHeader","selectorLabelText","selectorHelpText","emptySelectionText",4,"ngIf"],["formControlName","access",3,"permissionMode","items","columnHeader","selectorLabelText","emptySelectionText",4,"ngIf"],["bitDialogFooter",""],["type","submit","bitButton","","bitFormButton","","buttonType","primary"],["type","button","bitButton","","bitFormButton","","buttonType","secondary","bitDialogClose",""],["formControlName","access",3,"permissionMode","items","columnHeader","selectorLabelText","selectorHelpText","emptySelectionText"],["formControlName","access",3,"permissionMode","items","columnHeader","selectorLabelText","emptySelectionText"]],template:function(e,i){1&e&&(Z.j41(0,"form",0)(1,"bit-dialog",1)(2,"span",2),Z.EFF(3),Z.nI1(4,"i18n"),Z.j41(5,"span",3),Z.EFF(6),Z.nI1(7,"i18n"),Z.k0s()(),Z.j41(8,"div",4),Z.DNE(9,We,5,14,"bit-access-selector",5)(10,Le,4,11,"bit-access-selector",6),Z.k0s(),Z.qex(11,7),Z.j41(12,"button",8),Z.EFF(13),Z.nI1(14,"i18n"),Z.k0s(),Z.j41(15,"button",9),Z.EFF(16),Z.nI1(17,"i18n"),Z.k0s(),Z.bVm(),Z.k0s()()),2&e&&(Z.Y8G("formGroup",i.formGroup)("bitSubmit",i.submit),Z.R7$(),Z.Y8G("loading",i.loading),Z.R7$(2),Z.SpI(" ",Z.bMT(4,10,"assignCollectionAccess")," "),Z.R7$(3),Z.Lme(" ",i.numCollections," ",Z.bMT(7,12,1==i.numCollections?"collection":"collections")," "),Z.R7$(3),Z.Y8G("ngIf",null==i.organization?null:i.organization.useGroups),Z.R7$(),Z.Y8G("ngIf",!(null!=i.organization&&i.organization.useGroups)),Z.R7$(3),Z.SpI(" ",Z.bMT(14,14,"save")," "),Z.R7$(3),Z.SpI(" ",Z.bMT(17,16,"cancel")," "))},dependencies:[o.G,le.bT,Ae.qT,Ae.BC,Ae.cb,Ae.j4,Ae.JD,je.$,Xe.L,Ve.Q,Be.I,Ne.m,Oe.$,Ge.mH,Pe.t],encapsulation:2});var He=t(21457),_e=t(29029),Je=t(22690);function Ke(e,i){if(1&e){const e=Z.RV6();Z.j41(0,"button",3),Z.bIt("click",(function(){Z.eBV(e);const i=Z.XpG();return Z.Njj(i.viewCollectionClicked.emit({readonly:!1,tab:i.collectionDialogTabType.Info}))})),Z.nrm(1,"i",4),Z.EFF(2),Z.nI1(3,"i18n"),Z.k0s()}2&e&&(Z.R7$(2),Z.SpI(" ",Z.bMT(3,1,"editCollection")," "))}function Qe(e,i){if(1&e){const e=Z.RV6();Z.j41(0,"button",3),Z.bIt("click",(function(){Z.eBV(e);const i=Z.XpG();return Z.Njj(i.viewCollectionClicked.emit({readonly:!0,tab:i.collectionDialogTabType.Access}))})),Z.nrm(1,"i",5),Z.EFF(2),Z.nI1(3,"i18n"),Z.k0s()}2&e&&(Z.R7$(2),Z.SpI(" ",Z.bMT(3,1,"viewAccess")," "))}const Ze=He.Sm`<svg xmlns="http://www.w3.org/2000/svg" width="120" height="120" viewBox="10 -10 120 140" fill="none">
  <rect class="tw-stroke-secondary-600" width="134" height="86" x="3" y="31.485" stroke-width="6" rx="11"/>
  <path class="tw-fill-secondary-600" d="M123.987 20.15H14.779a3.114 3.114 0 0 1-2.083-.95 3.036 3.036 0 0 1 0-4.208 3.125 3.125 0 0 1 2.083-.951h109.208c.792.043 1.536.38 2.083.95a3.035 3.035 0 0 1 0 4.208 3.115 3.115 0 0 1-2.083.95Zm-6.649-14.041h-95.91a3.114 3.114 0 0 1-2.082-.95 3.036 3.036 0 0 1-.848-2.105c0-.782.306-1.538.848-2.104A3.125 3.125 0 0 1 21.43 0h95.909c.791.043 1.535.38 2.082.95.547.57.849 1.322.849 2.104a3.05 3.05 0 0 1-.849 2.104 3.115 3.115 0 0 1-2.082.95ZM95.132 74.407A42.317 42.317 0 0 0 83.59 65.43l8.799-8.657a1.59 1.59 0 0 0 .004-2.27 1.641 1.641 0 0 0-2.298-.004l-9.64 9.479a28.017 28.017 0 0 0-10.483-2.13c-14.323 0-24.814 12.342-25.298 12.89a2.431 2.431 0 0 0-.675 1.64c-.01.612.215 1.203.626 1.66a43.981 43.981 0 0 0 11.873 9.485l-8.806 8.658a1.601 1.601 0 0 0-.499 1.138 1.602 1.602 0 0 0 1.008 1.5 1.651 1.651 0 0 0 1.255-.009c.199-.085.379-.205.528-.359l9.634-9.443a27.16 27.16 0 0 0 10.359 2.158c14.323 0 24.753-12.086 25.23-12.63a2.983 2.983 0 0 0-.078-4.128h.002ZM49.204 77.82a1.82 1.82 0 0 1-.43-.6 1.767 1.767 0 0 1-.152-.72 1.778 1.778 0 0 1 .582-1.32c3.857-3.564 11.782-9.686 20.77-9.676 2.564.037 5.105.508 7.508 1.395l-3.291 3.235a7.793 7.793 0 0 0-5.02-1.226 7.746 7.746 0 0 0-4.676 2.18 7.528 7.528 0 0 0-1 9.563l-4.199 4.143a43.135 43.135 0 0 1-10.092-6.974Zm26.059-1.318a5.19 5.19 0 0 1-1.557 3.68 5.326 5.326 0 0 1-3.733 1.521c-.82-.005-1.63-.2-2.359-.57l7.067-6.952c.377.718.575 1.513.582 2.321Zm-10.58 0a5.136 5.136 0 0 1 .673-2.555 5.204 5.204 0 0 1 1.862-1.897 5.302 5.302 0 0 1 5.172-.146l-7.096 6.977a5.06 5.06 0 0 1-.61-2.379Zm26.053 1.331c-3.857 3.56-11.779 9.677-20.763 9.677a22.723 22.723 0 0 1-7.454-1.369l3.292-3.226a7.793 7.793 0 0 0 4.995 1.192 7.734 7.734 0 0 0 4.642-2.176 7.524 7.524 0 0 0 1.033-9.506l4.224-4.168a43.258 43.258 0 0 1 10.02 6.945 1.788 1.788 0 0 1 .585 1.313 1.788 1.788 0 0 1-.577 1.318h.003Z"/>
</svg>`;class ei{constructor(){this.icon=Ze,this.collectionDialogTabType=g._K,this.canEditCollection=!1,this.canViewCollectionInfo=!1,this.viewCollectionClicked=new Z.bkB}}ei.ɵfac=function(e){return new(e||ei)},ei.ɵcmp=Z.VBU({type:ei,selectors:[["collection-access-restricted"]],inputs:{canEditCollection:"canEditCollection",canViewCollectionInfo:"canViewCollectionInfo"},outputs:{viewCollectionClicked:"viewCollectionClicked"},decls:6,vars:6,consts:[[1,"tw-mt-2","tw-block",3,"icon"],["slot","title",1,"tw-mt-4","tw-block"],["slot","button","bitButton","","buttonType","secondary","type","button",3,"click",4,"ngIf"],["slot","button","bitButton","","buttonType","secondary","type","button",3,"click"],["aria-hidden","true",1,"bwi","bwi-pencil-square"],["aria-hidden","true",1,"bwi","bwi-users"]],template:function(e,i){1&e&&(Z.j41(0,"bit-no-items",0)(1,"span",1),Z.EFF(2),Z.nI1(3,"i18n"),Z.k0s(),Z.DNE(4,Ke,4,3,"button",2)(5,Qe,4,3,"button",2),Z.k0s()),2&e&&(Z.Y8G("icon",i.icon),Z.R7$(2),Z.JRh(Z.bMT(3,4,"youDoNotHavePermissions")),Z.R7$(2),Z.Y8G("ngIf",i.canEditCollection),Z.R7$(),Z.Y8G("ngIf",!i.canEditCollection&&i.canViewCollectionInfo))},dependencies:[o.G,le.bT,Ve.Q,Oe.$,_e.t,H.s,Je.D],encapsulation:2});var ii=t(46128),ti=t(60893),ni=t(91240),oi=t(18990),ri=t(72737),si=t(95637),ai=t(31408),li=t(74526),ci=t(5556),di=t(18499),ui=function(e,i,t,n){return new(t||(t=Promise))((function(o,r){function s(e){try{l(n.next(e))}catch(i){r(i)}}function a(e){try{l(n.throw(e))}catch(i){r(i)}}function l(e){var i;e.done?o(e.value):(i=e.value,i instanceof t?i:new t((function(e){e(i)}))).then(s,a)}l((n=n.apply(e,i||[])).next())}))};class hi extends ai.u{constructor(e,i,t,n,o,r,s,a){super(e,i,t,n,o,r,s,a),this.destroy$=new w.B,this._collections=new ri.m(1),this.filteredCollections$=this._collections.asObservable(),this.collectionTree$=this.filteredCollections$.pipe((0,k.T)((e=>this.buildCollectionTree(e))))}reloadCollections(e){return ui(this,void 0,void 0,(function*(){this._collections.next(e)}))}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}}hi.ɵfac=function(e){return new(e||hi)(Z.KVO(l.PV),Z.KVO(li.k),Z.KVO(ci.p),Z.KVO(di.m),Z.KVO(ie.W),Z.KVO(si.v2),Z.KVO(x.YD),Z.KVO(Ue.Di))},hi.ɵprov=Z.jDH({token:hi,factory:hi.ɵfac});class pi{}pi.ɵfac=function(e){return new(e||pi)},pi.ɵmod=Z.$C({type:pi}),pi.ɵinj=Z.G2t({providers:[{provide:ni.u,useClass:hi}],imports:[oi.m,ti.t]});var gi=t(58625),mi=t(10436),vi=t(51661),fi=t(90647),bi=t(56615),wi=t(42594),Ii=t(13496),yi=t(53997),Si=t(82494),Ci=t(32924),Ti=t(54471),ki=t(36288),$i=t(1576),Ri=t(88547),Fi=t(20464),Mi=t(5520),Ei=function(e,i,t,n){return new(t||(t=Promise))((function(o,r){function s(e){try{l(n.next(e))}catch(i){r(i)}}function a(e){try{l(n.throw(e))}catch(i){r(i)}}function l(e){var i;e.done?o(e.value):(i=e.value,i instanceof t?i:new t((function(e){e(i)}))).then(s,a)}l((n=n.apply(e,i||[])).next())}))};const Di=()=>[],Gi=e=>({organizationId:e,collectionId:null}),zi=e=>({collectionId:e});function Ai(e,i){if(1&e&&(Z.j41(0,"bit-breadcrumb",11),Z.EFF(1),Z.k0s()),2&e){const e=i.$implicit;Z.Y8G("route",Z.lJ4(3,Di))("queryParams",Z.eq3(4,zi,e.id)),Z.R7$(),Z.SpI(" ",e.name," ")}}function Ui(e,i){if(1&e&&(Z.j41(0,"bit-breadcrumbs",8)(1,"bit-breadcrumb",9),Z.EFF(2),Z.j41(3,"span"),Z.EFF(4),Z.nI1(5,"i18n"),Z.nI1(6,"lowercase"),Z.k0s()(),Z.qex(7),Z.DNE(8,Ai,2,6,"bit-breadcrumb",10),Z.bVm(),Z.k0s()),2&e){const e=Z.XpG();Z.R7$(),Z.Y8G("route",Z.lJ4(9,Di))("queryParams",Z.eq3(10,Gi,e.organization.id)),Z.R7$(),Z.SpI(" ",e.organization.name," "),Z.R7$(2),Z.SpI(" ",Z.bMT(6,7,Z.bMT(5,5,"collections"))," "),Z.R7$(4),Z.Y8G("ngForOf",e.collections)}}function xi(e,i){if(1&e){const e=Z.RV6();Z.qex(0),Z.j41(1,"button",14),Z.bIt("click",(function(){Z.eBV(e);const i=Z.XpG(2);return Z.Njj(i.editCollection(i.CollectionDialogTabType.Info,!1))})),Z.nrm(2,"i",15),Z.EFF(3),Z.nI1(4,"i18n"),Z.k0s(),Z.j41(5,"button",14),Z.bIt("click",(function(){Z.eBV(e);const i=Z.XpG(2);return Z.Njj(i.editCollection(i.CollectionDialogTabType.Access,!1))})),Z.nrm(6,"i",16),Z.EFF(7),Z.nI1(8,"i18n"),Z.k0s(),Z.bVm()}2&e&&(Z.R7$(3),Z.SpI(" ",Z.bMT(4,2,"editInfo")," "),Z.R7$(4),Z.SpI(" ",Z.bMT(8,4,"access")," "))}function ji(e,i){if(1&e){const e=Z.RV6();Z.qex(0),Z.j41(1,"button",14),Z.bIt("click",(function(){Z.eBV(e);const i=Z.XpG(2);return Z.Njj(i.editCollection(i.CollectionDialogTabType.Info,!0))})),Z.nrm(2,"i",15),Z.EFF(3),Z.nI1(4,"i18n"),Z.k0s(),Z.j41(5,"button",14),Z.bIt("click",(function(){Z.eBV(e);const i=Z.XpG(2);return Z.Njj(i.editCollection(i.CollectionDialogTabType.Access,!0))})),Z.nrm(6,"i",16),Z.EFF(7),Z.nI1(8,"i18n"),Z.k0s(),Z.bVm()}2&e&&(Z.R7$(3),Z.SpI(" ",Z.bMT(4,2,"viewInfo")," "),Z.R7$(4),Z.SpI(" ",Z.bMT(8,4,"viewAccess")," "))}function Xi(e,i){if(1&e){const e=Z.RV6();Z.j41(0,"button",14),Z.bIt("click",(function(){Z.eBV(e);const i=Z.XpG(2);return Z.Njj(i.deleteCollection())})),Z.j41(1,"span",17),Z.nrm(2,"i",18),Z.EFF(3),Z.nI1(4,"i18n"),Z.k0s()()}2&e&&(Z.R7$(3),Z.SpI(" ",Z.bMT(4,1,"delete")," "))}function Vi(e,i){if(1&e&&(Z.qex(0),Z.nrm(1,"button",12),Z.j41(2,"bit-menu",null,0),Z.DNE(4,xi,9,6,"ng-container",5)(5,ji,9,6,"ng-container",5)(6,Xi,5,3,"button",13),Z.k0s(),Z.bVm()),2&e){const e=Z.sdS(3),i=Z.XpG();Z.R7$(),Z.Y8G("bitMenuTriggerFor",e),Z.R7$(3),Z.Y8G("ngIf",i.canEditCollection),Z.R7$(),Z.Y8G("ngIf",!i.canEditCollection&&i.canViewCollectionInfo),Z.R7$(),Z.Y8G("ngIf",i.canDeleteCollection)}}function Bi(e,i){1&e&&(Z.j41(0,"small"),Z.nrm(1,"i",19),Z.nI1(2,"i18n"),Z.j41(3,"span",20),Z.EFF(4),Z.nI1(5,"i18n"),Z.k0s()()),2&e&&(Z.R7$(),Z.FS9("title",Z.bMT(2,2,"loading")),Z.R7$(3),Z.JRh(Z.bMT(5,4,"loading")))}function Ni(e,i){if(1&e){const e=Z.RV6();Z.j41(0,"bit-search",21),Z.nI1(1,"i18n"),Z.bIt("ngModelChange",(function(i){Z.eBV(e);const t=Z.XpG();return Z.Njj(t.onSearchTextChanged(i))})),Z.k0s()}if(2&e){const e=Z.XpG();Z.Y8G("ngModel",e.searchText)("placeholder",Z.bMT(1,2,"searchCollection"))}}function Oi(e,i){if(1&e){const e=Z.RV6();Z.qex(0),Z.j41(1,"button",14),Z.bIt("click",(function(){Z.eBV(e);const i=Z.XpG(3);return Z.Njj(i.addCipher(i.CipherType.Login))})),Z.nrm(2,"i",28),Z.EFF(3),Z.nI1(4,"i18n"),Z.k0s(),Z.j41(5,"button",14),Z.bIt("click",(function(){Z.eBV(e);const i=Z.XpG(3);return Z.Njj(i.addCipher(i.CipherType.Card))})),Z.nrm(6,"i",29),Z.EFF(7),Z.nI1(8,"i18n"),Z.k0s(),Z.j41(9,"button",14),Z.bIt("click",(function(){Z.eBV(e);const i=Z.XpG(3);return Z.Njj(i.addCipher(i.CipherType.Identity))})),Z.nrm(10,"i",30),Z.EFF(11),Z.nI1(12,"i18n"),Z.k0s(),Z.j41(13,"button",14),Z.bIt("click",(function(){Z.eBV(e);const i=Z.XpG(3);return Z.Njj(i.addCipher(i.CipherType.SecureNote))})),Z.nrm(14,"i",31),Z.EFF(15),Z.nI1(16,"i18n"),Z.k0s(),Z.bVm()}2&e&&(Z.R7$(3),Z.SpI(" ",Z.bMT(4,4,"typeLogin")," "),Z.R7$(4),Z.SpI(" ",Z.bMT(8,6,"typeCard")," "),Z.R7$(4),Z.SpI(" ",Z.bMT(12,8,"typeIdentity")," "),Z.R7$(4),Z.SpI(" ",Z.bMT(16,10,"note")," "))}function Pi(e,i){1&e&&Z.nrm(0,"bit-menu-divider")}function Yi(e,i){if(1&e){const e=Z.RV6();Z.qex(0),Z.DNE(1,Pi,1,0,"bit-menu-divider",5),Z.j41(2,"button",14),Z.bIt("click",(function(){Z.eBV(e);const i=Z.XpG(3);return Z.Njj(i.addCollection())})),Z.nrm(3,"i",32),Z.EFF(4),Z.nI1(5,"i18n"),Z.k0s(),Z.bVm()}if(2&e){const e=Z.XpG(3);Z.R7$(),Z.Y8G("ngIf",e.canCreateCipher),Z.R7$(3),Z.SpI(" ",Z.bMT(5,2,"collection")," ")}}function Wi(e,i){if(1&e&&(Z.qex(0),Z.j41(1,"div",23)(2,"button",24),Z.nI1(3,"i18n"),Z.nrm(4,"i",25),Z.EFF(5),Z.nI1(6,"i18n"),Z.nrm(7,"i",26),Z.k0s(),Z.j41(8,"bit-menu",27,1),Z.DNE(10,Oi,17,12,"ng-container",5)(11,Yi,6,4,"ng-container",5),Z.k0s()(),Z.bVm()),2&e){const e=Z.sdS(9),i=Z.XpG(2);Z.R7$(2),Z.FS9("appA11yTitle",Z.bMT(3,5,"new")),Z.Y8G("bitMenuTriggerFor",e),Z.R7$(3),Z.SpI(" ",Z.bMT(6,7,"new"),""),Z.R7$(5),Z.Y8G("ngIf",i.canCreateCipher),Z.R7$(),Z.Y8G("ngIf",i.canCreateCollection)}}function Li(e,i){if(1&e&&(Z.j41(0,"div",22),Z.DNE(1,Wi,12,9,"ng-container",5),Z.k0s()),2&e){const e=Z.XpG();Z.R7$(),Z.Y8G("ngIf",e.canCreateCipher||e.canCreateCollection)}}class qi{constructor(e,i,t,n){this.i18nService=e,this.dialogService=i,this.collectionAdminService=t,this.router=n,this.All=Re.u,this.Unassigned=x.I_,this.onAddCipher=new Z.bkB,this.onAddCollection=new Z.bkB,this.onEditCollection=new Z.bkB,this.onDeleteCollection=new Z.bkB,this.searchTextChanged=new Z.bkB,this.CollectionDialogTabType=g._K,this.CipherType=vi.gC}get title(){var e,i;const t=this.i18nService.t("collections").toLowerCase();return null!=this.collection?this.collection.node.name:this.filter.collectionId===x.I_?this.i18nService.t("unassigned"):(null===(e=this.organization)||void 0===e?void 0:e.name)?`${null===(i=this.organization)||void 0===i?void 0:i.name} ${t}`:this.i18nService.t("collections")}get icon(){return void 0!==this.filter.collectionId?"bwi-collection-shared":""}get showBreadcrumbs(){return void 0!==this.filter.collectionId&&this.filter.collectionId!==Re.u}get collections(){if(null==this.collection)return[];const e=[this.collection];for(;null!=e[e.length-1].parent;)e.push(e[e.length-1].parent);return e.slice(1).reverse().map((e=>e.node))}showFreeOrgUpgradeDialog(){const e={title:this.i18nService.t("upgradeOrganization"),content:this.i18nService.t(this.organization.canEditSubscription?"freeOrgMaxCollectionReachedManageBilling":"freeOrgMaxCollectionReachedNoManageBilling",this.organization.maxCollections),type:"primary"};this.organization.canEditSubscription?e.acceptButtonText=this.i18nService.t("upgrade"):(e.acceptButtonText=this.i18nService.t("ok"),e.cancelButtonText=null);const i=this.dialogService.openSimpleDialogRef(e);(0,y._)(i.closed).then((e=>{e&&e&&this.organization.canEditSubscription&&this.router.navigate(["/organizations",this.organization.id,"billing","subscription"],{queryParams:{upgrade:!0}})}))}get canEditCollection(){return void 0!==this.collection&&this.collection.node.canEdit(this.organization)}addCipher(e){this.onAddCipher.emit(e)}addCollection(){return Ei(this,void 0,void 0,(function*(){if(this.organization.productTierType===mi.K_.Free){if((yield this.collectionAdminService.getAll(this.organization.id)).length===this.organization.maxCollections)return void this.showFreeOrgUpgradeDialog()}this.onAddCollection.emit()}))}editCollection(e,i){return Ei(this,void 0,void 0,(function*(){this.onEditCollection.emit({tab:e,readonly:i})}))}get canDeleteCollection(){return void 0!==this.collection&&this.collection.node.canDelete(this.organization)}get canViewCollectionInfo(){return this.collection.node.canViewCollectionInfo(this.organization)}get canCreateCollection(){var e;return null===(e=this.organization)||void 0===e?void 0:e.canCreateNewCollections}get canCreateCipher(){var e,i;return!((null===(e=this.organization)||void 0===e?void 0:e.isProviderUser)&&!(null===(i=this.organization)||void 0===i?void 0:i.isMember))}deleteCollection(){this.onDeleteCollection.emit()}onSearchTextChanged(e){this.searchText=e,this.searchTextChanged.emit(e)}}qi.ɵfac=function(e){return new(e||qi)(Z.rXU(ie.W),Z.rXU(ee.o3),Z.rXU(x.vE),Z.rXU(oe.Ix))},qi.ɵcmp=Z.VBU({type:qi,selectors:[["app-org-vault-header"]],inputs:{loading:"loading",filter:"filter",organization:"organization",collection:"collection",searchText:"searchText"},outputs:{onAddCipher:"onAddCipher",onAddCollection:"onAddCollection",onEditCollection:"onEditCollection",onDeleteCollection:"onDeleteCollection",searchTextChanged:"searchTextChanged"},decls:7,vars:7,consts:[["editCollectionMenu",""],["addOptions",""],[3,"title","icon"],["slot","breadcrumbs",4,"ngIf"],["slot","title-suffix"],[4,"ngIf"],["class","tw-grow",3,"ngModel","placeholder","ngModelChange",4,"ngIf"],["class","tw-shrink-0",4,"ngIf"],["slot","breadcrumbs"],["queryParamsHandling","merge",3,"route","queryParams"],["icon","bwi-collection-shared","queryParamsHandling","merge",3,"route","queryParams",4,"ngFor","ngForOf"],["icon","bwi-collection-shared","queryParamsHandling","merge",3,"route","queryParams"],["bitIconButton","bwi-angle-down","size","small","type","button",3,"bitMenuTriggerFor"],["type","button","bitMenuItem","",3,"click",4,"ngIf"],["type","button","bitMenuItem","",3,"click"],["aria-hidden","true",1,"bwi","bwi-fw","bwi-pencil-square"],["aria-hidden","true",1,"bwi","bwi-fw","bwi-users"],[1,"tw-text-danger"],["aria-hidden","true",1,"bwi","bwi-fw","bwi-trash"],["aria-hidden","true",1,"bwi","bwi-spinner","bwi-spin","tw-text-muted",3,"title"],[1,"tw-sr-only"],[1,"tw-grow",3,"ngModelChange","ngModel","placeholder"],[1,"tw-shrink-0"],["appListDropdown",""],["bitButton","","buttonType","primary","type","button","id","newItemDropdown",3,"bitMenuTriggerFor","appA11yTitle"],["aria-hidden","true",1,"bwi","bwi-plus"],["aria-hidden","true",1,"bwi","tw-ml-2"],["aria-labelledby","newItemDropdown"],["slot","start","aria-hidden","true",1,"bwi","bwi-globe"],["slot","start","aria-hidden","true",1,"bwi","bwi-credit-card"],["slot","start","aria-hidden","true",1,"bwi","bwi-id-card"],["slot","start","aria-hidden","true",1,"bwi","bwi-sticky-note"],["aria-hidden","true",1,"bwi","bwi-fw","bwi-collection-shared"]],template:function(e,i){1&e&&(Z.j41(0,"app-header",2),Z.DNE(1,Ui,9,12,"bit-breadcrumbs",3),Z.qex(2,4),Z.DNE(3,Vi,7,4,"ng-container",5)(4,Bi,6,6,"small",5),Z.bVm(),Z.DNE(5,Ni,2,4,"bit-search",6)(6,Li,2,1,"div",7),Z.k0s()),2&e&&(Z.Y8G("title",i.title)("icon",i.icon),Z.R7$(),Z.Y8G("ngIf",i.showBreadcrumbs),Z.R7$(2),Z.Y8G("ngIf",null!=i.collection&&(i.canEditCollection||i.canDeleteCollection||i.canViewCollectionInfo)),Z.R7$(),Z.Y8G("ngIf",i.loading),Z.R7$(),Z.Y8G("ngIf",(null==i.organization?null:i.organization.isProviderUser)&&!(null!=i.organization&&i.organization.isMember)),Z.R7$(),Z.Y8G("ngIf","trash"!==i.filter.type&&i.filter.collectionId!==i.Unassigned&&i.organization))},dependencies:[le.MD,le.Sq,le.bT,le.GH,fi.M,Ii.Z,yi.O,Si.w,Ci.M,o.G,Ae.BC,Ae.vS,Ti.C,Ve.Q,ki.s,Oe.$,bi.V,$i.m,Ri.D,wi.G,Fi.f,ti.t,Mi.S,gi.p],encapsulation:2});var Hi=t(52396),_i=t(54351),Ji=t(56962),Ki=t(81582),Qi=t(63098),Zi=t(12012),et=t(1601),it=t(48180),tt=t(58605),nt=t(66983),ot=t(85111),rt=t(49519),st=t(49492),at=function(e,i,t,n){return new(t||(t=Promise))((function(o,r){function s(e){try{l(n.next(e))}catch(i){r(i)}}function a(e){try{l(n.throw(e))}catch(i){r(i)}}function l(e){var i;e.done?o(e.value):(i=e.value,i instanceof t?i:new t((function(e){e(i)}))).then(s,a)}l((n=n.apply(e,i||[])).next())}))};function lt(e,i){1&e&&(Z.j41(0,"div",3),Z.nrm(1,"i",4),Z.k0s())}function ct(e,i){if(1&e&&(Z.qex(0),Z.j41(1,"div",12),Z.nrm(2,"app-filter-section",13),Z.k0s(),Z.bVm()),2&e){const e=i.$implicit,t=Z.XpG(2);Z.R7$(2),Z.Y8G("activeFilter",t.activeFilter)("section",e)}}function dt(e,i){if(1&e){const e=Z.RV6();Z.j41(0,"div")(1,"div",5),Z.EFF(2),Z.nI1(3,"i18n"),Z.j41(4,"a",6),Z.nI1(5,"i18n"),Z.nrm(6,"i",7),Z.k0s()(),Z.j41(7,"div",8)(8,"div",9)(9,"bit-search",10),Z.nI1(10,"i18n"),Z.mxI("ngModelChange",(function(i){Z.eBV(e);const t=Z.XpG();return Z.DH7(t.searchText,i)||(t.searchText=i),Z.Njj(i)})),Z.bIt("ngModelChange",(function(i){Z.eBV(e);const t=Z.XpG();return Z.Njj(t.onSearchTextChanged(i))})),Z.k0s()(),Z.DNE(11,ct,3,2,"ng-container",11),Z.k0s()()}if(2&e){const e=Z.XpG();Z.R7$(2),Z.SpI(" ",Z.bMT(3,5,"filters")," "),Z.R7$(2),Z.FS9("appA11yTitle",Z.bMT(5,7,"learnMoreAboutSearchingYourVault")),Z.R7$(5),Z.FS9("placeholder",Z.bMT(10,9,e.searchPlaceholder)),Z.R50("ngModel",e.searchText),Z.R7$(2),Z.Y8G("ngForOf",e.filtersList)}}class ut extends ot.C{set organization(e){e&&e!==this._organization&&(this._organization=e,this.vaultFilterService.setOrganizationFilter(this._organization))}constructor(e,i,t,n,o,r,s,a,l,c){super(e,i,t,n,o,r,s,a,l,c),this.vaultFilterService=e,this.policyService=i,this.i18nService=t,this.platformUtilsService=n,this.toastService=o,this.billingApiService=r,this.dialogService=s,this.configService=a,this.accountService=l,this.restrictedItemTypesService=c}ngOnInit(){return at(this,void 0,void 0,(function*(){this.filters=yield this.buildAllFilters(),this.activeFilter.selectedCipherTypeNode||(this.activeFilter.resetFilter(),this.activeFilter.selectedCollectionNode=yield this.getDefaultFilter()),this.isLoaded=!0}))}ngOnChanges(e){return at(this,void 0,void 0,(function*(){e.organization&&(this.filters=yield this.buildAllFilters())}))}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}removeCollapsibleCollection(){return at(this,void 0,void 0,(function*(){const e=yield(0,y._)(this.vaultFilterService.collapsedFilterNodes$);e.delete("AllCollections");const i=yield(0,y._)(this.activeUserId$);yield this.vaultFilterService.setCollapsedFilterNodes(e,i)}))}addCollectionFilter(){return at(this,void 0,void 0,(function*(){this.removeCollapsibleCollection();return{data$:this.vaultFilterService.buildTypeTree({id:"AllCollections",name:"collections",type:"all",icon:"bwi-collection-shared"},[{id:"AllCollections",name:"Collections",type:"all",icon:"bwi-collection-shared"}]),header:{showHeader:!1,isSelectable:!0},action:this.applyCollectionFilter}}))}buildAllFilters(){return at(this,void 0,void 0,(function*(){const e={};return e.typeFilter=yield this.addTypeFilter(["favorites"]),e.collectionFilter=yield this.addCollectionFilter(),e.trashFilter=yield this.addTrashFilter(),e}))}getDefaultFilter(){return at(this,void 0,void 0,(function*(){var e;return yield(0,y._)(null===(e=this.filters)||void 0===e?void 0:e.collectionFilter.data$)}))}}ut.ɵfac=function(e){return new(e||ut)(Z.rXU(ni.u),Z.rXU(di.m),Z.rXU(ie.W),Z.rXU(xe.y),Z.rXU(ze.f),Z.rXU(it.P),Z.rXU(ee.o3),Z.rXU(et.w),Z.rXU(Ue.Di),Z.rXU(nt.b))},ut.ɵcmp=Z.VBU({type:ut,selectors:[["app-organization-vault-filter"]],inputs:{organization:"organization"},standalone:!1,features:[Z.Vt3,Z.OA$],decls:3,vars:2,consts:[["data-testid","filters",1,"tw-border","tw-border-solid","tw-border-secondary-300","tw-rounded"],["class","tw-text-center tw-p-5",4,"ngIf"],[4,"ngIf"],[1,"tw-text-center","tw-p-5"],["aria-hidden","true",1,"bwi","bwi-spinner","bwi-spin","bwi-3x"],["data-testid","filters-header",1,"tw-bg-background-alt","tw-border-0","tw-border-b","tw-border-solid","tw-border-secondary-100","tw-rounded-t","tw-px-5","tw-py-2.5","tw-font-semibold","tw-uppercase"],["href","https://bitwarden.com/help/searching-vault/","target","_blank","rel","noreferrer",1,"tw-float-right",3,"appA11yTitle"],["aria-hidden","true",1,"bwi","bwi-question-circle"],["data-testid","filters-body",1,"tw-p-5"],[1,"tw-mb-4"],["id","search","autocomplete","off","appAutofocus","",3,"ngModelChange","placeholder","ngModel"],[4,"ngFor","ngForOf"],[1,"filter"],[3,"activeFilter","section"]],template:function(e,i){1&e&&(Z.j41(0,"div",0),Z.DNE(1,lt,2,0,"div",1)(2,dt,12,11,"div",2),Z.k0s()),2&e&&(Z.R7$(),Z.Y8G("ngIf",!i.isLoaded),Z.R7$(),Z.Y8G("ngIf",i.isLoaded))},dependencies:[le.Sq,le.bT,Ae.BC,Ae.vS,Ti.C,rt.B,st.H,Mi.S,Oe.$],encapsulation:2});var ht=t(85523),pt=t(44432),gt=t(12694),mt=t(16496),vt=function(e,i,t,n){return new(t||(t=Promise))((function(o,r){function s(e){try{l(n.next(e))}catch(i){r(i)}}function a(e){try{l(n.throw(e))}catch(i){r(i)}}function l(e){var i;e.done?o(e.value):(i=e.value,i instanceof t?i:new t((function(e){e(i)}))).then(s,a)}l((n=n.apply(e,i||[])).next())}))};const ft=e=>[e],bt=()=>[];function wt(e,i){if(1&e){const e=Z.RV6();Z.j41(0,"app-free-trial-warning",10),Z.bIt("clicked",(function(){Z.eBV(e);const i=Z.XpG();return Z.Njj(i.navigateToPaymentMethod())})),Z.k0s()}if(2&e){const e=Z.XpG();Z.Y8G("organization",e.organization)}}function It(e,i){if(1&e&&Z.nrm(0,"app-reseller-renewal-warning",11),2&e){const e=Z.XpG();Z.Y8G("organization",e.organization)}}function yt(e,i){if(1&e){const e=Z.RV6();Z.j41(0,"bit-banner",13),Z.EFF(1),Z.j41(2,"a",14),Z.bIt("click",(function(){Z.eBV(e);const i=Z.XpG(2);return Z.Njj(i.navigateToPaymentMethod())})),Z.EFF(3),Z.nI1(4,"i18n"),Z.k0s()()}if(2&e){const e=Z.XpG().ngIf;Z.Y8G("showClose",!1),Z.R7$(),Z.SpI(" ",e.message," "),Z.R7$(2),Z.SpI(" ",Z.bMT(4,3,"clickHereToAddPaymentMethod")," ")}}function St(e,i){if(1&e&&(Z.qex(0),Z.DNE(1,yt,5,5,"bit-banner",12),Z.bVm()),2&e){const e=i.ngIf,t=Z.XpG();Z.R7$(),Z.Y8G("ngIf",!t.refreshing&&e.shownBanner)}}function Ct(e,i){if(1&e&&(Z.j41(0,"bit-banner",16),Z.EFF(1),Z.k0s()),2&e){const e=Z.XpG().ngIf;Z.Y8G("showClose",!1),Z.R7$(),Z.SpI(" ",null==e?null:e.message," ")}}function Tt(e,i){if(1&e&&(Z.qex(0),Z.DNE(1,Ct,2,2,"bit-banner",15),Z.bVm()),2&e){const e=Z.XpG();Z.R7$(),Z.Y8G("ngIf",!e.refreshing)}}function kt(e,i){if(1&e){const e=Z.RV6();Z.j41(0,"div",17)(1,"app-organization-vault-filter",18),Z.nI1(2,"async"),Z.bIt("searchTextChanged",(function(i){Z.eBV(e);const t=Z.XpG();return Z.Njj(t.filterSearchText(i))})),Z.k0s()()}if(2&e){const e=Z.XpG();Z.R7$(),Z.Y8G("organization",e.organization)("activeFilter",e.activeFilter)("searchText",Z.bMT(2,3,e.currentSearchText$))}}function $t(e,i){if(1&e){const e=Z.RV6();Z.j41(0,"bit-toggle-group",19),Z.nI1(1,"async"),Z.nI1(2,"i18n"),Z.bIt("selectedChange",(function(i){Z.eBV(e);const t=Z.XpG();return Z.Njj(t.addAccessToggle(i))})),Z.j41(3,"bit-toggle",20),Z.EFF(4),Z.nI1(5,"i18n"),Z.k0s(),Z.j41(6,"bit-toggle",20),Z.EFF(7),Z.nI1(8,"i18n"),Z.k0s()()}if(2&e){const e=Z.XpG();Z.Y8G("selected",Z.bMT(1,6,e.addAccessStatus$)),Z.BMQ("aria-label",Z.bMT(2,8,"addAccessFilter")),Z.R7$(3),Z.Y8G("value",0),Z.R7$(),Z.SpI(" ",Z.bMT(5,10,"all")," "),Z.R7$(2),Z.Y8G("value",1),Z.R7$(),Z.SpI(" ",Z.bMT(8,12,"addAccess")," ")}}function Rt(e,i){if(1&e&&(Z.j41(0,"bit-callout",21),Z.EFF(1),Z.k0s()),2&e){const e=Z.XpG();Z.R7$(),Z.SpI(" ",e.trashCleanupWarning," ")}}function Ft(e,i){if(1&e){const e=Z.RV6();Z.j41(0,"button",25),Z.bIt("click",(function(){Z.eBV(e);const i=Z.XpG(3);return Z.Njj(i.addCipher())})),Z.nrm(1,"i",26),Z.EFF(2),Z.nI1(3,"i18n"),Z.k0s()}2&e&&(Z.R7$(2),Z.SpI(" ",Z.bMT(3,1,"newItem")," "))}function Mt(e,i){if(1&e&&(Z.j41(0,"bit-no-items")(1,"span",23),Z.EFF(2),Z.nI1(3,"i18n"),Z.k0s(),Z.DNE(4,Ft,4,3,"button",24),Z.k0s()),2&e){const e=Z.XpG(2);Z.R7$(2),Z.JRh(Z.bMT(3,2,"noItemsInList")),Z.R7$(2),Z.Y8G("ngIf","trash"!==e.filter.type&&e.filter.collectionId!==e.Unassigned&&(null==e.selectedCollection||null==e.selectedCollection.node?null:e.selectedCollection.node.canEditItems(e.organization)))}}function Et(e,i){if(1&e){const e=Z.RV6();Z.j41(0,"collection-access-restricted",27),Z.bIt("viewCollectionClicked",(function(i){Z.eBV(e);const t=Z.XpG(2);return Z.Njj(t.editCollection(t.selectedCollection.node,i.tab,i.readonly))})),Z.k0s()}if(2&e){const e=Z.XpG(2);Z.Y8G("canEditCollection",null==e.selectedCollection||null==e.selectedCollection.node?null:e.selectedCollection.node.canEdit(e.organization))("canViewCollectionInfo",null==e.selectedCollection||null==e.selectedCollection.node?null:e.selectedCollection.node.canViewCollectionInfo(e.organization))}}function Dt(e,i){if(1&e&&(Z.qex(0),Z.DNE(1,Mt,5,4,"bit-no-items",2)(2,Et,1,2,"collection-access-restricted",22),Z.bVm()),2&e){const e=Z.XpG();Z.R7$(),Z.Y8G("ngIf",!e.showCollectionAccessRestricted),Z.R7$(),Z.Y8G("ngIf",e.showCollectionAccessRestricted)}}function Gt(e,i){1&e&&(Z.j41(0,"div",28),Z.nrm(1,"i",29),Z.nI1(2,"i18n"),Z.j41(3,"span",30),Z.EFF(4),Z.nI1(5,"i18n"),Z.k0s()()),2&e&&(Z.R7$(),Z.FS9("title",Z.bMT(2,2,"loading")),Z.R7$(3),Z.JRh(Z.bMT(5,4,"loading")))}const zt="OrgVaultComponent";var At;!function(e){e[e.All=0]="All",e[e.AddAccess=1]="AddAccess"}(At||(At={}));class Ut{get hideVaultFilters(){var e,i;return(null===(e=this.organization)||void 0===e?void 0:e.isProviderUser)&&!(null===(i=this.organization)||void 0===i?void 0:i.isMember)}constructor(e,i,t,n,o,r,s,a,l,c,d,u,h,p,m,v,f,S,C,T,M,E,D,G,z,A,U,j,V,B,N,O,P,Y,W){this.route=e,this.organizationService=i,this.vaultFilterService=t,this.routedVaultFilterBridgeService=n,this.routedVaultFilterService=o,this.router=r,this.changeDetectorRef=s,this.syncService=a,this.i18nService=l,this.dialogService=c,this.messagingService=d,this.broadcasterService=u,this.ngZone=h,this.platformUtilsService=p,this.cipherService=m,this.passwordRepromptService=v,this.collectionAdminService=f,this.searchService=S,this.searchPipe=C,this.groupService=T,this.logService=M,this.eventCollectionService=E,this.totpService=D,this.apiService=G,this.toastService=z,this.configService=A,this.cipherFormConfigService=U,this.organizationApiService=j,this.trialFlowService=V,this.billingApiService=B,this.organizationBillingService=N,this.resellerWarningService=O,this.accountService=P,this.billingNotificationService=Y,this.organizationWarningsService=W,this.Unassigned=x.I_,this.trashCleanupWarning=null,this.activeFilter=new Fe.$,this.showAddAccessToggle=!1,this.noItemIcon=L.v,this.performingInitialLoad=!0,this.refreshing=!1,this.processingEvent=!1,this.filter={},this.hasSubscription$=new b.t(!1),this.prevCipherId=null,this.searchText$=new w.B,this.refresh$=new b.t(null),this.destroy$=new w.B,this.addAccessStatus$=new b.t(0),this.unpaidSubscriptionDialog$=this.accountService.activeAccount$.pipe((0,k.T)((e=>null==e?void 0:e.id)),(0,$.n)((e=>this.organizationService.organizations$(e).pipe((0,R.p)((e=>1===e.length)),(0,k.T)((([e])=>e)),(0,$.n)((e=>(0,I.H)(this.billingApiService.getOrganizationBillingMetadata(e.id)).pipe((0,F.M)((e=>{this.hasSubscription$.next(e.hasSubscription)})),(0,$.n)((i=>(0,I.H)(this.trialFlowService.handleUnpaidSubscriptionDialog(e,i))))))))))),this.restore=e=>vt(this,void 0,void 0,(function*(){var i;if(e.isDeleted)if(this.organization.permissions.editAnyCollection||e.edit||this.organization.allowAdminAccessToAllCollectionItems){if(yield this.repromptCipher([e]))try{const t=yield(0,y._)(this.accountService.activeAccount$.pipe(X.F6)),n=(null===(i=this.organization)||void 0===i?void 0:i.canEditAnyCollection)||e.isUnassigned;yield this.cipherService.restoreWithServer(e.id,t,n),this.toastService.showToast({variant:"success",title:null,message:this.i18nService.t("restoredItem")}),this.refresh()}catch(t){this.logService.error(t)}}else this.showMissingPermissionsError()})),this.CollectionDialogTabType=g._K}ngOnInit(){return vt(this,void 0,void 0,(function*(){this.userId=yield(0,y._)((0,X.F6)(this.accountService.activeAccount$)),this.trashCleanupWarning=this.i18nService.t(this.platformUtilsService.isSelfHost()?"trashCleanupWarningSelfHosted":"trashCleanupWarning");const e=this.routedVaultFilterService.filter$,i=e.pipe((0,k.T)((e=>e.organizationId)),(0,R.p)((e=>void 0!==e)),(0,M.F)()),t=this.accountService.activeAccount$.pipe((0,k.T)((e=>null==e?void 0:e.id)),(0,$.n)((e=>i.pipe((0,$.n)((i=>this.organizationService.organizations$(e).pipe((0,k.T)((e=>e.find((e=>e.id===i))))))),(0,E.Q)(this.destroy$),(0,D.t)({refCount:!1,bufferSize:1}))))),n=(0,S.z)([t,this.route.queryParams]).pipe((0,G.$)(),(0,$.n)((e=>vt(this,[e],void 0,(function*([e]){this.organization=e,e.canEditAnyCollection||(yield this.syncService.fullSync(!1))})))),(0,D.t)({refCount:!0,bufferSize:1}));this.broadcasterService.subscribe(zt,(e=>{this.ngZone.run((()=>vt(this,void 0,void 0,(function*(){if("syncCompleted"===e.command)e.successfully&&(this.refresh(),this.changeDetectorRef.detectChanges())}))))})),this.routedVaultFilterBridgeService.activeFilter$.pipe((0,E.Q)(this.destroy$)).subscribe((e=>{this.activeFilter=e,this.activeFilter.collectionId||(this.showAddAccessToggle=!1)})),this.searchText$.pipe((0,z.B)(200),(0,E.Q)(this.destroy$)).subscribe((e=>this.router.navigate([],{queryParams:{search:O.A.isNullOrEmpty(e)?null:e},queryParamsHandling:"merge",replaceUrl:!0}))),this.currentSearchText$=this.route.queryParams.pipe((0,k.T)((e=>e.search))),this.allCollectionsWithoutUnassigned$=this.refresh$.pipe((0,$.n)((()=>i)),(0,$.n)((e=>this.collectionAdminService.getAll(e))),(0,D.t)({refCount:!1,bufferSize:1})),this.editableCollections$=this.allCollectionsWithoutUnassigned$.pipe((0,k.T)((e=>this.organization.canEditAllCiphers?e:e.filter((e=>e.assigned)))),(0,D.t)({refCount:!0,bufferSize:1}));const o=(0,S.z)([i,this.allCollectionsWithoutUnassigned$]).pipe((0,k.T)((([e,i])=>{const t=new x.nb;return t.name=this.i18nService.t("unassigned"),t.id=x.I_,t.organizationId=e,i.concat(t)}))),r=i.pipe((0,$.n)((e=>this.groupService.getAll(e))),(0,D.t)({refCount:!0,bufferSize:1})),s=(0,S.z)([t,this.refresh$]).pipe((0,$.n)((e=>vt(this,[e],void 0,(function*([e]){let i;return this.showAddAccessToggle&&!e||this.addAccessToggle(0),!e.isMember&&e.isProviderUser?[]:(e.canEditAllCiphers?(i=yield this.cipherService.getAllFromApiForOrganization(e.id),null==i||i.forEach((e=>e.edit=!0))):i=yield this.cipherService.getManyFromApiForOrganization(e.id),yield this.searchService.indexCiphers(this.userId,i,e.id),i)})))),(0,D.t)({refCount:!0,bufferSize:1})),a=s.pipe((0,k.T)((e=>Object.fromEntries(e.map((e=>[e.id,e])))))),l=o.pipe((0,k.T)((e=>(0,ii.m)(e))),(0,D.t)({refCount:!0,bufferSize:1})),c=(0,S.z)([l,e,this.currentSearchText$,this.addAccessStatus$]).pipe((0,R.p)((([e,i])=>null!=e&&null!=i)),(0,A.H)((e=>vt(this,[e],void 0,(function*([e,i,t,n]){var o;if(i.collectionId===x.I_||void 0===i.collectionId&&void 0!==i.type)return[];this.showAddAccessToggle=!1;let r=[];if(void 0===i.collectionId||i.collectionId===Re.u)r=e;else{const t=W.F.getTreeNodeObjectFromList(e,i.collectionId);r=null!==(o=null==t?void 0:t.children)&&void 0!==o?o:[]}let s=[];if(yield this.searchService.isSearchable(this.userId,t)){const e=(0,ii.e)(r);s=this.searchPipe.transform(e,t,(e=>e.name),(e=>e.id))}else s=r.map((e=>e.node));return this.showAddAccessToggle=!this.organization.allowAdminAccessToAllCollectionItems&&this.organization.canEditUnmanagedCollections&&s.some((e=>e.unmanaged)),1===n&&this.showAddAccessToggle&&(s=s.filter((e=>e.unmanaged))),s})))),(0,E.Q)(this.destroy$),(0,D.t)({refCount:!0,bufferSize:1})),d=(0,S.z)([l,e]).pipe((0,R.p)((([e,i])=>null!=e&&null!=i)),(0,k.T)((([e,i])=>{if(void 0!==i.collectionId&&i.collectionId!==Re.u&&i.collectionId!==x.I_)return W.F.getTreeNodeObjectFromList(e,i.collectionId)})),(0,D.t)({refCount:!0,bufferSize:1})),u=(0,S.z)([e,d,t]).pipe((0,k.T)((([e,i,t])=>e.collectionId===x.I_&&!t.canEditUnassignedCiphers||!t.canEditAllCiphers&&null!=i&&!i.node.assigned)),(0,D.t)({refCount:!0,bufferSize:1})),h=(0,S.z)([s,e,this.currentSearchText$,u]).pipe((0,R.p)((([e,i])=>null!=e&&null!=i)),(0,A.H)((e=>vt(this,[e],void 0,(function*([e,i,t,n]){if(void 0===i.collectionId&&void 0===i.type)return[];if(n)return[];const o=(0,$e.J)(i);return(yield this.searchService.isSearchable(this.userId,t))?yield this.searchService.searchCiphers(this.userId,t,[o],e):e.filter(o)})))),(0,D.t)({refCount:!0,bufferSize:1}));n.pipe((0,$.n)((()=>(0,S.z)([this.route.queryParams,a]))),(0,R.p)((()=>null==this.vaultItemDialogRef)),(0,$.n)((e=>vt(this,[e],void 0,(function*([e,i]){const t=xt(e);if(!t)return void(this.prevCipherId=null);if(t===this.prevCipherId)return;this.prevCipherId=t;const n=i[t];if(n){let i=e.action;if("showFailedToDecrypt"==i)return _.Tp.open(this.dialogService,{cipherIds:[t]}),void(yield this.router.navigate([],{queryParams:{itemId:null,cipherId:null,action:null},queryParamsHandling:"merge",replaceUrl:!0}));null==i&&(i="view"),"view"===i?yield this.viewCipherById(n):yield this.editCipher(n,!1)}else this.toastService.showToast({variant:"error",title:null,message:this.i18nService.t("unknownCipher")}),yield this.router.navigate([],{queryParams:{cipherId:null,itemId:null},queryParamsHandling:"merge"})})))),(0,E.Q)(this.destroy$)).subscribe(),n.pipe((0,$.n)((()=>(0,S.z)([this.route.queryParams,t,s]))),(0,$.n)((e=>vt(this,[e],void 0,(function*([e,i,t]){const n=e.viewEvents;if(!n)return;const o=t.find((e=>e.id===n));i.useEvents&&null!=o?yield this.viewEvents(o):(this.toastService.showToast({variant:"error",title:null,message:this.i18nService.t("unknownCipher")}),yield this.router.navigate([],{queryParams:{viewEvents:null},queryParamsHandling:"merge"}))})))),(0,E.Q)(this.destroy$)).subscribe(),this.useOrganizationWarningsService$=this.configService.getFeatureFlag$(B.TO.UseOrganizationWarningsService),this.useOrganizationWarningsService$.pipe((0,$.n)((e=>e?this.organizationWarningsService.showInactiveSubscriptionDialog$(this.organization):this.unpaidSubscriptionDialog$)),(0,E.Q)(this.destroy$)).subscribe();const p=(0,S.z)([t,this.hasSubscription$.pipe((0,R.p)((e=>null!==e)))]).pipe((0,R.p)((([e,i])=>e.isOwner&&i&&e.canViewBillingHistory)),(0,$.n)((([e])=>(0,S.z)([(0,C.of)(e),this.organizationApiService.getSubscription(e.id),(0,I.H)(this.organizationBillingService.getPaymentSource(e.id)).pipe((0,U.W)((e=>(this.billingNotificationService.handleError(e),(0,C.of)(null)))))]))),(0,k.T)((([e,i,t])=>this.trialFlowService.checkForOrgsWithUpcomingPaymentIssues(e,i,t))),(0,R.p)((e=>null!==e)));this.freeTrialWhenWarningsServiceDisabled$=this.useOrganizationWarningsService$.pipe((0,R.p)((e=>!e)),(0,$.n)((()=>p)));const g=t.pipe((0,R.p)((e=>e.isOwner)),(0,$.n)((e=>(0,I.H)(this.billingApiService.getOrganizationBillingMetadata(e.id)).pipe((0,k.T)((i=>({org:e,metadata:i})))))),(0,k.T)((({org:e,metadata:i})=>this.resellerWarningService.getWarning(e,i))));this.resellerWarningWhenWarningsServiceDisabled$=this.useOrganizationWarningsService$.pipe((0,R.p)((e=>!e)),(0,$.n)((()=>g))),n.pipe((0,$.n)((()=>this.refresh$)),(0,F.M)((()=>this.refreshing=!0)),(0,$.n)((()=>(0,S.z)([t,e,o,r,h,c,d,u]))),(0,E.Q)(this.destroy$)).subscribe((([e,i,t,n,o,r,s,a])=>{this.organization=e,this.filter=i,this.allCollections=t,this.allGroups=n,this.ciphers=o,this.collections=r,this.selectedCollection=s,this.showCollectionAccessRestricted=a,this.isEmpty=0===(null==r?void 0:r.length)&&0===(null==o?void 0:o.length),this.vaultFilterService.reloadCollections(t),this.refreshing=!1,this.performingInitialLoad=!1}))}))}navigateToPaymentMethod(){return vt(this,void 0,void 0,(function*(){var e;yield this.router.navigate(["organizations",`${null===(e=this.organization)||void 0===e?void 0:e.id}`,"billing","payment-method"],{state:{launchPaymentModalAutomatically:!0}})}))}addAccessToggle(e){this.addAccessStatus$.next(e)}get loading(){return this.refreshing||this.processingEvent}ngOnDestroy(){this.broadcasterService.unsubscribe(zt),this.destroy$.next(),this.destroy$.complete()}onVaultItemsEvent(e){return vt(this,void 0,void 0,(function*(){this.processingEvent=!0;try{switch(e.type){case"viewAttachments":yield this.editCipherAttachments(e.item);break;case"clone":yield this.cloneCipher(e.item);break;case"restore":1===e.items.length?yield this.restore(e.items[0]):yield this.bulkRestore(e.items);break;case"delete":{const i=e.items.filter((e=>void 0===e.collection)).map((e=>e.cipher)),t=e.items.filter((e=>void 0===e.cipher)).map((e=>e.collection));1===i.length&&0===t.length?yield this.deleteCipher(i[0]):0===i.length&&1===t.length?yield this.deleteCollection(t[0]):yield this.bulkDelete(i,t,this.organization);break}case"copyField":yield this.copy(e.item,e.field);break;case"editCollection":yield this.editCollection(e.item,g._K.Info,e.readonly);break;case"viewCollectionAccess":yield this.editCollection(e.item,g._K.Access,e.readonly);break;case"bulkEditCollectionAccess":yield this.bulkEditCollectionAccess(e.items,this.organization);break;case"assignToCollections":yield this.bulkAssignToCollections(e.items);break;case"viewEvents":yield this.viewEvents(e.item)}}finally{this.processingEvent=!1}}))}filterSearchText(e){this.searchText$.next(e)}editCipherAttachments(e){return vt(this,void 0,void 0,(function*(){if(0!==(null==e?void 0:e.reprompt)&&!(yield this.passwordRepromptService.showPasswordPrompt()))return void this.go({cipherId:null,itemId:null});if(null==this.organization.maxStorageGb||0===this.organization.maxStorageGb)return void this.messagingService.send("upgradeOrganization",{organizationId:e.organizationId});const i=_._A.open(this.dialogService,{cipherId:e.id,organizationId:e.organizationId,admin:!0}),t=yield(0,y._)(i.closed);t.action!==_.NY.Removed&&t.action!==_.NY.Uploaded||this.refresh()}))}addCipher(e){return vt(this,void 0,void 0,(function*(){const i=yield this.cipherFormConfigService.buildConfig("add",null,e),t=this.activeFilter.collectionId;i.initialValues={organizationId:this.organization.id,collectionIds:t?[t]:[]},yield this.openVaultItemDialog("form",i)}))}editCipher(e,i){return vt(this,void 0,void 0,(function*(){if(e&&0!==e.reprompt&&!(yield this.passwordRepromptService.showPasswordPrompt()))return void this.go({cipherId:null,itemId:null});const t=yield this.cipherFormConfigService.buildConfig(i?"clone":"edit",null==e?void 0:e.id);yield this.openVaultItemDialog("form",t,e)}))}viewCipherById(e){return vt(this,void 0,void 0,(function*(){if(!e)return;if(e&&0!==e.reprompt&&!(yield this.passwordRepromptService.showPasswordPrompt()))return void(yield this.go({cipherId:null,itemId:null,action:null}));const i=yield this.cipherFormConfigService.buildConfig("edit",e.id,e.type);yield this.openVaultItemDialog("view",i,e,this.activeFilter.collectionId)}))}openVaultItemDialog(e,i,t,n){return vt(this,void 0,void 0,(function*(){const o=!!t&&(!t.edit&&!this.organization.canEditAllCiphers),r=o?"view":e;this.vaultItemDialogRef=ye.V.open(this.dialogService,{mode:r,formConfig:i,disableForm:o,activeCollectionId:n,isAdminConsoleAction:!0,restore:this.restore});const s=yield(0,T.s)(this.vaultItemDialogRef.closed);this.vaultItemDialogRef=void 0,s!==ye.r.Deleted&&s!==ye.r.Saved||this.refresh(),yield this.go({cipherId:null,itemId:null,action:null})}))}cloneCipher(e){return vt(this,void 0,void 0,(function*(){var i;if(null===(i=e.login)||void 0===i?void 0:i.hasFido2Credentials){if(!(yield this.dialogService.openSimpleDialog({title:{key:"passkeyNotCopied"},content:{key:"passkeyNotCopiedAlert"},type:"info"})))return!1}yield this.editCipher(e,!0)}))}bulkRestore(e){return vt(this,void 0,void 0,(function*(){if(!this.organization.permissions.editAnyCollection&&e.some((e=>!e.edit&&!this.organization.allowAdminAccessToAllCollectionItems)))return void this.showMissingPermissionsError();if(!(yield this.repromptCipher(e)))return;const i=[],t=[];this.organization.canEditAllCiphers?e.map((e=>{i.push(e.id)})):e.map((e=>{0===e.collectionIds.length?t.push(e.id):e.edit&&i.push(e.id)})),0!==t.length||0!==i.length?((t.length>0||i.length>0)&&(yield this.cipherService.restoreManyWithServer([...t,...i],this.organization.id)),this.toastService.showToast({variant:"success",title:null,message:this.i18nService.t("restoredItems")}),this.refresh()):this.toastService.showToast({variant:"error",title:this.i18nService.t("errorOccurred"),message:this.i18nService.t("nothingSelected")})}))}deleteCipher(e){return vt(this,void 0,void 0,(function*(){if(!e.edit&&!this.organization.canEditAllCiphers)return void this.showMissingPermissionsError();if(!(yield this.repromptCipher([e])))return;const i=e.isDeleted;if(!(yield this.dialogService.openSimpleDialog({title:{key:i?"permanentlyDeleteItem":"deleteItem"},content:{key:i?"permanentlyDeleteItemConfirmation":"deleteItemConfirmation"},type:"warning"})))return!1;try{const t=yield(0,y._)(this.accountService.activeAccount$.pipe(X.F6));yield this.deleteCipherWithServer(e.id,t,i,e.isUnassigned),this.toastService.showToast({variant:"success",title:null,message:this.i18nService.t(i?"permanentlyDeletedItem":"deletedItem")}),this.refresh()}catch(t){this.logService.error(t)}}))}deleteCollection(e){return vt(this,void 0,void 0,(function*(){var i,t,n,o;if(!e.canDelete(this.organization))return void this.showMissingPermissionsError();if(yield this.dialogService.openSimpleDialog({title:e.name,content:{key:"deleteCollectionConfirmation"},type:"warning"}))try{yield this.apiService.deleteCollection(null===(i=this.organization)||void 0===i?void 0:i.id,e.id),this.toastService.showToast({variant:"success",title:null,message:this.i18nService.t("deletedCollectionId",e.name)}),(null===(t=this.selectedCollection)||void 0===t?void 0:t.node.id)===e.id&&(yield this.cipherService.clear(),this.router.navigate([],{queryParams:{collectionId:null!==(o=null===(n=this.selectedCollection.parent)||void 0===n?void 0:n.node.id)&&void 0!==o?o:null},queryParamsHandling:"merge",replaceUrl:!0})),this.refresh()}catch(r){this.logService.error(r)}}))}bulkDelete(e,i,t){return vt(this,void 0,void 0,(function*(){if(!(yield this.repromptCipher(e)))return;const n=[],o=[];if(e.map((e=>{e.isUnassigned?n.push(e.id):o.push(e.id)})),0===e.length&&0===i.length)return void this.toastService.showToast({variant:"error",title:null,message:this.i18nService.t("nothingSelected")});const r=null==i||i.every((e=>e.canDelete(t)));if(!(null==e||e.every((e=>e.edit))||this.organization.canEditAllCiphers)||!r)return void this.showMissingPermissionsError();const s=(0,Ce.Q0)(this.dialogService,{data:{permanent:"trash"===this.filter.type,cipherIds:o,collections:i,organization:t,unassignedCiphers:n}});(yield(0,T.s)(s.closed))===Ce.vA.Deleted&&this.refresh()}))}copy(e,i){return vt(this,void 0,void 0,(function*(){let t,n,o;if("username"===i)t="Username",n=e.login.username,o="username";else if("password"===i)t="Password",n=e.login.password,o="password";else{if("totp"!==i)return void this.toastService.showToast({variant:"error",title:null,message:this.i18nService.t("unexpectedError")});{t="TOTP";const i=yield(0,y._)(this.totpService.getCode$(e.login.totp));n=null==i?void 0:i.code,o="verificationCodeTotp"}}this.passwordRepromptService.protectedFields().includes(t)&&!(yield this.repromptCipher([e]))||e.viewPassword&&(this.platformUtilsService.copyToClipboard(n,{window}),this.toastService.showToast({variant:"info",title:null,message:this.i18nService.t("valueCopied",this.i18nService.t(o))}),"password"===i?yield this.eventCollectionService.collect(V.Bx.Cipher_ClientCopiedPassword,e.id):"totp"===i&&(yield this.eventCollectionService.collect(V.Bx.Cipher_ClientCopiedHiddenField,e.id)))}))}addCollection(){return vt(this,void 0,void 0,(function*(){var e,i;const t=(0,g.jN)(this.dialogService,{data:{organizationId:null===(e=this.organization)||void 0===e?void 0:e.id,parentCollectionId:null===(i=this.selectedCollection)||void 0===i?void 0:i.node.id,limitNestedCollections:!this.organization.canEditAnyCollection,isAdminConsoleActive:!0}}),n=yield(0,T.s)(t.closed);n.action!==g.RZ.Saved&&n.action!==g.RZ.Deleted||this.refresh()}))}editCollection(e,i,t){return vt(this,void 0,void 0,(function*(){var n,o,r,s;const a=(0,g.jN)(this.dialogService,{data:{collectionId:null==e?void 0:e.id,organizationId:null===(n=this.organization)||void 0===n?void 0:n.id,initialTab:i,readonly:t,isAddAccessCollection:e.unmanaged,limitNestedCollections:!this.organization.canEditAnyCollection,isAdminConsoleActive:!0}}),l=yield(0,T.s)(a.closed);l.action!==g.RZ.Saved&&l.action!==g.RZ.Deleted||(this.refresh(),l.action===g.RZ.Deleted&&(null===(o=this.selectedCollection)||void 0===o?void 0:o.node.id)===(null==e?void 0:e.id)&&this.router.navigate([],{queryParams:{collectionId:null!==(s=null===(r=this.selectedCollection.parent)||void 0===r?void 0:r.node.id)&&void 0!==s?s:null},queryParamsHandling:"merge",replaceUrl:!0}))}))}bulkEditCollectionAccess(e,i){return vt(this,void 0,void 0,(function*(){var t;if(0===e.length)return void this.toastService.showToast({variant:"error",title:null,message:this.i18nService.t("noCollectionsSelected")});if(e.some((e=>!e.canEdit(i))))return void this.showMissingPermissionsError();const n=qe.open(this.dialogService,{data:{collections:e,organizationId:null===(t=this.organization)||void 0===t?void 0:t.id}});(yield(0,T.s)(n.closed))===we.Saved&&this.refresh()}))}bulkAssignToCollections(e){return vt(this,void 0,void 0,(function*(){var i,t,n,o;if(0===e.length)return void this.toastService.showToast({variant:"error",title:null,message:this.i18nService.t("nothingSelected")});const r=yield(0,y._)(this.editableCollections$),s=Ie.G.open(this.dialogService,{data:{ciphers:e,organizationId:null===(i=this.organization)||void 0===i?void 0:i.id,availableCollections:r,activeCollection:null===(n=null===(t=this.activeFilter)||void 0===t?void 0:t.selectedCollectionNode)||void 0===n?void 0:n.node,isSingleCipherAdmin:1===e.length&&((null===(o=this.organization)||void 0===o?void 0:o.canEditAllCiphers)||e[0].isUnassigned)}});(yield(0,T.s)(s.closed))===_.f$.Saved&&this.refresh()}))}viewEvents(e){return vt(this,void 0,void 0,(function*(){yield(0,Ee.l)(this.dialogService,{data:{name:e.name,organizationId:this.organization.id,entityId:e.id,showUser:!0,entity:"cipher"}})}))}deleteCipherWithServer(e,i,t,n){var o;const r=(null===(o=this.organization)||void 0===o?void 0:o.canEditAllCiphers)||n;return t?this.cipherService.deleteWithServer(e,i,r):this.cipherService.softDeleteWithServer(e,i,r)}repromptCipher(e){return vt(this,void 0,void 0,(function*(){return!e.find((e=>e.reprompt!==Y.b.None))||(yield this.passwordRepromptService.showPasswordPrompt())}))}refresh(){this.refresh$.next()}go(e=null){null==e&&(e={type:this.activeFilter.cipherType,collectionId:this.activeFilter.collectionId,deleted:this.activeFilter.isDeleted||null}),this.router.navigate([],{relativeTo:this.route,queryParams:e,queryParamsHandling:"merge",replaceUrl:!0})}showMissingPermissionsError(){this.toastService.showToast({variant:"error",title:null,message:this.i18nService.t("missingPermissions")})}}Ut.ɵfac=function(e){return new(e||Ut)(Z.rXU(oe.nX),Z.rXU(l.PV),Z.rXU(ni.u),Z.rXU(Te.a),Z.rXU(ke.B),Z.rXU(oe.Ix),Z.rXU(Z.gRc),Z.rXU(P.H),Z.rXU(ie.W),Z.rXU(ee.o3),Z.rXU(N.U),Z.rXU(Hi.y),Z.rXU(Z.SKi),Z.rXU(xe.y),Z.rXU(ci.p),Z.rXU(_.qX),Z.rXU(x.vE),Z.rXU(_i.S),Z.rXU(j.R),Z.rXU(r.nK),Z.rXU(Ji.K),Z.rXU(Ki.c),Z.rXU(Qi.R),Z.rXU(Zi.G),Z.rXU(ze.f),Z.rXU(et.w),Z.rXU(_.hI),Z.rXU(te.X),Z.rXU(ge.A),Z.rXU(it.P),Z.rXU(tt.Y),Z.rXU(pe),Z.rXU(Ue.Di),Z.rXU(he.g),Z.rXU(ae))},Ut.ɵcmp=Z.VBU({type:Ut,selectors:[["app-org-vault"]],features:[Z.Jv_([ke.B,Te.a,{provide:_.hI,useClass:Me.l}])],decls:19,vars:52,consts:[[3,"organization","clicked",4,"ngIf"],[3,"organization",4,"ngIf"],[4,"ngIf"],[3,"onAddCipher","onAddCollection","onEditCollection","onDeleteCollection","searchTextChanged","filter","loading","organization","collection","searchText"],[1,"tw-flex","tw-flex-row"],["class","tw-w-1/4 tw-mr-5",4,"ngIf"],[3,"selected","selectedChange",4,"ngIf"],["type","warning",4,"ngIf"],[3,"onEvent","ciphers","collections","allCollections","allOrganizations","allGroups","disabled","showOwner","showPermissionsColumn","showCollections","showGroups","showPremiumFeatures","showBulkMove","showBulkTrashOptions","useEvents","showAdminActions","showBulkEditCollectionAccess","showBulkAddToCollections","viewingOrgVault","addAccessStatus","addAccessToggle","activeCollection"],["class","tw-mt-6 tw-flex tw-h-full tw-flex-col tw-items-center tw-justify-start",4,"ngIf"],[3,"clicked","organization"],[3,"organization"],["id","free-trial-banner","class","-tw-m-6 tw-flex tw-flex-col tw-pb-6","icon","bwi-billing","bannerType","premium",3,"showClose",4,"ngIf"],["id","free-trial-banner","icon","bwi-billing","bannerType","premium",1,"-tw-m-6","tw-flex","tw-flex-col","tw-pb-6",3,"showClose"],["bitLink","","linkType","secondary","rel","noreferrer noopener",1,"tw-cursor-pointer",3,"click"],["id","reseller-warning-banner","class","-tw-m-6 tw-flex tw-flex-col tw-pb-6","icon","bwi-billing","bannerType","info",3,"showClose",4,"ngIf"],["id","reseller-warning-banner","icon","bwi-billing","bannerType","info",1,"-tw-m-6","tw-flex","tw-flex-col","tw-pb-6",3,"showClose"],[1,"tw-w-1/4","tw-mr-5"],[3,"searchTextChanged","organization","activeFilter","searchText"],[3,"selectedChange","selected"],[3,"value"],["type","warning"],[3,"canEditCollection","canViewCollectionInfo","viewCollectionClicked",4,"ngIf"],["slot","title",1,"tw-mt-4","tw-block"],["slot","button","bitButton","","buttonType","primary","type","button",3,"click",4,"ngIf"],["slot","button","bitButton","","buttonType","primary","type","button",3,"click"],["aria-hidden","true",1,"bwi","bwi-plus"],[3,"viewCollectionClicked","canEditCollection","canViewCollectionInfo"],[1,"tw-mt-6","tw-flex","tw-h-full","tw-flex-col","tw-items-center","tw-justify-start"],["aria-hidden","true",1,"bwi","bwi-spinner","bwi-spin","tw-text-muted",3,"title"],[1,"tw-sr-only"]],template:function(e,i){1&e&&(Z.DNE(0,wt,1,1,"app-free-trial-warning",0),Z.nI1(1,"async"),Z.DNE(2,It,1,1,"app-reseller-renewal-warning",1),Z.nI1(3,"async"),Z.DNE(4,St,2,1,"ng-container",2),Z.nI1(5,"async"),Z.DNE(6,Tt,2,1,"ng-container",2),Z.nI1(7,"async"),Z.j41(8,"app-org-vault-header",3),Z.nI1(9,"async"),Z.bIt("onAddCipher",(function(e){return i.addCipher(e)}))("onAddCollection",(function(){return i.addCollection()}))("onEditCollection",(function(e){return i.editCollection(i.selectedCollection.node,e.tab,e.readonly)}))("onDeleteCollection",(function(){return i.deleteCollection(i.selectedCollection.node)}))("searchTextChanged",(function(e){return i.filterSearchText(e)})),Z.k0s(),Z.j41(10,"div",4),Z.DNE(11,kt,3,5,"div",5),Z.j41(12,"div"),Z.DNE(13,$t,9,14,"bit-toggle-group",6)(14,Rt,2,1,"bit-callout",7),Z.j41(15,"app-vault-items",8),Z.nI1(16,"async"),Z.bIt("onEvent",(function(e){return i.onVaultItemsEvent(e)})),Z.k0s(),Z.DNE(17,Dt,3,2,"ng-container",2)(18,Gt,6,6,"div",9),Z.k0s()()),2&e&&(Z.Y8G("ngIf",Z.bMT(1,37,i.useOrganizationWarningsService$)),Z.R7$(2),Z.Y8G("ngIf",Z.bMT(3,39,i.useOrganizationWarningsService$)),Z.R7$(2),Z.Y8G("ngIf",Z.bMT(5,41,i.freeTrialWhenWarningsServiceDisabled$)),Z.R7$(2),Z.Y8G("ngIf",Z.bMT(7,43,i.resellerWarningWhenWarningsServiceDisabled$)),Z.R7$(2),Z.Y8G("filter",i.filter)("loading",i.refreshing)("organization",i.organization)("collection",i.selectedCollection)("searchText",Z.bMT(9,45,i.currentSearchText$)),Z.R7$(3),Z.Y8G("ngIf",!i.hideVaultFilters),Z.R7$(),Z.HbH(i.hideVaultFilters?"tw-w-full":"tw-w-3/4"),Z.R7$(),Z.Y8G("ngIf",i.showAddAccessToggle&&i.activeFilter.selectedCollectionNode),Z.R7$(),Z.Y8G("ngIf",i.activeFilter.isDeleted),Z.R7$(),Z.Y8G("ciphers",i.ciphers)("collections",i.collections)("allCollections",i.allCollections)("allOrganizations",i.organization?Z.eq3(49,ft,i.organization):Z.lJ4(51,bt))("allGroups",i.allGroups)("disabled",i.loading)("showOwner",!1)("showPermissionsColumn",!0)("showCollections",void 0!==i.filter.type)("showGroups",(null==i.organization?null:i.organization.useGroups)&&(void 0===i.filter.type&&void 0===i.filter.collectionId||void 0!==i.filter.collectionId))("showPremiumFeatures",null==i.organization?null:i.organization.useTotp)("showBulkMove",!1)("showBulkTrashOptions","trash"===i.filter.type)("useEvents",null==i.organization?null:i.organization.canAccessEventLogs)("showAdminActions",!0)("showBulkEditCollectionAccess",!0)("showBulkAddToCollections",!0)("viewingOrgVault",!0)("addAccessStatus",Z.bMT(16,47,i.addAccessStatus$))("addAccessToggle",i.showAddAccessToggle)("activeCollection",null==i.selectedCollection?null:i.selectedCollection.node),Z.R7$(2),Z.Y8G("ngIf",!i.performingInitialLoad&&i.isEmpty),Z.R7$(),Z.Y8G("ngIf",i.performingInitialLoad))},dependencies:[qi,ei,pi,ut,Se.l,ht.W_,o.G,le.bT,Ve.Q,pt.G,me.L,gt.H,mt.a,le.Jj,Oe.$,q.H,ce.K,H.s,Je.D,be,ue],encapsulation:2});const xt=e=>e.itemId||e.cipherId,jt=[{path:"",component:Ut,canActivate:[(0,f.V)(l.of)],data:{titleId:"vaults"}}];class Xt{}Xt.ɵfac=function(e){return new(e||Xt)},Xt.ɵmod=Z.$C({type:Xt}),Xt.ɵinj=Z.G2t({imports:[s.iI.forChild(jt),s.iI]});class Vt{}Vt.ɵfac=function(e){return new(e||Vt)},Vt.ɵmod=Z.$C({type:Vt}),Vt.ɵinj=Z.G2t({imports:[Xt,u.G,d.T,v.B,m.K,h.t,g.GW,Ut,p.vG]});var Bt=t(95661),Nt=t(5326),Ot=t(2073),Pt=t(67582),Yt=t(83234),Wt=t(47696);const Lt=["imageEle"];function qt(e,i){1&e&&(Z.j41(0,"span",11),Z.EFF(1),Z.nI1(2,"i18n"),Z.k0s()),2&e&&(Z.R7$(),Z.SpI(" ",Z.bMT(2,1,"new")," "))}class Ht{constructor(e,i){this.themeStateService=e,this.systemTheme$=i,this.destroyed$=new w.B}ngAfterViewInit(){(0,S.z)([this.themeStateService.selectedTheme$,this.systemTheme$]).pipe((0,E.Q)(this.destroyed$)).subscribe((([e,i])=>{if(this.imageDarkMode)if(e===Pt.SV.System){const e=i===Pt.SV.Dark;this.imageEle.nativeElement.src=e?this.imageDarkMode:this.image}else e===Pt.SV.Dark?this.imageEle.nativeElement.src=this.imageDarkMode:this.imageEle.nativeElement.src=this.image}))}ngOnDestroy(){this.destroyed$.next(),this.destroyed$.complete()}showNewBadge(){if(!this.newBadgeExpiration)return!1;const e=new Date(this.newBadgeExpiration);return!isNaN(e.getTime())&&e>new Date}}function _t(e,i){if(1&e&&(Z.j41(0,"li",2),Z.nI1(1,"i18n"),Z.nI1(2,"i18n"),Z.nrm(3,"app-integration-card",3),Z.k0s()),2&e){const e=i.$implicit,t=Z.XpG();Z.Y8G("title",Z.i5U(1,8,t.tooltipI18nKey,e.name)),Z.BMQ("aria-label",Z.i5U(2,11,t.ariaI18nKey,e.name)),Z.R7$(3),Z.Y8G("name",e.name)("linkURL",e.linkURL)("image",e.image)("imageDarkMode",e.imageDarkMode)("externalURL",e.type===t.IntegrationType.SDK)("newBadgeExpiration",e.newBadgeExpiration)}}Ht.ɵfac=function(e){return new(e||Ht)(Z.rXU(Yt.oO),Z.rXU(Ot.eL))},Ht.ɵcmp=Z.VBU({type:Ht,selectors:[["app-integration-card"]],viewQuery:function(e,i){if(1&e&&Z.GBs(Lt,5),2&e){let e;Z.mGM(e=Z.lsd())&&(i.imageEle=e.first)}},inputs:{name:"name",image:"image",imageDarkMode:"imageDarkMode",linkURL:"linkURL",externalURL:"externalURL",newBadgeExpiration:"newBadgeExpiration"},decls:12,vars:4,consts:[["imageEle",""],[1,"tw-block","tw-h-full","tw-overflow-hidden","tw-rounded","tw-border","tw-border-solid","tw-border-secondary-600","tw-relative","tw-transition-all","hover:tw-scale-105","focus-within:tw-outline-none","focus-within:tw-ring","focus-within:tw-ring-primary-700","focus-within:tw-ring-offset-2"],[1,"tw-flex","tw-bg-secondary-100","tw-items-center","tw-justify-end","tw-pt-4","tw-pr-4"],[1,"bwi","bwi-external-link"],[1,"tw-flex","tw-h-32","tw-bg-secondary-100","tw-items-center","tw-justify-center","tw-pb-2","tw-px-6","lg:tw-pb-4","lg:tw-px-12"],[1,"tw-flex","tw-items-center","tw-justify-center","tw-size-28","lg:tw-w-40"],["alt","",1,"tw-block","tw-mx-auto","tw-h-auto","tw-max-w-full","tw-max-h-full",3,"src"],[1,"tw-p-5"],[1,"tw-text-main","tw-text-lg","tw-font-semibold"],["rel","noopener noreferrer","target","_blank",1,"tw-block","tw-mb-0","tw-font-bold","hover:tw-no-underline","focus:tw-outline-none","after:tw-content-['']","after:tw-block","after:tw-absolute","after:tw-size-full","after:tw-left-0","after:tw-top-0",3,"href"],["bitBadge","","class","tw-mt-3","variant","secondary",4,"ngIf"],["bitBadge","","variant","secondary",1,"tw-mt-3"]],template:function(e,i){1&e&&(Z.j41(0,"div",1)(1,"div",2),Z.nrm(2,"i",3),Z.k0s(),Z.j41(3,"div",4)(4,"div",5),Z.nrm(5,"img",6,0),Z.k0s()(),Z.j41(7,"div",7)(8,"h3",8),Z.EFF(9),Z.k0s(),Z.nrm(10,"a",9),Z.DNE(11,qt,3,3,"span",10),Z.k0s()()),2&e&&(Z.R7$(5),Z.Y8G("src",i.image,Z.B4B),Z.R7$(4),Z.JRh(i.name),Z.R7$(),Z.Y8G("href",i.linkURL,Z.B4B),Z.R7$(),Z.Y8G("ngIf",i.showNewBadge()))},dependencies:[u.G,le.bT,Wt.n,Oe.$],encapsulation:2});class Jt{constructor(){this.ariaI18nKey="integrationCardAriaLabel",this.tooltipI18nKey="integrationCardTooltip",this.IntegrationType=V.pq}}Jt.ɵfac=function(e){return new(e||Jt)},Jt.ɵcmp=Z.VBU({type:Jt,selectors:[["app-integration-grid"]],inputs:{integrations:"integrations",ariaI18nKey:"ariaI18nKey",tooltipI18nKey:"tooltipI18nKey"},decls:2,vars:1,consts:[[1,"tw-inline-grid","tw-grid-cols-3","tw-gap-6","tw-m-0","tw-p-0","tw-w-full","tw-auto-cols-auto","tw-list-none","lg:tw-grid-cols-4","lg:tw-gap-10","lg:tw-w-auto"],[3,"title",4,"ngFor","ngForOf"],[3,"title"],[3,"name","linkURL","image","imageDarkMode","externalURL","newBadgeExpiration"]],template:function(e,i){1&e&&(Z.j41(0,"ul",0),Z.DNE(1,_t,4,14,"li",1),Z.k0s()),2&e&&(Z.R7$(),Z.Y8G("ngForOf",i.integrations))},dependencies:[Ht,u.G,le.Sq,Oe.$],encapsulation:2});class Kt{transform(e,i){return e.filter((e=>e.type===i))}}Kt.ɵfac=function(e){return new(e||Kt)},Kt.ɵpipe=Z.EJ8({name:"filterIntegrations",type:Kt,pure:!0});var Qt=t(88516),Zt=t(49608),en=t(58806);function tn(e,i){if(1&e&&(Z.j41(0,"bit-tab",3),Z.nI1(1,"i18n"),Z.j41(2,"section",4)(3,"h2",5),Z.EFF(4),Z.nI1(5,"i18n"),Z.k0s(),Z.j41(6,"p",6),Z.EFF(7),Z.nI1(8,"i18n"),Z.j41(9,"a",8),Z.EFF(10),Z.nI1(11,"i18n"),Z.k0s(),Z.EFF(12),Z.nI1(13,"i18n"),Z.k0s(),Z.nrm(14,"app-integration-grid",7),Z.nI1(15,"filterIntegrations"),Z.k0s()()),2&e){const e=Z.XpG(2);Z.Y8G("label",Z.bMT(1,6,"singleSignOn")),Z.R7$(4),Z.JRh(Z.bMT(5,8,"singleSignOn")),Z.R7$(3),Z.SpI(" ",Z.bMT(8,10,"ssoDescStart")," "),Z.R7$(3),Z.JRh(Z.bMT(11,12,"singleSignOn")),Z.R7$(2),Z.SpI(" ",Z.bMT(13,14,"ssoDescEnd")," "),Z.R7$(2),Z.Y8G("integrations",Z.i5U(15,16,e.integrationsList,e.IntegrationType.SSO))}}function nn(e,i){if(1&e&&(Z.j41(0,"section",4)(1,"h2",5),Z.EFF(2),Z.nI1(3,"i18n"),Z.k0s(),Z.j41(4,"p",6),Z.EFF(5),Z.nI1(6,"i18n"),Z.j41(7,"a",10),Z.EFF(8),Z.nI1(9,"i18n"),Z.k0s(),Z.EFF(10),Z.nI1(11,"i18n"),Z.k0s(),Z.nrm(12,"app-integration-grid",7),Z.nI1(13,"filterIntegrations"),Z.k0s()),2&e){const e=Z.XpG(3);Z.R7$(2),Z.SpI(" ",Z.bMT(3,5,"scimIntegration")," "),Z.R7$(3),Z.SpI(" ",Z.bMT(6,7,"scimIntegrationDescStart")," "),Z.R7$(3),Z.JRh(Z.bMT(9,9,"scimIntegration")),Z.R7$(2),Z.SpI(" ",Z.bMT(11,11,"scimIntegrationDescEnd")," "),Z.R7$(2),Z.Y8G("integrations",Z.i5U(13,13,e.integrationsList,e.IntegrationType.SCIM))}}function on(e,i){if(1&e&&(Z.j41(0,"section",4)(1,"h2",5),Z.EFF(2),Z.nI1(3,"i18n"),Z.k0s(),Z.j41(4,"p",6),Z.EFF(5),Z.nI1(6,"i18n"),Z.k0s(),Z.nrm(7,"app-integration-grid",7),Z.nI1(8,"filterIntegrations"),Z.k0s()),2&e){const e=Z.XpG(3);Z.R7$(2),Z.SpI(" ",Z.bMT(3,3,"bwdc")," "),Z.R7$(3),Z.JRh(Z.bMT(6,5,"bwdcDesc")),Z.R7$(2),Z.Y8G("integrations",Z.i5U(8,7,e.integrationsList,e.IntegrationType.BWDC))}}function rn(e,i){if(1&e&&(Z.j41(0,"bit-tab",3),Z.nI1(1,"i18n"),Z.DNE(2,nn,14,16,"section",9)(3,on,9,10,"section",9),Z.k0s()),2&e){const e=Z.XpG().ngIf;Z.Y8G("label",Z.bMT(1,3,"userProvisioning")),Z.R7$(2),Z.Y8G("ngIf",e.useScim),Z.R7$(),Z.Y8G("ngIf",e.useDirectory)}}function sn(e,i){if(1&e&&(Z.j41(0,"bit-tab",3),Z.nI1(1,"i18n"),Z.j41(2,"section",4)(3,"h2",5),Z.EFF(4),Z.nI1(5,"i18n"),Z.k0s(),Z.j41(6,"p",6),Z.EFF(7),Z.nI1(8,"i18n"),Z.k0s(),Z.nrm(9,"app-integration-grid",7),Z.nI1(10,"filterIntegrations"),Z.k0s()()),2&e){const e=Z.XpG(2);Z.Y8G("label",Z.bMT(1,4,"eventManagement")),Z.R7$(4),Z.SpI(" ",Z.bMT(5,6,"eventManagement")," "),Z.R7$(3),Z.JRh(Z.bMT(8,8,"eventManagementDesc")),Z.R7$(2),Z.Y8G("integrations",Z.i5U(10,10,e.integrationsList,e.IntegrationType.EVENT))}}function an(e,i){if(1&e){const e=Z.RV6();Z.j41(0,"bit-tab-group",1),Z.mxI("selectedIndexChange",(function(i){Z.eBV(e);const t=Z.XpG();return Z.DH7(t.tabIndex,i)||(t.tabIndex=i),Z.Njj(i)})),Z.DNE(1,tn,16,19,"bit-tab",2)(2,rn,4,5,"bit-tab",2)(3,sn,11,13,"bit-tab",2),Z.j41(4,"bit-tab",3),Z.nI1(5,"i18n"),Z.j41(6,"section",4)(7,"h2",5),Z.EFF(8),Z.nI1(9,"i18n"),Z.k0s(),Z.j41(10,"p",6),Z.EFF(11),Z.nI1(12,"i18n"),Z.k0s(),Z.nrm(13,"app-integration-grid",7),Z.nI1(14,"filterIntegrations"),Z.k0s()()()}if(2&e){const e=i.ngIf,t=Z.XpG();Z.R50("selectedIndex",t.tabIndex),Z.R7$(),Z.Y8G("ngIf",e.useSso),Z.R7$(),Z.Y8G("ngIf",e.useScim||e.useDirectory),Z.R7$(),Z.Y8G("ngIf",e.useEvents),Z.R7$(),Z.Y8G("label",Z.bMT(5,8,"deviceManagement")),Z.R7$(4),Z.SpI(" ",Z.bMT(9,10,"deviceManagement")," "),Z.R7$(3),Z.JRh(Z.bMT(12,12,"deviceManagementDesc")),Z.R7$(2),Z.Y8G("integrations",Z.i5U(14,14,t.integrationsList,t.IntegrationType.DEVICE))}}class ln{ngOnInit(){this.organization$=this.route.params.pipe((0,$.n)((e=>this.accountService.activeAccount$.pipe((0,$.n)((i=>this.organizationService.organizations$(null==i?void 0:i.id).pipe((0,l.Sw)(e.organizationId))))))))}constructor(e,i,t){this.route=e,this.organizationService=i,this.accountService=t,this.integrationsList=[],this.integrationsList=[{name:"AD FS",linkURL:"https://bitwarden.com/help/saml-adfs/",image:"../../../../../../../images/integrations/azure-active-directory.svg",type:V.pq.SSO},{name:"Auth0",linkURL:"https://bitwarden.com/help/saml-auth0/",image:"../../../../../../../images/integrations/logo-auth0-badge-color.svg",type:V.pq.SSO},{name:"AWS",linkURL:"https://bitwarden.com/help/saml-aws/",image:"../../../../../../../images/integrations/aws-color.svg",imageDarkMode:"../../../../../../../images/integrations/aws-darkmode.svg",type:V.pq.SSO},{name:"Microsoft Entra ID",linkURL:"https://bitwarden.com/help/saml-azure/",image:"../../../../../../../images/integrations/logo-microsoft-entra-id-color.svg",type:V.pq.SSO},{name:"Duo",linkURL:"https://bitwarden.com/help/saml-duo/",image:"../../../../../../../images/integrations/logo-duo-color.svg",type:V.pq.SSO},{name:"Google",linkURL:"https://bitwarden.com/help/saml-google/",image:"../../../../../../../images/integrations/logo-google-badge-color.svg",type:V.pq.SSO},{name:"JumpCloud",linkURL:"https://bitwarden.com/help/saml-jumpcloud/",image:"../../../../../../../images/integrations/logo-jumpcloud-badge-color.svg",imageDarkMode:"../../../../../../../images/integrations/jumpcloud-darkmode.svg",type:V.pq.SSO},{name:"KeyCloak",linkURL:"https://bitwarden.com/help/saml-keycloak/",image:"../../../../../../../images/integrations/logo-keycloak-icon.svg",type:V.pq.SSO},{name:"Okta",linkURL:"https://bitwarden.com/help/saml-okta/",image:"../../../../../../../images/integrations/logo-okta-symbol-black.svg",imageDarkMode:"../../../../../../../images/integrations/okta-darkmode.svg",type:V.pq.SSO},{name:"OneLogin",linkURL:"https://bitwarden.com/help/saml-onelogin/",image:"../../../../../../../images/integrations/logo-onelogin-badge-color.svg",imageDarkMode:"../../../../../../../images/integrations/onelogin-darkmode.svg",type:V.pq.SSO},{name:"PingFederate",linkURL:"https://bitwarden.com/help/saml-pingfederate/",image:"../../../../../../../images/integrations/logo-ping-identity-badge-color.svg",type:V.pq.SSO},{name:"Microsoft Entra ID",linkURL:"https://bitwarden.com/help/microsoft-entra-id-scim-integration/",image:"../../../../../../../images/integrations/logo-microsoft-entra-id-color.svg",type:V.pq.SCIM},{name:"Okta",linkURL:"https://bitwarden.com/help/okta-scim-integration/",image:"../../../../../../../images/integrations/logo-okta-symbol-black.svg",imageDarkMode:"../../../../../../../images/integrations/okta-darkmode.svg",type:V.pq.SCIM},{name:"OneLogin",linkURL:"https://bitwarden.com/help/onelogin-scim-integration/",image:"../../../../../../../images/integrations/logo-onelogin-badge-color.svg",imageDarkMode:"../../../../../../../images/integrations/onelogin-darkmode.svg",type:V.pq.SCIM},{name:"JumpCloud",linkURL:"https://bitwarden.com/help/jumpcloud-scim-integration/",image:"../../../../../../../images/integrations/logo-jumpcloud-badge-color.svg",imageDarkMode:"../../../../../../../images/integrations/jumpcloud-darkmode.svg",type:V.pq.SCIM},{name:"Ping Identity",linkURL:"https://bitwarden.com/help/ping-identity-scim-integration/",image:"../../../../../../../images/integrations/logo-ping-identity-badge-color.svg",type:V.pq.SCIM},{name:"Active Directory",linkURL:"https://bitwarden.com/help/ldap-directory/",image:"../../../../../../../images/integrations/azure-active-directory.svg",type:V.pq.BWDC},{name:"Microsoft Entra ID",linkURL:"https://bitwarden.com/help/microsoft-entra-id/",image:"../../../../../../../images/integrations/logo-microsoft-entra-id-color.svg",type:V.pq.BWDC},{name:"Google Workspace",linkURL:"https://bitwarden.com/help/workspace-directory/",image:"../../../../../../../images/integrations/logo-google-badge-color.svg",type:V.pq.BWDC},{name:"Okta",linkURL:"https://bitwarden.com/help/okta-directory/",image:"../../../../../../../images/integrations/logo-okta-symbol-black.svg",imageDarkMode:"../../../../../../../images/integrations/okta-darkmode.svg",type:V.pq.BWDC},{name:"OneLogin",linkURL:"https://bitwarden.com/help/onelogin-directory/",image:"../../../../../../../images/integrations/logo-onelogin-badge-color.svg",imageDarkMode:"../../../../../../../images/integrations/onelogin-darkmode.svg",type:V.pq.BWDC},{name:"Splunk",linkURL:"https://bitwarden.com/help/splunk-siem/",image:"../../../../../../../images/integrations/logo-splunk-black.svg",imageDarkMode:"../../../../../../../images/integrations/splunk-darkmode.svg",type:V.pq.EVENT},{name:"Microsoft Sentinel",linkURL:"https://bitwarden.com/help/microsoft-sentinel-siem/",image:"../../../../../../../images/integrations/logo-microsoft-sentinel-color.svg",type:V.pq.EVENT},{name:"Rapid7",linkURL:"https://bitwarden.com/help/rapid7-siem/",image:"../../../../../../../images/integrations/logo-rapid7-black.svg",imageDarkMode:"../../../../../../../images/integrations/rapid7-darkmode.svg",type:V.pq.EVENT},{name:"Elastic",linkURL:"https://bitwarden.com/help/elastic-siem/",image:"../../../../../../../images/integrations/logo-elastic-badge-color.svg",type:V.pq.EVENT},{name:"Panther",linkURL:"https://bitwarden.com/help/panther-siem/",image:"../../../../../../../images/integrations/logo-panther-round-color.svg",type:V.pq.EVENT},{name:"Microsoft Intune",linkURL:"https://bitwarden.com/help/deploy-browser-extensions-with-intune/",image:"../../../../../../../images/integrations/logo-microsoft-intune-color.svg",type:V.pq.DEVICE}]}get IntegrationType(){return V.pq}}ln.ɵfac=function(e){return new(e||ln)(Z.rXU(oe.nX),Z.rXU(l.PV),Z.rXU(Ue.Di))},ln.ɵcmp=Z.VBU({type:ln,selectors:[["ac-integrations"]],decls:3,vars:3,consts:[[3,"selectedIndex","selectedIndexChange",4,"ngIf"],[3,"selectedIndexChange","selectedIndex"],[3,"label",4,"ngIf"],[3,"label"],[1,"tw-mb-9"],["bitTypography","h2"],["bitTypography","body1"],[3,"integrations"],["bitLink","","routerLink","../settings/sso",1,"tw-lowercase"],["class","tw-mb-9",4,"ngIf"],["bitLink","","routerLink","../settings/scim"]],template:function(e,i){1&e&&(Z.nrm(0,"app-header"),Z.DNE(1,an,15,17,"bit-tab-group",0),Z.nI1(2,"async")),2&e&&(Z.R7$(),Z.Y8G("ngIf",Z.bMT(2,1,i.organization$)))},dependencies:[u.G,le.bT,s.Wk,me.L,Qt.W,Zt.j,en.r,le.Jj,Oe.$,Nt.R,Jt,wi.G,Fi.f,Kt],encapsulation:2});var cn,dn,un=t(21367),hn=t(83731),pn=t(55542),gn=t(7861),mn=t(3892),vn=t(86226),fn=t(99917),bn=t(97553),wn=t(43759),In=function(e,i,t,n){return new(t||(t=Promise))((function(o,r){function s(e){try{l(n.next(e))}catch(i){r(i)}}function a(e){try{l(n.throw(e))}catch(i){r(i)}}function l(e){var i;e.done?o(e.value):(i=e.value,i instanceof t?i:new t((function(e){e(i)}))).then(s,a)}l((n=n.apply(e,i||[])).next())}))};function yn(e,i){if(1&e&&(Z.j41(0,"span",11),Z.EFF(1),Z.k0s()),2&e){const e=Z.XpG();Z.R7$(),Z.JRh(null==e.group?null:e.group.name)}}function Sn(e,i){1&e&&(Z.j41(0,"div"),Z.nrm(1,"i",12),Z.nI1(2,"i18n"),Z.j41(3,"span",13),Z.EFF(4),Z.nI1(5,"i18n"),Z.k0s()()),2&e&&(Z.R7$(),Z.FS9("title",Z.bMT(2,2,"loading")),Z.R7$(3),Z.JRh(Z.bMT(5,4,"loading")))}function Cn(e,i){1&e&&(Z.j41(0,"bit-form-field")(1,"bit-label"),Z.EFF(2),Z.nI1(3,"i18n"),Z.k0s(),Z.nrm(4,"input",19),Z.j41(5,"bit-hint"),Z.EFF(6),Z.nI1(7,"i18n"),Z.k0s()()),2&e&&(Z.R7$(2),Z.JRh(Z.bMT(3,2,"externalId")),Z.R7$(4),Z.JRh(Z.bMT(7,4,"externalIdDesc")))}function Tn(e,i){1&e&&(Z.j41(0,"span"),Z.EFF(1),Z.nI1(2,"i18n"),Z.k0s()),2&e&&(Z.R7$(),Z.SpI(" ",Z.bMT(2,1,"restrictedGroupAccessDesc")," "))}function kn(e,i){1&e&&(Z.j41(0,"span"),Z.EFF(1),Z.nI1(2,"i18n"),Z.k0s()),2&e&&(Z.R7$(),Z.SpI(" ",Z.bMT(2,1,"restrictedCollectionAssignmentDesc")," "))}function $n(e,i){if(1&e){const e=Z.RV6();Z.j41(0,"bit-tab-group",14),Z.mxI("selectedIndexChange",(function(i){Z.eBV(e);const t=Z.XpG();return Z.DH7(t.tabIndex,i)||(t.tabIndex=i),Z.Njj(i)})),Z.j41(1,"bit-tab",15),Z.nI1(2,"i18n"),Z.j41(3,"bit-form-field")(4,"bit-label"),Z.EFF(5),Z.nI1(6,"i18n"),Z.k0s(),Z.nrm(7,"input",16),Z.j41(8,"bit-hint"),Z.EFF(9),Z.nI1(10,"i18n"),Z.k0s()(),Z.DNE(11,Cn,8,6,"bit-form-field",5),Z.k0s(),Z.j41(12,"bit-tab",15),Z.nI1(13,"i18n"),Z.j41(14,"p"),Z.EFF(15),Z.nI1(16,"i18n"),Z.DNE(17,Tn,3,3,"span",5),Z.nI1(18,"async"),Z.k0s(),Z.nrm(19,"bit-access-selector",17),Z.nI1(20,"i18n"),Z.nI1(21,"i18n"),Z.nI1(22,"i18n"),Z.k0s(),Z.j41(23,"bit-tab",15),Z.nI1(24,"i18n"),Z.j41(25,"p"),Z.EFF(26),Z.nI1(27,"i18n"),Z.DNE(28,kn,3,3,"span",5),Z.nI1(29,"async"),Z.k0s(),Z.nrm(30,"bit-access-selector",18),Z.nI1(31,"i18n"),Z.nI1(32,"i18n"),Z.nI1(33,"i18n"),Z.k0s()()}if(2&e){const e=Z.XpG();Z.R50("selectedIndex",e.tabIndex),Z.R7$(),Z.FS9("label",Z.bMT(2,22,"groupInfo")),Z.R7$(4),Z.JRh(Z.bMT(6,24,"name")),Z.R7$(4),Z.JRh(Z.i5U(10,26,"characterMaximum",100)),Z.R7$(2),Z.Y8G("ngIf",e.isExternalIdVisible),Z.R7$(),Z.FS9("label",Z.bMT(13,29,"members")),Z.R7$(3),Z.SpI(" ",Z.bMT(16,31,"editGroupMembersDesc")," "),Z.R7$(2),Z.Y8G("ngIf",Z.bMT(18,33,e.cannotAddSelfToGroup$)),Z.R7$(2),Z.Y8G("items",e.members)("showMemberRoles",!0)("permissionMode",e.PermissionMode.Hidden)("columnHeader",Z.bMT(20,35,"member"))("selectorLabelText",Z.bMT(21,37,"selectMembers"))("emptySelectionText",Z.bMT(22,39,"noMembersAdded")),Z.R7$(4),Z.FS9("label",Z.bMT(24,41,"collections")),Z.R7$(3),Z.SpI(" ",Z.bMT(27,43,"editGroupCollectionsDesc")," "),Z.R7$(2),Z.Y8G("ngIf",!Z.bMT(29,45,e.canAssignAccessToAnyCollection$)),Z.R7$(2),Z.Y8G("items",e.collections)("permissionMode",e.PermissionMode.Edit)("columnHeader",Z.bMT(31,47,"collection"))("selectorLabelText",Z.bMT(32,49,"selectCollections"))("emptySelectionText",Z.bMT(33,51,"noCollectionsAdded"))}}!function(e){e[e.Info=0]="Info",e[e.Members=1]="Members",e[e.Collections=2]="Collections"}(cn||(cn={})),function(e){e.Saved="saved",e.Canceled="canceled",e.Deleted="deleted"}(dn||(dn={}));class Rn{get groupId(){return this.params.groupId}get organizationId(){return this.params.organizationId}get isExternalIdVisible(){var e;return!!(null===(e=this.groupForm.get("externalId"))||void 0===e?void 0:e.value)}get editMode(){return null!=this.groupId}get orgMembers$(){return(0,I.H)(this.organizationUserApiService.getAllMiniUserDetails(this.organizationId)).pipe((0,k.T)((e=>e.data.map((e=>{var i;return{id:e.id,type:Ge.Uv.Member,email:e.email,role:e.type,listName:(null===(i=e.name)||void 0===i?void 0:i.length)>0?`${e.name} (${e.email})`:e.email,labelName:e.name||e.email,status:e.status,userId:e.userId}})))))}constructor(e,i,t,n,o,r,s,a,c,d,u,h,p,g,m,v){var f;this.params=e,this.dialogRef=i,this.apiService=t,this.organizationUserApiService=n,this.groupService=o,this.i18nService=r,this.platformUtilsService=s,this.logService=a,this.formBuilder=c,this.changeDetectorRef=d,this.dialogService=u,this.organizationService=h,this.accountService=p,this.collectionAdminService=g,this.toastService=m,this.configService=v,this.organization$=this.accountService.activeAccount$.pipe((0,$.n)((e=>this.organizationService.organizations$(null==e?void 0:e.id).pipe((0,l.Sw)(this.organizationId)).pipe((0,D.t)({refCount:!0}))))),this.PermissionMode=Ge.ZC,this.ResultType=dn,this.loading=!0,this.collections=[],this.members=[],this.groupForm=this.formBuilder.group({name:["",[Ae.k0.required,Ae.k0.maxLength(100)]],externalId:this.formBuilder.control({value:"",disabled:!0}),members:[[]],collections:[[]]}),this.destroy$=new w.B,this.orgCollections$=(0,I.H)(this.collectionAdminService.getAll(this.organizationId)).pipe((0,D.t)({refCount:!0,bufferSize:1})),this.groupDetails$=(0,C.of)(this.editMode).pipe((0,A.H)((e=>e?(0,S.z)([this.groupService.get(this.organizationId,this.groupId),this.apiService.getGroupUsers(this.organizationId,this.groupId)]).pipe((0,k.T)((([e,i])=>Object.assign(Object.assign({},e),{members:i}))),(0,U.W)((e=>(e instanceof gn._?this.logService.error(e.message):this.logService.error(e.toString()),(0,C.of)(void 0))))):(0,C.of)(void 0))),(0,D.t)({refCount:!0,bufferSize:1})),this.allowAdminAccessToAllCollectionItems$=this.organization$.pipe((0,k.T)((e=>e.allowAdminAccessToAllCollectionItems))),this.canAssignAccessToAnyCollection$=(0,S.z)([this.organization$,this.allowAdminAccessToAllCollectionItems$]).pipe((0,k.T)((([e,i])=>e.canEditAnyCollection||e.permissions.manageGroups&&i))),this.cannotAddSelfToGroup$=(0,S.z)([this.allowAdminAccessToAllCollectionItems$,this.groupDetails$]).pipe((0,k.T)((([e,i])=>!e&&null!=i))),this.submit=()=>In(this,void 0,void 0,(function*(){var e,i;if(this.groupForm.markAllAsTouched(),this.groupForm.invalid)return void(this.tabIndex!==cn.Info&&this.toastService.showToast({variant:"error",title:null,message:this.i18nService.t("fieldOnTabRequiresAttention",this.i18nService.t("groupInfo"))}));const t=this.groupForm.value,n={id:this.groupId,organizationId:this.organizationId,name:t.name,members:null!==(i=null===(e=t.members)||void 0===e?void 0:e.map((e=>e.id)))&&void 0!==i?i:[],collections:t.collections.map((e=>(0,Ge.yo)(e))),externalId:t.externalId};yield this.groupService.save(n),this.toastService.showToast({variant:"success",title:null,message:this.i18nService.t(this.editMode?"editedGroupId":"createdGroupId",t.name)}),this.dialogRef.close(dn.Saved)})),this.delete=()=>In(this,void 0,void 0,(function*(){if(!this.editMode)return;if(!(yield this.dialogService.openSimpleDialog({title:this.group.name,content:{key:"deleteGroupConfirmation"},type:"warning"})))return!1;yield this.groupService.delete(this.organizationId,this.groupId),this.toastService.showToast({variant:"success",title:null,message:this.i18nService.t("deletedGroupId",this.group.name)}),this.dialogRef.close(dn.Deleted)})),this.tabIndex=null!==(f=e.initialTab)&&void 0!==f?f:cn.Info}ngOnInit(){this.loading=!0,this.title=this.i18nService.t(this.editMode?"editGroup":"newGroup"),(0,S.z)([this.orgCollections$,this.orgMembers$,this.groupDetails$,this.cannotAddSelfToGroup$,this.accountService.activeAccount$,this.organization$]).pipe((0,E.Q)(this.destroy$)).subscribe((([e,i,t,n,o,r])=>{var s;if(this.members=i,this.group=t,this.collections=function(e,i,t){return e.map((e=>{var n;const o=null!==(n=null==t?void 0:t.collections.find((i=>i.id==e.id)))&&void 0!==n?n:void 0;return{id:e.id,type:Ge.Uv.Collection,labelName:e.name,listName:e.name,readonly:!e.canEditGroupAccess(i),readonlyPermission:o?(0,Ge.Jh)(o):void 0}})).filter((e=>!e.readonly||(null==t?void 0:t.collections.some((i=>i.id==e.id)))))}(e,r,t),null!=this.group&&(this.changeDetectorRef.detectChanges(),this.groupForm.patchValue({name:this.group.name,externalId:this.group.externalId,members:this.group.members.map((e=>({id:e,type:Ge.Uv.Member}))),collections:Fn(t,this.collections)})),n){const e=null===(s=this.members.find((e=>e.userId===o.id)))||void 0===s?void 0:s.id,i=this.groupForm.value.members.some((i=>i.id===e));null==e||i||(this.members=this.members.filter((i=>i.id!==e)))}this.loading=!1}))}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}}function Fn(e,i){return e.collections.filter((e=>!i.find((i=>i.id==e.id)).readonly)).map((e=>({id:e.id,type:Ge.Uv.Collection,permission:(0,Ge.Jh)(e)})))}Rn.ɵfac=function(e){return new(e||Rn)(Z.rXU(De.Qs),Z.rXU(ee.ce),Z.rXU(Zi.G),Z.rXU(x.uB),Z.rXU(r.EB),Z.rXU(ie.W),Z.rXU(xe.y),Z.rXU(Ji.K),Z.rXU(Ae.ok),Z.rXU(Z.gRc),Z.rXU(ee.o3),Z.rXU(l.PV),Z.rXU(Ue.Di),Z.rXU(x.vE),Z.rXU(ze.f),Z.rXU(et.w))},Rn.ɵcmp=Z.VBU({type:Rn,selectors:[["app-group-add-edit"]],standalone:!1,decls:17,vars:18,consts:[[3,"formGroup","bitSubmit"],["dialogSize","large",3,"disablePadding"],["bitDialogTitle",""],["class","tw-text-sm tw-normal-case tw-text-muted",4,"ngIf"],["bitDialogContent",""],[4,"ngIf"],[3,"selectedIndex","selectedIndexChange",4,"ngIf"],["bitDialogFooter",""],["bitButton","","buttonType","primary","bitFormButton","","type","submit"],["bitButton","","buttonType","secondary","type","button",3,"bitDialogClose"],["type","button","buttonType","danger","bitIconButton","bwi-trash","bitFormButton","",1,"tw-ml-auto",3,"bitAction","appA11yTitle"],[1,"tw-text-sm","tw-normal-case","tw-text-muted"],["aria-hidden","true",1,"bwi","bwi-spinner","bwi-spin","tw-text-muted",3,"title"],[1,"tw-sr-only"],[3,"selectedIndexChange","selectedIndex"],[3,"label"],["bitInput","","appAutofocus","","type","text","formControlName","name"],["formControlName","members",3,"items","showMemberRoles","permissionMode","columnHeader","selectorLabelText","emptySelectionText"],["formControlName","collections",3,"items","permissionMode","columnHeader","selectorLabelText","emptySelectionText"],["bitInput","","type","text","formControlName","externalId"]],template:function(e,i){1&e&&(Z.j41(0,"form",0)(1,"bit-dialog",1)(2,"span",2),Z.EFF(3),Z.DNE(4,yn,2,1,"span",3),Z.k0s(),Z.j41(5,"div",4),Z.DNE(6,Sn,6,6,"div",5)(7,$n,34,53,"bit-tab-group",6),Z.k0s(),Z.qex(8,7),Z.j41(9,"button",8),Z.EFF(10),Z.nI1(11,"i18n"),Z.k0s(),Z.j41(12,"button",9),Z.EFF(13),Z.nI1(14,"i18n"),Z.k0s(),Z.nrm(15,"button",10),Z.nI1(16,"i18n"),Z.bVm(),Z.k0s()()),2&e&&(Z.Y8G("formGroup",i.groupForm)("bitSubmit",i.submit),Z.R7$(),Z.Y8G("disablePadding",!i.loading),Z.R7$(2),Z.SpI(" ",i.title," "),Z.R7$(),Z.Y8G("ngIf",i.editMode),Z.R7$(2),Z.Y8G("ngIf",i.loading),Z.R7$(),Z.Y8G("ngIf",!i.loading),Z.R7$(3),Z.SpI(" ",Z.bMT(11,12,"save")," "),Z.R7$(2),Z.Y8G("bitDialogClose",i.ResultType.Canceled),Z.R7$(),Z.SpI(" ",Z.bMT(14,14,"cancel")," "),Z.R7$(2),Z.Y8G("bitAction",i.delete)("appA11yTitle",Z.bMT(16,16,"delete")))},dependencies:[le.bT,Ae.qT,Ae.me,Ae.BC,Ae.cb,Ae.j4,Ae.JD,Ti.C,rt.B,mn.p,je.$,Xe.L,Ve.Q,Be.I,Ne.m,vn.m,fn.s,bn.J,wn.h,ki.s,Qt.W,Zt.j,Pe.t,le.Jj,Oe.$],encapsulation:2});var Mn=t(94438),En=t(50352),Dn=t(38410),Gn=t(22466),zn=t(32316),An=t(36572),Un=t(69672),xn=function(e,i,t,n){return new(t||(t=Promise))((function(o,r){function s(e){try{l(n.next(e))}catch(i){r(i)}}function a(e){try{l(n.throw(e))}catch(i){r(i)}}function l(e){var i;e.done?o(e.value):(i=e.value,i instanceof t?i:new t((function(e){e(i)}))).then(s,a)}l((n=n.apply(e,i||[])).next())}))};function jn(e,i){1&e&&(Z.qex(0),Z.nrm(1,"i",6),Z.nI1(2,"i18n"),Z.j41(3,"span",7),Z.EFF(4),Z.nI1(5,"i18n"),Z.k0s(),Z.bVm()),2&e&&(Z.R7$(),Z.FS9("title",Z.bMT(2,2,"loading")),Z.R7$(3),Z.JRh(Z.bMT(5,4,"loading")))}function Xn(e,i){1&e&&(Z.j41(0,"p"),Z.EFF(1),Z.nI1(2,"i18n"),Z.k0s()),2&e&&(Z.R7$(),Z.JRh(Z.bMT(2,1,"noGroupsInList")))}function Vn(e,i){if(1&e){const e=Z.RV6();Z.j41(0,"tr",24)(1,"td",25),Z.bIt("click",(function(){const i=Z.eBV(e).$implicit,t=Z.XpG(4);return Z.Njj(t.check(i))})),Z.j41(2,"input",26),Z.mxI("ngModelChange",(function(i){const t=Z.eBV(e).$implicit;return Z.DH7(t.checked,i)||(t.checked=i),Z.Njj(i)})),Z.k0s()(),Z.j41(3,"td",27),Z.bIt("click",(function(){const i=Z.eBV(e).$implicit,t=Z.XpG(4);return Z.Njj(t.edit(i))})),Z.j41(4,"button",28),Z.EFF(5),Z.k0s()(),Z.j41(6,"td",25),Z.bIt("click",(function(){const i=Z.eBV(e).$implicit,t=Z.XpG(4);return Z.Njj(t.edit(i,t.ModalTabType.Collections))})),Z.nrm(7,"bit-badge-list",29),Z.k0s(),Z.j41(8,"td",16),Z.nrm(9,"button",18),Z.nI1(10,"i18n"),Z.j41(11,"bit-menu",null,1)(13,"button",19),Z.bIt("click",(function(){const i=Z.eBV(e).$implicit,t=Z.XpG(4);return Z.Njj(t.edit(i))})),Z.nrm(14,"i",30),Z.EFF(15),Z.nI1(16,"i18n"),Z.k0s(),Z.j41(17,"button",19),Z.bIt("click",(function(){const i=Z.eBV(e).$implicit,t=Z.XpG(4);return Z.Njj(t.edit(i,t.ModalTabType.Members))})),Z.nrm(18,"i",31),Z.EFF(19),Z.nI1(20,"i18n"),Z.k0s(),Z.j41(21,"button",19),Z.bIt("click",(function(){const i=Z.eBV(e).$implicit,t=Z.XpG(4);return Z.Njj(t.edit(i,t.ModalTabType.Collections))})),Z.nrm(22,"i",32),Z.EFF(23),Z.nI1(24,"i18n"),Z.k0s(),Z.j41(25,"button",19),Z.bIt("click",(function(){const i=Z.eBV(e).$implicit,t=Z.XpG(4);return Z.Njj(t.delete(i))})),Z.j41(26,"span",20),Z.nrm(27,"i",21),Z.EFF(28),Z.nI1(29,"i18n"),Z.k0s()()()()()}if(2&e){const e=i.$implicit,t=Z.sdS(12),n=Z.XpG(4);Z.Y8G("ngClass",n.rowHeightClass),Z.R7$(2),Z.R50("ngModel",e.checked),Z.R7$(3),Z.SpI(" ",e.details.name," "),Z.R7$(2),Z.Y8G("items",e.collectionNames)("maxItems",3),Z.R7$(2),Z.FS9("appA11yTitle",Z.bMT(10,11,"options")),Z.Y8G("bitMenuTriggerFor",t),Z.R7$(6),Z.SpI(" ",Z.bMT(16,13,"editInfo")," "),Z.R7$(4),Z.SpI(" ",Z.bMT(20,15,"members")," "),Z.R7$(4),Z.SpI(" ",Z.bMT(24,17,"collections")," "),Z.R7$(5),Z.SpI(" ",Z.bMT(29,19,"delete"),"")}}function Bn(e,i){if(1&e&&Z.DNE(0,Vn,30,21,"tr",23),2&e){const e=i.$implicit;Z.Y8G("cdkVirtualForOf",e)}}function Nn(e,i){if(1&e){const e=Z.RV6();Z.j41(0,"bit-table",10),Z.qex(1,11),Z.j41(2,"tr")(3,"th",12)(4,"input",13),Z.bIt("change",(function(i){Z.eBV(e);const t=Z.XpG(2);return Z.Njj(t.toggleAllVisible(i))})),Z.k0s(),Z.j41(5,"label",14),Z.EFF(6),Z.nI1(7,"i18n"),Z.k0s()(),Z.j41(8,"th",15),Z.EFF(9),Z.nI1(10,"i18n"),Z.k0s(),Z.j41(11,"th",16),Z.EFF(12),Z.nI1(13,"i18n"),Z.k0s(),Z.j41(14,"th",17),Z.nrm(15,"button",18),Z.nI1(16,"i18n"),Z.j41(17,"bit-menu",null,0)(19,"button",19),Z.bIt("click",(function(){Z.eBV(e);const i=Z.XpG(2);return Z.Njj(i.deleteAllSelected())})),Z.j41(20,"span",20),Z.nrm(21,"i",21),Z.EFF(22),Z.nI1(23,"i18n"),Z.k0s()()()()(),Z.bVm(),Z.DNE(24,Bn,1,1,"ng-template",22),Z.k0s()}if(2&e){const e=Z.sdS(18),i=Z.XpG(2);Z.Y8G("dataSource",i.dataSource),Z.R7$(6),Z.JRh(Z.bMT(7,7,"all")),Z.R7$(3),Z.JRh(Z.bMT(10,9,"name")),Z.R7$(3),Z.JRh(Z.bMT(13,11,"collections")),Z.R7$(3),Z.FS9("appA11yTitle",Z.bMT(16,13,"options")),Z.Y8G("bitMenuTriggerFor",e),Z.R7$(7),Z.SpI(" ",Z.bMT(23,15,"delete"),"")}}function On(e,i){if(1&e&&(Z.qex(0),Z.DNE(1,Xn,3,3,"p",5),Z.j41(2,"cdk-virtual-scroll-viewport",8),Z.DNE(3,Nn,25,17,"bit-table",9),Z.k0s(),Z.bVm()),2&e){const e=Z.XpG();Z.R7$(),Z.Y8G("ngIf",!e.dataSource.filteredData.length),Z.R7$(),Z.Y8G("itemSize",e.rowHeight),Z.R7$(),Z.Y8G("ngIf",e.dataSource.filteredData.length)}}class Pn{constructor(e,i,t,n,o,r,s,a){this.apiService=e,this.groupService=i,this.route=t,this.i18nService=n,this.dialogService=o,this.logService=r,this.collectionService=s,this.toastService=a,this.loading=!0,this.dataSource=new pn.s,this.searchControl=new Ae.MJ(""),this.rowHeight=52,this.rowHeightClass="tw-h-[52px]",this.ModalTabType=cn,this.refreshGroups$=new b.t(null),this.route.params.pipe((0,F.M)((e=>this.organizationId=e.organizationId)),(0,$.n)((()=>(0,S.z)([(0,I.H)(this.apiService.getCollections(this.organizationId)).pipe((0,A.H)((e=>this.toCollectionMap(e)))),this.refreshGroups$.pipe((0,$.n)((()=>this.groupService.getAllDetails(this.organizationId))))]))),(0,k.T)((([e,i])=>i.map((i=>{var t;return{id:i.id,name:i.name,details:i,checked:!1,collectionNames:i.collections.map((i=>{var t;return null===(t=e[i.id])||void 0===t?void 0:t.name})).sort(null===(t=this.i18nService.collator)||void 0===t?void 0:t.compare)}})))),(0,hn.pQ)()).subscribe((e=>{this.dataSource.data=e,this.loading=!1})),this.searchControl.valueChanges.pipe((0,z.B)(200),(0,hn.pQ)()).subscribe((e=>this.dataSource.filter=(e=>{null!=e||(e="");const i=e.trim().toLowerCase();return e=>{const t=e.details;return-1!=t.id.toLowerCase().indexOf(i)||-1!=t.name.toLowerCase().indexOf(i)}})(e))),this.route.queryParams.pipe((0,G.$)(),(0,hn.pQ)()).subscribe((e=>{this.searchControl.setValue(e.search)}))}edit(e){return xn(this,arguments,void 0,(function*(e,i=cn.Info){const t=(n=this.dialogService,o={data:{initialTab:i,organizationId:this.organizationId,groupId:null!=e?e.details.id:null}},n.open(Rn,o));var n,o;const r=yield(0,T.s)(t.closed);r==dn.Saved?this.refreshGroups$.next():r==dn.Deleted&&this.removeGroup(e)}))}add(){return xn(this,void 0,void 0,(function*(){yield this.edit(null)}))}delete(e){return xn(this,void 0,void 0,(function*(){if(!(yield this.dialogService.openSimpleDialog({title:e.details.name,content:{key:"deleteGroupConfirmation"},type:"warning"})))return!1;try{yield this.groupService.delete(this.organizationId,e.details.id),this.toastService.showToast({variant:"success",title:null,message:this.i18nService.t("deletedGroupId",e.details.name)}),this.removeGroup(e)}catch(i){this.logService.error(i)}}))}deleteAllSelected(){return xn(this,void 0,void 0,(function*(){const e=this.dataSource.data.filter((e=>e.checked));if(0==e.length)return;const i=e.map((e=>e.details.name)).join(", ");if(!(yield this.dialogService.openSimpleDialog({title:{key:"deleteMultipleGroupsConfirmation",placeholders:[e.length.toString()]},content:i,type:"warning"})))return!1;try{yield this.groupService.deleteMany(this.organizationId,e.map((e=>e.details.id))),this.toastService.showToast({variant:"success",title:null,message:this.i18nService.t("deletedManyGroups",e.length.toString())}),e.forEach((e=>this.removeGroup(e)))}catch(t){this.logService.error(t)}}))}check(e){e.checked=!e.checked}toggleAllVisible(e){this.dataSource.filteredData.forEach((i=>i.checked=e.target.checked))}removeGroup(e){this.dataSource.data=this.dataSource.data.filter((i=>i!==e))}toCollectionMap(e){return xn(this,void 0,void 0,(function*(){const i=e.data.map((e=>new x.pM(new x.Fw(e)))),t=yield this.collectionService.decryptMany(i),n={};return t.forEach((e=>n[e.id]=e)),n}))}}Pn.ɵfac=function(e){return new(e||Pn)(Z.rXU(Zi.G),Z.rXU(r.EB),Z.rXU(oe.nX),Z.rXU(ie.W),Z.rXU(ee.o3),Z.rXU(Ji.K),Z.rXU(x.YD),Z.rXU(ze.f))},Pn.ɵcmp=Z.VBU({type:Pn,selectors:[["ng-component"]],standalone:!1,decls:9,vars:9,consts:[["headerMenu",""],["rowMenu",""],[1,"tw-w-80",3,"placeholder","formControl"],["bitButton","","type","button","buttonType","primary",3,"click"],["aria-hidden","true",1,"bwi","bwi-plus","bwi-fw"],[4,"ngIf"],["aria-hidden","true",1,"bwi","bwi-spinner","bwi-spin","tw-text-muted",3,"title"],[1,"tw-sr-only"],["bitScrollLayout","",1,"tw-pb-8",3,"itemSize"],[3,"dataSource",4,"ngIf"],[3,"dataSource"],["header",""],["bitCell","",1,"tw-w-20"],["type","checkbox","bitCheckbox","","id","selectAll",1,"tw-mr-2",3,"change"],["for","selectAll",1,"tw-mb-0","!tw-font-bold","!tw-text-muted"],["bitCell","","bitSortable","name","default",""],["bitCell",""],["bitCell","",1,"tw-w-10"],["type","button","bitIconButton","bwi-ellipsis-v","size","small",3,"bitMenuTriggerFor","appA11yTitle"],["type","button","bitMenuItem","",3,"click"],[1,"tw-text-danger"],["aria-hidden","true",1,"bwi","bwi-trash"],["body",""],["bitRow","",3,"ngClass",4,"cdkVirtualFor","cdkVirtualForOf"],["bitRow","",3,"ngClass"],["bitCell","",1,"tw-cursor-pointer",3,"click"],["type","checkbox","bitCheckbox","",3,"ngModelChange","ngModel"],["bitCell","",1,"tw-cursor-pointer","tw-font-bold",3,"click"],["type","button","bitLink",""],["variant","secondary",3,"items","maxItems"],["aria-hidden","true",1,"bwi","bwi-pencil-square"],["aria-hidden","true",1,"bwi","bwi-user"],["aria-hidden","true",1,"bwi","bwi-collection-shared"]],template:function(e,i){1&e&&(Z.j41(0,"app-header"),Z.nrm(1,"bit-search",2),Z.nI1(2,"i18n"),Z.j41(3,"button",3),Z.bIt("click",(function(){return i.add()})),Z.nrm(4,"i",4),Z.EFF(5),Z.nI1(6,"i18n"),Z.k0s()(),Z.DNE(7,jn,6,6,"ng-container",5)(8,On,4,3,"ng-container",5)),2&e&&(Z.R7$(),Z.Y8G("placeholder",Z.bMT(2,5,"searchGroups"))("formControl",i.searchControl),Z.R7$(4),Z.SpI(" ",Z.bMT(6,7,"newGroup")," "),Z.R7$(2),Z.Y8G("ngIf",i.loading),Z.R7$(),Z.Y8G("ngIf",!i.loading))},dependencies:[le.YU,le.bT,Ae.Zm,Ae.BC,Ae.vS,Ae.l_,Ti.C,Mn.p,Ve.Q,En.P,ki.s,me.o,Ii.Z,yi.O,Si.w,Dn.Q,Gn.Y,zn.O,An._,An.O,Mi.S,Fi.f,n.yg,n.E$,n.d6,Un.lp,Oe.$],encapsulation:2});const Yn=[{path:":organizationId",component:un.d,canActivate:[(0,c.i)(),a.W_,(0,f.V)(l.OV)],children:[{path:"",pathMatch:"full",canActivate:[(0,Bt.r)((function(e){if((0,l.of)(e))return"vault";if((0,l.pe)(e))return"members";if((0,l.ex)(e))return"groups";if((0,l.Ue)(e))return"reporting";if((0,l.Dl)(e))return"settings";return}))],children:[]},{path:"vault",loadChildren:()=>Vt},{path:"integrations",canActivate:[(0,f.V)((function(e){return e.canAccessIntegrations}))],component:ln,data:{titleId:"integrations"}},{path:"settings",loadChildren:()=>t.e(64).then(t.bind(t,40064)).then((e=>e.OrganizationSettingsModule))},{path:"members",loadChildren:()=>t.e(703).then(t.bind(t,58703)).then((e=>e.MembersModule))},{component:Pn,path:"groups",canActivate:[(0,f.V)(l.ex)],data:{titleId:"groups"}},{path:"reporting",loadChildren:()=>t.e(449).then(t.bind(t,14449)).then((e=>e.OrganizationReportingModule))},{path:"billing",loadChildren:()=>Promise.all([t.e(281),t.e(982)]).then(t.bind(t,77601)).then((e=>e.OrganizationBillingModule))}]}];class Wn{}Wn.ɵfac=function(e){return new(e||Wn)},Wn.ɵmod=Z.$C({type:Wn}),Wn.ɵinj=Z.G2t({imports:[s.iI.forChild(Yn),s.iI]});class Ln{}Ln.ɵfac=function(e){return new(e||Ln)},Ln.ɵmod=Z.$C({type:Ln}),Ln.ɵinj=Z.G2t({imports:[Nt.R,Ge.mH,r.Je,Wn,o.T,n.E9]})},95661:(e,i,t)=>{t.d(i,{r:()=>d});var n=t(3867),o=t(64195),r=t(72245),s=t(3204),a=t(67553),l=t(35500),c=function(e,i,t,n){return new(t||(t=Promise))((function(o,r){function s(e){try{l(n.next(e))}catch(i){r(i)}}function a(e){try{l(n.throw(e))}catch(i){r(i)}}function l(e){var i;e.done?o(e.value):(i=e.value,i instanceof t?i:new t((function(e){e(i)}))).then(s,a)}l((n=n.apply(e,i||[])).next())}))};function d(e){return(i,t)=>c(this,void 0,void 0,(function*(){const c=(0,n.WQX)(o.Ix),d=(0,n.WQX)(a.PV),u=(0,n.WQX)(l.Di),h=yield(0,r._)(u.activeAccount$.pipe((0,s.T)((e=>null==e?void 0:e.id))));if(!h)return c.createUrlTree(["/"]);const p=yield(0,r._)(d.organizations$(h).pipe((0,s.T)((e=>e.find((e=>e.id===i.params.organizationId))))));if(!p)return c.createUrlTree(["/"]);if(null!=e){let i=e(p);return"string"==typeof i&&(i=[i]),c.createUrlTree([t.url,...i])}return null!=p&&(0,a.OV)(p)?c.createUrlTree(["/organizations",p.id]):c.createUrlTree(["/"])}))}},97319:(e,i,t)=>{t.d(i,{g:()=>n});class n{constructor(e){this.message=e.message,this.humanReadableMessage=e.humanReadableMessage,this.appIcon=e.appIcon,this.appName=e.appName,this.userId=e.userId,this.userName=e.userName,this.userEmail=e.userEmail,this.date=e.date,this.ip=e.ip,this.type=e.type,this.installationId=e.installationId,this.systemUser=e.systemUser,this.serviceAccountId=e.serviceAccountId}}}}]);
//# sourceMappingURL=621.56607f39031e4be2c135.js.map