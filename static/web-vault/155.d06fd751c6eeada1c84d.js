"use strict";(self.webpackChunk_bitwarden_web_vault=self.webpackChunk_bitwarden_web_vault||[]).push([[155],{5326:(e,t,i)=>{i.d(t,{R:()=>a});var n=i(60893),o=i(62963),s=i(97434),r=i(33812),l=i(74208);class a{}a.ɵfac=function(e){return new(e||a)},a.ɵmod=r.$C({type:a}),a.ɵinj=l.G2t({imports:[o.G,s.m,n.t,o.G,s.m,n.t]})},38766:(e,t,i)=>{i.d(t,{Jh:()=>s.Jh,NU:()=>s.NU,Uv:()=>s.Uv,ZC:()=>n.Z,df:()=>s.df,mH:()=>o.m,yo:()=>s.yo});var n=i(43184),o=i(97434),s=i(45980)},47155:(e,t,i)=>{i.d(t,{OrganizationModule:()=>To});var n,o=i(94251),s=i(17197),r=i(72932),l=i(81667),a=i(6056),c=i(2780),d=i(67553),u=i(63629),h=i(62963),p=i(14092),g=i(2195),m=i(86561),v=i(79303),f=i(77259),b=i(83731),I=i(16878),y=i(93695),w=i(66046),S=i(72245),$=i(33338),C=i(83892),T=i(88507),M=i(88565),x=i(3204),G=i(69194),z=i(34040),R=i(44500),F=i(27442),A=i(73276),k=i(14803),j=i(12610),U=i(58363),E=i(14928),X=i(75811),D=i(36006),V=i(28202),B=i(34530),N=i(78510),Y=i(3633),q=i(11573),P=i(56962),O=i(83516),_=i(15639),H=i(78781),W=i(49272),L=i(36501),Q=i(23567),J=i(66983),Z=i(61325),K=i(90097),ee=i(59525),te=i(22166),ie=i(1094),ne=i(27760),oe=i(85523),se=i(25065),re=i(85494),le=i(24593),ae=i(93817),ce=i(9083),de=i(39738),ue=i(8144),he=i(47911),pe=i(30550),ge=i(51122),me=i(62819),ve=i(76876),fe=i(81525),be=i(38766),Ie=i(33812),ye=i(21274),we=i(69855),Se=i(51757),$e=i(35500),Ce=i(37115),Te=i(50700),Me=i(77468),xe=i(26657),Ge=i(45154),ze=i(56898),Re=i(7730),Fe=i(68016),Ae=i(43184),ke=i(88016),je=function(e,t,i,n){return new(i||(i=Promise))(function(o,s){function r(e){try{a(n.next(e))}catch(t){s(t)}}function l(e){try{a(n.throw(e))}catch(t){s(t)}}function a(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(r,l)}a((n=n.apply(e,t||[])).next())})};function Ue(e,t){if(1&e&&(Ie.nrm(0,"bit-access-selector",10),Ie.nI1(1,"i18n"),Ie.nI1(2,"i18n"),Ie.nI1(3,"i18n"),Ie.nI1(4,"i18n")),2&e){const e=Ie.XpG();Ie.Y8G("permissionMode",e.PermissionMode.Edit)("items",e.accessItems)("columnHeader",Ie.bMT(1,6,"groupSlashMemberColumnHeader"))("selectorLabelText",Ie.bMT(2,8,"selectGroupsAndMembers"))("selectorHelpText",Ie.bMT(3,10,"userPermissionOverrideHelperDesc"))("emptySelectionText",Ie.bMT(4,12,"noMembersOrGroupsAdded"))}}function Ee(e,t){if(1&e&&(Ie.nrm(0,"bit-access-selector",11),Ie.nI1(1,"i18n"),Ie.nI1(2,"i18n"),Ie.nI1(3,"i18n")),2&e){const e=Ie.XpG();Ie.Y8G("permissionMode",e.PermissionMode.Edit)("items",e.accessItems)("columnHeader",Ie.bMT(1,5,"memberColumnHeader"))("selectorLabelText",Ie.bMT(2,7,"selectMembers"))("emptySelectionText",Ie.bMT(3,9,"noMembersAdded"))}}!function(e){e.Saved="saved",e.Canceled="canceled"}(n||(n={}));class Xe{constructor(e,t,i,o,s,r,l,a,c,u,h){this.params=e,this.dialogRef=t,this.formBuilder=i,this.organizationService=o,this.accountService=s,this.groupService=r,this.organizationUserApiService=l,this.platformUtilsService=a,this.i18nService=c,this.collectionAdminService=u,this.toastService=h,this.PermissionMode=be.ZC,this.formGroup=this.formBuilder.group({access:[[]]}),this.loading=!0,this.accessItems=[],this.destroy$=new w.B,this.submit=()=>je(this,void 0,void 0,function*(){const e=this.formGroup.controls.access.value.filter(e=>e.type===be.Uv.Member).map(be.yo),t=this.formGroup.controls.access.value.filter(e=>e.type===be.Uv.Group).map(be.yo);yield this.collectionAdminService.bulkAssignAccess(this.organization.id,this.params.collections.map(e=>e.id),e,t),this.toastService.showToast({variant:"success",title:null,message:this.i18nService.t("editedCollections")}),this.dialogRef.close(n.Saved)}),this.numCollections=this.params.collections.length;const p=this.accountService.activeAccount$.pipe((0,R.n)(e=>this.organizationService.organizations$(null==e?void 0:e.id).pipe((0,d.Sw)(this.params.organizationId)))),g=p.pipe((0,R.n)(e=>e.useGroups?this.groupService.getAll(e.id):(0,y.of)([])));(0,$.z)([p,g,this.organizationUserApiService.getAllMiniUserDetails(this.params.organizationId)]).pipe((0,k.Q)(this.destroy$)).subscribe(([e,t,i])=>{this.organization=e,this.accessItems=[].concat(t.map(be.NU),i.data.map(be.df)),this.loading=!1})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}static open(e,t){return e.open(Xe,t)}}Xe.ɵfac=function(e){return new(e||Xe)(Ie.rXU(fe.Qs),Ie.rXU(ye.ce),Ie.rXU(Se.ok),Ie.rXU(d.PV),Ie.rXU($e.Di),Ie.rXU(l.nK),Ie.rXU(V.uB),Ie.rXU(Ce.y),Ie.rXU(Te.W),Ie.rXU(V.vE),Ie.rXU(we.f))},Xe.ɵcmp=Ie.VBU({type:Xe,selectors:[["app-bulk-collections-dialog"]],decls:18,vars:18,consts:[[3,"formGroup","bitSubmit"],["dialogSize","large",3,"loading"],["bitDialogTitle",""],[1,"tw-text-sm","tw-normal-case","tw-text-muted"],["bitDialogContent",""],["formControlName","access",3,"permissionMode","items","columnHeader","selectorLabelText","selectorHelpText","emptySelectionText",4,"ngIf"],["formControlName","access",3,"permissionMode","items","columnHeader","selectorLabelText","emptySelectionText",4,"ngIf"],["bitDialogFooter",""],["type","submit","bitButton","","bitFormButton","","buttonType","primary"],["type","button","bitButton","","bitFormButton","","buttonType","secondary","bitDialogClose",""],["formControlName","access",3,"permissionMode","items","columnHeader","selectorLabelText","selectorHelpText","emptySelectionText"],["formControlName","access",3,"permissionMode","items","columnHeader","selectorLabelText","emptySelectionText"]],template:function(e,t){1&e&&(Ie.j41(0,"form",0)(1,"bit-dialog",1)(2,"span",2),Ie.EFF(3),Ie.nI1(4,"i18n"),Ie.j41(5,"span",3),Ie.EFF(6),Ie.nI1(7,"i18n"),Ie.k0s()(),Ie.j41(8,"div",4),Ie.DNE(9,Ue,5,14,"bit-access-selector",5)(10,Ee,4,11,"bit-access-selector",6),Ie.k0s(),Ie.qex(11,7),Ie.j41(12,"button",8),Ie.EFF(13),Ie.nI1(14,"i18n"),Ie.k0s(),Ie.j41(15,"button",9),Ie.EFF(16),Ie.nI1(17,"i18n"),Ie.k0s(),Ie.bVm(),Ie.k0s()()),2&e&&(Ie.Y8G("formGroup",t.formGroup)("bitSubmit",t.submit),Ie.R7$(),Ie.Y8G("loading",t.loading),Ie.R7$(2),Ie.SpI(" ",Ie.bMT(4,10,"assignCollectionAccess")," "),Ie.R7$(3),Ie.Lme(" ",t.numCollections," ",Ie.bMT(7,12,1==t.numCollections?"collection":"collections")," "),Ie.R7$(3),Ie.Y8G("ngIf",null==t.organization?null:t.organization.useGroups),Ie.R7$(),Ie.Y8G("ngIf",!(null!=t.organization&&t.organization.useGroups)),Ie.R7$(3),Ie.SpI(" ",Ie.bMT(14,14,"save")," "),Ie.R7$(3),Ie.SpI(" ",Ie.bMT(17,16,"cancel")," "))},dependencies:[se.G,Me.bT,Se.qT,Se.BC,Se.cb,Se.j4,Se.JD,xe.$,Ge.L,ze.Q,Re.I,Fe.m,be.mH,Ae.t,ke.$],encapsulation:2});var De=i(13299);const Ve=De.Sm`
  <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="5.52 2.62 110 110">
    <path class="tw-fill-illustration-bg-secondary" d="M25.518 12.621c0-5.523 4.477-10 10-10h50c5.523 0 10 4.477 10 10v2.5h-70v-2.5Z"/>
    <path class="tw-fill-illustration-outline" fill-rule="evenodd" d="M85.518 5.121h-50a7.5 7.5 0 0 0-7.5 7.5h65a7.5 7.5 0 0 0-7.5-7.5Zm-50-2.5c-5.523 0-10 4.477-10 10v2.5h70v-2.5c0-5.523-4.477-10-10-10h-50Z" clip-rule="evenodd"/>
    <path class="tw-fill-illustration-bg-primary" d="M15.518 22.621c0-5.523 4.477-10 10-10h70c5.523 0 10 4.477 10 10v2.5h-90v-2.5Z"/>
    <path class="tw-fill-illustration-outline" fill-rule="evenodd" d="M95.518 15.121h-70a7.5 7.5 0 0 0-7.5 7.5h85a7.5 7.5 0 0 0-7.5-7.5Zm-70-2.5c-5.523 0-10 4.477-10 10v2.5h90v-2.5c0-5.523-4.477-10-10-10h-70Z" clip-rule="evenodd"/>
    <path class="tw-fill-illustration-bg-tertiary" d="M5.518 32.621c0-5.523 4.477-10 10-10h90c5.523 0 10 4.477 10 10v70c0 5.523-4.477 10-10 10h-90c-5.523 0-10-4.477-10-10v-70Z"/>
    <path class="tw-fill-illustration-outline" fill-rule="evenodd" d="M105.518 25.121h-90a7.5 7.5 0 0 0-7.5 7.5v70a7.5 7.5 0 0 0 7.5 7.5h90a7.5 7.5 0 0 0 7.5-7.5v-70a7.5 7.5 0 0 0-7.5-7.5Zm-90-2.5c-5.523 0-10 4.477-10 10v70c0 5.523 4.477 10 10 10h90c5.523 0 10-4.477 10-10v-70c0-5.523-4.477-10-10-10h-90Z" clip-rule="evenodd"/>
    <path class="tw-fill-illustration-tertiary" d="M95.518 67.621c0 19.33-15.67 35-35 35s-35-15.67-35-35 15.67-35 35-35 35 15.67 35 35Z"/>
    <path class="tw-fill-illustration-outline" fill-rule="evenodd" d="M60.518 100.121c17.95 0 32.5-14.55 32.5-32.5s-14.55-32.5-32.5-32.5-32.5 14.55-32.5 32.5 14.55 32.5 32.5 32.5Zm0 2.5c19.33 0 35-15.67 35-35s-15.67-35-35-35-35 15.67-35 35 15.67 35 35 35Z" clip-rule="evenodd"/>
    <path class="tw-fill-illustration-bg-tertiary" d="m41.092 59.482-6.328 6.378a2.5 2.5 0 0 0 0 3.522l6.328 6.378a27.362 27.362 0 0 0 19.426 8.111 27.362 27.362 0 0 0 19.425-8.11l6.328-6.38a2.5 2.5 0 0 0 0-3.52l-6.328-6.379a27.362 27.362 0 0 0-19.425-8.11 27.362 27.362 0 0 0-19.426 8.11Z"/>
    <path class="tw-fill-illustration-outline" fill-rule="evenodd" d="m42.867 61.243-6.328 6.378L42.867 74a24.862 24.862 0 0 0 17.65 7.371c6.617 0 12.967-2.65 17.652-7.371l6.327-6.379-6.327-6.378a24.862 24.862 0 0 0-17.651-7.372 24.862 24.862 0 0 0-17.651 7.372Zm-8.102 4.617 6.327-6.378a27.362 27.362 0 0 1 19.426-8.11 27.362 27.362 0 0 1 19.425 8.11l6.328 6.378a2.5 2.5 0 0 1 0 3.522l-6.328 6.378a27.362 27.362 0 0 1-19.425 8.111 27.362 27.362 0 0 1-19.426-8.11l-6.328-6.38a2.5 2.5 0 0 1 0-3.52Z" clip-rule="evenodd"/>
    <path class="tw-fill-illustration-bg-primary" d="M71.768 67.621c0 6.213-5.037 11.25-11.25 11.25s-11.25-5.037-11.25-11.25 5.037-11.25 11.25-11.25 11.25 5.037 11.25 11.25Z"/>
    <path class="tw-fill-illustration-bg-secondary" d="M68.018 67.621a7.5 7.5 0 1 1-15 0 7.5 7.5 0 0 1 15 0Z"/>
    <path class="tw-fill-illustration-outline" fill-rule="evenodd" d="M42.134 49.237a1.25 1.25 0 0 1 1.768 0l35 35a1.25 1.25 0 1 1-1.768 1.768l-35-35a1.25 1.25 0 0 1 0-1.768Z" clip-rule="evenodd"/>
  </svg>
`;var Be=i(29029),Ne=i(74208),Ye=i(22690);function qe(e,t){if(1&e){const e=Ie.RV6();Ie.j41(0,"button",3),Ie.bIt("click",function(){Ne.eBV(e);const t=Ie.XpG();return Ne.Njj(t.viewCollectionClicked.emit({readonly:!1,tab:t.collectionDialogTabType.Info}))}),Ie.nrm(1,"i",4),Ie.EFF(2),Ie.nI1(3,"i18n"),Ie.k0s()}2&e&&(Ie.R7$(2),Ie.SpI(" ",Ie.bMT(3,1,"editCollection")," "))}function Pe(e,t){if(1&e){const e=Ie.RV6();Ie.j41(0,"button",3),Ie.bIt("click",function(){Ne.eBV(e);const t=Ie.XpG();return Ne.Njj(t.viewCollectionClicked.emit({readonly:!0,tab:t.collectionDialogTabType.Access}))}),Ie.nrm(1,"i",5),Ie.EFF(2),Ie.nI1(3,"i18n"),Ie.k0s()}2&e&&(Ie.R7$(2),Ie.SpI(" ",Ie.bMT(3,1,"viewAccess")," "))}class Oe{constructor(){this.icon=Ve,this.collectionDialogTabType=g._K,this.canEditCollection=!1,this.canViewCollectionInfo=!1,this.viewCollectionClicked=new Ie.bkB}}Oe.ɵfac=function(e){return new(e||Oe)},Oe.ɵcmp=Ie.VBU({type:Oe,selectors:[["collection-access-restricted"]],inputs:{canEditCollection:"canEditCollection",canViewCollectionInfo:"canViewCollectionInfo"},outputs:{viewCollectionClicked:"viewCollectionClicked"},decls:6,vars:6,consts:[[1,"tw-mt-2","tw-block",3,"icon"],["slot","title",1,"tw-mt-4","tw-block"],["slot","button","bitButton","","buttonType","secondary","type","button",3,"click",4,"ngIf"],["slot","button","bitButton","","buttonType","secondary","type","button",3,"click"],["aria-hidden","true",1,"bwi","bwi-pencil-square"],["aria-hidden","true",1,"bwi","bwi-users"]],template:function(e,t){1&e&&(Ie.j41(0,"bit-no-items",0)(1,"span",1),Ie.EFF(2),Ie.nI1(3,"i18n"),Ie.k0s(),Ie.DNE(4,qe,4,3,"button",2)(5,Pe,4,3,"button",2),Ie.k0s()),2&e&&(Ie.Y8G("icon",t.icon),Ie.R7$(2),Ie.JRh(Ie.bMT(3,4,"youDoNotHavePermissions")),Ie.R7$(2),Ie.Y8G("ngIf",t.canEditCollection),Ie.R7$(),Ie.Y8G("ngIf",!t.canEditCollection&&t.canViewCollectionInfo))},dependencies:[se.G,Me.bT,ze.Q,Ye.D,Be.t,ee.s,ke.$],encapsulation:2});var _e=i(46128),He=i(60893),We=i(91240),Le=i(18990),Qe=i(72737),Je=i(31857),Ze=i(74956),Ke=i(74526),et=i(5556),tt=i(18499),it=i(1601),nt=function(e,t,i,n){return new(i||(i=Promise))(function(o,s){function r(e){try{a(n.next(e))}catch(t){s(t)}}function l(e){try{a(n.throw(e))}catch(t){s(t)}}function a(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(r,l)}a((n=n.apply(e,t||[])).next())})};class ot extends Ze.u{constructor(e,t,i,n,o,s,r,l,a){super(e,t,i,n,o,s,r,l,a),this.destroy$=new w.B,this._collections=new Qe.m(1),this.filteredCollections$=this._collections.asObservable(),this.collectionTree$=this.filteredCollections$.pipe((0,x.T)(e=>this.buildCollectionTree(e)))}reloadCollections(e){return nt(this,void 0,void 0,function*(){this._collections.next(e)})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}}ot.ɵfac=function(e){return new(e||ot)(Ne.KVO(d.PV),Ne.KVO(Ke.k),Ne.KVO(et.p),Ne.KVO(tt.m),Ne.KVO(Te.W),Ne.KVO(Je.v2),Ne.KVO(V.YD),Ne.KVO($e.Di),Ne.KVO(it.w))},ot.ɵprov=Ne.jDH({token:ot,factory:ot.ɵfac});class st{}st.ɵfac=function(e){return new(e||st)},st.ɵmod=Ie.$C({type:st}),st.ɵinj=Ne.G2t({providers:[{provide:We.u,useClass:ot}],imports:[Le.m,He.t]});var rt=i(58625),lt=(i(84488),i(88083)),at=i(31442),ct=i(90647),dt=i(56615),ut=i(23649),ht=i(13496),pt=i(53997),gt=i(78952),mt=i(36288),vt=i(1576),ft=i(88547),bt=i(93748),It=i(5520),yt=function(e,t,i,n){return new(i||(i=Promise))(function(o,s){function r(e){try{a(n.next(e))}catch(t){s(t)}}function l(e){try{a(n.throw(e))}catch(t){s(t)}}function a(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(r,l)}a((n=n.apply(e,t||[])).next())})};const wt=()=>[],St=e=>({organizationId:e,collectionId:null}),$t=e=>({collectionId:e});function Ct(e,t){if(1&e&&(Ie.j41(0,"bit-breadcrumb",10),Ie.EFF(1),Ie.k0s()),2&e){const e=t.$implicit;Ie.Y8G("route",Ie.lJ4(3,wt))("queryParams",Ie.eq3(4,$t,e.id)),Ie.R7$(),Ie.SpI(" ",e.name," ")}}function Tt(e,t){if(1&e&&(Ie.j41(0,"bit-breadcrumbs",7)(1,"bit-breadcrumb",8),Ie.EFF(2),Ie.j41(3,"span"),Ie.EFF(4),Ie.nI1(5,"i18n"),Ie.nI1(6,"lowercase"),Ie.k0s()(),Ie.qex(7),Ie.DNE(8,Ct,2,6,"bit-breadcrumb",9),Ie.bVm(),Ie.k0s()),2&e){const e=Ie.XpG();Ie.R7$(),Ie.Y8G("route",Ie.lJ4(9,wt))("queryParams",Ie.eq3(10,St,e.organization.id)),Ie.R7$(),Ie.SpI(" ",e.organization.name," "),Ie.R7$(2),Ie.SpI(" ",Ie.bMT(6,7,Ie.bMT(5,5,"collections"))," "),Ie.R7$(4),Ie.Y8G("ngForOf",e.collections)}}function Mt(e,t){if(1&e){const e=Ie.RV6();Ie.qex(0),Ie.j41(1,"button",13),Ie.bIt("click",function(){Ne.eBV(e);const t=Ie.XpG(2);return Ne.Njj(t.editCollection(t.CollectionDialogTabType.Info,!1))}),Ie.nrm(2,"i",14),Ie.EFF(3),Ie.nI1(4,"i18n"),Ie.k0s(),Ie.j41(5,"button",13),Ie.bIt("click",function(){Ne.eBV(e);const t=Ie.XpG(2);return Ne.Njj(t.editCollection(t.CollectionDialogTabType.Access,!1))}),Ie.nrm(6,"i",15),Ie.EFF(7),Ie.nI1(8,"i18n"),Ie.k0s(),Ie.bVm()}2&e&&(Ie.R7$(3),Ie.SpI(" ",Ie.bMT(4,2,"editInfo")," "),Ie.R7$(4),Ie.SpI(" ",Ie.bMT(8,4,"access")," "))}function xt(e,t){if(1&e){const e=Ie.RV6();Ie.qex(0),Ie.j41(1,"button",13),Ie.bIt("click",function(){Ne.eBV(e);const t=Ie.XpG(2);return Ne.Njj(t.editCollection(t.CollectionDialogTabType.Info,!0))}),Ie.nrm(2,"i",14),Ie.EFF(3),Ie.nI1(4,"i18n"),Ie.k0s(),Ie.j41(5,"button",13),Ie.bIt("click",function(){Ne.eBV(e);const t=Ie.XpG(2);return Ne.Njj(t.editCollection(t.CollectionDialogTabType.Access,!0))}),Ie.nrm(6,"i",15),Ie.EFF(7),Ie.nI1(8,"i18n"),Ie.k0s(),Ie.bVm()}2&e&&(Ie.R7$(3),Ie.SpI(" ",Ie.bMT(4,2,"viewInfo")," "),Ie.R7$(4),Ie.SpI(" ",Ie.bMT(8,4,"viewAccess")," "))}function Gt(e,t){if(1&e){const e=Ie.RV6();Ie.j41(0,"button",13),Ie.bIt("click",function(){Ne.eBV(e);const t=Ie.XpG(2);return Ne.Njj(t.deleteCollection())}),Ie.j41(1,"span",16),Ie.nrm(2,"i",17),Ie.EFF(3),Ie.nI1(4,"i18n"),Ie.k0s()()}2&e&&(Ie.R7$(3),Ie.SpI(" ",Ie.bMT(4,1,"delete")," "))}function zt(e,t){if(1&e&&(Ie.qex(0),Ie.nrm(1,"button",11),Ie.nI1(2,"i18n"),Ie.j41(3,"bit-menu",null,0),Ie.DNE(5,Mt,9,6,"ng-container",4)(6,xt,9,6,"ng-container",4)(7,Gt,5,3,"button",12),Ie.k0s(),Ie.bVm()),2&e){const e=Ie.sdS(4),t=Ie.XpG();Ie.R7$(),Ie.Y8G("bitMenuTriggerFor",e)("label",Ie.bMT(2,5,"editCollection")),Ie.R7$(4),Ie.Y8G("ngIf",t.canEditCollection),Ie.R7$(),Ie.Y8G("ngIf",!t.canEditCollection&&t.canViewCollectionInfo),Ie.R7$(),Ie.Y8G("ngIf",t.canDeleteCollection)}}function Rt(e,t){1&e&&(Ie.j41(0,"small"),Ie.nrm(1,"i",18),Ie.nI1(2,"i18n"),Ie.j41(3,"span",19),Ie.EFF(4),Ie.nI1(5,"i18n"),Ie.k0s()()),2&e&&(Ie.R7$(),Ie.Y8G("title",Ie.mNQ(Ie.bMT(2,3,"loading"))),Ie.R7$(3),Ie.JRh(Ie.bMT(5,5,"loading")))}function Ft(e,t){if(1&e){const e=Ie.RV6();Ie.j41(0,"bit-search",20),Ie.nI1(1,"i18n"),Ie.bIt("ngModelChange",function(t){Ne.eBV(e);const i=Ie.XpG();return Ne.Njj(i.onSearchTextChanged(t))}),Ie.k0s()}if(2&e){const e=Ie.XpG();Ie.Y8G("ngModel",e.searchText)("placeholder",Ie.bMT(1,2,"searchCollection"))}}function At(e,t){if(1&e){const e=Ie.RV6();Ie.j41(0,"div",21)(1,"vault-new-cipher-menu",22),Ie.bIt("cipherAdded",function(t){Ne.eBV(e);const i=Ie.XpG();return Ne.Njj(i.addCipher(t))})("collectionAdded",function(){Ne.eBV(e);const t=Ie.XpG();return Ne.Njj(t.addCollection())}),Ie.k0s()()}if(2&e){const e=Ie.XpG();Ie.R7$(),Ie.Y8G("canCreateCipher",e.canCreateCipher)("canCreateCollection",e.canCreateCollection)}}class kt{constructor(e,t,i,n,o){this.i18nService=e,this.dialogService=t,this.collectionAdminService=i,this.router=n,this.accountService=o,this.All=pe.u,this.Unassigned=V.I_,this.onAddCipher=new Ie.bkB,this.onAddCollection=new Ie.bkB,this.onEditCollection=new Ie.bkB,this.onDeleteCollection=new Ie.bkB,this.searchTextChanged=new Ie.bkB,this.CollectionDialogTabType=g._K,this.CipherType=at.gC}get title(){var e,t;const i=this.i18nService.t("collections").toLowerCase();return null!=this.collection?this.collection.node.name:this.filter.collectionId===V.I_?this.i18nService.t("unassigned"):(null===(e=this.organization)||void 0===e?void 0:e.name)?`${null===(t=this.organization)||void 0===t?void 0:t.name} ${i}`:this.i18nService.t("collections")}get icon(){return void 0!==this.filter.collectionId?"bwi-collection-shared":""}get showBreadcrumbs(){return void 0!==this.filter.collectionId&&this.filter.collectionId!==pe.u}get collections(){if(null==this.collection)return[];const e=[this.collection];for(;null!=e[e.length-1].parent;)e.push(e[e.length-1].parent);return e.slice(1).reverse().map(e=>e.node)}showFreeOrgUpgradeDialog(){const e={title:this.i18nService.t("upgradeOrganization"),content:this.i18nService.t(this.organization.canEditSubscription?"freeOrgMaxCollectionReachedManageBilling":"freeOrgMaxCollectionReachedNoManageBilling",this.organization.maxCollections),type:"primary"};this.organization.canEditSubscription?e.acceptButtonText=this.i18nService.t("upgrade"):(e.acceptButtonText=this.i18nService.t("ok"),e.cancelButtonText=null);const t=this.dialogService.openSimpleDialogRef(e);(0,S._)(t.closed).then(e=>{e&&e&&this.organization.canEditSubscription&&this.router.navigate(["/organizations",this.organization.id,"billing","subscription"],{queryParams:{upgrade:!0}})})}get canEditCollection(){return void 0!==this.collection&&this.collection.node.canEdit(this.organization)}addCipher(e){this.onAddCipher.emit(e)}addCollection(){return yt(this,void 0,void 0,function*(){if(this.organization.productTierType===lt.K_.Free){if((yield(0,S._)(this.accountService.activeAccount$.pipe(Y.F6,(0,R.n)(e=>this.collectionAdminService.collectionAdminViews$(this.organization.id,e))))).length===this.organization.maxCollections)return void this.showFreeOrgUpgradeDialog()}this.onAddCollection.emit()})}editCollection(e,t){return yt(this,void 0,void 0,function*(){this.onEditCollection.emit({tab:e,readonly:t})})}get canDeleteCollection(){return void 0!==this.collection&&this.collection.node.canDelete(this.organization)}get canViewCollectionInfo(){return this.collection.node.canViewCollectionInfo(this.organization)}get canCreateCollection(){var e;return null===(e=this.organization)||void 0===e?void 0:e.canCreateNewCollections}get canCreateCipher(){var e,t;return!((null===(e=this.organization)||void 0===e?void 0:e.isProviderUser)&&!(null===(t=this.organization)||void 0===t?void 0:t.isMember))}deleteCollection(){this.onDeleteCollection.emit()}onSearchTextChanged(e){this.searchText=e,this.searchTextChanged.emit(e)}}kt.ɵfac=function(e){return new(e||kt)(Ie.rXU(Te.W),Ie.rXU(ye.o3),Ie.rXU(V.vE),Ie.rXU(ut.Ix),Ie.rXU($e.Di))},kt.ɵcmp=Ie.VBU({type:kt,selectors:[["app-org-vault-header"]],inputs:{loading:"loading",filter:"filter",organization:"organization",collection:"collection",searchText:"searchText"},outputs:{onAddCipher:"onAddCipher",onAddCollection:"onAddCollection",onEditCollection:"onEditCollection",onDeleteCollection:"onDeleteCollection",searchTextChanged:"searchTextChanged"},decls:7,vars:7,consts:[["editCollectionMenu",""],[3,"title","icon"],["slot","breadcrumbs",4,"ngIf"],["slot","title-suffix"],[4,"ngIf"],["class","tw-grow",3,"ngModel","placeholder","ngModelChange",4,"ngIf"],["class","tw-shrink-0",4,"ngIf"],["slot","breadcrumbs"],["queryParamsHandling","merge",3,"route","queryParams"],["icon","bwi-collection-shared","queryParamsHandling","merge",3,"route","queryParams",4,"ngFor","ngForOf"],["icon","bwi-collection-shared","queryParamsHandling","merge",3,"route","queryParams"],["bitIconButton","bwi-angle-down","size","small","type","button",3,"bitMenuTriggerFor","label"],["type","button","bitMenuItem","",3,"click",4,"ngIf"],["type","button","bitMenuItem","",3,"click"],["aria-hidden","true",1,"bwi","bwi-fw","bwi-pencil-square"],["aria-hidden","true",1,"bwi","bwi-fw","bwi-users"],[1,"tw-text-danger"],["aria-hidden","true",1,"bwi","bwi-fw","bwi-trash"],["aria-hidden","true",1,"bwi","bwi-spinner","bwi-spin","tw-text-muted",3,"title"],[1,"tw-sr-only"],[1,"tw-grow",3,"ngModelChange","ngModel","placeholder"],[1,"tw-shrink-0"],[3,"cipherAdded","collectionAdded","canCreateCipher","canCreateCollection"]],template:function(e,t){1&e&&(Ie.j41(0,"app-header",1),Ie.DNE(1,Tt,9,12,"bit-breadcrumbs",2),Ie.qex(2,3),Ie.nVh(3,zt,8,7,"ng-container"),Ie.DNE(4,Rt,6,7,"small",4),Ie.bVm(),Ie.DNE(5,Ft,2,4,"bit-search",5)(6,At,2,2,"div",6),Ie.k0s()),2&e&&(Ie.Y8G("title",t.title)("icon",t.icon),Ie.R7$(),Ie.Y8G("ngIf",t.showBreadcrumbs),Ie.R7$(2),Ie.vxM(null!=t.collection&&(t.canEditCollection||t.canDeleteCollection||t.canViewCollectionInfo)?3:-1),Ie.R7$(),Ie.Y8G("ngIf",t.loading),Ie.R7$(),Ie.Y8G("ngIf",(null==t.organization?null:t.organization.isProviderUser)&&!(null!=t.organization&&t.organization.isMember)),Ie.R7$(),Ie.Y8G("ngIf","trash"!==t.filter.type&&t.filter.collectionId!==t.Unassigned&&t.organization))},dependencies:[Me.MD,Me.Sq,Me.bT,ct.M,ht.Z,pt.O,gt.S,se.G,Se.BC,Se.vS,mt.s,dt.V,vt.m,ft.D,r.G,bt.f,He.t,It.S,rt.p,te.eG,Me.GH,ke.$],encapsulation:2});var jt=i(94573),Ut=i(52396),Et=i(54351),Xt=i(81582),Dt=i(63098),Vt=i(12012),Bt=i(48180),Nt=i(85111),Yt=i(92411),qt=i(43090),Pt=i(54471),Ot=i(49519),_t=i(59032),Ht=i(49492),Wt=function(e,t,i,n){return new(i||(i=Promise))(function(o,s){function r(e){try{a(n.next(e))}catch(t){s(t)}}function l(e){try{a(n.throw(e))}catch(t){s(t)}}function a(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(r,l)}a((n=n.apply(e,t||[])).next())})};function Lt(e,t){1&e&&(Ie.j41(0,"div",3),Ie.nrm(1,"i",4),Ie.k0s())}function Qt(e,t){if(1&e&&(Ie.qex(0),Ie.j41(1,"div",12),Ie.nrm(2,"app-filter-section",13),Ie.k0s(),Ie.bVm()),2&e){const e=t.$implicit,i=Ie.XpG(2);Ie.R7$(2),Ie.Y8G("activeFilter",i.activeFilter)("section",e)}}function Jt(e,t){if(1&e){const e=Ie.RV6();Ie.j41(0,"div")(1,"div",5),Ie.EFF(2),Ie.nI1(3,"i18n"),Ie.j41(4,"a",6),Ie.nI1(5,"i18n"),Ie.nrm(6,"i",7),Ie.k0s()(),Ie.j41(7,"div",8)(8,"div",9)(9,"bit-search",10),Ie.nI1(10,"i18n"),Ie.mxI("ngModelChange",function(t){Ne.eBV(e);const i=Ie.XpG();return Ie.DH7(i.searchText,t)||(i.searchText=t),Ne.Njj(t)}),Ie.bIt("ngModelChange",function(t){Ne.eBV(e);const i=Ie.XpG();return Ne.Njj(i.onSearchTextChanged(t))}),Ie.k0s()(),Ie.DNE(11,Qt,3,2,"ng-container",11),Ie.k0s()()}if(2&e){const e=Ie.XpG();Ie.R7$(2),Ie.SpI(" ",Ie.bMT(3,7,"filters")," "),Ie.R7$(2),Ie.Y8G("appA11yTitle",Ie.mNQ(Ie.bMT(5,9,"learnMoreAboutSearchingYourVault"))),Ie.R7$(5),Ie.Y8G("placeholder",Ie.mNQ(Ie.bMT(10,11,e.searchPlaceholder))),Ie.R50("ngModel",e.searchText),Ie.R7$(2),Ie.Y8G("ngForOf",e.filtersList)}}class Zt extends Nt.C{set organization(e){e&&e!==this._organization&&(this._organization=e,this.vaultFilterService.setOrganizationFilter(this._organization))}constructor(e,t,i,n,o,s,r,l,a,c,d,u){super(e,t,i,n,o,s,r,l,a,c,d,u),this.vaultFilterService=e,this.policyService=t,this.i18nService=i,this.platformUtilsService=n,this.toastService=o,this.billingApiService=s,this.dialogService=r,this.accountService=l,this.restrictedItemTypesService=a,this.cipherService=c,this.cipherArchiveService=d}ngOnInit(){return Wt(this,void 0,void 0,function*(){this.filters=yield this.buildAllFilters(),this.activeFilter.selectedCipherTypeNode||(this.activeFilter.resetFilter(),this.activeFilter.selectedCollectionNode=yield this.getDefaultFilter()),this.isLoaded=!0})}ngOnChanges(e){return Wt(this,void 0,void 0,function*(){e.organization&&(this.filters=yield this.buildAllFilters())})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}removeCollapsibleCollection(){return Wt(this,void 0,void 0,function*(){const e=yield(0,S._)(this.vaultFilterService.collapsedFilterNodes$);e.delete("AllCollections");const t=yield(0,S._)(this.activeUserId$);yield this.vaultFilterService.setCollapsedFilterNodes(e,t)})}addCollectionFilter(){return Wt(this,void 0,void 0,function*(){this.removeCollapsibleCollection();return{data$:this.vaultFilterService.buildTypeTree({id:"AllCollections",name:"collections",type:"all",icon:"bwi-collection-shared"},[{id:"AllCollections",name:"Collections",type:"all",icon:"bwi-collection-shared"}]),header:{showHeader:!1,isSelectable:!0},action:this.applyCollectionFilter}})}buildAllFilters(){return Wt(this,void 0,void 0,function*(){var e;const t={};return t.typeFilter=yield this.addTypeFilter(["favorites"],null===(e=this._organization)||void 0===e?void 0:e.id),t.collectionFilter=yield this.addCollectionFilter(),t.trashFilter=yield this.addTrashFilter(),t})}getDefaultFilter(){return Wt(this,void 0,void 0,function*(){var e;return yield(0,S._)(null===(e=this.filters)||void 0===e?void 0:e.collectionFilter.data$)})}}Zt.ɵfac=function(e){return new(e||Zt)(Ie.rXU(We.u),Ie.rXU(tt.m),Ie.rXU(Te.W),Ie.rXU(Ce.y),Ie.rXU(we.f),Ie.rXU(Bt.P),Ie.rXU(ye.o3),Ie.rXU($e.Di),Ie.rXU(J.b),Ie.rXU(et.p),Ie.rXU(Yt.J),Ie.rXU(qt.l))},Zt.ɵcmp=Ie.VBU({type:Zt,selectors:[["app-organization-vault-filter"]],inputs:{organization:"organization"},standalone:!1,features:[Ie.Vt3,Ie.OA$],decls:3,vars:2,consts:[["data-testid","filters",1,"tw-border","tw-border-solid","tw-border-secondary-300","tw-rounded"],["class","tw-text-center tw-p-5",4,"ngIf"],[4,"ngIf"],[1,"tw-text-center","tw-p-5"],["aria-hidden","true",1,"bwi","bwi-spinner","bwi-spin"],["data-testid","filters-header",1,"tw-bg-background-alt","tw-border-0","tw-border-b","tw-border-solid","tw-border-secondary-100","tw-rounded-t","tw-px-5","tw-py-2.5","tw-font-medium","tw-uppercase"],["bitLink","","href","https://bitwarden.com/help/searching-vault/","target","_blank","rel","noreferrer",1,"tw-float-right",3,"appA11yTitle"],["aria-hidden","true",1,"bwi","bwi-question-circle"],["data-testid","filters-body",1,"tw-p-5"],[1,"tw-mb-4"],["id","search","autocomplete","off","appAutofocus","",3,"ngModelChange","placeholder","ngModel"],[4,"ngFor","ngForOf"],[1,"filter"],[3,"activeFilter","section"]],template:function(e,t){1&e&&(Ie.j41(0,"div",0),Ie.DNE(1,Lt,2,0,"div",1)(2,Jt,12,13,"div",2),Ie.k0s()),2&e&&(Ie.R7$(),Ie.Y8G("ngIf",!t.isLoaded),Ie.R7$(),Ie.Y8G("ngIf",t.isLoaded))},dependencies:[Me.Sq,Me.bT,Se.BC,Se.vS,Pt.C,Ot.B,_t.L,Ht.H,It.S,ke.$],encapsulation:2});var Kt=i(44432),ei=i(12694),ti=i(16496),ii=function(e,t,i,n){return new(i||(i=Promise))(function(o,s){function r(e){try{a(n.next(e))}catch(t){s(t)}}function l(e){try{a(n.throw(e))}catch(t){s(t)}}function a(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(r,l)}a((n=n.apply(e,t||[])).next())})};const ni=["vaultItems"],oi=e=>[e],si=()=>[];function ri(e,t){if(1&e){const e=Ie.RV6();Ie.j41(0,"app-organization-free-trial-warning",8),Ie.bIt("clicked",function(){Ne.eBV(e);const t=Ie.XpG(2);return Ne.Njj(t.navigateToPaymentMethod())}),Ie.k0s(),Ie.nrm(1,"app-organization-reseller-renewal-warning",9)}if(2&e){Ie.XpG(2);const e=Ie.r8f(0);Ie.Y8G("organization",e),Ie.R7$(),Ie.Y8G("organization",e)}}function li(e,t){if(1&e){const e=Ie.RV6();Ie.j41(0,"app-org-vault-header",10),Ie.nI1(1,"async"),Ie.bIt("onAddCipher",function(t){Ne.eBV(e);const i=Ie.XpG(2);return Ne.Njj(i.addCipher(t))})("onAddCollection",function(){Ne.eBV(e);const t=Ie.XpG(2);return Ne.Njj(t.addCollection())})("onEditCollection",function(t){Ne.eBV(e);const i=Ie.XpG(2),n=Ie.r8f(2);return Ne.Njj(i.editCollection(null==n?null:n.node,t.tab,t.readonly))})("onDeleteCollection",function(){Ne.eBV(e);const t=Ie.XpG(2),i=Ie.r8f(2);return Ne.Njj(t.deleteCollection(null==i?null:i.node))})("searchTextChanged",function(t){Ne.eBV(e);const i=Ie.XpG(2);return Ne.Njj(i.filterSearchText(t))}),Ie.k0s()}if(2&e){const e=Ie.XpG(2),t=Ie.r8f(0),i=Ie.r8f(2),n=Ie.r8f(4),o=Ie.r8f(6);Ie.Y8G("filter",n)("loading",o)("organization",t)("collection",i)("searchText",Ie.bMT(1,5,e.currentSearchText$))}}function ai(e,t){if(1&e){const e=Ie.RV6();Ie.j41(0,"div",3)(1,"app-organization-vault-filter",11),Ie.nI1(2,"async"),Ie.bIt("searchTextChanged",function(t){Ne.eBV(e);const i=Ie.XpG(2);return Ne.Njj(i.filterSearchText(t))}),Ie.k0s()()}if(2&e){const e=Ie.XpG(2),t=Ie.r8f(0);Ie.R7$(),Ie.Y8G("organization",t)("activeFilter",e.activeFilter)("searchText",Ie.bMT(2,3,e.currentSearchText$))}}function ci(e,t){if(1&e){const e=Ie.RV6();Ie.j41(0,"bit-toggle-group",12),Ie.nI1(1,"async"),Ie.nI1(2,"i18n"),Ie.bIt("selectedChange",function(t){Ne.eBV(e);const i=Ie.XpG(2);return Ne.Njj(i.addAccessToggle(t))}),Ie.j41(3,"bit-toggle",13),Ie.EFF(4),Ie.nI1(5,"i18n"),Ie.k0s(),Ie.j41(6,"bit-toggle",13),Ie.EFF(7),Ie.nI1(8,"i18n"),Ie.k0s()()}if(2&e){const e=Ie.XpG(2);Ie.Y8G("selected",Ie.bMT(1,6,e.addAccessStatus$)),Ie.BMQ("aria-label",Ie.bMT(2,8,"addAccessFilter")),Ie.R7$(3),Ie.Y8G("value",0),Ie.R7$(),Ie.SpI(" ",Ie.bMT(5,10,"all")," "),Ie.R7$(2),Ie.Y8G("value",1),Ie.R7$(),Ie.SpI(" ",Ie.bMT(8,12,"addAccess")," ")}}function di(e,t){if(1&e&&(Ie.j41(0,"bit-callout",5),Ie.EFF(1),Ie.k0s()),2&e){const e=Ie.XpG(2);Ie.R7$(),Ie.SpI(" ",e.trashCleanupWarning," ")}}function ui(e,t){if(1&e){const e=Ie.RV6();Ie.j41(0,"app-vault-items",14,0),Ie.nI1(2,"async"),Ie.nI1(3,"async"),Ie.nI1(4,"async"),Ie.nI1(5,"async"),Ie.nI1(6,"async"),Ie.bIt("onEvent",function(t){Ne.eBV(e);const i=Ie.XpG(2);return Ne.Njj(i.onVaultItemsEvent(t))}),Ie.k0s()}if(2&e){const e=Ie.XpG(2),t=Ie.r8f(0),i=Ie.r8f(2),n=Ie.r8f(4),o=Ie.r8f(8);Ie.Y8G("ciphers",Ie.bMT(2,21,e.ciphers$))("collections",Ie.bMT(3,23,e.collections$))("allCollections",Ie.bMT(4,25,e.allCollections$))("allOrganizations",t?Ie.eq3(31,oi,t):Ie.lJ4(33,si))("allGroups",Ie.bMT(5,27,e.allGroups$))("disabled",o)("showOwner",!1)("showPermissionsColumn",!0)("showCollections",void 0!==n.type)("showGroups",(null==t?null:t.useGroups)&&(void 0===n.type&&void 0===n.collectionId||void 0!==n.collectionId))("showPremiumFeatures",null==t?null:t.useTotp)("showBulkMove",!1)("showBulkTrashOptions","trash"===n.type)("useEvents",null==t?null:t.canAccessEventLogs)("showAdminActions",!0)("showBulkEditCollectionAccess",!0)("showBulkAddToCollections",!0)("viewingOrgVault",!0)("addAccessStatus",Ie.bMT(6,29,e.addAccessStatus$))("addAccessToggle",e.showAddAccessToggle)("activeCollection",null==i?null:i.node)}}function hi(e,t){if(1&e){const e=Ie.RV6();Ie.j41(0,"button",18),Ie.bIt("click",function(){Ne.eBV(e);const t=Ie.XpG(4);return Ne.Njj(t.addCipher())}),Ie.nrm(1,"i",19),Ie.EFF(2),Ie.nI1(3,"i18n"),Ie.k0s()}2&e&&(Ie.R7$(2),Ie.SpI(" ",Ie.bMT(3,1,"newItem")," "))}function pi(e,t){if(1&e&&(Ie.j41(0,"bit-no-items")(1,"span",16),Ie.EFF(2),Ie.nI1(3,"i18n"),Ie.k0s(),Ie.nVh(4,hi,4,3,"button",17),Ie.k0s()),2&e){const e=Ie.XpG(3),t=Ie.r8f(0),i=Ie.r8f(2),n=Ie.r8f(4);Ie.R7$(2),Ie.JRh(Ie.bMT(3,2,"noItemsInList")),Ie.R7$(2),Ie.vxM(n&&"trash"!==n.type&&n.collectionId!==e.Unassigned&&(!i||null!=i.node&&i.node.canEditItems(t))?4:-1)}}function gi(e,t){if(1&e){const e=Ie.RV6();Ie.j41(0,"collection-access-restricted",20),Ie.bIt("viewCollectionClicked",function(t){Ne.eBV(e);const i=Ie.XpG(3),n=Ie.r8f(2);return Ne.Njj(i.editCollection(null==n?null:n.node,t.tab,t.readonly))}),Ie.k0s()}if(2&e){Ie.XpG(3);const e=Ie.r8f(0),t=Ie.r8f(2);Ie.Y8G("canEditCollection",null==t||null==t.node?null:t.node.canEdit(e))("canViewCollectionInfo",null==t||null==t.node?null:t.node.canViewCollectionInfo(e))}}function mi(e,t){if(1&e&&Ie.nVh(0,pi,5,4,"bit-no-items")(1,gi,1,2,"collection-access-restricted",15),2&e){Ie.XpG();const e=Ie.r8f(10);Ie.vxM(e?1:0)}}function vi(e,t){1&e&&(Ie.j41(0,"div",7),Ie.nrm(1,"i",21),Ie.nI1(2,"i18n"),Ie.j41(3,"span",22),Ie.EFF(4),Ie.nI1(5,"i18n"),Ie.k0s()()),2&e&&(Ie.R7$(),Ie.Y8G("title",Ie.mNQ(Ie.bMT(2,3,"loading"))),Ie.R7$(3),Ie.JRh(Ie.bMT(5,5,"loading")))}function fi(e,t){if(1&e&&(Ie.nVh(0,ri,2,2),Ie.nVh(1,li,2,7,"app-org-vault-header",1),Ie.j41(2,"div",2),Ie.SS7(3),Ie.nI1(4,"async"),Ie.nVh(5,ai,3,5,"div",3),Ie.j41(6,"div"),Ie.nVh(7,ci,9,14,"bit-toggle-group",4),Ie.nVh(8,di,2,1,"bit-callout",5),Ie.nVh(9,ui,7,34,"app-vault-items",6),Ie.SS7(10),Ie.nI1(11,"async"),Ie.nVh(12,mi,2,1),Ie.nI1(13,"async"),Ie.nVh(14,vi,6,7,"div",7),Ie.k0s()()),2&e){const e=Ie.XpG(),t=Ie.r8f(4),i=Ie.r8f(6);Ie.vxM(i?-1:0),Ie.R7$(),Ie.vxM(t?1:-1);const n=Ie.bMT(4,10,e.hideVaultFilter$);Ie.R7$(4),Ie.vxM(n?-1:5),Ie.R7$(),Ie.HbH(n?"tw-w-full":"tw-w-3/4"),Ie.R7$(),Ie.vxM(e.showAddAccessToggle&&e.activeFilter.selectedCollectionNode?7:-1),Ie.R7$(),Ie.vxM(e.activeFilter.isDeleted?8:-1),Ie.R7$(),Ie.vxM(t?9:-1),Ie.R7$(),Ie.bH3(Ie.bMT(11,12,e.showCollectionAccessRestricted$)),Ie.R7$(2),Ie.vxM(!i&&Ie.bMT(13,15,e.isEmpty$)?12:-1),Ie.R7$(2),Ie.vxM(i?14:-1)}}const bi="OrgVaultComponent";var Ii;!function(e){e[e.All=0]="All",e[e.AddAccess=1]="AddAccess"}(Ii||(Ii={}));class yi{constructor(e,t,i,n,o,s,r,l,a,c,d,u,h,p,m,v,f,M,E,X,D,B,q,P,O,H,W,L,J,K,ee){this.route=e,this.organizationService=t,this.vaultFilterService=i,this.routedVaultFilterBridgeService=n,this.routedVaultFilterService=o,this.router=s,this.changeDetectorRef=r,this.syncService=l,this.i18nService=a,this.dialogService=c,this.messagingService=d,this.broadcasterService=u,this.ngZone=h,this.platformUtilsService=p,this.cipherService=m,this.passwordRepromptService=v,this.collectionAdminService=f,this.searchService=M,this.searchPipe=E,this.groupService=X,this.logService=D,this.eventCollectionService=B,this.totpService=q,this.apiService=P,this.toastService=O,this.cipherFormConfigService=H,this.billingApiService=W,this.accountService=L,this.organizationWarningsService=J,this.collectionService=K,this.restrictedItemTypesService=ee,this.Unassigned=V.I_,this.trashCleanupWarning=this.i18nService.t(this.platformUtilsService.isSelfHost()?"trashCleanupWarningSelfHosted":"trashCleanupWarning"),this.activeFilter=new ge.$,this.showAddAccessToggle=!1,this.noItemIcon=N.a,this.processingEvent$=new I.t(!1),this.isEmpty$=(0,y.of)(!1),this.prevCipherId=null,this.searchText$=new w.B,this.refreshingSubject$=new I.t(!0),this.destroy$=new w.B,this.addAccessStatus$=new I.t(0),this.restore=e=>ii(this,void 0,void 0,function*(){const t=yield(0,S._)(this.organization$);if(!Z.n.isDeleted(e))return!1;if(!t.permissions.editAnyCollection&&!e.edit&&!t.allowAdminAccessToAllCollectionItems)return this.showMissingPermissionsError(),!1;if(!(yield this.repromptCipher([e])))return!1;try{if(null==e.id||""===e.id)throw new Error("Cipher must have an Id to be restored");const t=yield(0,S._)(this.accountService.activeAccount$.pipe(Y.F6)),i=(yield(0,S._)(this.organization$)).canEditAnyCollection||Z.n.isUnassigned(e);return yield this.cipherService.restoreWithServer(e.id,t,i),this.toastService.showToast({variant:"success",message:this.i18nService.t("restoredItem")}),this.refresh(),!0}catch(i){return this.logService.error(i),!1}}),this.CollectionDialogTabType=g._K,this.userId$=this.accountService.activeAccount$.pipe(Y.F6),this.filter$=this.routedVaultFilterService.filter$,this.organizationId$=this.filter$.pipe((0,x.T)(e=>e.organizationId),(0,G.p)(e=>void 0!==e),(0,G.p)(e=>e!==V.I_),(0,z.F)()),this.currentSearchText$=this.route.queryParams.pipe((0,x.T)(e=>e.search)),this.organization$=(0,$.z)([this.organizationId$,this.userId$]).pipe((0,R.n)(([e,t])=>this.organizationService.organizations$(t).pipe((0,_.Hc)(e))),(0,G.p)(e=>null!=e),(0,F.t)({refCount:!0,bufferSize:1})),this.hideVaultFilter$=this.organization$.pipe((0,x.T)(e=>e.isProviderUser&&!e.isMember)),this.allCollectionsWithoutUnassigned$=this.refreshingSubject$.pipe((0,G.p)(e=>e),(0,R.n)(()=>(0,$.z)([this.organizationId$,this.userId$])),(0,R.n)(([e,t])=>this.collectionAdminService.collectionAdminViews$(e,t)),(0,F.t)({refCount:!0,bufferSize:1})),this.allCollections$=(0,$.z)([this.organizationId$,this.allCollectionsWithoutUnassigned$]).pipe((0,x.T)(([e,t])=>{const i=new V.nb({name:this.i18nService.t("unassigned"),id:V.I_,organizationId:e});return t.concat(i)})),this.nestedCollections$=this.allCollections$.pipe((0,x.T)(e=>(0,_e.mw)(e)),(0,F.t)({refCount:!0,bufferSize:1})),this.allGroups$=this.organizationId$.pipe((0,R.n)(e=>this.groupService.getAll(e)),(0,F.t)({refCount:!0,bufferSize:1})),this.allCiphers$=(0,$.z)([this.organization$,this.userId$,this.restrictedItemTypesService.restricted$,this.refreshingSubject$]).pipe((0,R.n)(e=>ii(this,[e],void 0,function*([e,t,i]){let n;return this.showAddAccessToggle&&!e||this.addAccessToggle(0),!e.isMember&&e.isProviderUser?[]:(e.canEditAllCiphers?(n=yield this.cipherService.getAllFromApiForOrganization(e.id),n.forEach(e=>e.edit=!0)):n=yield this.cipherService.getManyFromApiForOrganization(e.id),n=n.filter(e=>!this.restrictedItemTypesService.isCipherRestricted(e,i)),yield this.searchService.indexCiphers(t,n,e.id),n)})),(0,F.t)({refCount:!0,bufferSize:1})),this.selectedCollection$=(0,$.z)([this.nestedCollections$,this.filter$]).pipe((0,G.p)(([e,t])=>null!=e&&null!=t),(0,x.T)(([e,t])=>{if(void 0!==t.collectionId&&t.collectionId!==pe.u&&t.collectionId!==V.I_)return Q.F.getTreeNodeObjectFromList(e,t.collectionId)}),(0,F.t)({refCount:!0,bufferSize:1})),this.showCollectionAccessRestricted$=(0,$.z)([this.filter$,this.selectedCollection$,this.organization$]).pipe((0,x.T)(([e,t,i])=>e.collectionId===V.I_&&!i.canEditUnassignedCiphers||!i.canEditAllCiphers&&null!=t&&!t.node.assigned),(0,F.t)({refCount:!0,bufferSize:1})),this.ciphers$=(0,$.z)([this.allCiphers$,this.filter$,this.currentSearchText$,this.showCollectionAccessRestricted$,this.userId$]).pipe((0,G.p)(([e,t])=>null!=e&&null!=t),(0,A.H)(e=>ii(this,[e],void 0,function*([e,t,i,n,o]){if(void 0===t.collectionId&&void 0===t.type)return[];if(n)return[];const s=(0,he.J)(t);return(yield this.searchService.isSearchable(o,i))?yield this.searchService.searchCiphers(o,i,[s],e):e.filter(s)})),(0,F.t)({refCount:!0,bufferSize:1})),this.organization$.pipe((0,R.n)(e=>(0,C.h)(this.organizationWarningsService.showInactiveSubscriptionDialog$(e),this.organizationWarningsService.showSubscribeBeforeFreeTrialEndsDialog$(e))),(0,b.pQ)()).subscribe(),this.editableCollections$=(0,$.z)([this.allCollectionsWithoutUnassigned$,this.organization$]).pipe((0,x.T)(([e,t])=>t.canEditAllCiphers?e:e.filter(e=>e.assigned)),(0,F.t)({refCount:!0,bufferSize:1})),this.collections$=(0,$.z)([this.nestedCollections$,this.filter$,this.currentSearchText$,this.addAccessStatus$,this.userId$,this.organization$]).pipe((0,G.p)(([e,t])=>null!=e&&null!=t),(0,A.H)(e=>ii(this,[e],void 0,function*([e,t,i,n,o,s]){var r;if(t.collectionId===V.I_||void 0===t.collectionId&&void 0!==t.type)return[];this.showAddAccessToggle=!1;let l=[];if(void 0===t.collectionId||t.collectionId===pe.u)l=e;else{l=null!==(r=Q.F.getTreeNodeObjectFromList(e,t.collectionId).children)&&void 0!==r?r:[]}let a=[];if(yield this.searchService.isSearchable(o,i)){const e=(0,_e.eO)(l);a=this.searchPipe.transform(e,i,e=>e.name,e=>e.id)}else a=l.map(e=>e.node);return this.showAddAccessToggle=!s.allowAdminAccessToAllCollectionItems&&s.canEditUnmanagedCollections&&a.some(e=>e.unmanaged),1===n&&this.showAddAccessToggle&&(a=a.filter(e=>e.unmanaged)),a})),(0,k.Q)(this.destroy$),(0,F.t)({refCount:!0,bufferSize:1}));const te=(0,T.y)([this.organization$,this.filter$,this.allCollections$,this.allGroups$,this.ciphers$,this.collections$,this.selectedCollection$,this.showCollectionAccessRestricted$]).pipe((0,x.T)(()=>!0),(0,j.Z)(!1),(0,U.s)(2),(0,F.t)({refCount:!0,bufferSize:1}));this.loading$=(0,$.z)([this.refreshingSubject$,this.processingEvent$,te]).pipe((0,x.T)(([e,t,i])=>e||t||!i))}ngOnInit(){return ii(this,void 0,void 0,function*(){const e=(0,$.z)([this.organization$,this.route.queryParams]).pipe((0,E.$)(),(0,R.n)(e=>ii(this,[e],void 0,function*([e]){e.canEditAnyCollection||(yield this.syncService.fullSync(!1))})),(0,X.W)(e=>(this.logService.error("Failed during firstSetup$:",e),(0,y.of)())),(0,F.t)({refCount:!0,bufferSize:1}));this.broadcasterService.subscribe(bi,e=>{this.ngZone.run(()=>ii(this,void 0,void 0,function*(){if("syncCompleted"===e.command)e.successfully&&(this.refresh(),this.changeDetectorRef.detectChanges())}))}),this.routedVaultFilterBridgeService.activeFilter$.pipe((0,k.Q)(this.destroy$)).subscribe(e=>{this.activeFilter=e,this.activeFilter.collectionId||(this.showAddAccessToggle=!1)}),this.searchText$.pipe((0,D.B)(200),(0,k.Q)(this.destroy$)).subscribe(e=>this.router.navigate([],{queryParams:{search:H.A.isNullOrEmpty(e)?null:e},queryParamsHandling:"merge",replaceUrl:!0}));const t=this.allCiphers$.pipe((0,x.T)(e=>Object.fromEntries(e.map(e=>[e.id,e]))));e.pipe((0,R.n)(()=>(0,$.z)([this.route.queryParams,t])),(0,G.p)(()=>null==this.vaultItemDialogRef),(0,R.n)(e=>ii(this,[e],void 0,function*([e,t]){const i=wi(e);if(!i)return void(this.prevCipherId=null);if(i===this.prevCipherId)return;this.prevCipherId=i;const n=t[i];if(n){let t=e.action;if("showFailedToDecrypt"==t)return te.Tp.open(this.dialogService,{cipherIds:[i]}),void(yield this.router.navigate([],{queryParams:{itemId:null,cipherId:null,action:null},queryParamsHandling:"merge",replaceUrl:!0}));null==t&&(t="view"),"view"===t?yield this.viewCipherById(n):yield this.editCipher(n,!1)}else this.toastService.showToast({variant:"error",message:this.i18nService.t("unknownCipher")}),yield this.router.navigate([],{queryParams:{cipherId:null,itemId:null},queryParamsHandling:"merge"})})),(0,k.Q)(this.destroy$)).subscribe(),e.pipe((0,R.n)(()=>(0,$.z)([this.route.queryParams,this.organization$,this.allCiphers$])),(0,R.n)(e=>ii(this,[e],void 0,function*([e,t,i]){const n=e.viewEvents;if(!n)return;const o=i.find(e=>e.id===n);t.useEvents&&null!=o?yield this.viewEvents(o):(this.toastService.showToast({variant:"error",message:this.i18nService.t("unknownCipher")}),yield this.router.navigate([],{queryParams:{viewEvents:null},queryParamsHandling:"merge"}))})),(0,k.Q)(this.destroy$)).subscribe(),e.pipe((0,R.n)(()=>this.allCollections$),(0,k.Q)(this.destroy$)).subscribe(e=>{this.vaultFilterService.reloadCollections&&this.vaultFilterService.reloadCollections(e),this.refreshingSubject$.next(!1)}),this.isEmpty$=(0,$.z)([this.ciphers$,this.collections$]).pipe((0,x.T)(([e,t])=>0===t.length&&0===(null==e?void 0:e.length)))})}navigateToPaymentMethod(){return ii(this,void 0,void 0,function*(){const e=yield(0,S._)(this.organizationId$);yield this.router.navigate(["organizations",`${e}`,"billing","payment-details"],{state:{launchPaymentModalAutomatically:!0}})})}addAccessToggle(e){this.addAccessStatus$.next(e)}ngOnDestroy(){this.broadcasterService.unsubscribe(bi),this.destroy$.next(),this.destroy$.complete()}onVaultItemsEvent(e){return ii(this,void 0,void 0,function*(){this.processingEvent$.next(!0);try{const t=yield(0,S._)(this.organization$);switch(e.type){case"viewAttachments":yield this.editCipherAttachments(e.item);break;case"clone":yield this.cloneCipher(e.item);break;case"restore":1===e.items.length?yield this.restore(e.items[0]):yield this.bulkRestore(e.items);break;case"delete":{const i=e.items.filter(e=>void 0===e.collection).map(e=>e.cipher).filter(e=>null!=e),n=e.items.filter(e=>void 0===e.cipher).map(e=>e.collection).filter(e=>null!=e);1===i.length&&0===n.length?yield this.deleteCipher(i[0]):0===i.length&&1===n.length?yield this.deleteCollection(n[0]):yield this.bulkDelete(i,n,t);break}case"copyField":yield this.copy(e.item,e.field);break;case"editCollection":yield this.editCollection(e.item,g._K.Info,e.readonly);break;case"viewCollectionAccess":yield this.editCollection(e.item,g._K.Access,e.readonly,e.initialPermission);break;case"bulkEditCollectionAccess":yield this.bulkEditCollectionAccess(e.items,t);break;case"assignToCollections":yield this.bulkAssignToCollections(e.items);break;case"viewEvents":yield this.viewEvents(e.item);break;case"editCipher":yield this.editCipher(e.item)}}finally{this.processingEvent$.next(!1)}})}filterSearchText(e){this.searchText$.next(e)}editCipherAttachments(e){return ii(this,void 0,void 0,function*(){if(0!==e.reprompt&&!(yield this.passwordRepromptService.showPasswordPrompt()))return void this.go({cipherId:null,itemId:null});const t=yield(0,S._)(this.organization$);if(null==t.maxStorageGb||0===t.maxStorageGb)return void this.messagingService.send("upgradeOrganization",{organizationId:e.organizationId});const i=te._A.open(this.dialogService,{cipherId:e.id,organizationId:e.organizationId,admin:!0}),n=yield(0,S._)(i.closed);(null==n?void 0:n.action)!==te.NY.Removed&&(null==n?void 0:n.action)!==te.NY.Uploaded||this.refresh()})}addCipher(e){return ii(this,void 0,void 0,function*(){const t=yield this.cipherFormConfigService.buildConfig("add",void 0,e),i=this.activeFilter.collectionId,n=yield(0,S._)(this.organization$);t.initialValues={organizationId:n.id,collectionIds:i?[i]:[]},yield this.openVaultItemDialog("form",t)})}editCipher(e,t){return ii(this,void 0,void 0,function*(){if(e&&0!==e.reprompt&&!(yield this.passwordRepromptService.showPasswordPrompt()))return void this.go({cipherId:null,itemId:null});const i=yield this.cipherFormConfigService.buildConfig(t?"clone":"edit",null==e?void 0:e.id);yield this.openVaultItemDialog("form",i,e)})}viewCipherById(e){return ii(this,void 0,void 0,function*(){if(!e)return;if(e&&0!==e.reprompt&&!(yield this.passwordRepromptService.showPasswordPrompt()))return void(yield this.go({cipherId:null,itemId:null,action:null}));const t=yield this.cipherFormConfigService.buildConfig("edit",e.id,e.type);yield this.openVaultItemDialog("view",t,e,this.activeFilter.collectionId)})}openVaultItemDialog(e,t,i,n){return ii(this,void 0,void 0,function*(){const o=yield(0,S._)(this.organization$),s=!!i&&(!i.edit&&!o.canEditAllCiphers),r=s?"view":e;this.vaultItemDialogRef=le.V.open(this.dialogService,{mode:r,formConfig:t,disableForm:s,activeCollectionId:n,isAdminConsoleAction:!0,restore:this.restore});const l=yield(0,M.s)(this.vaultItemDialogRef.closed);this.vaultItemDialogRef=void 0,l!==le.r.Deleted&&l!==le.r.Saved||this.refresh(),l!==le.r.PremiumUpgrade&&(yield this.go({cipherId:null,itemId:null,action:null}))})}cloneCipher(e){return ii(this,void 0,void 0,function*(){if(e.login.hasFido2Credentials){if(!(yield this.dialogService.openSimpleDialog({title:{key:"passkeyNotCopied"},content:{key:"passkeyNotCopiedAlert"},type:"info"})))return!1}yield this.editCipher(e,!0)})}bulkRestore(e){return ii(this,void 0,void 0,function*(){const t=yield(0,S._)(this.organization$);if(!t.permissions.editAnyCollection&&e.some(e=>!e.edit&&!t.allowAdminAccessToAllCollectionItems))return void this.showMissingPermissionsError();if(!(yield this.repromptCipher(e)))return;const i=[],n=[],o=yield(0,S._)(this.userId$);t.canEditAllCiphers?e.map(e=>{i.push(e.id)}):e.map(e=>{0===e.collectionIds.length?n.push(e.id):e.edit&&i.push(e.id)}),0!==n.length||0!==i.length?((n.length>0||i.length>0)&&(yield this.cipherService.restoreManyWithServer([...n,...i],o,t.id)),this.toastService.showToast({variant:"success",message:this.i18nService.t("restoredItems")}),this.refresh()):this.toastService.showToast({variant:"error",title:this.i18nService.t("errorOccurred"),message:this.i18nService.t("nothingSelected")})})}deleteCipher(e){return ii(this,void 0,void 0,function*(){const t=yield(0,S._)(this.organization$);if(!e.edit&&!t.canEditAllCiphers)return this.showMissingPermissionsError(),!1;if(!(yield this.repromptCipher([e])))return!1;const i=e.isDeleted;if(!(yield this.dialogService.openSimpleDialog({title:{key:i?"permanentlyDeleteItem":"deleteItem"},content:{key:i?"permanentlyDeleteItemConfirmation":"deleteItemConfirmation"},type:"warning"})))return!1;try{const t=yield(0,S._)(this.accountService.activeAccount$.pipe(Y.F6));return yield this.deleteCipherWithServer(e.id,t,i,e.isUnassigned),this.toastService.showToast({variant:"success",message:this.i18nService.t(i?"permanentlyDeletedItem":"deletedItem")}),this.refresh(),!0}catch(n){return this.logService.error(n),!1}})}deleteCollection(e){return ii(this,void 0,void 0,function*(){var t,i;const n=yield(0,S._)(this.organization$),o=yield(0,S._)(this.userId$);if(!e.canDelete(n))return void this.showMissingPermissionsError();if(yield this.dialogService.openSimpleDialog({title:e.name,content:{key:"deleteCollectionConfirmation"},type:"warning"}))try{yield this.apiService.deleteCollection(n.id,e.id),yield this.collectionService.delete([e.id],o),this.toastService.showToast({variant:"success",message:this.i18nService.t("deletedCollectionId",e.name)}),yield this.cipherService.clear();const s=yield(0,S._)(this.selectedCollection$);(null==s?void 0:s.node.id)===e.id&&this.router.navigate([],{queryParams:{collectionId:null!==(i=null===(t=null==s?void 0:s.parent)||void 0===t?void 0:t.node.id)&&void 0!==i?i:null},queryParamsHandling:"merge",replaceUrl:!0}),this.refresh()}catch(s){this.logService.error(s)}})}bulkDelete(e,t,i){return ii(this,void 0,void 0,function*(){if(!(yield this.repromptCipher(e)))return;const n=[],o=[];if(e.map(e=>{e.isUnassigned?n.push(e.id):o.push(e.id)}),0===e.length&&0===t.length)return void this.toastService.showToast({variant:"error",message:this.i18nService.t("nothingSelected")});const s=yield(0,S._)(this.organization$),r=null==t||t.every(e=>e.canDelete(i));if(!(null==e||e.every(e=>e.edit)||s.canEditAllCiphers)||!r)return void this.showMissingPermissionsError();const l=yield(0,S._)(this.filter$),a=(0,ce.Q0)(this.dialogService,{data:{permanent:"trash"===l.type,cipherIds:o,collections:t,organization:i,unassignedCiphers:n}});(yield(0,M.s)(a.closed))===ce.vA.Deleted&&this.refresh()})}copy(e,t){return ii(this,void 0,void 0,function*(){let i,n,o;if("username"===t)i="Username",n=e.login.username,o="username";else if("password"===t)i="Password",n=e.login.password,o="password";else{if("totp"!==t||null==e.login.totp)return void this.toastService.showToast({variant:"error",message:this.i18nService.t("unexpectedError")});i="TOTP";n=(yield(0,S._)(this.totpService.getCode$(e.login.totp))).code,o="verificationCodeTotp"}this.passwordRepromptService.protectedFields().includes(i)&&!(yield this.repromptCipher([e]))||e.viewPassword&&null!=n&&(this.platformUtilsService.copyToClipboard(n,{window}),this.toastService.showToast({variant:"info",message:this.i18nService.t("valueCopied",this.i18nService.t(o))}),"password"===t?yield this.eventCollectionService.collect(q.Bx.Cipher_ClientCopiedPassword,e.id):"totp"===t&&(yield this.eventCollectionService.collect(q.Bx.Cipher_ClientCopiedHiddenField,e.id)))})}addCollection(){return ii(this,void 0,void 0,function*(){const e=yield(0,S._)(this.organization$),t=yield(0,S._)(this.selectedCollection$),i=(0,g.jN)(this.dialogService,{data:{organizationId:e.id,parentCollectionId:null==t?void 0:t.node.id,limitNestedCollections:!e.canEditAnyCollection,isAdminConsoleActive:!0}}),n=yield(0,M.s)(i.closed);(null==n?void 0:n.action)!==g.RZ.Saved&&(null==n?void 0:n.action)!==g.RZ.Deleted||this.refresh()})}editCollection(e,t,i,n){return ii(this,void 0,void 0,function*(){var o;const s=yield(0,S._)(this.organization$),r=(0,g.jN)(this.dialogService,{data:{collectionId:e.id,organizationId:s.id,initialTab:t,readonly:i,isAddAccessCollection:e.unmanaged,limitNestedCollections:!s.canEditAnyCollection,isAdminConsoleActive:!0,initialPermission:n}}),l=yield(0,M.s)(r.closed);if((null==l?void 0:l.action)===g.RZ.Saved||(null==l?void 0:l.action)===g.RZ.Deleted){this.refresh();const t=yield(0,S._)(this.selectedCollection$);l.action===g.RZ.Deleted&&(null==t?void 0:t.node.id)===e.id&&this.router.navigate([],{queryParams:{collectionId:null!==(o=t.parent.node.id)&&void 0!==o?o:null},queryParamsHandling:"merge",replaceUrl:!0})}})}bulkEditCollectionAccess(e,t){return ii(this,void 0,void 0,function*(){if(0===e.length)return void this.toastService.showToast({variant:"error",message:this.i18nService.t("noCollectionsSelected")});if(e.some(e=>!e.canEdit(t)))return void this.showMissingPermissionsError();const i=yield(0,S._)(this.organization$),o=Xe.open(this.dialogService,{data:{collections:e,organizationId:i.id}});(yield(0,M.s)(o.closed))===n.Saved&&this.refresh()})}bulkAssignToCollections(e){return ii(this,void 0,void 0,function*(){var t,i;if(0===e.length)return void this.toastService.showToast({variant:"error",message:this.i18nService.t("nothingSelected")});const n=yield(0,S._)(this.editableCollections$),o=yield(0,S._)(this.organization$),s=re.G.open(this.dialogService,{data:{ciphers:e,organizationId:o.id,availableCollections:n,activeCollection:null===(i=null===(t=this.activeFilter)||void 0===t?void 0:t.selectedCollectionNode)||void 0===i?void 0:i.node,isSingleCipherAdmin:1===e.length&&(o.canEditAllCiphers||e[0].isUnassigned)}});(yield(0,M.s)(s.closed))===te.f$.Saved&&this.refresh()})}viewEvents(e){return ii(this,void 0,void 0,function*(){const t=yield(0,S._)(this.organization$);(0,ve.l)(this.dialogService,{data:{name:e.name,organizationId:t.id,entityId:e.id,showUser:!0,entity:"cipher"}})})}deleteCipherWithServer(e,t,i,n){return ii(this,void 0,void 0,function*(){const o=(yield(0,S._)(this.organization$)).canEditAllCiphers||n;return i?this.cipherService.deleteWithServer(e,t,o):this.cipherService.softDeleteWithServer(e,t,o)})}repromptCipher(e){return ii(this,void 0,void 0,function*(){return!e.find(e=>e.reprompt!==L.b.None)||(yield this.passwordRepromptService.showPasswordPrompt())})}refresh(){this.refreshingSubject$.next(!0),this.vaultItemsComponent&&this.vaultItemsComponent.clearSelection()}go(e=null){null==e&&(e={type:this.activeFilter.cipherType,collectionId:this.activeFilter.collectionId,deleted:this.activeFilter.isDeleted||null}),this.router.navigate([],{relativeTo:this.route,queryParams:e,queryParamsHandling:"merge",replaceUrl:!0})}showMissingPermissionsError(){this.toastService.showToast({variant:"error",message:this.i18nService.t("missingPermissions")})}}yi.ɵfac=function(e){return new(e||yi)(Ie.rXU(ut.nX),Ie.rXU(d.PV),Ie.rXU(We.u),Ie.rXU(de.a),Ie.rXU(ue.B),Ie.rXU(ut.Ix),Ie.rXU(jt.gRc),Ie.rXU(W.H),Ie.rXU(Te.W),Ie.rXU(ye.o3),Ie.rXU(O.U),Ie.rXU(Ut.y),Ie.rXU(Ie.SKi),Ie.rXU(Ce.y),Ie.rXU(et.p),Ie.rXU(te.qX),Ie.rXU(V.vE),Ie.rXU(Et.S),Ie.rXU(B.R),Ie.rXU(l.nK),Ie.rXU(P.K),Ie.rXU(Xt.c),Ie.rXU(Dt.R),Ie.rXU(Vt.G),Ie.rXU(we.f),Ie.rXU(te.hI),Ie.rXU(Bt.P),Ie.rXU($e.Di),Ie.rXU(ne.S),Ie.rXU(V.YD),Ie.rXU(J.b))},yi.ɵcmp=Ie.VBU({type:yi,selectors:[["app-org-vault"]],viewQuery:function(e,t){if(1&e&&Ie.GBs(ni,5),2&e){let e;Ie.mGM(e=Ie.lsd())&&(t.vaultItemsComponent=e.first)}},features:[Ie.Jv_([ue.B,de.a,{provide:te.hI,useClass:me.l}])],decls:11,vars:16,consts:[["vaultItems",""],[3,"filter","loading","organization","collection","searchText"],[1,"tw-flex","tw-flex-row"],[1,"tw-w-1/4","tw-mr-5"],[3,"selected"],["type","warning"],[3,"ciphers","collections","allCollections","allOrganizations","allGroups","disabled","showOwner","showPermissionsColumn","showCollections","showGroups","showPremiumFeatures","showBulkMove","showBulkTrashOptions","useEvents","showAdminActions","showBulkEditCollectionAccess","showBulkAddToCollections","viewingOrgVault","addAccessStatus","addAccessToggle","activeCollection"],[1,"tw-mt-6","tw-flex","tw-h-full","tw-flex-col","tw-items-center","tw-justify-start"],[3,"clicked","organization"],[3,"organization"],[3,"onAddCipher","onAddCollection","onEditCollection","onDeleteCollection","searchTextChanged","filter","loading","organization","collection","searchText"],[3,"searchTextChanged","organization","activeFilter","searchText"],[3,"selectedChange","selected"],[3,"value"],[3,"onEvent","ciphers","collections","allCollections","allOrganizations","allGroups","disabled","showOwner","showPermissionsColumn","showCollections","showGroups","showPremiumFeatures","showBulkMove","showBulkTrashOptions","useEvents","showAdminActions","showBulkEditCollectionAccess","showBulkAddToCollections","viewingOrgVault","addAccessStatus","addAccessToggle","activeCollection"],[3,"canEditCollection","canViewCollectionInfo"],["slot","title",1,"tw-mt-4","tw-block"],["slot","button","bitButton","","buttonType","primary","type","button"],["slot","button","bitButton","","buttonType","primary","type","button",3,"click"],["aria-hidden","true",1,"bwi","bwi-plus"],[3,"viewCollectionClicked","canEditCollection","canViewCollectionInfo"],["aria-hidden","true",1,"bwi","bwi-spinner","bwi-spin","tw-text-muted",3,"title"],[1,"tw-sr-only"]],template:function(e,t){if(1&e&&(Ie.SS7(0),Ie.nI1(1,"async"),Ie.SS7(2),Ie.nI1(3,"async"),Ie.SS7(4),Ie.nI1(5,"async"),Ie.SS7(6),Ie.nI1(7,"async"),Ie.SS7(8),Ie.nI1(9,"async"),Ie.nVh(10,fi,15,17)),2&e){const e=Ie.bH3(Ie.bMT(1,1,t.organization$));Ie.R7$(2),Ie.bH3(Ie.bMT(3,4,t.selectedCollection$)),Ie.R7$(2),Ie.bH3(Ie.bMT(5,7,t.filter$)),Ie.R7$(2),Ie.bH3(Ie.bMT(7,10,t.refreshingSubject$)),Ie.R7$(2),Ie.bH3(Ie.bMT(9,13,t.loading$)),Ie.R7$(2),Ie.vxM(e?10:-1)}},dependencies:[kt,Oe,st,Zt,ae.l,oe.W_,se.G,ze.Q,Kt.G,Ye.D,ei.H,ti.a,K.H,ee.s,ie.z,ie.h,Me.Jj,ke.$],encapsulation:2});const wi=e=>e.itemId||e.cipherId,Si=[{data:{titleId:"vaults"},path:"",canActivate:[(0,f.V)(d.of)],component:yi}];class $i{}$i.ɵfac=function(e){return new(e||$i)},$i.ɵmod=Ie.$C({type:$i}),$i.ɵinj=Ne.G2t({imports:[a.iI.forChild(Si),a.iI]});class Ci{}Ci.ɵfac=function(e){return new(e||Ci)},Ci.ɵmod=Ie.$C({type:Ci}),Ci.ɵinj=Ne.G2t({imports:[$i,h.G,v.B,m.K,p.t,g.GW,yi]});var Ti=i(95661),Mi=i(8131);const xi=De.Sm`
<svg version="1.1" viewBox="0 0 800 200" xmlns="http://www.w3.org/2000/svg">
<g class="tw-fill-text-alt2" clip-path="url(#admin-console-logo-clip)">
 <path d="m457.16 129.39-11.407-36.49q-1.0783-3.3482-4.0292-15.209h-.454q-2.27 9.9313-3.9725 15.322l-11.747 36.377h-10.896l-16.968-62.197h9.8744q6.0158 23.438 9.137 35.696 3.178 12.258 3.632 16.514h.454q.62424-3.2347 1.9863-8.342 1.4188-5.1642 2.4402-8.1717l11.407-35.696h10.215l11.123 35.696q3.178 9.7611 4.313 16.401h.454q.227-2.043 1.1918-6.2993 1.0215-4.2562 11.861-45.797h9.7611l-17.195 62.197zm77.858 0-1.8727-8.8528h-.454q-4.6535 5.8455-9.3072 7.9451-4.5968 2.043-11.52 2.043-9.2503 0-14.528-4.767-5.221-4.767-5.221-13.563 0-18.841 30.134-19.749l10.555-.3405v-3.859q0-7.3209-3.178-10.783-3.1212-3.5185-10.045-3.5185-7.7748 0-17.592 4.767l-2.8943-7.207q4.5968-2.497 10.045-3.9158 5.5048-1.4187 11.009-1.4187 11.123 0 16.457 4.9373 5.3912 4.9373 5.3912 15.833v42.449zm-21.281-6.6399q8.7964 0 13.79-4.8238 5.0508-4.8238 5.0508-13.506v-5.6183l-9.4205.39725q-11.237.39725-16.231 3.5185-4.9372 3.0645-4.9372 9.5908 0 5.1075 3.0645 7.7748 3.1212 2.6672 8.6825 2.6672zm76.045-56.693q4.1428 0 7.4343.68101l-1.3053 8.7395q-3.859-.85122-6.8101-.85122-7.5476 0-12.939 6.1291-5.3345 6.1291-5.3345 15.266v33.369h-9.4205v-62.197h7.7748l1.0783 11.52h.454q3.4617-6.0721 8.3425-9.3636 4.8805-3.2915 10.726-3.2915zm59.077 54.991h-.51081q-6.526 9.4775-19.522 9.4775-12.201 0-19.011-8.342-6.7532-8.342-6.7532-23.721t6.8102-23.892q6.8101-8.5122 18.954-8.5122 12.655 0 19.408 9.1933h.73779l-.39725-4.4832-.22704-4.3697v-25.311h9.4205v88.301h-7.6615zm-18.841 1.589q9.6478 0 13.96-5.221 4.3697-5.2777 4.3697-16.968v-1.9863q0-13.223-4.4264-18.841-4.3698-5.675-14.017-5.675-8.2856 0-12.712 6.4696-4.3698 6.4127-4.3698 18.16 0 11.918 4.3698 17.99 4.3697 6.0721 12.825 6.0721zm74 7.8881q-13.79 0-21.792-8.3989-7.9451-8.3989-7.9451-23.324 0-15.039 7.3773-23.892 7.4343-8.8528 19.919-8.8528 11.69 0 18.501 7.7179 6.8101 7.6615 6.8101 20.26v5.9588h-42.846q.28376 10.953 5.5048 16.628 5.2777 5.675 14.812 5.675 10.045 0 19.863-4.1995v8.3989q-4.994 2.1565-9.4775 3.0645-4.4265.96478-10.726.96478zm-2.5537-56.58q-7.4912 0-11.975 4.8805-4.4265 4.8805-5.221 13.506h32.518q0-8.9097-3.9725-13.62-3.9725-4.767-11.35-4.767zm84.047 55.445v-40.236q0-7.6045-3.4617-11.35-3.4618-3.7455-10.839-3.7455-9.7611 0-14.301 5.2777t-4.54 17.422v32.631h-9.4205v-62.197h7.6615l1.5322 8.5122h.45403q2.8942-4.5968 8.1153-7.0937 5.221-2.5537 11.634-2.5537 11.237 0 16.912 5.448 5.675 5.3912 5.675 17.309v40.576z"/>
 <path d="m213.24 129.39-3.3482-8.6261h-.454q-4.3697 5.5048-9.023 7.6615-4.5968 2.0998-12.031 2.0998-9.137 0-14.415-5.221-5.221-5.221-5.221-14.869 0-10.102 7.0368-14.869 7.0937-4.8238 21.338-5.3345l11.009-.3405v-2.7808q0-9.6478-9.8744-9.6478-7.6045 0-17.876 4.5968l-5.7318-11.69q10.953-5.7318 24.289-5.7318 12.769 0 19.579 5.5615 6.8102 5.5615 6.8102 16.912v42.279zm-5.1075-29.397-6.6962.227q-7.5476.227-11.237 2.724-3.6888 2.497-3.6888 7.6045 0 7.321 8.3989 7.321 6.0158 0 9.5908-3.4617 3.632-3.4617 3.632-9.1933zm79.962 29.397-2.3268-8.1153h-.908q-2.7808 4.4265-7.8881 6.8665-5.1075 2.3835-11.634 2.3835-11.18 0-16.855-5.9588-5.675-6.0158-5.675-17.252v-41.371h17.309v37.058q0 6.8665 2.4402 10.328 2.4402 3.405 7.7748 3.405 7.264 0 10.499-4.8238 3.2348-4.8805 3.2348-16.117v-29.85h17.309v63.447zm48.748 0h-17.309v-88.301h17.309zm44.889-12.655q4.54 0 10.896-1.9863v12.882q-6.4696 2.8943-15.89 2.8943-10.385 0-15.152-5.221-4.7103-5.2777-4.7103-15.776v-30.588h-8.2856v-7.321l9.5338-5.7885 4.994-13.393h11.066v13.506h17.763v12.996h-17.763v30.588q0 3.6887 2.043 5.448 2.0998 1.7592 5.5047 1.7592z"/>
 <path d="m51.982 33.947-15.322.002 41.131 115.17h14.518l41.131-115.17h-15.162l-25.971 73.872c-1.7205 4.7315-3.1706 9.1927-4.3535 13.387-1.1829 4.086-2.1516 8.0119-2.9043 11.775-.75272-3.7636-1.7195-7.7417-2.9023-11.936-1.1829-4.1938-2.635-8.7098-4.3555-13.549l-25.809-73.552z"/>
 <path d="m84.264 5.0749a2.3288 2.3288 0 00-1.2122.99654l-4.145 6.9077c-.72599.06029-1.4502.12529-2.1701.20657l-5.406-5.9599a2.3288 2.3288 0 00-3.9203.77975l-2.7161 7.5796c-.7008.20184-1.4008.40458-2.0929.62653l-6.4616-4.7875a2.3288 2.3288 0 00-3.691 1.53l-1.1884 7.9871c-.63834.33084-1.2749.66363-1.9023 1.0124l-7.297-3.4482a2.3288 2.3288 0 00-3.3222 2.2201l.39272 8.0937c-.55229.44111-1.0997.8874-1.639 1.3438l-7.8588-1.9647a2.3288 2.3288 0 00-2.825 2.825l1.9647 7.8588c-.45646.53923-.90273 1.0867-1.3439 1.639l-8.0937-.39271a2.3288 2.3288 0 00-2.2201 3.3222l3.4482 7.297c-.3488.62737-.68158 1.2639-1.0124 1.9023l-7.9871 1.1884a2.3288 2.3288 0 00-1.53 3.6911l4.7875 6.4616c-.22196.69217-.4247 1.3921-.62653 2.093l-7.5796 2.7161a2.3288 2.3288 0 00-.77976 3.9203l5.9599 5.4061c-.08128.71995-.14628 1.4442-.20657 2.1701l-6.9077 4.1451a2.3288 2.3288 0 000 3.9952l6.9077 4.1439c.06028.72636.12524 1.451.20657 2.1713l-5.9599 5.4061a2.3288 2.3288 0 00.77976 3.9192l7.5796 2.7161c.20188.70099.4045 1.4017.62653 2.0941l-4.7875 6.4605a2.3288 2.3288 0 001.53 3.6922l7.9871 1.1884c.33079.63822.6637 1.275 1.0124 1.9023l-3.4482 7.297a2.3288 2.3288 0 002.2201 3.3222l8.0937-.39272c.44117.55235.88734 1.0997 1.3439 1.639l-1.9647 7.8588a2.3288 2.3288 0 002.825 2.825l7.8588-1.9647c.53923.45647 1.0867.90273 1.639 1.3438l-.39272 8.0926a2.3288 2.3288 0 003.3222 2.2201l7.297-3.447c.62736.34881 1.2639.68158 1.9023 1.0124l1.1884 7.987a2.3288 2.3288 0 003.691 1.5289l6.4616-4.7864c.69217.22197 1.3921.4247 2.0929.62654l2.7161 7.5796a2.3288 2.3288 0 003.9203.7786l5.4049-5.9588c.72031.0813 1.4449.14624 2.1713.20656l4.145 6.9077a2.3288 2.3288 0 003.9952 0l4.1439-6.9077c.72674-.0603 1.4517-.12518 2.1724-.20656l5.4049 5.9588a2.3288 2.3288 0 003.9192-.7786l2.7161-7.5796c.70103-.20189 1.4017-.4045 2.0941-.62654l6.4605 4.7864a2.3288 2.3288 0 003.6922-1.5289l1.1884-7.987c.63823-.33079 1.275-.6637 1.9023-1.0124l7.297 3.447a2.3288 2.3288 0 003.3222-2.2201l-.39271-8.0926c.55234-.44117 1.0997-.88734 1.639-1.3438l7.8588 1.9647a2.3288 2.3288 0 002.825-2.825l-1.9647-7.8588c.4565-.53928.90269-1.0866 1.3438-1.639l8.0926.39272a2.3288 2.3288 0 002.2201-3.3222l-3.447-7.297c.34872-.62723.68163-1.264 1.0124-1.9023l7.987-1.1884a2.3288 2.3288 0 001.5289-3.6922l-4.7863-6.4605c.22202-.69235.42462-1.3931.62652-2.0941l7.5796-2.7161a2.3288 2.3288 0 00.77862-3.9192l-5.9588-5.4049c.0814-.72069.14623-1.4457.20658-2.1724l6.9077-4.1439a2.3288 2.3288 0 000-3.9952l-6.9077-4.1451c-.0603-.72635-.12524-1.451-.20658-2.1713l5.9588-5.4049a2.3288 2.3288 0 00-.77862-3.9203l-7.5796-2.7161c-.20184-.70082-.40457-1.4008-.62652-2.093l4.7863-6.4616a2.3288 2.3288 0 00-1.5289-3.6911l-7.987-1.1884c-.33084-.63836-.66362-1.2749-1.0124-1.9023l3.447-7.297a2.3288 2.3288 0 00-2.2201-3.3222l-8.0926.39271c-.44112-.55229-.8874-1.0997-1.3438-1.639l1.9647-7.8588a2.3288 2.3288 0 00-2.825-2.825l-7.8588 1.9647c-.53927-.4565-1.0866-.9027-1.639-1.3438l.39271-8.0937a2.3288 2.3288 0 00-3.3222-2.2201l-7.297 3.4482c-.62726-.34873-1.264-.68165-1.9023-1.0124l-1.1884-7.9871a2.3288 2.3288 0 00-3.6922-1.53l-6.4605 4.7875c-.69236-.22201-1.3931-.42463-2.0941-.62653l-2.7161-7.5796a2.3288 2.3288 0 00-3.9192-.77975l-5.406 5.9599c-.72032-.08133-1.4449-.14626-2.1713-.20657l-4.1439-6.9077a2.3288 2.3288 0 00-2.783-.99654zm.78543 14.613a4.657 4.657 0 014.6569 4.6569 4.657 4.657 0 01-4.6569 4.6569 4.657 4.657 0 01-4.6569-4.6569 4.657 4.657 0 014.6569-4.6569zm-10.998 8.0064 7.7056 7.7056a4.6575 4.6575 0 006.5853 0l7.7056-7.7056c17.959 3.3214 33.023 14.65 41.468 30.141l-4.943 9.6998a4.6575 4.6575 0 002.0351 6.263l9.7123 4.9486c.32157 2.5182.49487 5.0839.49487 7.692 0 15.934-6.1974 30.369-16.306 41.066l-10.796-1.7093a4.6575 4.6575 0 00-5.3277 3.8704l-1.7116 10.804c-7.7603 3.6739-16.443 5.734-25.624 5.734-9.1812 0-17.864-2.0608-25.625-5.7352l-1.7116-10.803a4.6575 4.6575 0 00-5.3277-3.8715l-10.795 1.7105c-10.108-10.697-16.306-25.132-16.306-41.066 0-2.608.1733-5.1738.49487-7.692l9.7111-4.9486a4.6575 4.6575 0 002.0351-6.263l-4.9418-9.6986c8.4449-15.492 23.508-26.821 41.468-30.142zm-47.923 34.902a4.657 4.657 0 011.3064.22587 4.657 4.657 0 012.9896 5.868 4.657 4.657 0 01-5.868 2.9907 4.657 4.657 0 01-2.9907-5.8691 4.657 4.657 0 014.5627-3.2155zm117.84 0a4.657 4.657 0 014.5616 3.2155 4.657 4.657 0 01-2.9896 5.8691 4.657 4.657 0 01-5.868-2.9907 4.657 4.657 0 012.9896-5.868 4.657 4.657 0 011.3064-.22587zm-95.153 69.428a4.657 4.657 0 012.4709.88189 4.657 4.657 0 011.0306 6.5047 4.657 4.657 0 01-6.5047 1.0306 4.657 4.657 0 01-1.0306-6.5047 4.657 4.657 0 014.0338-1.9125zm72.463 0a4.657 4.657 0 014.0338 1.9125 4.657 4.657 0 01-1.0306 6.5047 4.657 4.657 0 01-6.5047-1.0306 4.657 4.657 0 011.0306-6.5047 4.657 4.657 0 012.4709-.88189z"/>
 <path d="m406.1 185.44-4.8026-12.342h-15.803l-4.7468 12.342h-5.0817l15.58-40.04h4.5232l15.524 40.04zm-10.778-28.871q-.16753-.44674-.55844-1.6194-.3909-1.1727-.7818-2.4012-.33505-1.2844-.55843-1.9545-.39091 1.7312-.89345 3.4064-.50261 1.6194-.83768 2.5687l-4.5233 12.062h12.62zm31.384 29.429q-5.5844 0-8.9346-3.8532-3.3506-3.9091-3.3506-11.615t3.3506-11.615q3.4064-3.9649 8.9905-3.9649 3.4623 0 5.6402 1.2844 2.2338 1.2844 3.6298 3.1271h.33506q-.0559-.72595-.22337-2.122-.11169-1.4518-.11169-2.2895v-11.951h4.9142v42.441h-3.9649l-.72593-4.0207h-.22339q-1.3403 1.8987-3.574 3.2389-2.2338 1.3402-5.7519 1.3402zm.7818-4.0765q4.7468 0 6.6452-2.5687 1.9545-2.6246 1.9545-7.8738v-.89347q0-5.5844-1.8428-8.544-1.8428-3.0155-6.8127-3.0155-3.9649 0-5.975 3.1831-1.9545 3.1272-1.9545 8.4322 0 5.3609 1.9545 8.3206 2.0103 2.9597 6.0309 2.9597zm55.788-26.972q5.0817 0 7.5946 2.6246 2.5129 2.5687 2.5129 8.3764v19.489h-4.8584v-19.266q0-7.092-6.0867-7.092-4.3558 0-6.2542 2.5129-1.8428 2.5129-1.8428 7.3154v16.529h-4.8584v-19.266q0-7.092-6.1426-7.092-4.5232 0-6.2542 2.7922-1.7312 2.7922-1.7312 8.0414v15.524h-4.9142v-29.933h3.9649l.72595 4.0766h.27922q1.3961-2.3454 3.7416-3.4623 2.4012-1.1727 5.0817-1.1727 7.0362 0 9.1582 5.0258h.27921q1.5078-2.5687 4.0766-3.7974 2.6246-1.2286 5.5284-1.2286zm21.891-10.666q1.1169 0 1.9545.78178.89355.72598.89355 2.3454 0 1.5636-.89355 2.3454-.83765.78179-1.9545.78179-1.2286 0-2.0662-.78179-.83766-.7818-.83766-2.3454 0-1.6194.83766-2.3454.83763-.78178 2.0662-.78178zm2.4012 11.225v29.933h-4.9141v-29.933zm23.901-.55843q5.3609 0 8.0972 2.6246 2.7363 2.5687 2.7363 8.3765v19.489h-4.8584v-19.154q0-7.2037-6.701-7.2037-4.97 0-6.8686 2.7922-1.8987 2.7922-1.8987 8.0414v15.524h-4.9142v-29.933h3.9649l.72596 4.0766h.27921q1.4519-2.3454 4.0207-3.4623 2.5687-1.1727 5.4167-1.1727zm52.381-5.5285q-6.4218 0-10.108 4.3-3.6857 4.3-3.6857 11.783 0 7.4271 3.4064 11.783 3.4623 4.3 10.331 4.3 2.6246 0 4.97-.44675 2.3454-.44675 4.5792-1.1169v4.3558q-2.2337.83766-4.635 1.2286-2.3454.3909-5.6402.3909-6.0867 0-10.163-2.5129-4.0768-2.5129-6.1426-7.1479-2.0103-4.635-2.0103-10.889 0-6.0309 2.1778-10.61 2.2337-4.6351 6.5335-7.2037 4.3-2.6246 10.443-2.6246 6.3101 0 11.001 2.3454l-2.0103 4.2441q-1.8428-.83766-4.1325-1.5078-2.2337-.67011-4.9141-.67011zm43.558 20.997q0 7.4271-3.7974 11.503-3.7416 4.0765-10.163 4.0765-3.9649 0-7.092-1.787-3.0713-1.8428-4.8584-5.3051-1.787-3.5181-1.787-8.4881 0-7.4271 3.7416-11.448 3.7416-4.0207 10.163-4.0207 4.0765 0 7.1479 1.8428 3.1271 1.787 4.8584 5.2492 1.787 3.4064 1.787 8.3764zm-22.617 0q0 5.3051 2.0662 8.4322 2.122 3.0714 6.701 3.0714 4.5233 0 6.6452-3.0714 2.122-3.1271 2.122-8.4322t-2.122-8.3206q-2.122-3.0155-6.701-3.0155-4.5792 0-6.6452 3.0155-2.0662 3.0155-2.0662 8.3206zm44.786-15.468q5.361 0 8.0973 2.6246 2.7363 2.5687 2.7363 8.3765v19.489h-4.8584v-19.154q0-7.2037-6.701-7.2037-4.97 0-6.8685 2.7922-1.8987 2.7922-1.8987 8.0414v15.524h-4.9142v-29.933h3.9649l.72597 4.0765h.2792q1.4519-2.3454 4.0207-3.4623 2.5687-1.1727 5.4168-1.1727zm39.593 22.225q0 4.3558-3.2389 6.5894-3.2389 2.2338-8.7119 2.2338-3.1271 0-5.4168-.5026-2.2338-.50258-3.9649-1.396v-4.4675q1.787.89346 4.3 1.6753 2.5687.72594 5.1934.72594 3.7416 0 5.4168-1.1727 1.6752-1.2286 1.6752-3.2389 0-1.1169-.61424-2.0103-.61426-.89347-2.2337-1.787-1.5636-.89346-4.5233-2.0103-2.9039-1.1169-4.97-2.2337-2.0662-1.1169-3.1831-2.6805-1.1169-1.5636-1.1169-4.0208 0-3.7974 3.0714-5.8635 3.1272-2.0662 8.153-2.0662 2.7363 0 5.0818.55842 2.4012.50259 4.4675 1.4519l-1.6752 3.9091q-1.8987-.78179-3.9649-1.3403-2.0662-.55842-4.2441-.55842-3.0155 0-4.6351 1.0052-1.5636.94937-1.5636 2.6246 0 1.2286.72596 2.122.72595.83764 2.4012 1.6753 1.7311.78179 4.5792 1.8987 2.848 1.061 4.8584 2.1779 2.0104 1.1169 3.0713 2.7363 1.0611 1.5636 1.0611 3.9649zm33.283-6.7569q0 7.4271-3.7974 11.503-3.7416 4.0766-10.163 4.0766-3.9649 0-7.092-1.787-3.0714-1.8428-4.8583-5.3051-1.787-3.5181-1.787-8.4881 0-7.4271 3.7416-11.448 3.7416-4.0207 10.163-4.0207 4.0766 0 7.1479 1.8428 3.1271 1.787 4.8584 5.2492 1.787 3.4064 1.787 8.3764zm-22.617 0q0 5.3051 2.0662 8.4322 2.122 3.0714 6.701 3.0714 4.5233 0 6.6452-3.0714 2.122-3.1271 2.122-8.4322 0-5.3051-2.122-8.3206-2.122-3.0155-6.701-3.0155t-6.6452 3.0155q-2.0662 3.0155-2.0662 8.3206zm35.293 15.022h-4.9142v-42.441h4.9142zm21.053-30.491q3.8532 0 6.5894 1.6753 2.7922 1.6754 4.2441 4.7468 1.5078 3.0155 1.5078 7.092v2.9597h-20.494q.11169 5.0818 2.5687 7.7621 2.5129 2.6246 6.9803 2.6246 2.848 0 5.0259-.50258 2.2337-.55844 4.5792-1.5636v4.3q-2.2895 1.0052-4.5233 1.4519-2.2337.5026-5.3051.5026-4.2441 0-7.5388-1.7312-3.2389-1.7312-5.0817-5.1376-1.787-3.4623-1.787-8.4322 0-4.9142 1.6194-8.4322 1.6754-3.5181 4.635-5.4168 3.0155-1.8986 6.9803-1.8986zm-.0559 4.0207q-3.5181 0-5.5844 2.2895-2.0103 2.2337-2.4012 6.2543h15.245q-.0559-3.7974-1.787-6.1426-1.7311-2.4012-5.4726-2.4012z" stroke-width=".93783"/>
</g>
<defs>
  <clipPath id="admin-console-logo-clip">
    <path d="M0 0h800v200H0z" class="tw-fill-text-alt2"/>
  </clipPath>
</defs>
</svg>
`;var Gi=i(43978),zi=i(55807),Ri=i(82468),Fi=i(91968),Ai=i(98221),ki=i(63734),ji=i(47438),Ui=i(91326),Ei=function(e,t,i,n){return new(i||(i=Promise))(function(o,s){function r(e){try{a(n.next(e))}catch(t){s(t)}}function l(e){try{a(n.throw(e))}catch(t){s(t)}}function a(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(r,l)}a((n=n.apply(e,t||[])).next())})};function Xi(e,t){if(1&e){const e=Ie.RV6();Ie.j41(0,"bit-banner",1),Ie.bIt("onClose",function(){Ne.eBV(e);const t=Ie.XpG(2);return Ne.Njj(t.trackDismissal())}),Ie.EFF(1),Ie.j41(2,"a",2),Ie.bIt("click",function(){Ne.eBV(e);const t=Ie.XpG(2);return Ne.Njj(t.editBillingAddress())}),Ie.EFF(3),Ie.k0s()()}if(2&e){Ie.XpG();const e=Ie.r8f(0);Ie.R7$(),Ie.SpI(" ",e.message," "),Ie.R7$(2),Ie.SpI(" ",e.callToAction," ")}}function Di(e,t){if(1&e&&(Ie.SS7(0),Ie.nI1(1,"async"),Ie.nVh(2,Xi,4,2,"bit-banner",0)),2&e){const e=Ie.bH3(Ie.bMT(1,1,Ie.XpG().view$));Ie.R7$(2),Ie.vxM(e?2:-1)}}const Vi=new Fi.Ok(Fi.Cg,"taxIdWarningDismissalCounts",{deserializer:e=>e,clearOn:[]}),Bi=new Fi.Ok(Fi.Cg,"taxIdWarningDismissedThisSession",{deserializer:e=>e,clearOn:["logout"]});class Ni{constructor(e,t,i,n,o,s){this.accountService=e,this.configService=t,this.dialogService=i,this.i18nService=n,this.subscriberBillingClient=o,this.stateProvider=s,this.billingAddressUpdated=new Ie.bkB,this.enableTaxIdWarning$=this.configService.getFeatureFlag$(Ri.TO.PM22415_TaxIDWarnings),this.userId$=this.accountService.activeAccount$.pipe((0,G.p)(e=>null!==e),Y.F6),this.dismissals$=this.userId$.pipe((0,R.n)(e=>(0,$.z)([this.stateProvider.getUser(e,Vi).state$.pipe((0,x.T)(e=>{var t,i;return e?{[ji.e.Missing]:null!==(t=e[ji.e.Missing])&&void 0!==t?t:0,[ji.e.FailedVerification]:null!==(i=e[ji.e.FailedVerification])&&void 0!==i?i:0}:{[ji.e.Missing]:0,[ji.e.FailedVerification]:0}})),this.stateProvider.getUser(e,Bi).state$.pipe((0,x.T)(e=>{var t,i;return e?{[ji.e.Missing]:null!==(t=e[ji.e.Missing])&&void 0!==t&&t,[ji.e.FailedVerification]:null!==(i=e[ji.e.FailedVerification])&&void 0!==i&&i}:{[ji.e.Missing]:!1,[ji.e.FailedVerification]:!1}}))])),(0,x.T)(([e,t])=>({[ji.e.Missing]:{count:e[ji.e.Missing],dismissedThisSession:t[ji.e.Missing]},[ji.e.FailedVerification]:{count:e[ji.e.FailedVerification],dismissedThisSession:t[ji.e.FailedVerification]}}))),this.getWarningSubject=new I.t(null),this.warning$=this.getWarningSubject.pipe((0,R.n)(()=>this.getWarning$())),this.view$=(0,$.z)([this.warning$,this.dismissals$]).pipe((0,x.T)(([e,t])=>{if(!e||e===ji.e.PendingVerification)return null;if(!((e,t)=>{const i=t[e];return!i.dismissedThisSession&&i.count<3})(e,t))return null;switch(e){case ji.e.Missing:return{message:this.i18nService.t("missingTaxIdWarning"),callToAction:this.i18nService.t("addTaxId")};case ji.e.FailedVerification:return{message:this.i18nService.t("unverifiedTaxIdWarning"),callToAction:this.i18nService.t("editTaxId")}}})),this.editBillingAddress=()=>Ei(this,void 0,void 0,function*(){var e;const t=yield this.subscriberBillingClient.getBillingAddress(this.subscriber),i=null!==(e=yield(0,S._)(this.warning$))&&void 0!==e?e:void 0,n=ki.ve.open(this.dialogService,{data:{subscriber:this.subscriber,billingAddress:t,taxIdWarning:i}}),o=yield(0,M.s)(n.closed);"success"===(null==o?void 0:o.type)&&this.billingAddressUpdated.emit()}),this.trackDismissal=()=>Ei(this,void 0,void 0,function*(){const e=yield(0,S._)(this.warning$);if(!e||e===ji.e.PendingVerification)return;const t=yield(0,S._)(this.userId$),i=this.stateProvider.getUser(t,Vi).update(t=>{if(!t)return{[e]:1};const i=t[e];return i?Object.assign(Object.assign({},t),{[e]:i+1}):Object.assign(Object.assign({},t),{[e]:1})}),n=this.stateProvider.getUser(t,Bi).update(t=>{if(!t)return{[e]:!0};const i=t[e];return i?Object.assign(Object.assign({},t),{[e]:i}):Object.assign({},t)});yield Promise.all([i,n])})}ngOnInit(){this.getWarningSubject.next(this.getWarning$)}}Ni.ɵfac=function(e){return new(e||Ni)(Ie.rXU($e.Di),Ie.rXU(it.w),Ie.rXU(ye.o3),Ie.rXU(Te.W),Ie.rXU(Ai.Hd),Ie.rXU(Fi.v2))},Ni.ɵcmp=Ie.VBU({type:Ni,selectors:[["app-tax-id-warning"]],inputs:{subscriber:"subscriber",getWarning$:"getWarning$"},outputs:{billingAddressUpdated:"billingAddressUpdated"},decls:2,vars:3,consts:[["id","tax-id-warning-banner","bannerType","warning"],["id","tax-id-warning-banner","bannerType","warning",3,"onClose"],["bitLink","","linkType","secondary","rel","noreferrer noopener",1,"tw-cursor-pointer",3,"click"]],template:function(e,t){1&e&&(Ie.nVh(0,Di,3,4),Ie.nI1(1,"async")),2&e&&Ie.vxM(Ie.bMT(1,1,t.enableTaxIdWarning$)?0:-1)},dependencies:[K.H,Ui.K,se.G,_t.L,Me.Jj],encapsulation:2});var Yi=i(33189),qi=i(24137),Pi=i(74269),Oi=i(44087),_i=i(65067);const Hi=(e,t)=>[e,t],Wi=e=>["../",e],Li=()=>({exact:!0});function Qi(e,t){1&e&&(Ie.nrm(0,"i",5),Ie.nI1(1,"i18n"),Ie.nI1(2,"i18n")),2&e&&(Ie.Y8G("appA11yTitle",Ie.mNQ(Ie.bMT(1,3,"organizationIsDisabled"))),Ie.BMQ("aria-label",Ie.bMT(2,5,"organizationIsDisabled")))}function Ji(e,t){1&e&&(Ie.nrm(0,"i",9),Ie.nI1(1,"i18n"),Ie.nI1(2,"i18n")),2&e&&(Ie.Y8G("appA11yTitle",Ie.mNQ(Ie.bMT(1,3,"organizationIsDisabled"))),Ie.BMQ("aria-label",Ie.bMT(2,5,"organizationIsDisabled")))}function Zi(e,t){if(1&e){const e=Ie.RV6();Ie.j41(0,"bit-nav-item",7),Ie.nI1(1,"i18n"),Ie.bIt("mainContentClicked",function(){Ne.eBV(e);const t=Ie.XpG(3);return Ne.Njj(t.toggle())}),Ie.DNE(2,Ji,3,7,"i",8),Ie.k0s()}if(2&e){const e=t.$implicit;Ie.Y8G("text",e.name)("ariaLabel",Ie.l_i(7,Hi,Ie.bMT(1,5,"organization"),e.name).join(" "))("route",Ie.eq3(10,Wi,e.id))("routerLinkActiveOptions",Ie.lJ4(12,Li)),Ie.R7$(2),Ie.Y8G("ngIf",0==e.enabled)}}function Ki(e,t){if(1&e&&(Ie.qex(0),Ie.DNE(1,Zi,3,13,"bit-nav-item",6),Ie.bVm()),2&e){const e=t.ngIf;Ie.R7$(),Ie.Y8G("ngForOf",e)}}function en(e,t){1&e&&(Ie.nrm(0,"bit-nav-item",10),Ie.nI1(1,"i18n")),2&e&&Ie.Y8G("text",Ie.bMT(1,1,"newOrganization"))}function tn(e,t){if(1&e){const e=Ie.RV6();Ie.j41(0,"bit-nav-group",1),Ie.nI1(1,"i18n"),Ie.mxI("openChange",function(t){Ne.eBV(e);const i=Ie.XpG();return Ie.DH7(i.open,t)||(i.open=t),Ne.Njj(t)}),Ie.DNE(2,Qi,3,7,"i",2)(3,Ki,2,1,"ng-container",3),Ie.nI1(4,"async"),Ie.DNE(5,en,2,3,"bit-nav-item",4),Ie.nrm(6,"bit-nav-divider"),Ie.k0s()}if(2&e){const e=t.ngIf,i=Ie.XpG();Ie.Y8G("text",e.name)("ariaLabel",Ie.l_i(12,Hi,Ie.bMT(1,8,"organization"),e.name).join(" "))("route",Ie.eq3(15,Wi,e.id))("routerLinkActiveOptions",Ie.lJ4(17,Li)),Ie.R50("open",i.open),Ie.R7$(2),Ie.Y8G("ngIf",!e.enabled),Ie.R7$(),Ie.Y8G("ngIf",Ie.bMT(4,10,i.organizations$)),Ie.R7$(2),Ie.Y8G("ngIf",!i.hideNewButton)}}class nn{constructor(e,t,i,n,o){this.route=e,this.dialogService=t,this.organizationService=i,this.billingApiService=n,this.accountService=o,this.organizations$=this.accountService.activeAccount$.pipe((0,R.n)(e=>this.organizationService.organizations$(null==e?void 0:e.id).pipe((0,x.T)(e=>e.filter(e=>this.filter(e)).sort((e,t)=>e.name.localeCompare(t.name)))))),this.activeOrganization$=(0,$.z)([this.route.paramMap,this.organizations$]).pipe((0,x.T)(([e,t])=>t.find(t=>t.id===e.get("organizationId")))),this.filter=()=>!0,this.open=!1,this.openChange=new Ie.bkB,this.hideNewButton=!1}toggle(e){null==e||e.stopPropagation(),this.open=!this.open,this.openChange.emit(this.open)}}nn.ɵfac=function(e){return new(e||nn)(Ie.rXU(ut.nX),Ie.rXU(ye.o3),Ie.rXU(d.PV),Ie.rXU(Bt.P),Ie.rXU($e.Di))},nn.ɵcmp=Ie.VBU({type:nn,selectors:[["org-switcher"]],inputs:{filter:"filter",open:"open",hideNewButton:"hideNewButton"},outputs:{openChange:"openChange"},decls:2,vars:3,consts:[["icon","bwi-business",3,"text","ariaLabel","route","routerLinkActiveOptions","open","openChange",4,"ngIf"],["icon","bwi-business",3,"openChange","text","ariaLabel","route","routerLinkActiveOptions","open"],["slot","end","class","bwi bwi-exclamation-triangle tw-my-auto",3,"appA11yTitle",4,"ngIf"],[4,"ngIf"],["icon","bwi-plus","route","/create-organization",3,"text",4,"ngIf"],["slot","end",1,"bwi","bwi-exclamation-triangle","tw-my-auto",3,"appA11yTitle"],[3,"text","ariaLabel","route","routerLinkActiveOptions","mainContentClicked",4,"ngFor","ngForOf"],[3,"mainContentClicked","text","ariaLabel","route","routerLinkActiveOptions"],["slot","end","class","bwi bwi-exclamation-triangle",3,"appA11yTitle",4,"ngIf"],["slot","end",1,"bwi","bwi-exclamation-triangle",3,"appA11yTitle"],["icon","bwi-plus","route","/create-organization",3,"text"]],template:function(e,t){1&e&&(Ie.DNE(0,tn,7,18,"bit-nav-group",0),Ie.nI1(1,"async")),2&e&&Ie.Y8G("ngIf",Ie.bMT(1,1,t.activeOrganization$))},dependencies:[Me.MD,Me.Sq,Me.bT,rt.p,Pt.C,qi.f,Pi.K,Oi.O,_i.u,s.t,Me.Jj,ke.$],encapsulation:2});var on=i(81740),sn=i(13417),rn=i(59557),ln=i(1463),an=i(41607),cn=function(e,t,i,n){return new(i||(i=Promise))(function(o,s){function r(e){try{a(n.next(e))}catch(t){s(t)}}function l(e){try{a(n.throw(e))}catch(t){s(t)}}function a(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(r,l)}a((n=n.apply(e,t||[])).next())})};const dn=()=>({exact:!0});function un(e,t){1&e&&(Ie.nrm(0,"bit-nav-item",6),Ie.nI1(1,"i18n")),2&e&&Ie.Y8G("text",Ie.bMT(1,1,"accessIntelligence"))}function hn(e,t){1&e&&(Ie.nrm(0,"bit-nav-item",13),Ie.nI1(1,"i18n")),2&e&&Ie.Y8G("text",Ie.bMT(1,1,"collections"))}function pn(e,t){1&e&&(Ie.qex(0),Ie.j41(1,"bit-nav-group",15),Ie.nI1(2,"i18n"),Ie.nrm(3,"bit-nav-item",16),Ie.nI1(4,"i18n"),Ie.nrm(5,"bit-nav-item",17),Ie.nI1(6,"i18n"),Ie.k0s(),Ie.bVm()),2&e&&(Ie.R7$(),Ie.Y8G("text",Ie.bMT(2,4,"members")),Ie.R7$(2),Ie.Y8G("text",Ie.bMT(4,6,"members"))("routerLinkActiveOptions",Ie.lJ4(10,dn)),Ie.R7$(2),Ie.Y8G("text",Ie.bMT(6,8,"sponsoredFamilies")))}function gn(e,t){1&e&&(Ie.nrm(0,"bit-nav-item",15),Ie.nI1(1,"i18n")),2&e&&Ie.Y8G("text",Ie.bMT(1,1,"members"))}function mn(e,t){if(1&e&&(Ie.qex(0),Ie.DNE(1,pn,7,11,"ng-container",14),Ie.nI1(2,"async"),Ie.DNE(3,gn,2,3,"ng-template",null,0,Ie.C5r),Ie.bVm()),2&e){const e=Ie.sdS(4),t=Ie.XpG(2);Ie.R7$(),Ie.Y8G("ngIf",Ie.bMT(2,2,t.showSponsoredFamiliesDropdown$))("ngIfElse",e)}}function vn(e,t){1&e&&(Ie.nrm(0,"bit-nav-item",18),Ie.nI1(1,"i18n")),2&e&&Ie.Y8G("text",Ie.bMT(1,1,"groups"))}function fn(e,t){1&e&&(Ie.nrm(0,"bit-nav-item",22),Ie.nI1(1,"i18n")),2&e&&Ie.Y8G("text",Ie.bMT(1,1,"eventLogs"))}function bn(e,t){1&e&&(Ie.nrm(0,"bit-nav-item",23),Ie.nI1(1,"i18n")),2&e&&Ie.Y8G("text",Ie.bMT(1,1,"reports"))}function In(e,t){if(1&e&&(Ie.j41(0,"bit-nav-group",19),Ie.nI1(1,"i18n"),Ie.DNE(2,fn,2,3,"bit-nav-item",20)(3,bn,2,3,"bit-nav-item",21),Ie.k0s()),2&e){const e=Ie.XpG().ngIf,t=Ie.XpG();Ie.Y8G("text",Ie.bMT(1,3,t.getReportTabLabel(e))),Ie.R7$(2),Ie.Y8G("ngIf",(e.canAccessEventLogs||e.isOwner)&&e.useEvents),Ie.R7$(),Ie.Y8G("ngIf",e.canAccessReports)}}function yn(e,t){1&e&&(Ie.qex(0),Ie.nrm(1,"bit-nav-item",26),Ie.nI1(2,"i18n"),Ie.nrm(3,"bit-nav-item",27),Ie.nI1(4,"i18n"),Ie.bVm()),2&e&&(Ie.R7$(),Ie.Y8G("text",Ie.bMT(2,2,"paymentDetails")),Ie.R7$(2),Ie.Y8G("text",Ie.bMT(4,4,"billingHistory")))}function wn(e,t){if(1&e&&(Ie.j41(0,"bit-nav-group",24),Ie.nI1(1,"i18n"),Ie.nrm(2,"bit-nav-item",25),Ie.nI1(3,"i18n"),Ie.DNE(4,yn,5,6,"ng-container",2),Ie.nI1(5,"async"),Ie.nI1(6,"async"),Ie.k0s()),2&e){const e=Ie.XpG(2);Ie.Y8G("text",Ie.bMT(1,3,"billing")),Ie.R7$(2),Ie.Y8G("text",Ie.bMT(3,5,"subscription")),Ie.R7$(2),Ie.Y8G("ngIf",Ie.bMT(5,7,e.showPaymentAndHistory$)&&Ie.bMT(6,9,e.organizationIsUnmanaged$))}}function Sn(e,t){1&e&&(Ie.nrm(0,"bit-nav-item",28),Ie.nI1(1,"i18n")),2&e&&Ie.Y8G("text",Ie.bMT(1,1,"integrations"))}function $n(e,t){1&e&&(Ie.nrm(0,"bit-nav-item",39),Ie.nI1(1,"i18n")),2&e&&Ie.Y8G("text",Ie.bMT(1,1,"organizationInfo"))}function Cn(e,t){1&e&&(Ie.nrm(0,"bit-nav-item",40),Ie.nI1(1,"i18n")),2&e&&Ie.Y8G("text",Ie.bMT(1,1,"policies"))}function Tn(e,t){1&e&&(Ie.nrm(0,"bit-nav-item",41),Ie.nI1(1,"i18n")),2&e&&Ie.Y8G("text",Ie.bMT(1,1,"twoStepLogin"))}function Mn(e,t){1&e&&(Ie.nrm(0,"bit-nav-item",42),Ie.nI1(1,"i18n")),2&e&&Ie.Y8G("text",Ie.bMT(1,1,"import"))}function xn(e,t){1&e&&(Ie.nrm(0,"bit-nav-item",43),Ie.nI1(1,"i18n")),2&e&&Ie.Y8G("text",Ie.bMT(1,1,"export"))}function Gn(e,t){1&e&&(Ie.nrm(0,"bit-nav-item",44),Ie.nI1(1,"i18n")),2&e&&Ie.Y8G("text",Ie.bMT(1,1,"claimedDomains"))}function zn(e,t){1&e&&(Ie.nrm(0,"bit-nav-item",45),Ie.nI1(1,"i18n")),2&e&&Ie.Y8G("text",Ie.bMT(1,1,"singleSignOn"))}function Rn(e,t){1&e&&(Ie.nrm(0,"bit-nav-item",46),Ie.nI1(1,"i18n")),2&e&&Ie.Y8G("text",Ie.bMT(1,1,"deviceApprovals"))}function Fn(e,t){1&e&&(Ie.nrm(0,"bit-nav-item",47),Ie.nI1(1,"i18n")),2&e&&Ie.Y8G("text",Ie.bMT(1,1,"scim"))}function An(e,t){if(1&e&&(Ie.j41(0,"bit-nav-group",29),Ie.nI1(1,"i18n"),Ie.DNE(2,$n,2,3,"bit-nav-item",30)(3,Cn,2,3,"bit-nav-item",31)(4,Tn,2,3,"bit-nav-item",32)(5,Mn,2,3,"bit-nav-item",33)(6,xn,2,3,"bit-nav-item",34),Ie.nI1(7,"async"),Ie.DNE(8,Gn,2,3,"bit-nav-item",35)(9,zn,2,3,"bit-nav-item",36)(10,Rn,2,3,"bit-nav-item",37)(11,Fn,2,3,"bit-nav-item",38),Ie.k0s()),2&e){const e=Ie.XpG().ngIf,t=Ie.XpG();Ie.Y8G("text",Ie.bMT(1,10,"settings")),Ie.R7$(2),Ie.Y8G("ngIf",e.isOwner),Ie.R7$(),Ie.Y8G("ngIf",e.canManagePolicies),Ie.R7$(),Ie.Y8G("ngIf",e.use2fa&&e.isOwner),Ie.R7$(),Ie.Y8G("ngIf",e.canAccessImport),Ie.R7$(),Ie.Y8G("ngIf",Ie.bMT(7,12,t.canAccessExport$)),Ie.R7$(2),Ie.Y8G("ngIf",null==e?null:e.canManageDomainVerification),Ie.R7$(),Ie.Y8G("ngIf",e.canManageSso),Ie.R7$(),Ie.Y8G("ngIf",e.canManageDeviceApprovals),Ie.R7$(),Ie.Y8G("ngIf",e.canManageScim)}}function kn(e,t){if(1&e&&(Ie.j41(0,"app-side-nav",3),Ie.nrm(1,"bit-nav-logo",4),Ie.nI1(2,"i18n"),Ie.nrm(3,"org-switcher",5),Ie.nI1(4,"async"),Ie.nVh(5,un,2,3,"bit-nav-item",6),Ie.DNE(6,hn,2,3,"bit-nav-item",7)(7,mn,5,4,"ng-container",2)(8,vn,2,3,"bit-nav-item",8)(9,In,4,5,"bit-nav-group",9)(10,wn,7,11,"bit-nav-group",10)(11,Sn,2,3,"bit-nav-item",11),Ie.nI1(12,"async"),Ie.DNE(13,An,12,14,"bit-nav-group",12),Ie.k0s()),2&e){const e=t.ngIf,i=Ie.XpG();Ie.R7$(),Ie.Y8G("openIcon",i.logo)("label",Ie.bMT(2,12,"adminConsole")),Ie.R7$(2),Ie.Y8G("filter",i.orgFilter)("hideNewButton",Ie.bMT(4,14,i.hideNewOrgButton$)),Ie.R7$(2),Ie.vxM(i.canShowAccessIntelligenceTab(e)?5:-1),Ie.R7$(),Ie.Y8G("ngIf",i.canShowVaultTab(e)),Ie.R7$(),Ie.Y8G("ngIf",i.canShowMembersTab(e)),Ie.R7$(),Ie.Y8G("ngIf",i.canShowGroupsTab(e)),Ie.R7$(),Ie.Y8G("ngIf",i.canShowReportsTab(e)),Ie.R7$(),Ie.Y8G("ngIf",i.canShowBillingTab(e)),Ie.R7$(),Ie.Y8G("ngIf",Ie.bMT(12,16,i.integrationPageEnabled$)),Ie.R7$(2),Ie.Y8G("ngIf",i.canShowSettingsTab(e))}}function jn(e,t){if(1&e&&(Ie.j41(0,"bit-banner",50),Ie.EFF(1),Ie.nI1(2,"i18n"),Ie.k0s()),2&e){const e=Ie.XpG().ngIf;Ie.Y8G("showClose",!1),Ie.R7$(),Ie.SpI(" ",Ie.i5U(2,2,"accessingUsingProvider",e.providerName)," ")}}function Un(e,t){if(1&e){const e=Ie.RV6();Ie.qex(0),Ie.DNE(1,jn,3,5,"bit-banner",48),Ie.j41(2,"app-tax-id-warning",49),Ie.nI1(3,"async"),Ie.bIt("billingAddressUpdated",function(){Ne.eBV(e);const t=Ie.XpG();return Ne.Njj(t.refreshTaxIdWarning())}),Ie.k0s(),Ie.bVm()}if(2&e){const e=t.ngIf,i=Ie.XpG();Ie.R7$(),Ie.Y8G("ngIf",e.isProviderUser),Ie.R7$(),Ie.Y8G("subscriber",Ie.bMT(3,3,i.subscriber$))("getWarning$",i.getTaxIdWarning$)}}class En{constructor(e,t,i,n,o,s,r,l){this.route=e,this.organizationService=t,this.platformUtilsService=i,this.policyService=n,this.providerService=o,this.accountService=s,this.freeFamiliesPolicyService=r,this.organizationWarningsService=l,this.logo=xi,this.orgFilter=e=>(0,d.OV)(e),this.refreshTaxIdWarning=()=>this.organizationWarningsService.refreshTaxIdWarning()}ngOnInit(){return cn(this,void 0,void 0,function*(){document.body.classList.remove("layout_frontend"),this.organization$=this.route.params.pipe((0,x.T)(e=>e.organizationId),(0,Mi.E)(this.accountService.activeAccount$.pipe(Y.F6)),(0,R.n)(([e,t])=>this.organizationService.organizations$(t).pipe((0,_.Hc)(e))),(0,G.p)(e=>null!=e)),this.showSponsoredFamiliesDropdown$=this.freeFamiliesPolicyService.showSponsoredFamiliesDropdown$(this.organization$),this.canAccessExport$=this.organization$.pipe((0,x.T)(e=>e.canAccessExport)),this.showPaymentAndHistory$=this.organization$.pipe((0,x.T)(e=>!this.platformUtilsService.isSelfHost()&&e.canViewBillingHistory&&e.canEditPaymentMethods)),this.hideNewOrgButton$=this.accountService.activeAccount$.pipe(Y.F6,(0,R.n)(e=>this.policyService.policyAppliesToUser$(Gi.tt.SingleOrg,e)));const e=(0,$.z)([this.organization$,this.accountService.activeAccount$.pipe(Y.F6)]).pipe((0,R.n)(([e,t])=>this.providerService.get$(e.providerId,t)));this.organizationIsUnmanaged$=(0,$.z)([this.organization$,e]).pipe((0,x.T)(([e,t])=>!e.hasProvider||!t||t.providerStatus!==Gi.kC.Billable)),this.integrationPageEnabled$=this.organization$.pipe((0,x.T)(e=>e.canAccessIntegrations)),this.subscriber$=this.organization$.pipe((0,x.T)(e=>({type:"organization",data:e}))),this.getTaxIdWarning$=()=>this.organization$.pipe((0,R.n)(e=>this.organizationWarningsService.getTaxIdWarning$(e)))})}canShowVaultTab(e){return(0,d.of)(e)}canShowSettingsTab(e){return(0,d.Dl)(e)}canShowMembersTab(e){return(0,d.pe)(e)}canShowGroupsTab(e){return(0,d.ex)(e)}canShowReportsTab(e){return(0,d.Ue)(e)}canShowBillingTab(e){return!1}canShowAccessIntelligenceTab(e){return(0,d.o2)(e)}getReportTabLabel(e){return e.useEvents?"reporting":"reports"}}En.ɵfac=function(e){return new(e||En)(Ie.rXU(ut.nX),Ie.rXU(d.PV),Ie.rXU(Ce.y),Ie.rXU(tt.m),Ie.rXU(sn.$),Ie.rXU($e.Di),Ie.rXU(Yi.A),Ie.rXU(ne.S))},En.ɵcmp=Ie.VBU({type:En,selectors:[["app-organization-layout"]],decls:6,vars:6,consts:[["regularMembersItem",""],["variant","secondary",4,"ngIf"],[4,"ngIf"],["variant","secondary"],["route",".",3,"openIcon","label"],[3,"filter","hideNewButton"],["icon","bwi-dashboard","route","access-intelligence",3,"text"],["icon","bwi-collection-shared","route","vault",3,"text",4,"ngIf"],["icon","bwi-users","route","groups",3,"text",4,"ngIf"],["icon","bwi-sliders","route","reporting",3,"text",4,"ngIf"],["icon","bwi-billing","route","billing",3,"text",4,"ngIf"],["icon","bwi-msp","route","integrations",3,"text",4,"ngIf"],["icon","bwi-cog","route","settings",3,"text",4,"ngIf"],["icon","bwi-collection-shared","route","vault",3,"text"],[4,"ngIf","ngIfElse"],["icon","bwi-user","route","members",3,"text"],["route","members",3,"text","routerLinkActiveOptions"],["route","members/sponsored-families",3,"text"],["icon","bwi-users","route","groups",3,"text"],["icon","bwi-sliders","route","reporting",3,"text"],["route","reporting/events",3,"text",4,"ngIf"],["route","reporting/reports",3,"text",4,"ngIf"],["route","reporting/events",3,"text"],["route","reporting/reports",3,"text"],["icon","bwi-billing","route","billing",3,"text"],["route","billing/subscription",3,"text"],["route","billing/payment-details",3,"text"],["route","billing/history",3,"text"],["icon","bwi-msp","route","integrations",3,"text"],["icon","bwi-cog","route","settings",3,"text"],["route","settings/account",3,"text",4,"ngIf"],["route","settings/policies",3,"text",4,"ngIf"],["route","settings/two-factor",3,"text",4,"ngIf"],["route","settings/tools/import",3,"text",4,"ngIf"],["route","settings/tools/export",3,"text",4,"ngIf"],["route","settings/domain-verification",3,"text",4,"ngIf"],["route","settings/sso",3,"text",4,"ngIf"],["route","settings/device-approvals",3,"text",4,"ngIf"],["route","settings/scim",3,"text",4,"ngIf"],["route","settings/account",3,"text"],["route","settings/policies",3,"text"],["route","settings/two-factor",3,"text"],["route","settings/tools/import",3,"text"],["route","settings/tools/export",3,"text"],["route","settings/domain-verification",3,"text"],["route","settings/sso",3,"text"],["route","settings/device-approvals",3,"text"],["route","settings/scim",3,"text"],[3,"showClose",4,"ngIf"],[3,"billingAddressUpdated","subscriber","getWarning$"],[3,"showClose"]],template:function(e,t){1&e&&(Ie.j41(0,"app-layout"),Ie.DNE(1,kn,14,18,"app-side-nav",1),Ie.nI1(2,"async"),Ie.DNE(3,Un,4,5,"ng-container",2),Ie.nI1(4,"async"),Ie.nrm(5,"router-outlet"),Ie.k0s()),2&e&&(Ie.R7$(),Ie.Y8G("ngIf",Ie.bMT(2,2,t.organization$)),Ie.R7$(2),Ie.Y8G("ngIf",Ie.bMT(4,4,t.organization$)))},dependencies:[Me.MD,Me.bT,a.iI,ut.n3,rt.p,on.P,Oi.O,_i.u,rn.K,ln.s,an.y,zi.o,nn,K.H,Ui.K,Ni,s.t,Me.Jj,ke.$],encapsulation:2});var Xn,Dn,Vn=i(36359),Bn=i(84079),Nn=i(55542),Yn=i(22848),qn=i(7861),Pn=i(3892),On=i(86226),_n=i(93199),Hn=i(97553),Wn=i(43759),Ln=i(88516),Qn=i(49608),Jn=function(e,t,i,n){return new(i||(i=Promise))(function(o,s){function r(e){try{a(n.next(e))}catch(t){s(t)}}function l(e){try{a(n.throw(e))}catch(t){s(t)}}function a(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(r,l)}a((n=n.apply(e,t||[])).next())})};function Zn(e,t){if(1&e&&(Ie.j41(0,"span",11),Ie.EFF(1),Ie.k0s()),2&e){const e=Ie.XpG();Ie.R7$(),Ie.JRh(null==e.group?null:e.group.name)}}function Kn(e,t){1&e&&(Ie.j41(0,"div"),Ie.nrm(1,"i",12),Ie.nI1(2,"i18n"),Ie.j41(3,"span",13),Ie.EFF(4),Ie.nI1(5,"i18n"),Ie.k0s()()),2&e&&(Ie.R7$(),Ie.Y8G("title",Ie.mNQ(Ie.bMT(2,3,"loading"))),Ie.R7$(3),Ie.JRh(Ie.bMT(5,5,"loading")))}function eo(e,t){1&e&&(Ie.j41(0,"bit-form-field")(1,"bit-label"),Ie.EFF(2),Ie.nI1(3,"i18n"),Ie.k0s(),Ie.nrm(4,"input",19),Ie.j41(5,"bit-hint"),Ie.EFF(6),Ie.nI1(7,"i18n"),Ie.k0s()()),2&e&&(Ie.R7$(2),Ie.JRh(Ie.bMT(3,2,"externalId")),Ie.R7$(4),Ie.JRh(Ie.bMT(7,4,"externalIdDesc")))}function to(e,t){1&e&&(Ie.j41(0,"span"),Ie.EFF(1),Ie.nI1(2,"i18n"),Ie.k0s()),2&e&&(Ie.R7$(),Ie.SpI(" ",Ie.bMT(2,1,"restrictedGroupAccessDesc")," "))}function io(e,t){1&e&&(Ie.j41(0,"span"),Ie.EFF(1),Ie.nI1(2,"i18n"),Ie.k0s()),2&e&&(Ie.R7$(),Ie.SpI(" ",Ie.bMT(2,1,"restrictedCollectionAssignmentDesc")," "))}function no(e,t){if(1&e){const e=Ie.RV6();Ie.j41(0,"bit-tab-group",14),Ie.mxI("selectedIndexChange",function(t){Ne.eBV(e);const i=Ie.XpG();return Ie.DH7(i.tabIndex,t)||(i.tabIndex=t),Ne.Njj(t)}),Ie.j41(1,"bit-tab",15),Ie.nI1(2,"i18n"),Ie.j41(3,"bit-form-field")(4,"bit-label"),Ie.EFF(5),Ie.nI1(6,"i18n"),Ie.k0s(),Ie.nrm(7,"input",16),Ie.j41(8,"bit-hint"),Ie.EFF(9),Ie.nI1(10,"i18n"),Ie.k0s()(),Ie.DNE(11,eo,8,6,"bit-form-field",5),Ie.k0s(),Ie.j41(12,"bit-tab",15),Ie.nI1(13,"i18n"),Ie.j41(14,"p"),Ie.EFF(15),Ie.nI1(16,"i18n"),Ie.DNE(17,to,3,3,"span",5),Ie.nI1(18,"async"),Ie.k0s(),Ie.nrm(19,"bit-access-selector",17),Ie.nI1(20,"i18n"),Ie.nI1(21,"i18n"),Ie.nI1(22,"i18n"),Ie.k0s(),Ie.j41(23,"bit-tab",15),Ie.nI1(24,"i18n"),Ie.j41(25,"p"),Ie.EFF(26),Ie.nI1(27,"i18n"),Ie.DNE(28,io,3,3,"span",5),Ie.nI1(29,"async"),Ie.k0s(),Ie.nrm(30,"bit-access-selector",18),Ie.nI1(31,"i18n"),Ie.nI1(32,"i18n"),Ie.nI1(33,"i18n"),Ie.k0s()()}if(2&e){const e=Ie.XpG();Ie.R50("selectedIndex",e.tabIndex),Ie.R7$(),Ie.Y8G("label",Ie.mNQ(Ie.bMT(2,25,"groupInfo"))),Ie.R7$(4),Ie.JRh(Ie.bMT(6,27,"name")),Ie.R7$(4),Ie.JRh(Ie.i5U(10,29,"characterMaximum",100)),Ie.R7$(2),Ie.Y8G("ngIf",e.isExternalIdVisible),Ie.R7$(),Ie.Y8G("label",Ie.mNQ(Ie.bMT(13,32,"members"))),Ie.R7$(3),Ie.SpI(" ",Ie.bMT(16,34,"editGroupMembersDesc")," "),Ie.R7$(2),Ie.Y8G("ngIf",Ie.bMT(18,36,e.cannotAddSelfToGroup$)),Ie.R7$(2),Ie.Y8G("items",e.members)("showMemberRoles",!0)("permissionMode",e.PermissionMode.Hidden)("columnHeader",Ie.bMT(20,38,"member"))("selectorLabelText",Ie.bMT(21,40,"selectMembers"))("emptySelectionText",Ie.bMT(22,42,"noMembersAdded")),Ie.R7$(4),Ie.Y8G("label",Ie.mNQ(Ie.bMT(24,44,"collections"))),Ie.R7$(3),Ie.SpI(" ",Ie.bMT(27,46,"editGroupCollectionsDesc")," "),Ie.R7$(2),Ie.Y8G("ngIf",!Ie.bMT(29,48,e.canAssignAccessToAnyCollection$)),Ie.R7$(2),Ie.Y8G("items",e.collections)("permissionMode",e.PermissionMode.Edit)("columnHeader",Ie.bMT(31,50,"collection"))("selectorLabelText",Ie.bMT(32,52,"selectCollections"))("emptySelectionText",Ie.bMT(33,54,"noCollectionsAdded"))}}!function(e){e[e.Info=0]="Info",e[e.Members=1]="Members",e[e.Collections=2]="Collections"}(Xn||(Xn={})),function(e){e.Saved="saved",e.Canceled="canceled",e.Deleted="deleted"}(Dn||(Dn={}));class oo{get groupId(){return this.params.groupId}get organizationId(){return this.params.organizationId}get isExternalIdVisible(){var e;return!!(null===(e=this.groupForm.get("externalId"))||void 0===e?void 0:e.value)}get editMode(){return null!=this.groupId}get orgMembers$(){return(0,Bn.H)(this.organizationUserApiService.getAllMiniUserDetails(this.organizationId)).pipe((0,x.T)(e=>e.data.map(e=>{var t;return{id:e.id,type:be.Uv.Member,email:e.email,role:e.type,listName:(null===(t=e.name)||void 0===t?void 0:t.length)>0?`${e.name} (${e.email})`:e.email,labelName:e.name||e.email,status:e.status,userId:e.userId}})))}constructor(e,t,i,n,o,s,r,l,a,c,u,h,p,g,m,v){var f;this.params=e,this.dialogRef=t,this.apiService=i,this.organizationUserApiService=n,this.groupService=o,this.i18nService=s,this.platformUtilsService=r,this.logService=l,this.formBuilder=a,this.changeDetectorRef=c,this.dialogService=u,this.organizationService=h,this.accountService=p,this.collectionAdminService=g,this.toastService=m,this.configService=v,this.organization$=this.accountService.activeAccount$.pipe((0,R.n)(e=>this.organizationService.organizations$(null==e?void 0:e.id).pipe((0,d.Sw)(this.organizationId)).pipe((0,F.t)({refCount:!0})))),this.PermissionMode=be.ZC,this.ResultType=Dn,this.loading=!0,this.collections=[],this.members=[],this.groupForm=this.formBuilder.group({name:["",[Se.k0.required,Se.k0.maxLength(100)]],externalId:this.formBuilder.control({value:"",disabled:!0}),members:[[]],collections:[[]]}),this.destroy$=new w.B,this.orgCollections$=this.accountService.activeAccount$.pipe(Y.F6,(0,R.n)(e=>this.collectionAdminService.collectionAdminViews$(this.organizationId,e)),(0,F.t)({refCount:!0,bufferSize:1})),this.groupDetails$=(0,y.of)(this.editMode).pipe((0,A.H)(e=>e?(0,$.z)([this.groupService.get(this.organizationId,this.groupId),this.apiService.getGroupUsers(this.organizationId,this.groupId)]).pipe((0,x.T)(([e,t])=>Object.assign(Object.assign({},e),{members:t})),(0,X.W)(e=>(e instanceof qn._?this.logService.error(e.message):this.logService.error(e.toString()),(0,y.of)(void 0)))):(0,y.of)(void 0)),(0,F.t)({refCount:!0,bufferSize:1})),this.allowAdminAccessToAllCollectionItems$=this.organization$.pipe((0,x.T)(e=>e.allowAdminAccessToAllCollectionItems)),this.canAssignAccessToAnyCollection$=(0,$.z)([this.organization$,this.allowAdminAccessToAllCollectionItems$]).pipe((0,x.T)(([e,t])=>e.canEditAnyCollection||e.permissions.manageGroups&&t)),this.cannotAddSelfToGroup$=(0,$.z)([this.allowAdminAccessToAllCollectionItems$,this.groupDetails$]).pipe((0,x.T)(([e,t])=>!e&&null!=t)),this.submit=()=>Jn(this,void 0,void 0,function*(){var e,t;if(this.groupForm.markAllAsTouched(),this.groupForm.invalid)return void(this.tabIndex!==Xn.Info&&this.toastService.showToast({variant:"error",title:null,message:this.i18nService.t("fieldOnTabRequiresAttention",this.i18nService.t("groupInfo"))}));const i=this.groupForm.value,n={id:this.groupId,organizationId:this.organizationId,name:i.name,members:null!==(t=null===(e=i.members)||void 0===e?void 0:e.map(e=>e.id))&&void 0!==t?t:[],collections:i.collections.map(e=>(0,be.yo)(e)),externalId:i.externalId};yield this.groupService.save(n),this.toastService.showToast({variant:"success",title:null,message:this.i18nService.t(this.editMode?"editedGroupId":"createdGroupId",i.name)}),this.dialogRef.close(Dn.Saved)}),this.delete=()=>Jn(this,void 0,void 0,function*(){if(!this.editMode)return;if(!(yield this.dialogService.openSimpleDialog({title:this.group.name,content:{key:"deleteGroupConfirmation"},type:"warning"})))return!1;yield this.groupService.delete(this.organizationId,this.groupId),this.toastService.showToast({variant:"success",title:null,message:this.i18nService.t("deletedGroupId",this.group.name)}),this.dialogRef.close(Dn.Deleted)}),this.tabIndex=null!==(f=e.initialTab)&&void 0!==f?f:Xn.Info}ngOnInit(){this.loading=!0,this.title=this.i18nService.t(this.editMode?"editGroup":"newGroup"),(0,$.z)([this.orgCollections$,this.orgMembers$,this.groupDetails$,this.cannotAddSelfToGroup$,this.accountService.activeAccount$,this.organization$]).pipe((0,k.Q)(this.destroy$)).subscribe(([e,t,i,n,o,s])=>{var r;if(this.members=t,this.group=i,this.collections=function(e,t,i){return e.map(e=>{var n;const o=null!==(n=null==i?void 0:i.collections.find(t=>t.id==e.id))&&void 0!==n?n:void 0;return{id:e.id,type:be.Uv.Collection,labelName:e.name,listName:e.name,readonly:!e.canEditGroupAccess(t),readonlyPermission:o?(0,be.Jh)(o):void 0}}).filter(e=>!e.readonly||(null==i?void 0:i.collections.some(t=>t.id==e.id)))}(e,s,i),null!=this.group&&(this.changeDetectorRef.detectChanges(),this.groupForm.patchValue({name:this.group.name,externalId:this.group.externalId,members:this.group.members.map(e=>({id:e,type:be.Uv.Member})),collections:so(i,this.collections)})),n){const e=null===(r=this.members.find(e=>e.userId===o.id))||void 0===r?void 0:r.id,t=this.groupForm.value.members.some(t=>t.id===e);null==e||t||(this.members=this.members.filter(t=>t.id!==e))}this.loading=!1})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}}function so(e,t){return e.collections.filter(e=>!t.find(t=>t.id==e.id).readonly).map(e=>({id:e.id,type:be.Uv.Collection,permission:(0,be.Jh)(e)}))}oo.ɵfac=function(e){return new(e||oo)(Ie.rXU(fe.Qs),Ie.rXU(ye.ce),Ie.rXU(Vt.G),Ie.rXU(V.uB),Ie.rXU(l.EB),Ie.rXU(Te.W),Ie.rXU(Ce.y),Ie.rXU(P.K),Ie.rXU(Se.ok),Ie.rXU(jt.gRc),Ie.rXU(ye.o3),Ie.rXU(d.PV),Ie.rXU($e.Di),Ie.rXU(V.vE),Ie.rXU(we.f),Ie.rXU(it.w))},oo.ɵcmp=Ie.VBU({type:oo,selectors:[["app-group-add-edit"]],standalone:!1,decls:17,vars:18,consts:[[3,"formGroup","bitSubmit"],["dialogSize","large",3,"disablePadding"],["bitDialogTitle",""],["class","tw-text-sm tw-normal-case tw-text-muted",4,"ngIf"],["bitDialogContent",""],[4,"ngIf"],[3,"selectedIndex","selectedIndexChange",4,"ngIf"],["bitDialogFooter",""],["bitButton","","buttonType","primary","bitFormButton","","type","submit"],["bitButton","","buttonType","secondary","type","button",3,"bitDialogClose"],["type","button","buttonType","danger","bitIconButton","bwi-trash","bitFormButton","",1,"tw-ml-auto",3,"bitAction","label"],[1,"tw-text-sm","tw-normal-case","tw-text-muted"],["aria-hidden","true",1,"bwi","bwi-spinner","bwi-spin","tw-text-muted",3,"title"],[1,"tw-sr-only"],[3,"selectedIndexChange","selectedIndex"],[3,"label"],["bitInput","","appAutofocus","","type","text","formControlName","name"],["formControlName","members",3,"items","showMemberRoles","permissionMode","columnHeader","selectorLabelText","emptySelectionText"],["formControlName","collections",3,"items","permissionMode","columnHeader","selectorLabelText","emptySelectionText"],["bitInput","","type","text","formControlName","externalId"]],template:function(e,t){1&e&&(Ie.j41(0,"form",0)(1,"bit-dialog",1)(2,"span",2),Ie.EFF(3),Ie.DNE(4,Zn,2,1,"span",3),Ie.k0s(),Ie.j41(5,"div",4),Ie.DNE(6,Kn,6,7,"div",5)(7,no,34,56,"bit-tab-group",6),Ie.k0s(),Ie.qex(8,7),Ie.j41(9,"button",8),Ie.EFF(10),Ie.nI1(11,"i18n"),Ie.k0s(),Ie.j41(12,"button",9),Ie.EFF(13),Ie.nI1(14,"i18n"),Ie.k0s(),Ie.nrm(15,"button",10),Ie.nI1(16,"i18n"),Ie.bVm(),Ie.k0s()()),2&e&&(Ie.Y8G("formGroup",t.groupForm)("bitSubmit",t.submit),Ie.R7$(),Ie.Y8G("disablePadding",!t.loading),Ie.R7$(2),Ie.SpI(" ",t.title," "),Ie.R7$(),Ie.Y8G("ngIf",t.editMode),Ie.R7$(2),Ie.Y8G("ngIf",t.loading),Ie.R7$(),Ie.Y8G("ngIf",!t.loading),Ie.R7$(3),Ie.SpI(" ",Ie.bMT(11,12,"save")," "),Ie.R7$(2),Ie.Y8G("bitDialogClose",t.ResultType.Canceled),Ie.R7$(),Ie.SpI(" ",Ie.bMT(14,14,"cancel")," "),Ie.R7$(2),Ie.Y8G("bitAction",t.delete)("label",Ie.bMT(16,16,"delete")))},dependencies:[Me.bT,Se.qT,Se.me,Se.BC,Se.cb,Se.j4,Se.JD,Ot.B,Pn.p,xe.$,Ge.L,ze.Q,Re.I,Fe.m,On.j,_n.I,Hn.J,Wn.h,mt.s,Ln.W,Qn.j,Ae.t,Me.Jj,ke.$],encapsulation:2});var ro=i(94438),lo=i(50352),ao=i(38410),co=i(22466),uo=i(32316),ho=i(36572),po=i(69672),go=function(e,t,i,n){return new(i||(i=Promise))(function(o,s){function r(e){try{a(n.next(e))}catch(t){s(t)}}function l(e){try{a(n.throw(e))}catch(t){s(t)}}function a(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(r,l)}a((n=n.apply(e,t||[])).next())})};function mo(e,t){1&e&&(Ie.qex(0),Ie.nrm(1,"i",6),Ie.nI1(2,"i18n"),Ie.j41(3,"span",7),Ie.EFF(4),Ie.nI1(5,"i18n"),Ie.k0s(),Ie.bVm()),2&e&&(Ie.R7$(),Ie.Y8G("title",Ie.mNQ(Ie.bMT(2,3,"loading"))),Ie.R7$(3),Ie.JRh(Ie.bMT(5,5,"loading")))}function vo(e,t){1&e&&(Ie.j41(0,"p"),Ie.EFF(1),Ie.nI1(2,"i18n"),Ie.k0s()),2&e&&(Ie.R7$(),Ie.JRh(Ie.bMT(2,1,"noGroupsInList")))}function fo(e,t){if(1&e){const e=Ie.RV6();Ie.j41(0,"tr",24)(1,"td",25),Ie.bIt("click",function(){const t=Ne.eBV(e).$implicit,i=Ie.XpG(4);return Ne.Njj(i.check(t))}),Ie.j41(2,"input",26),Ie.mxI("ngModelChange",function(t){const i=Ne.eBV(e).$implicit;return Ie.DH7(i.checked,t)||(i.checked=t),Ne.Njj(t)}),Ie.k0s()(),Ie.j41(3,"td",27),Ie.bIt("click",function(){const t=Ne.eBV(e).$implicit,i=Ie.XpG(4);return Ne.Njj(i.edit(t))}),Ie.j41(4,"button",28),Ie.EFF(5),Ie.k0s()(),Ie.j41(6,"td",25),Ie.bIt("click",function(){const t=Ne.eBV(e).$implicit,i=Ie.XpG(4);return Ne.Njj(i.edit(t,i.ModalTabType.Collections))}),Ie.nrm(7,"bit-badge-list",29),Ie.k0s(),Ie.j41(8,"td",16),Ie.nrm(9,"button",18),Ie.nI1(10,"i18n"),Ie.j41(11,"bit-menu",null,1)(13,"button",19),Ie.bIt("click",function(){const t=Ne.eBV(e).$implicit,i=Ie.XpG(4);return Ne.Njj(i.edit(t))}),Ie.nrm(14,"i",30),Ie.EFF(15),Ie.nI1(16,"i18n"),Ie.k0s(),Ie.j41(17,"button",19),Ie.bIt("click",function(){const t=Ne.eBV(e).$implicit,i=Ie.XpG(4);return Ne.Njj(i.edit(t,i.ModalTabType.Members))}),Ie.nrm(18,"i",31),Ie.EFF(19),Ie.nI1(20,"i18n"),Ie.k0s(),Ie.j41(21,"button",19),Ie.bIt("click",function(){const t=Ne.eBV(e).$implicit,i=Ie.XpG(4);return Ne.Njj(i.edit(t,i.ModalTabType.Collections))}),Ie.nrm(22,"i",32),Ie.EFF(23),Ie.nI1(24,"i18n"),Ie.k0s(),Ie.j41(25,"button",19),Ie.bIt("click",function(){const t=Ne.eBV(e).$implicit,i=Ie.XpG(4);return Ne.Njj(i.delete(t))}),Ie.j41(26,"span",20),Ie.nrm(27,"i",21),Ie.EFF(28),Ie.nI1(29,"i18n"),Ie.k0s()()()()()}if(2&e){const e=t.$implicit,i=Ie.sdS(12),n=Ie.XpG(4);Ie.Y8G("ngClass",n.rowHeightClass),Ie.R7$(2),Ie.R50("ngModel",e.checked),Ie.R7$(3),Ie.SpI(" ",e.details.name," "),Ie.R7$(2),Ie.Y8G("items",e.collectionNames)("maxItems",3),Ie.R7$(2),Ie.Y8G("label",Ie.mNQ(Ie.bMT(10,12,"options")))("bitMenuTriggerFor",i),Ie.R7$(6),Ie.SpI(" ",Ie.bMT(16,14,"editInfo")," "),Ie.R7$(4),Ie.SpI(" ",Ie.bMT(20,16,"members")," "),Ie.R7$(4),Ie.SpI(" ",Ie.bMT(24,18,"collections")," "),Ie.R7$(5),Ie.SpI(" ",Ie.bMT(29,20,"delete"))}}function bo(e,t){if(1&e&&Ie.DNE(0,fo,30,22,"tr",23),2&e){const e=t.$implicit;Ie.Y8G("cdkVirtualForOf",e)}}function Io(e,t){if(1&e){const e=Ie.RV6();Ie.j41(0,"bit-table",10),Ie.qex(1,11),Ie.j41(2,"tr")(3,"th",12)(4,"input",13),Ie.bIt("change",function(t){Ne.eBV(e);const i=Ie.XpG(2);return Ne.Njj(i.toggleAllVisible(t))}),Ie.k0s(),Ie.j41(5,"label",14),Ie.EFF(6),Ie.nI1(7,"i18n"),Ie.k0s()(),Ie.j41(8,"th",15),Ie.EFF(9),Ie.nI1(10,"i18n"),Ie.k0s(),Ie.j41(11,"th",16),Ie.EFF(12),Ie.nI1(13,"i18n"),Ie.k0s(),Ie.j41(14,"th",17),Ie.nrm(15,"button",18),Ie.nI1(16,"i18n"),Ie.j41(17,"bit-menu",null,0)(19,"button",19),Ie.bIt("click",function(){Ne.eBV(e);const t=Ie.XpG(2);return Ne.Njj(t.deleteAllSelected())}),Ie.j41(20,"span",20),Ie.nrm(21,"i",21),Ie.EFF(22),Ie.nI1(23,"i18n"),Ie.k0s()()()()(),Ie.bVm(),Ie.DNE(24,bo,1,1,"ng-template",22),Ie.k0s()}if(2&e){const e=Ie.sdS(18),t=Ie.XpG(2);Ie.Y8G("dataSource",t.dataSource),Ie.R7$(6),Ie.JRh(Ie.bMT(7,8,"all")),Ie.R7$(3),Ie.JRh(Ie.bMT(10,10,"name")),Ie.R7$(3),Ie.JRh(Ie.bMT(13,12,"collections")),Ie.R7$(3),Ie.Y8G("label",Ie.mNQ(Ie.bMT(16,14,"options")))("bitMenuTriggerFor",e),Ie.R7$(7),Ie.SpI(" ",Ie.bMT(23,16,"delete"))}}function yo(e,t){if(1&e&&(Ie.qex(0),Ie.DNE(1,vo,3,3,"p",5),Ie.j41(2,"cdk-virtual-scroll-viewport",8),Ie.DNE(3,Io,25,18,"bit-table",9),Ie.k0s(),Ie.bVm()),2&e){const e=Ie.XpG();Ie.R7$(),Ie.Y8G("ngIf",!e.dataSource.filteredData.length),Ie.R7$(),Ie.Y8G("itemSize",e.rowHeight),Ie.R7$(),Ie.Y8G("ngIf",e.dataSource.filteredData.length)}}class wo{constructor(e,t,i,n,o,s,r,l,a,c){this.apiService=e,this.groupService=t,this.route=i,this.i18nService=n,this.dialogService=o,this.logService=s,this.collectionService=r,this.toastService=l,this.keyService=a,this.accountService=c,this.loading=!0,this.dataSource=new Nn.s,this.searchControl=new Se.MJ(""),this.rowHeight=50,this.rowHeightClass="tw-h-[50px]",this.ModalTabType=Xn,this.refreshGroups$=new I.t(null),this.route.params.pipe((0,Vn.M)(e=>this.organizationId=e.organizationId),(0,R.n)(()=>(0,$.z)([(0,Bn.H)(this.apiService.getCollections(this.organizationId)).pipe((0,A.H)(e=>this.toCollectionMap(e))),this.refreshGroups$.pipe((0,R.n)(()=>this.groupService.getAllDetails(this.organizationId)))])),(0,x.T)(([e,t])=>t.map(t=>{var i;return{id:t.id,name:t.name,details:t,checked:!1,collectionNames:t.collections.map(t=>{var i;return null===(i=e[t.id])||void 0===i?void 0:i.name}).sort(null===(i=this.i18nService.collator)||void 0===i?void 0:i.compare)}})),(0,b.pQ)()).subscribe(e=>{this.dataSource.data=e,this.loading=!1}),this.searchControl.valueChanges.pipe((0,D.B)(200),(0,b.pQ)()).subscribe(e=>this.dataSource.filter=(e=>{null!=e||(e="");const t=e.trim().toLowerCase();return e=>{const i=e.details;return-1!=i.id.toLowerCase().indexOf(t)||-1!=i.name.toLowerCase().indexOf(t)}})(e)),this.route.queryParams.pipe((0,E.$)(),(0,b.pQ)()).subscribe(e=>{this.searchControl.setValue(e.search)})}edit(e){return go(this,arguments,void 0,function*(e,t=Xn.Info){const i=(n=this.dialogService,o={data:{initialTab:t,organizationId:this.organizationId,groupId:null!=e?e.details.id:null}},n.open(oo,o));var n,o;const s=yield(0,M.s)(i.closed);s==Dn.Saved?this.refreshGroups$.next():s==Dn.Deleted&&this.removeGroup(e)})}add(){return go(this,void 0,void 0,function*(){yield this.edit(null)})}delete(e){return go(this,void 0,void 0,function*(){if(!(yield this.dialogService.openSimpleDialog({title:e.details.name,content:{key:"deleteGroupConfirmation"},type:"warning"})))return!1;try{yield this.groupService.delete(this.organizationId,e.details.id),this.toastService.showToast({variant:"success",title:null,message:this.i18nService.t("deletedGroupId",e.details.name)}),this.removeGroup(e)}catch(t){this.logService.error(t)}})}deleteAllSelected(){return go(this,void 0,void 0,function*(){const e=this.dataSource.data.filter(e=>e.checked);if(0==e.length)return;const t=e.map(e=>e.details.name).join(", ");if(!(yield this.dialogService.openSimpleDialog({title:{key:"deleteMultipleGroupsConfirmation",placeholders:[e.length.toString()]},content:t,type:"warning"})))return!1;try{yield this.groupService.deleteMany(this.organizationId,e.map(e=>e.details.id)),this.toastService.showToast({variant:"success",title:null,message:this.i18nService.t("deletedManyGroups",e.length.toString())}),e.forEach(e=>this.removeGroup(e))}catch(i){this.logService.error(i)}})}check(e){e.checked=!e.checked}toggleAllVisible(e){this.dataSource.filteredData.forEach(t=>t.checked=e.target.checked)}removeGroup(e){this.dataSource.data=this.dataSource.data.filter(t=>t!==e)}toCollectionMap(e){const t=e.data.map(e=>V.pM.fromCollectionData(new V.Fw(e)));return this.accountService.activeAccount$.pipe(Y.F6,(0,R.n)(e=>this.keyService.orgKeys$(e)),(0,R.n)(e=>this.collectionService.decryptMany$(t,e)),(0,x.T)(e=>{const t={};return e.forEach(e=>t[e.id]=e),t}))}}wo.ɵfac=function(e){return new(e||wo)(Ie.rXU(Vt.G),Ie.rXU(l.EB),Ie.rXU(ut.nX),Ie.rXU(Te.W),Ie.rXU(ye.o3),Ie.rXU(P.K),Ie.rXU(V.YD),Ie.rXU(we.f),Ie.rXU(Yn.Lu),Ie.rXU($e.Di))},wo.ɵcmp=Ie.VBU({type:wo,selectors:[["ng-component"]],standalone:!1,decls:9,vars:9,consts:[["headerMenu",""],["rowMenu",""],[1,"tw-w-80",3,"placeholder","formControl"],["bitButton","","type","button","buttonType","primary",3,"click"],["aria-hidden","true",1,"bwi","bwi-plus","bwi-fw"],[4,"ngIf"],["aria-hidden","true",1,"bwi","bwi-spinner","bwi-spin","tw-text-muted",3,"title"],[1,"tw-sr-only"],["bitScrollLayout","",1,"tw-pb-8",3,"itemSize"],[3,"dataSource",4,"ngIf"],[3,"dataSource"],["header",""],["bitCell","",1,"tw-w-20"],["type","checkbox","bitCheckbox","","id","selectAll",1,"tw-mr-2",3,"change"],["for","selectAll",1,"tw-mb-0","!tw-font-medium","!tw-text-muted"],["bitCell","","bitSortable","name","default",""],["bitCell",""],["bitCell","",1,"tw-w-10"],["type","button","bitIconButton","bwi-ellipsis-v","size","small",3,"bitMenuTriggerFor","label"],["type","button","bitMenuItem","",3,"click"],[1,"tw-text-danger"],["aria-hidden","true",1,"bwi","bwi-trash"],["body",""],["bitRow","",3,"ngClass",4,"cdkVirtualFor","cdkVirtualForOf"],["bitRow","",3,"ngClass"],["bitCell","",1,"tw-cursor-pointer",3,"click"],["type","checkbox","bitCheckbox","",3,"ngModelChange","ngModel"],["bitCell","",1,"tw-cursor-pointer","tw-font-medium",3,"click"],["type","button","bitLink",""],["variant","secondary",3,"items","maxItems"],["aria-hidden","true",1,"bwi","bwi-pencil-square"],["aria-hidden","true",1,"bwi","bwi-user"],["aria-hidden","true",1,"bwi","bwi-collection-shared"]],template:function(e,t){1&e&&(Ie.j41(0,"app-header"),Ie.nrm(1,"bit-search",2),Ie.nI1(2,"i18n"),Ie.j41(3,"button",3),Ie.bIt("click",function(){return t.add()}),Ie.nrm(4,"i",4),Ie.EFF(5),Ie.nI1(6,"i18n"),Ie.k0s()(),Ie.DNE(7,mo,6,7,"ng-container",5)(8,yo,4,3,"ng-container",5)),2&e&&(Ie.R7$(),Ie.Y8G("placeholder",Ie.bMT(2,5,"searchGroups"))("formControl",t.searchControl),Ie.R7$(4),Ie.SpI(" ",Ie.bMT(6,7,"newGroup")," "),Ie.R7$(2),Ie.Y8G("ngIf",t.loading),Ie.R7$(),Ie.Y8G("ngIf",!t.loading))},dependencies:[Me.YU,Me.bT,Se.Zm,Se.BC,Se.vS,Se.l_,ro.p,ze.Q,lo.P,mt.s,_t.o,ht.Z,pt.O,gt.S,ao.Q,co.Y,uo.O,ho._,ho.O,It.S,bt.f,o.yg,o.E$,o.d6,po.lp,ke.$],encapsulation:2});const So=[{path:":organizationId",component:En,canActivate:[(0,u.i)(),c.W_,(0,f.V)(d.OV)],children:[{path:"",pathMatch:"full",canActivate:[(0,Ti.r)(function(e){if((0,d.of)(e))return"vault";if((0,d.pe)(e))return"members";if((0,d.ex)(e))return"groups";if((0,d.Ue)(e))return"reporting";if((0,d.Dl)(e))return"settings";return})],children:[]},{path:"vault",loadChildren:()=>Ci},{path:"settings",loadChildren:()=>i.e(830).then(i.bind(i,46449)).then(e=>e.OrganizationSettingsModule)},{path:"members",loadChildren:()=>i.e(35).then(i.bind(i,39035)).then(e=>e.MembersModule)},{component:wo,path:"groups",canActivate:[(0,f.V)(d.ex)],data:{titleId:"groups"}},{path:"reporting",loadChildren:()=>i.e(449).then(i.bind(i,14449)).then(e=>e.OrganizationReportingModule)},{path:"billing",loadChildren:()=>Promise.all([i.e(281),i.e(614)]).then(i.bind(i,1614)).then(e=>e.OrganizationBillingModule)}]}];class $o{}$o.ɵfac=function(e){return new(e||$o)},$o.ɵmod=Ie.$C({type:$o}),$o.ɵinj=Ne.G2t({imports:[a.iI.forChild(So),a.iI]});var Co=i(5326);class To{}To.ɵfac=function(e){return new(e||To)},To.ɵmod=Ie.$C({type:To}),To.ɵinj=Ne.G2t({imports:[Co.R,be.mH,l.Je,$o,r.G,o.E9,s.t]})},76876:(e,t,i)=>{i.d(t,{l:()=>H});var n=i(72245),o=i(44500),s=i(28202),r=i(90171),l=i(67553),a=i(97319),c=i(56962),d=i(55542),u=i(81525),h=i(37967),p=i(25065),g=i(33812),m=i(12012),v=i(50700),f=i(51757),b=i(2471),I=i(69855),y=i(23649),w=i(35500),S=i(77468),$=i(54471),C=i(3892),T=i(26657),M=i(45154),x=i(56898),G=i(7730),z=i(68016),R=i(86226),F=i(97553),A=i(43759),k=i(38410),j=i(22466),U=i(36572),E=i(88016),X=function(e,t,i,n){return new(i||(i=Promise))(function(o,s){function r(e){try{a(n.next(e))}catch(t){s(t)}}function l(e){try{a(n.throw(e))}catch(t){s(t)}}function a(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(r,l)}a((n=n.apply(e,t||[])).next())})};function D(e,t){if(1&e&&(g.j41(0,"small",16),g.EFF(1),g.k0s()),2&e){const e=g.XpG();g.R7$(),g.JRh(e.name)}}function V(e,t){1&e&&(g.j41(0,"div"),g.EFF(1),g.nI1(2,"i18n"),g.k0s()),2&e&&(g.R7$(),g.SpI(" ",g.bMT(2,1,"noEventsInList")," "))}function B(e,t){1&e&&(g.j41(0,"th",19),g.EFF(1),g.nI1(2,"i18n"),g.k0s()),2&e&&(g.R7$(),g.JRh(g.bMT(2,1,"member")))}function N(e,t){if(1&e&&(g.j41(0,"td",19)(1,"span",27),g.EFF(2),g.k0s()()),2&e){const e=g.XpG().$implicit;g.R7$(),g.Y8G("appA11yTitle",g.mNQ(e.userEmail)),g.R7$(),g.JRh(e.userName)}}function Y(e,t){if(1&e&&(g.j41(0,"tr",24)(1,"td",19),g.EFF(2),g.nI1(3,"date"),g.k0s(),g.j41(4,"td",19),g.nrm(5,"i",25),g.j41(6,"span",20),g.EFF(7),g.k0s()(),g.DNE(8,N,3,3,"td",21),g.nrm(9,"td",26),g.k0s()),2&e){const e=t.$implicit,i=g.XpG(3);g.R7$(2),g.JRh(g.i5U(3,11,e.date,"medium")),g.R7$(3),g.HbH(g.VkB("tw-text-muted bwi bwi-lg ",e.appIcon)),g.Y8G("title",g.ai1("",e.appName,", ",e.ip)),g.R7$(2),g.Lme("",e.appName,", ",e.ip),g.R7$(),g.Y8G("ngIf",i.showUser),g.R7$(),g.Y8G("innerHTML",e.message,g.npT)}}function q(e,t){if(1&e&&(g.DNE(0,Y,10,14,"tr",23),g.nI1(1,"async")),2&e){const e=t.$implicit;g.Y8G("ngForOf",g.bMT(1,1,e))}}function P(e,t){if(1&e&&(g.j41(0,"bit-table",17),g.qex(1,18),g.j41(2,"tr")(3,"th",19),g.EFF(4),g.nI1(5,"i18n"),g.k0s(),g.j41(6,"th",19)(7,"span",20),g.EFF(8),g.nI1(9,"i18n"),g.k0s()(),g.DNE(10,B,3,3,"th",21),g.j41(11,"th",19),g.EFF(12),g.nI1(13,"i18n"),g.k0s()(),g.bVm(),g.DNE(14,q,2,3,"ng-template",22),g.k0s()),2&e){const e=g.XpG();g.Y8G("dataSource",e.dataSource),g.R7$(4),g.JRh(g.bMT(5,5,"timestamp")),g.R7$(4),g.JRh(g.bMT(9,7,"client")),g.R7$(2),g.Y8G("ngIf",e.showUser),g.R7$(2),g.JRh(g.bMT(13,9,"event"))}}function O(e,t){if(1&e&&(g.j41(0,"button",28),g.EFF(1),g.nI1(2,"i18n"),g.k0s()),2&e){const e=g.XpG();g.Y8G("bitAction",e.loadMoreEvents),g.R7$(),g.SpI(" ",g.bMT(2,2,"loadMore")," ")}}class _{get name(){return this.params.name}get showUser(){var e;return null!==(e=this.params.showUser)&&void 0!==e&&e}constructor(e,t,i,n,o,s,r,l,a,c,u,h,p,g){this.params=e,this.apiService=t,this.i18nService=i,this.eventService=n,this.userNamePipe=o,this.logService=s,this.organizationUserApiService=r,this.formBuilder=l,this.validationService=a,this.toastService=c,this.router=u,this.activeRoute=h,this.accountService=p,this.organizationService=g,this.loading=!0,this.dataSource=new d.s,this.filterFormGroup=this.formBuilder.group({start:[""],end:[""]}),this.orgUsersUserIdMap=new Map,this.orgUsersIdMap=new Map,this.loadMoreEvents=()=>X(this,void 0,void 0,function*(){yield this.loadEvents(!1)}),this.refreshEvents=()=>X(this,void 0,void 0,function*(){yield this.loadEvents(!0)})}ngOnInit(){return X(this,void 0,void 0,function*(){const e=this.eventService.getDefaultDateFilters();this.filterFormGroup.setValue({start:e[0],end:e[1]}),yield this.load()})}ngOnDestroy(){return X(this,void 0,void 0,function*(){yield(0,n._)(this.activeRoute.queryParams.pipe((0,o.n)(e=>X(this,void 0,void 0,function*(){yield this.router.navigate([],{queryParams:Object.assign(Object.assign({},e),{viewEvents:null})})}))))})}load(){return X(this,void 0,void 0,function*(){try{if(this.showUser){(yield this.organizationUserApiService.getAllMiniUserDetails(this.params.organizationId)).data.forEach(e=>{const t=this.userNamePipe.transform(e);this.orgUsersIdMap.set(e.id,{name:t,email:e.email}),this.orgUsersUserIdMap.set(e.userId,{name:t,email:e.email})})}yield this.loadEvents(!0)}catch(e){this.logService.error(e),this.validationService.showError(e)}this.loading=!1})}loadEvents(e){return X(this,void 0,void 0,function*(){let t,i=null;try{i=this.eventService.formatDateFilters(this.filterFormGroup.value.start,this.filterFormGroup.value.end)}catch(o){return void this.toastService.showToast({variant:"error",title:this.i18nService.t("errorOccurred"),message:this.i18nService.t("invalidDateRange")})}t="user"===this.params.entity&&this.params.providerId?yield this.apiService.getEventsProviderUser(this.params.providerId,this.params.entityId,i[0],i[1],e?null:this.continuationToken):"user"===this.params.entity?yield this.apiService.getEventsOrganizationUser(this.params.organizationId,this.params.entityId,i[0],i[1],e?null:this.continuationToken):"secret"===this.params.entity?yield this.apiService.getEventsSecret(this.params.organizationId,this.params.entityId,i[0],i[1],e?null:this.continuationToken):"service-account"===this.params.entity?yield this.apiService.getEventsServiceAccount(this.params.organizationId,this.params.entityId,i[0],i[1],e?null:this.continuationToken):"project"===this.params.entity?yield this.apiService.getEventsProject(this.params.organizationId,this.params.entityId,i[0],i[1],e?null:this.continuationToken):yield this.apiService.getEventsCipher(this.params.entityId,i[0],i[1],e?null:this.continuationToken),this.continuationToken=t.continuationToken;const n=yield Promise.all(t.data.map(e=>X(this,void 0,void 0,function*(){const t=null==e.actingUserId?e.userId:e.actingUserId,i=yield this.eventService.getEventInfo(e),n=this.showUser&&null!=t&&this.orgUsersUserIdMap.has(t)?this.orgUsersUserIdMap.get(t):null;return new a.g({message:i.message,humanReadableMessage:i.humanReadableMessage,appIcon:i.appIcon,appName:i.appName,userId:t,userName:null!=n?n.name:this.showUser?this.i18nService.t("unknown"):null,userEmail:null!=n?n.email:this.showUser?"":null,date:e.date,ip:e.ipAddress,type:e.type,installationId:e.installationId,systemUser:e.systemUser,serviceAccountId:e.serviceAccountId})})));!e&&null!=this.dataSource.data&&this.dataSource.data.length>0?this.dataSource.data=this.dataSource.data.concat(n):this.dataSource.data=n})}}_.ɵfac=function(e){return new(e||_)(g.rXU(u.Qs),g.rXU(m.G),g.rXU(v.W),g.rXU(h.US),g.rXU(r.b),g.rXU(c.K),g.rXU(s.uB),g.rXU(f.ok),g.rXU(b.B),g.rXU(I.f),g.rXU(y.Ix),g.rXU(y.nX),g.rXU(w.Di),g.rXU(l.PV))},_.ɵcmp=g.VBU({type:_,selectors:[["ng-component"]],decls:34,vars:30,consts:[["dialogSize","large",3,"loading"],["bitDialogTitle",""],["class","tw-text-muted",4,"ngIf"],["bitDialogContent",""],[3,"formGroup","bitSubmit"],[1,"tw-flex","tw-items-center","tw-space-x-2"],["bitInput","","type","datetime-local","id","start","formControlName","start",3,"placeholder"],[1,"tw-mx-2"],["bitInput","","type","datetime-local","id","end","formControlName","end",3,"placeholder"],["type","submit","bitButton","","buttonType","primary","bitFormButton",""],["aria-hidden","true",1,"bwi","bwi-refresh","bwi-fw"],[4,"ngIf"],[3,"dataSource",4,"ngIf"],["bitButton","","buttonType","secondary","block","","type","button",3,"bitAction",4,"ngIf"],["bitDialogFooter",""],["bitButton","","buttonType","secondary","type","button","bitDialogClose",""],[1,"tw-text-muted"],[3,"dataSource"],["header",""],["bitCell",""],[1,"tw-sr-only"],["bitCell","",4,"ngIf"],["body",""],["bitRow","",4,"ngFor","ngForOf"],["bitRow",""],["aria-hidden","true",3,"title"],["bitCell","",3,"innerHTML"],[3,"appA11yTitle"],["bitButton","","buttonType","secondary","block","","type","button",3,"bitAction"]],template:function(e,t){1&e&&(g.j41(0,"bit-dialog",0)(1,"span",1),g.EFF(2),g.nI1(3,"i18n"),g.DNE(4,D,2,1,"small",2),g.k0s(),g.j41(5,"div",3)(6,"form",4)(7,"div",5)(8,"bit-form-field")(9,"bit-label"),g.EFF(10),g.nI1(11,"i18n"),g.k0s(),g.nrm(12,"input",6),g.nI1(13,"i18n"),g.k0s(),g.j41(14,"span",7),g.EFF(15,"-"),g.k0s(),g.j41(16,"bit-form-field")(17,"bit-label"),g.EFF(18),g.nI1(19,"i18n"),g.k0s(),g.nrm(20,"input",8),g.nI1(21,"i18n"),g.k0s(),g.j41(22,"button",9),g.nrm(23,"i",10),g.EFF(24),g.nI1(25,"i18n"),g.k0s()()(),g.nrm(26,"hr"),g.DNE(27,V,3,3,"div",11)(28,P,15,11,"bit-table",12)(29,O,3,4,"button",13),g.k0s(),g.qex(30,14),g.j41(31,"button",15),g.EFF(32),g.nI1(33,"i18n"),g.k0s(),g.bVm(),g.k0s()),2&e&&(g.Y8G("loading",t.loading),g.R7$(2),g.SpI(" ",g.bMT(3,16,"eventLogs")," "),g.R7$(2),g.Y8G("ngIf",t.name),g.R7$(2),g.Y8G("formGroup",t.filterFormGroup)("bitSubmit",t.refreshEvents),g.R7$(4),g.JRh(g.bMT(11,18,"from")),g.R7$(2),g.Y8G("placeholder",g.mNQ(g.bMT(13,20,"startDate"))),g.R7$(6),g.JRh(g.bMT(19,22,"to")),g.R7$(2),g.Y8G("placeholder",g.mNQ(g.bMT(21,24,"endDate"))),g.R7$(4),g.SpI(" ",g.bMT(25,26,"refresh")," "),g.R7$(3),g.Y8G("ngIf",!t.dataSource.data||!t.dataSource.data.length),g.R7$(),g.Y8G("ngIf",null==t.dataSource||null==t.dataSource.data?null:t.dataSource.data.length),g.R7$(),g.Y8G("ngIf",t.continuationToken),g.R7$(3),g.SpI(" ",g.bMT(33,28,"close")," "))},dependencies:[p.G,S.Sq,S.bT,f.qT,f.me,f.BC,f.cb,f.j4,f.JD,$.C,C.p,T.$,M.L,x.Q,G.I,z.m,R.j,F.J,A.h,k.Q,j.Y,U._,U.O,S.Jj,S.vh,E.$],encapsulation:2});const H=(e,t)=>e.open(_,t)},77259:(e,t,i)=>{i.d(t,{V:()=>v});var n=i(74208),o=i(23649),s=i(26932),r=i(72245),l=i(44500),a=i(67553),c=i(35500),d=i(3633),u=i(50700),h=i(15639),p=i(39488),g=i(69855),m=function(e,t,i,n){return new(i||(i=Promise))(function(o,s){function r(e){try{a(n.next(e))}catch(t){s(t)}}function l(e){try{a(n.throw(e))}catch(t){s(t)}}function a(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(r,l)}a((n=n.apply(e,t||[])).next())})};function v(e){return(t,i)=>m(this,void 0,void 0,function*(){const m=(0,n.WQX)(o.Ix),v=(0,n.WQX)(a.PV),f=(0,n.WQX)(g.f),b=(0,n.WQX)(u.W),I=(0,n.WQX)(p.H),y=(0,n.WQX)(c.Di),w=(0,n.WQX)(n.uvJ);null==(yield I.getLastSync())&&(yield I.fullSync(!1));const S=yield(0,r._)(y.activeAccount$.pipe(d.F6,(0,l.n)(e=>v.organizations$(e)),(0,h.Hc)(t.params.organizationId)));if(null==S)return m.createUrlTree(["/"]);if(!S.isOwner&&!S.enabled)return f.showToast({variant:"error",title:null,message:b.t("organizationIsDisabled")}),m.createUrlTree(["/"]);if(null==e)return!0;const $=(0,n.N4e)(w,()=>e(S)),C=(0,s.A)($)?yield(0,r._)($):yield Promise.resolve($);if(!0!==C&&!1!==C)throw new Error("Permission callback did not resolve to a boolean.");if(!C){const e=i.root.queryParamMap.get("itemId")||i.root.queryParamMap.get("cipherId");return e?m.createUrlTree(["/vault"],{queryParams:{itemId:e}}):(f.showToast({variant:"error",title:null,message:b.t("accessDenied")}),(0,a.OV)(S)?m.createUrlTree(["/organizations",S.id]):m.createUrlTree(["/"]))}return!0})}},95661:(e,t,i)=>{i.d(t,{r:()=>d});var n=i(74208),o=i(23649),s=i(72245),r=i(3204),l=i(67553),a=i(35500),c=function(e,t,i,n){return new(i||(i=Promise))(function(o,s){function r(e){try{a(n.next(e))}catch(t){s(t)}}function l(e){try{a(n.throw(e))}catch(t){s(t)}}function a(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(r,l)}a((n=n.apply(e,t||[])).next())})};function d(e){return(t,i)=>c(this,void 0,void 0,function*(){const c=(0,n.WQX)(o.Ix),d=(0,n.WQX)(l.PV),u=(0,n.WQX)(a.Di),h=yield(0,s._)(u.activeAccount$.pipe((0,r.T)(e=>null==e?void 0:e.id)));if(!h)return c.createUrlTree(["/"]);const p=yield(0,s._)(d.organizations$(h).pipe((0,r.T)(e=>e.find(e=>e.id===t.params.organizationId))));if(!p)return c.createUrlTree(["/"]);if(null!=e){let t=e(p);return"string"==typeof t&&(t=[t]),c.createUrlTree([i.url,...t])}return null!=p&&(0,l.OV)(p)?c.createUrlTree(["/organizations",p.id]):c.createUrlTree(["/"])})}},97319:(e,t,i)=>{i.d(t,{g:()=>n});class n{constructor(e){this.message=e.message,this.humanReadableMessage=e.humanReadableMessage,this.appIcon=e.appIcon,this.appName=e.appName,this.userId=e.userId,this.userName=e.userName,this.userEmail=e.userEmail,this.date=e.date,this.ip=e.ip,this.type=e.type,this.installationId=e.installationId,this.systemUser=e.systemUser,this.serviceAccountId=e.serviceAccountId}}}}]);
//# sourceMappingURL=155.d06fd751c6eeada1c84d.js.map